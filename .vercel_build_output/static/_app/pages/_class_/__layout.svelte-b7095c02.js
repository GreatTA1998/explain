var Xe=Object.defineProperty;var Ie=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var ke=(o,e,n)=>e in o?Xe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,fe=(o,e)=>{for(var n in e||(e={}))xe.call(e,n)&&ke(o,n,e[n]);if(Ie)for(var n of Ie(e))et.call(e,n)&&ke(o,n,e[n]);return o};import{S as X,i as x,s as ee,ad as tt,ae as st,Z as ne,$ as ye,e as E,t as U,k as M,j as A,c as O,a as T,g as q,d as p,n as N,m as z,L as h,f as w,M as I,o as P,a3 as ce,h as te,a1 as Ce,x as $,u as D,v as L,E as H,A as oe,a8 as ue,P as J,ab as nt,O as G,_ as le,af as Ee,r as K,w as Q,ag as ot,V as lt,l as F,ah as at,ai as rt,aj as it,ak as ft,al as ct,b as j,am as ut,U as mt,H as me,I as de,J as _e,K as pe,a6 as he,an as dt,ao as Oe,ap as Te,aq as _t,ar as pt,R as ge,as as ht,a9 as gt,aa as bt,a7 as Re,Q as $t,at as ae,au as Se,av as je,aw as Ve,a0 as vt,ax as re,ay as Dt,az as wt,aA as It,aB as kt,N as Me}from"../../chunks/vendor-3008e3e0.js";import{u as Ne,g as be,b as $e,i as ve,r as Z,d as Ae,e as se,f as ze,a as yt,c as Ct}from"../../chunks/navigation-6099b534.js";import{b as Et}from"../../chunks/canvas-10fde0b2.js";import"../../chunks/singletons-12a22614.js";function Pe(o,e,n){const t=o.slice();return t[18]=e[n],t}function Ot(o){let e;return{c(){e=U("arrow_drop_down")},l(n){e=q(n,"arrow_drop_down")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Le(o){let e,n,t=o[7].enrolledClasses,s=[];for(let a=0;a<t.length;a+=1)s[a]=qe(Pe(o,t,a));const l=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=F()},l(a){for(let r=0;r<s.length;r+=1)s[r].l(a);e=F()},m(a,r){for(let i=0;i<s.length;i+=1)s[i].m(a,r);w(a,e,r),n=!0},p(a,r){if(r&385){t=a[7].enrolledClasses;let i;for(i=0;i<t.length;i+=1){const c=Pe(a,t,i);s[i]?(s[i].p(c,r),$(s[i],1)):(s[i]=qe(c),s[i].c(),$(s[i],1),s[i].m(e.parentNode,e))}for(K(),i=t.length;i<s.length;i+=1)l(i);Q()}},i(a){if(!n){for(let r=0;r<t.length;r+=1)$(s[r]);n=!0}},o(a){s=s.filter(Boolean);for(let r=0;r<s.length;r+=1)D(s[r]);n=!1},d(a){at(s,a),a&&p(e)}}}function Ue(o){let e,n;function t(){return o[10](o[18])}return e=new it({props:{$$slots:{default:[Tt]},$$scope:{ctx:o}}}),e.$on("SMUI:action",t),{c(){A(e.$$.fragment)},l(s){z(e.$$.fragment,s)},m(s,l){P(e,s,l),n=!0},p(s,l){o=s;const a={};l&2097280&&(a.$$scope={dirty:l,ctx:o}),e.$set(a)},i(s){n||($(e.$$.fragment,s),n=!0)},o(s){D(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function Tt(o){let e=o[18].name+"",n,t;return{c(){n=U(e),t=M()},l(s){n=q(s,e),t=N(s)},m(s,l){w(s,n,l),w(s,t,l)},p(s,l){l&128&&e!==(e=s[18].name+"")&&te(n,e)},d(s){s&&p(n),s&&p(t)}}}function qe(o){let e,n,t=o[18].name!==o[0]&&Ue(o);return{c(){t&&t.c(),e=F()},l(s){t&&t.l(s),e=F()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[18].name!==s[0]?t?(t.p(s,l),l&129&&$(t,1)):(t=Ue(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),D(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){D(t),n=!1},d(s){t&&t.d(s),s&&p(e)}}}function Rt(o){let e,n,t=o[7].enrolledClasses&&Le(o);return{c(){t&&t.c(),e=F()},l(s){t&&t.l(s),e=F()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[7].enrolledClasses?t?(t.p(s,l),l&128&&$(t,1)):(t=Le(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),D(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){D(t),n=!1},d(s){t&&t.d(s),s&&p(e)}}}function Be(o){let e,n,t;function s(a){o[11](a)}let l={options:o[6],getOptionLabel:Vt,textfield$variant:"outlined",label:"Search class"};return o[3]!==void 0&&(l.value=o[3]),e=new rt({props:l}),ne.push(()=>ye(e,"value",s)),{c(){A(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,r){P(e,a,r),t=!0},p(a,r){const i={};r&64&&(i.options=a[6]),!n&&r&8&&(n=!0,i.value=a[3],Ce(()=>n=!1)),e.$set(i)},i(a){t||($(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){L(e,a)}}}function St(o){let e,n,t,s;e=new Ee({props:{$$slots:{default:[Rt]},$$scope:{ctx:o}}});let l=o[2].length>0&&Be(o);return{c(){A(e.$$.fragment),n=M(),t=E("div"),l&&l.c(),this.h()},l(a){z(e.$$.fragment,a),n=N(a),t=O(a,"DIV",{style:!0});var r=T(t);l&&l.l(r),r.forEach(p),this.h()},h(){h(t,"margin","4px")},m(a,r){P(e,a,r),w(a,n,r),w(a,t,r),l&&l.m(t,null),s=!0},p(a,r){const i={};r&2097281&&(i.$$scope={dirty:r,ctx:a}),e.$set(i),a[2].length>0?l?(l.p(a,r),r&4&&$(l,1)):(l=Be(a),l.c(),$(l,1),l.m(t,null)):l&&(K(),D(l,1,1,()=>{l=null}),Q())},i(a){s||($(e.$$.fragment,a),$(l),s=!0)},o(a){D(e.$$.fragment,a),D(l),s=!1},d(a){L(e,a),a&&p(n),a&&p(t),l&&l.d()}}}function jt(o){let e,n,t,s,l,a,r,i,c,f,u,m,d,v,k,R;f=new tt({props:{class:"material-icons",on:!0,$$slots:{default:[Ot]},$$scope:{ctx:o}}});function B(_){o[13](_)}let W={anchor:!1,anchorCorner:"BOTTOM_LEFT",style:"left: 70px; top: 65px; width: 220px; overflow: visible;",$$slots:{default:[St]},$$scope:{ctx:o}};return o[4]!==void 0&&(W.anchorElement=o[4]),m=new st({props:W}),o[12](m),ne.push(()=>ye(m,"anchorElement",B)),{c(){e=E("div"),n=E("div"),t=E("div"),s=E("h1"),l=U(o[0]),a=M(),r=E("div"),i=U(o[1]),c=M(),A(f.$$.fragment),u=M(),A(m.$$.fragment),this.h()},l(_){e=O(_,"DIV",{});var y=T(e);n=O(y,"DIV",{style:!0});var b=T(n);t=O(b,"DIV",{});var g=T(t);s=O(g,"H1",{style:!0});var C=T(s);l=q(C,o[0]),C.forEach(p),a=N(g),r=O(g,"DIV",{style:!0});var V=T(r);i=q(V,o[1]),V.forEach(p),g.forEach(p),c=N(b),z(f.$$.fragment,b),b.forEach(p),u=N(y),z(m.$$.fragment,y),y.forEach(p),this.h()},h(){h(s,"font-family","Roboto, sans-serif"),h(s,"font-weight","400"),h(s,"margin-left","6px"),h(s,"margin-top","5px"),h(s,"margin-bottom","0px"),h(s,"font-size","2.0rem"),h(r,"font-family","Roboto,sans-serif"),h(r,"font-size","0.875rem"),h(r,"color","rgba(0,0,0,.6)"),h(r,"margin-left","8px"),h(r,"margin-bottom","12px"),h(n,"display","flex"),h(n,"align-items","center")},m(_,y){w(_,e,y),I(e,n),I(n,t),I(t,s),I(s,l),I(t,a),I(t,r),I(r,i),I(n,c),P(f,n,null),I(e,u),P(m,e,null),o[14](e),v=!0,k||(R=ce(n,"click",o[9]),k=!0)},p(_,[y]){(!v||y&1)&&te(l,_[0]),(!v||y&2)&&te(i,_[1]);const b={};y&2097152&&(b.$$scope={dirty:y,ctx:_}),f.$set(b);const g={};y&2097357&&(g.$$scope={dirty:y,ctx:_}),!d&&y&16&&(d=!0,g.anchorElement=_[4],Ce(()=>d=!1)),m.$set(g)},i(_){v||($(f.$$.fragment,_),$(m.$$.fragment,_),v=!0)},o(_){D(f.$$.fragment,_),D(m.$$.fragment,_),v=!1},d(_){_&&p(e),L(f),o[12](null),L(m),o[14](null),k=!1,R()}}}const Vt=o=>o?`${o.name} (${o.description})`:"";function Mt(o,e,n){let t,s;H(o,Ne,_=>n(7,s=_));let{nameOfClass:l}=e,{descriptionOfClass:a}=e,r,i=[],c="";console.log("$user =",s);let f;oe(async()=>{console.log("$user.enrolledClasses =",s.enrolledClasses);const _=ue(J(),"/classes"),y=await nt(_),b=[];y.forEach(g=>{b.push(fe({id:g.id},g.data()))}),n(2,i=[...b])});async function u({mitClass:_}){console.log("join mitClass =",_);for(const b of s.enrolledClasses)if(b.id===_.id){alert(`You are already in ${_.name}`);return}const y=J();le(G(y,`users/${s.uid}`),{enrolledClasses:ot(_),mostRecentClassID:_.id}),le(G(y,`classes/${_.id}`),{numOfMembers:lt(1)}),be(`/${_.id}/${_.id}`)}async function m(_){const y=J(),b=G(y,`users/${s.uid}`);le(b,{mostRecentClassID:_.id}),be(`/${_.id}/${_.id}`)}const d=()=>f.setOpen(!0),v=_=>m(_);function k(_){c=_,n(3,c)}function R(_){ne[_?"unshift":"push"](()=>{f=_,n(5,f)})}function B(_){r=_,n(4,r)}function W(_){ne[_?"unshift":"push"](()=>{r=_,n(4,r)})}return o.$$set=_=>{"nameOfClass"in _&&n(0,l=_.nameOfClass),"descriptionOfClass"in _&&n(1,a=_.descriptionOfClass)},o.$$.update=()=>{o.$$.dirty&8&&c&&(console.log("selected option =",c),u({mitClass:c})),o.$$.dirty&4&&n(6,t=i.filter(_=>["8.01"].includes(_.name)))},[l,a,i,c,r,f,t,s,m,d,v,k,R,B,W]}class Nt extends X{constructor(e){super();x(this,e,Mt,jt,ee,{nameOfClass:0,descriptionOfClass:1})}}function At(o){let e;const n=o[2].default,t=me(n,o,o[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,l){t&&t.p&&(!e||l&8)&&de(t,n,s,s[3],e?pe(n,s[3],l,null):_e(s[3]),null)},i(s){e||($(t,s),e=!0)},o(s){D(t,s),e=!1},d(s){t&&t.d(s)}}}function zt(o){let e,n,t,s,l,a,r,i,c,f;return r=new Nt({props:{nameOfClass:o[0],descriptionOfClass:o[1]}}),c=new Ee({props:{$$slots:{default:[At]},$$scope:{ctx:o}}}),{c(){e=E("div"),n=E("div"),t=E("img"),l=M(),a=E("div"),A(r.$$.fragment),i=M(),A(c.$$.fragment),this.h()},l(u){e=O(u,"DIV",{style:!0,class:!0});var m=T(e);n=O(m,"DIV",{style:!0,class:!0});var d=T(n);t=O(d,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),l=N(d),a=O(d,"DIV",{class:!0});var v=T(a);z(r.$$.fragment,v),v.forEach(p),d.forEach(p),m.forEach(p),i=N(u),z(c.$$.fragment,u),this.h()},h(){mt(t.src,s="/logo.png")||j(t,"src",s),j(t,"width","60"),j(t,"height","54"),j(t,"alt","web-logo"),j(t,"class","svelte-f4hgt4"),j(a,"class","svelte-f4hgt4"),h(n,"display","flex"),h(n,"align-items","center"),j(n,"class","svelte-f4hgt4"),h(e,"margin-bottom","12px"),h(e,"padding-top","2px"),h(e,"padding-bottom","0"),h(e,"padding-left","8px"),j(e,"class","mdc-elevation--z"+4+" svelte-f4hgt4")},m(u,m){w(u,e,m),I(e,n),I(n,t),I(n,l),I(n,a),P(r,a,null),w(u,i,m),P(c,u,m),f=!0},p(u,m){const d={};m&1&&(d.nameOfClass=u[0]),m&2&&(d.descriptionOfClass=u[1]),r.$set(d);const v={};m&8&&(v.$$scope={dirty:m,ctx:u}),c.$set(v)},i(u){f||($(r.$$.fragment,u),$(c.$$.fragment,u),f=!0)},o(u){D(r.$$.fragment,u),D(c.$$.fragment,u),f=!1},d(u){u&&p(e),L(r),u&&p(i),L(c,u)}}}function Pt(o){let e,n;return e=new ut({props:{$$slots:{default:[zt]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,s){P(e,t,s),n=!0},p(t,s){const l={};s&11&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Lt(o){let e;return{c(){e=E("main"),this.h()},l(n){e=O(n,"MAIN",{class:!0,id:!0,style:!0});var t=T(e);t.forEach(p),this.h()},h(){j(e,"class","main-content svelte-f4hgt4"),j(e,"id","main-content"),h(e,"padding","0")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Ut(o){let e,n,t,s,l;return n=new ft({props:{style:"overflow-y: scroll; height: 100%;",class:"mdc-elevation--z"+5,$$slots:{default:[Pt]},$$scope:{ctx:o}}}),s=new ct({props:{class:"app-content",$$slots:{default:[Lt]},$$scope:{ctx:o}}}),{c(){e=E("div"),A(n.$$.fragment),t=M(),A(s.$$.fragment),this.h()},l(a){e=O(a,"DIV",{class:!0});var r=T(e);z(n.$$.fragment,r),t=N(r),z(s.$$.fragment,r),r.forEach(p),this.h()},h(){j(e,"class","drawer-container svelte-f4hgt4")},m(a,r){w(a,e,r),P(n,e,null),I(e,t),P(s,e,null),l=!0},p(a,[r]){const i={};r&11&&(i.$$scope={dirty:r,ctx:a}),n.$set(i);const c={};r&8&&(c.$$scope={dirty:r,ctx:a}),s.$set(c)},i(a){l||($(n.$$.fragment,a),$(s.$$.fragment,a),l=!0)},o(a){D(n.$$.fragment,a),D(s.$$.fragment,a),l=!1},d(a){a&&p(e),L(n),L(s)}}}function qt(o,e,n){let{$$slots:t={},$$scope:s}=e,{nameOfClass:l}=e,{descriptionOfClass:a}=e;return o.$$set=r=>{"nameOfClass"in r&&n(0,l=r.nameOfClass),"descriptionOfClass"in r&&n(1,a=r.descriptionOfClass),"$$scope"in r&&n(3,s=r.$$scope)},[l,a,t,s]}class Bt extends X{constructor(e){super();x(this,e,qt,Ut,ee,{nameOfClass:0,descriptionOfClass:1})}}function Ft(o,e,n){let t,s,l,a;H(o,$e,v=>n(10,s=v)),H(o,Ne,v=>n(3,l=v)),H(o,ve,v=>n(4,a=v));let{classID:r}=e,{roomID:i}=e,c,f,u,m,d;return he(()=>{d&&d(),a&&(dt(f),ve.set(!1)),m&&m.cancel()}),oe(()=>{Z.set({}),u=Oe(Te(),".info/connected"),d=_t(u,async v=>{if(v.val()===!0){const k=Ae();c=Oe(Te(),`/class/${r}/room/${i}/participants/${k}`),m=pt(c),m.set({hasDisconnected:!0,userUID:l.uid}),n(2,f=G(J(),`classes/${r}/participants/${k}`)),ge(f,{uid:l.uid,browserTabID:s,currentRoomID:i,name:t}),ve.set(!0)}})}),o.$$set=v=>{"classID"in v&&n(0,r=v.classID),"roomID"in v&&n(1,i=v.roomID)},o.$$.update=()=>{o.$$.dirty&8&&(t=l.name?l.name:"Beaver #"),o.$$.dirty&30&&a&&l.name&&le(f,{currentRoomID:i,name:l.name})},[r,i,f,l,a]}class Ht extends X{constructor(e){super();x(this,e,Ft,null,ee,{classID:0,roomID:1})}}const Jt="0ac8a98cf9bef2827f5beef5cd36c4f42a442863ce904a2469de12caa9097fa1",Kt=o=>({activeSpeakerID:o&2,firestoreIDToDailyID:o&1}),Fe=o=>({toggleMic:o[2],activeSpeakerID:o[1],firestoreIDToDailyID:o[0]});function Qt(o){let e;const n=o[8].default,t=me(n,o,o[7],Fe);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,[l]){t&&t.p&&(!e||l&131)&&de(t,n,s,s[7],e?pe(n,s[7],l,Kt):_e(s[7]),Fe)},i(s){e||($(t,s),e=!0)},o(s){D(t,s),e=!1},d(s){t&&t.d(s)}}}async function Wt({track:o,participant:e}){switch(o.kind){case"audio":if(e.local)return;{const n=document.createElement("audio");n.srcObject=new MediaStream([o]),n.setAttribute("id","audio"+e.user_id),n.setAttribute("playsinline",!0),n.setAttribute("autoplay",!0),document.getElementById("container-for-audio-elements").appendChild(n)}break}}async function Yt({track:o,participant:e}){const n=document.getElementById(o.id);n&&(n.srcObject=null,n.remove())}function Gt(o,e,n){let t,s,l;H(o,se,g=>n(10,t=g)),H(o,$e,g=>n(11,s=g)),H(o,ze,g=>n(12,l=g));let{$$slots:a={},$$scope:r}=e,{roomID:i}=e,c,f,u,m,d,v="";he(()=>{m==="connected"&&y()}),oe(async()=>{await k(),R()});async function k(){return new Promise(async g=>{if(!l){const S=await navigator.mediaDevices.getUserMedia({audio:!0});ze.set(S)}const[C]=l.getAudioTracks();c=ht.createCallObject({audioSource:C,videoSource:!1});const V=["participant-joined","participant-updated","participant-left"];for(const S of V)c.on(S,()=>{se.set(c.participants());const Y={};for(const ie of Object.keys(t)){const De=t[ie],we=De.user_name;we&&(Y[we]=De.user_id)}n(0,f=Y)});c.on("track-started",Wt),c.on("track-stopped",Yt),c.on("active-speaker-change",({activeSpeaker:S})=>{n(1,v=S.peerId)}),c.on("load-attempt-failed",({action:S,errorMsg:Y})=>{alert(S+": "+Y)}),c.on("error",({action:S,errorMsg:Y})=>{alert(S+": "+Y)}),g()})}async function R(){n(4,u="not_connected"),n(5,m="connecting"),n(6,d=i);const{url:g}=await B();g&&(await W(g),n(4,u="connecting"),n(5,m="connected"))}function B(){return new Promise(async g=>{try{const C=2*60*60,S=await(await fetch("https://api.daily.co/v1/rooms",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+Jt},body:JSON.stringify({name:i,properties:{exp:Math.round(Date.now()/1e3)+C,eject_at_room_exp:!0,start_video_off:!0}})})).json();S.error==="invalid-request-error"&&S.info===`a room named ${i} already exists`?g({url:`https://feynman.daily.co/${i}`}):g(S)}catch(C){console.error(C),alert(C),reject({url:""})}})}function W(g){return new Promise(async(C,V)=>{try{await c.join({url:g,userName:s}),C()}catch(S){console.log("error)"),alert(S),V()}})}function _(){console.log("toggling mic"),c.setLocalAudio(!t.local.audio),se.set(c.participants())}function y(){const g=document.querySelectorAll("audio");for(const C of g)C.remove();b(),n(4,u="connected"),n(5,m="not_connected")}function b(){c.leave(),se.set({}),n(1,v="")}return o.$$set=g=>{"roomID"in g&&n(3,i=g.roomID),"$$scope"in g&&n(7,r=g.$$scope)},o.$$.update=()=>{o.$$.dirty&120&&u==="connecting"&&m==="connected"&&d!==i&&(console.log("part 1: user moved to a different room before voice chat connected"),y()),o.$$.dirty&120&&u==="connected"&&m==="not_connected"&&d!==i&&(console.log("part 2: ready to join the new room"),R())},[f,v,_,i,u,m,d,r,a]}class Zt extends X{constructor(e){super();x(this,e,Gt,Qt,ee,{roomID:3})}}function He(o,e,n){const t=o.slice();return t[21]=e[n],t}function Je(o,e,n){const t=o.slice();return t[24]=e[n],t}function Xt(o){let e,n;return{c(){e=E("div"),n=U("(no title)"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=q(s,"(no title)"),s.forEach(p),this.h()},h(){h(e,"margin-bottom","2px")},m(t,s){w(t,e,s),I(e,n)},p:Me,d(t){t&&p(e)}}}function xt(o){let e,n=o[21].name+"",t;return{c(){e=E("div"),t=U(n),this.h()},l(s){e=O(s,"DIV",{style:!0,class:!0});var l=T(e);t=q(l,n),l.forEach(p),this.h()},h(){h(e,"white-space","nowrap"),h(e,"overflow","hidden"),h(e,"text-overflow","ellipsis margin-bottom: 2px"),j(e,"class","svelte-twz7iw"),re(e,"question-item",o[21].name.charAt(o[21].name.length-1)==="?")},m(s,l){w(s,e,l),I(e,t)},p(s,l){l&16&&n!==(n=s[21].name+"")&&te(t,n),l&16&&re(e,"question-item",s[21].name.charAt(s[21].name.length-1)==="?")},d(s){s&&p(e)}}}function Ke(o){let e=[],n=new Map,t,s,l=o[5][o[21].id];const a=r=>r[24].browserTabID;for(let r=0;r<l.length;r+=1){let i=Je(o,l,r),c=a(i);n.set(c,e[r]=Ge(c,i))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=F()},l(r){for(let i=0;i<e.length;i+=1)e[i].l(r);t=F()},m(r,i){for(let c=0;c<e.length;c+=1)e[c].m(r,i);w(r,t,i),s=!0},p(r,i){i&1835248&&(l=r[5][r[21].id],K(),e=je(e,i,a,1,r,l,n,t.parentNode,Ve,Ge,t,Je),Q())},i(r){if(!s){for(let i=0;i<l.length;i+=1)$(e[i]);s=!0}},o(r){for(let i=0;i<e.length;i+=1)D(e[i]);s=!1},d(r){for(let i=0;i<e.length;i+=1)e[i].d(r);r&&p(t)}}}function Qe(o){let e,n,t,s=o[24].browserTabID===o[7]&&We(o),l=o[6][o[20][o[24].browserTabID]]&&Ye(o);return{c(){s&&s.c(),e=M(),l&&l.c(),n=F()},l(a){s&&s.l(a),e=N(a),l&&l.l(a),n=F()},m(a,r){s&&s.m(a,r),w(a,e,r),l&&l.m(a,r),w(a,n,r),t=!0},p(a,r){a[24].browserTabID===a[7]?s?(s.p(a,r),r&176&&$(s,1)):(s=We(a),s.c(),$(s,1),s.m(e.parentNode,e)):s&&(K(),D(s,1,1,()=>{s=null}),Q()),a[6][a[20][a[24].browserTabID]]?l?l.p(a,r):(l=Ye(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i(a){t||($(s),t=!0)},o(a){D(s),t=!1},d(a){s&&s.d(a),a&&p(e),l&&l.d(a),a&&p(n)}}}function We(o){let e,n,t,s,l,a,r;t=new kt({props:{checked:o[6].local.audio,style:"margin: 0 !important"}});function i(u,m){return u[6].local.audio?ts:es}let c=i(o),f=c(o);return{c(){e=E("div"),n=E("div"),A(t.$$.fragment),s=M(),f.c(),this.h()},l(u){e=O(u,"DIV",{style:!0});var m=T(e);n=O(m,"DIV",{style:!0});var d=T(n);z(t.$$.fragment,d),d.forEach(p),s=N(m),f.l(m),m.forEach(p),this.h()},h(){h(n,"margin-right","0"),h(n,"margin-left","auto"),h(n,"padding-top","5px"),h(e,"display","flex"),h(e,"align-items","center"),h(e,"margin-right","0"),h(e,"margin-left","auto")},m(u,m){w(u,e,m),I(e,n),P(t,n,null),I(e,s),f.m(e,null),l=!0,a||(r=ce(n,"click",Dt(wt(function(){It(o[19])&&o[19].apply(this,arguments)}))),a=!0)},p(u,m){o=u;const d={};m&64&&(d.checked=o[6].local.audio),t.$set(d),c!==(c=i(o))&&(f.d(1),f=c(o),f&&(f.c(),f.m(e,null)))},i(u){l||($(t.$$.fragment,u),l=!0)},o(u){D(t.$$.fragment,u),l=!1},d(u){u&&p(e),L(t),f.d(),a=!1,r()}}}function es(o){let e,n;return{c(){e=E("div"),n=U("muted"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=q(s,"muted"),s.forEach(p),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","red")},m(t,s){w(t,e,s),I(e,n)},d(t){t&&p(e)}}}function ts(o){let e,n;return{c(){e=E("div"),n=U("voice on"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=q(s,"voice on"),s.forEach(p),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","green")},m(t,s){w(t,e,s),I(e,n)},d(t){t&&p(e)}}}function Ye(o){let e;function n(l,a){return l[6][l[20][l[24].browserTabID]].audio?ns:ss}let t=n(o),s=t(o);return{c(){s.c(),e=F()},l(l){s.l(l),e=F()},m(l,a){s.m(l,a),w(l,e,a)},p(l,a){t===(t=n(l))&&s?s.p(l,a):(s.d(1),s=t(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){s.d(l),l&&p(e)}}}function ss(o){let e,n;return{c(){e=E("span"),n=U("mic_off"),this.h()},l(t){e=O(t,"SPAN",{class:!0,style:!0});var s=T(e);n=q(s,"mic_off"),s.forEach(p),this.h()},h(){j(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.2rem"),h(e,"color","red")},m(t,s){w(t,e,s),I(e,n)},p:Me,d(t){t&&p(e)}}}function ns(o){let e,n;return{c(){e=E("span"),n=U("mic"),this.h()},l(t){e=O(t,"SPAN",{class:!0,style:!0});var s=T(e);n=q(s,"mic"),s.forEach(p),this.h()},h(){j(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.2rem"),h(e,"color",o[20]&&o[20][o[24].browserTabID]&&o[20][o[24].browserTabID]===o[18]?"white":"")},m(t,s){w(t,e,s),I(e,n)},p(t,s){s&1310768&&h(e,"color",t[20]&&t[20][t[24].browserTabID]&&t[20][t[24].browserTabID]===t[18]?"white":"")},d(t){t&&p(e)}}}function Ge(o,e){let n,t,s=e[24].name+"",l,a,r=Object.keys(e[6]).length>0,i,c,f=r&&Qe(e);return{key:o,first:null,c(){n=E("div"),t=E("div"),l=U(s),a=M(),f&&f.c(),i=M(),this.h()},l(u){n=O(u,"DIV",{style:!0});var m=T(n);t=O(m,"DIV",{style:!0,class:!0});var d=T(t);l=q(d,s),d.forEach(p),a=N(m),f&&f.l(m),i=N(m),m.forEach(p),this.h()},h(){h(t,"font-size","0.7rem"),h(t,"margin-left","6px"),j(t,"class","svelte-twz7iw"),re(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),h(n,"display","flex"),h(n,"align-items","center"),this.first=n},m(u,m){w(u,n,m),I(n,t),I(t,l),I(n,a),f&&f.m(n,null),I(n,i),c=!0},p(u,m){e=u,(!c||m&48)&&s!==(s=e[24].name+"")&&te(l,s),m&1310768&&re(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),m&64&&(r=Object.keys(e[6]).length>0),r?f?(f.p(e,m),m&64&&$(f,1)):(f=Qe(e),f.c(),$(f,1),f.m(n,i)):f&&(K(),D(f,1,1,()=>{f=null}),Q())},i(u){c||($(f),c=!0)},o(u){D(f),c=!1},d(u){u&&p(n),f&&f.d()}}}function Ze(o,e){let n,t,s,l,a,r,i,c;function f(k,R){if(k[21].name)return xt;if(k[21].name==="")return Xt}let u=f(e),m=u&&u(e),d=e[5][e[21].id]&&Ke(e);function v(){return e[10](e[21])}return{key:o,first:null,c(){n=E("div"),t=E("div"),m&&m.c(),s=M(),d&&d.c(),a=M(),this.h()},l(k){n=O(k,"DIV",{style:!0});var R=T(n);t=O(R,"DIV",{class:!0,style:!0});var B=T(t);m&&m.l(B),s=N(B),d&&d.l(B),B.forEach(p),a=N(R),R.forEach(p),this.h()},h(){j(t,"class",l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-twz7iw")),h(t,"padding","6px 10px 6px 8px"),h(t,"opacity","90%"),h(t,"border-radius","5px"),h(n,"padding","6px"),this.first=n},m(k,R){w(k,n,R),I(n,t),m&&m.m(t,null),I(t,s),d&&d.m(t,null),I(n,a),r=!0,i||(c=ce(n,"click",v),i=!0)},p(k,R){e=k,u===(u=f(e))&&m?m.p(e,R):(m&&m.d(1),m=u&&u(e),m&&(m.c(),m.m(t,s))),e[5][e[21].id]?d?(d.p(e,R),R&48&&$(d,1)):(d=Ke(e),d.c(),$(d,1),d.m(t,null)):d&&(K(),D(d,1,1,()=>{d=null}),Q()),(!r||R&18&&l!==(l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-twz7iw")))&&j(t,"class",l)},i(k){r||($(d),r=!0)},o(k){D(d),r=!1},d(k){k&&p(n),m&&m.d(),d&&d.d(),i=!1,c()}}}function os(o){let e,n,t;return{c(){e=E("span"),n=U("add"),t=U(`\r
      New room`),this.h()},l(s){e=O(s,"SPAN",{class:!0,style:!0});var l=T(e);n=q(l,"add"),l.forEach(p),t=q(s,`\r
      New room`),this.h()},h(){j(e,"class","material-icons"),h(e,"margin-right","4px")},m(s,l){w(s,e,l),I(e,n),w(s,t,l)},d(s){s&&p(e),s&&p(t)}}}function ls(o){let e=[],n=new Map,t,s,l,a=o[4];const r=i=>i[21].id+i[1];for(let i=0;i<a.length;i+=1){let c=He(o,a,i),f=r(c);n.set(f,e[i]=Ze(f,c))}return s=new vt({props:{style:"width: 100%; margin: auto;",$$slots:{default:[os]},$$scope:{ctx:o}}}),s.$on("click",o[8]),{c(){for(let i=0;i<e.length;i+=1)e[i].c();t=M(),A(s.$$.fragment)},l(i){for(let c=0;c<e.length;c+=1)e[c].l(i);t=N(i),z(s.$$.fragment,i)},m(i,c){for(let f=0;f<e.length;f+=1)e[f].m(i,c);w(i,t,c),P(s,i,c),l=!0},p(i,c){c&1835251&&(a=i[4],K(),e=je(e,c,r,1,i,a,n,t.parentNode,Ve,Ze,t,He),Q());const f={};c&2048&&(f.$$scope={dirty:c,ctx:i}),s.$set(f)},i(i){if(!l){for(let c=0;c<a.length;c+=1)$(e[c]);$(s.$$.fragment,i),l=!0}},o(i){for(let c=0;c<e.length;c+=1)D(e[c]);D(s.$$.fragment,i),l=!1},d(i){for(let c=0;c<e.length;c+=1)e[c].d(i);i&&p(t),L(s,i)}}}function as(o){let e,n;return e=new Bt({props:{nameOfClass:o[2],descriptionOfClass:o[3],$$slots:{default:[ls]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,s){P(e,t,s),n=!0},p(t,s){const l={};s&4&&(l.nameOfClass=t[2]),s&8&&(l.descriptionOfClass=t[3]),s&1837299&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function rs(o){let e,n,t,s,l,a,r;e=new Ht({props:{classID:o[0],roomID:o[1]}}),l=new Zt({props:{roomID:o[1],$$slots:{default:[as,({activeSpeakerID:f,toggleMic:u,firestoreIDToDailyID:m})=>({18:f,19:u,20:m}),({activeSpeakerID:f,toggleMic:u,firestoreIDToDailyID:m})=>(f?262144:0)|(u?524288:0)|(m?1048576:0)]},$$scope:{ctx:o}}});const i=o[9].default,c=me(i,o,o[11],null);return{c(){A(e.$$.fragment),n=M(),t=E("div"),s=M(),A(l.$$.fragment),a=M(),c&&c.c(),this.h()},l(f){z(e.$$.fragment,f),n=N(f),t=O(f,"DIV",{id:!0});var u=T(t);u.forEach(p),s=N(f),z(l.$$.fragment,f),a=N(f),c&&c.l(f),this.h()},h(){j(t,"id","container-for-audio-elements")},m(f,u){P(e,f,u),w(f,n,u),w(f,t,u),w(f,s,u),P(l,f,u),w(f,a,u),c&&c.m(f,u),r=!0},p(f,[u]){const m={};u&1&&(m.classID=f[0]),u&2&&(m.roomID=f[1]),e.$set(m);const d={};u&2&&(d.roomID=f[1]),u&1837311&&(d.$$scope={dirty:u,ctx:f}),l.$set(d),c&&c.p&&(!r||u&2048)&&de(c,i,f,f[11],r?pe(i,f[11],u,null):_e(f[11]),null)},i(f){r||($(e.$$.fragment,f),$(l.$$.fragment,f),$(c,f),r=!0)},o(f){D(e.$$.fragment,f),D(l.$$.fragment,f),D(c,f),r=!1},d(f){L(e,f),f&&p(n),f&&p(t),f&&p(s),L(l,f),f&&p(a),c&&c.d(f)}}}function _s({page:o}){return{props:{classID:o.params.class,roomID:o.params.room}}}function is(o,e,n){let t,s,l;H(o,Z,b=>n(5,t=b)),H(o,se,b=>n(6,s=b)),H(o,$e,b=>n(7,l=b));let{$$slots:a={},$$scope:r}=e,{classID:i}=e,{roomID:c}=e,f="",u="",m=[];he(()=>{for(const b of R)b();window.removeEventListener("resize",k)}),oe(async()=>{console.log("__layout mounted, but should only be done once"),window.addEventListener("resize",k),k();const b=G(J(),`classes/${i}`),g=await $t(b);n(2,f=g.data().name),n(3,u=g.data().description)});async function d(){for(const S of m)if(S.name===""){alert("A room is still untitled - use it before creating a new one");return}const b=Ae(),g=`classes/${i}/`,C=G(J(),g+`rooms/${b}`),V=G(J(),g+`blackboards/${b}`);await Promise.all([ge(C,{name:"",blackboards:[b],date:new Date().toISOString()}),ge(V,{})])}function v(){const{height:b,width:g}=Et();yt.set(b),Ct.set(g)}function k(){setTimeout(v,100)}let R=[];const B=ue(J(),`classes/${i}/participants`),W=ue(J(),`classes/${i}/rooms`),_=gt(W,bt("date","asc"));R.push(Re(_,b=>{const g=[];b.forEach(C=>{g.push(fe({id:C.id,ref:C.ref.path},C.data()))}),n(4,m=g)})),R.push(Re(B,b=>{b.docChanges().forEach(g=>{const C=g.doc.data(),V=C.currentRoomID;switch(g.type){case"added":t[V]||ae(Z,t[V]=[],t),t[V].push(C);break;case"modified":for(const S of Object.keys(t))for(const Y of t[S])Y.browserTabID===C.browserTabID&&ae(Z,t[S]=t[S].filter(ie=>ie.browserTabID!==C.browserTabID),t);t[V]||ae(Z,t[V]=[],t),t[V].push(C);break;case"removed":ae(Z,t[V]=t[V].filter(S=>S.browserTabID!==C.browserTabID),t);break}})}));const y=b=>be(`/${i}/${b.id}`);return o.$$set=b=>{"classID"in b&&n(0,i=b.classID),"roomID"in b&&n(1,c=b.roomID),"$$scope"in b&&n(11,r=b.$$scope)},[i,c,f,u,m,t,s,l,d,a,y,r]}class ps extends X{constructor(e){super();x(this,e,is,rs,ee,{classID:0,roomID:1})}}export{ps as default,_s as load};
