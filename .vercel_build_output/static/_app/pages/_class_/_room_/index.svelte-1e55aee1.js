var De=Object.defineProperty;var x=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var ee=(a,e,o)=>e in a?De(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,te=(a,e)=>{for(var o in e||(e={}))Re.call(e,o)&&ee(a,o,e[o]);if(x)for(var o of x(e))Ie.call(e,o)&&ee(a,o,e[o]);return a};import{S as ye,i as Ae,s as Ne,e as q,j as v,k as E,c as H,a as F,m as D,n as M,d as b,K as Q,W as oe,f as g,o as R,L as Y,a1 as Z,az as Ue,aA as Le,w as N,x as m,u as h,v as I,l as y,D as K,A as Pe,N as T,O,Z as Se,a2 as G,r as U,aE as Be,av as V,ag as ze,aF as ne,aG as ae,aH as je,aI as Ee,aJ as Me,Q as Te,aK as Oe,Y as Ve,_ as Ce,t as S,g as B,aL as C,b as W,a8 as j,M as X,al as We,a4 as qe,am as He,an as Fe}from"../../../chunks/vendor-60dbf49e.js";import{R as Ke,T as Ge,a as Je,B as Qe,D as Ye}from"../../../chunks/TextAreaAutoResizing-a5d18062.js";import{a as Ze}from"../../../chunks/database-63c5af1e.js";import{g as Xe}from"../../../chunks/canvas-5b7b0e82.js";import{g as le,u as xe,c as et,a as tt,r as ot}from"../../../chunks/store-620103ad.js";import"../../../chunks/preload-helper-ec9aa979.js";import"../../../chunks/singletons-12a22614.js";function nt(a,e){let o=document.getElementById(e);return o==null||o.appendChild(a),{destroy(){a.remove()}}}function re(a,e){let o=new IntersectionObserver(t=>{for(const n of t)if(n.isIntersecting){e(),o.unobserve(a);return}},{root:null,threshold:.2,rootMargin:"0px"});o.observe(a)}function se(a,e,o){const t=a.slice();return t[24]=e[o],t}function ie(a){let e,o,t,n=[],l=new Map,r,s,i,f,u,c;o=new Se({props:{value:a[1].name,class:"room-title",style:`width: ${a[2]}px; margin-bottom: 20px;`}}),o.$on("input",a[13]);let _=a[1].blackboards;const A=p=>p[24];for(let p=0;p<_.length;p+=1){let $=se(a,_,p),k=A($);l.set(k,n[p]=pe(k,$))}return s=new G({props:{variant:"unelevated",color:"#2e3131",style:`width: ${a[2]}px; margin-top: 40px`,$$slots:{default:[kt]},$$scope:{ctx:a}}}),s.$on("click",a[10]),{c(){e=q("div"),v(o.$$.fragment),t=E();for(let p=0;p<n.length;p+=1)n[p].c();r=E(),v(s.$$.fragment),this.h()},l(p){e=H(p,"DIV",{style:!0});var $=F(e);D(o.$$.fragment,$),t=M($);for(let k=0;k<n.length;k+=1)n[k].l($);r=M($),D(s.$$.fragment,$),$.forEach(b),this.h()},h(){Q(e,"padding","16px"),oe(e,"question",a[1].name.charAt(a[1].name.length-1)==="?")},m(p,$){g(p,e,$),R(o,e,null),Y(e,t);for(let k=0;k<n.length;k+=1)n[k].m(e,null);Y(e,r),R(s,e,null),f=!0,u||(c=Z(i=nt.call(null,e,"main-content")),u=!0)},p(p,$){const k={};$[0]&2&&(k.value=p[1].name),$[0]&4&&(k.style=`width: ${p[2]}px; margin-bottom: 20px;`),o.$set(k),$[0]&2013266879|$[1]&30&&(_=p[1].blackboards,U(),n=Ue(n,$,A,1,p,_,l,e,Le,pe,r,se),N());const z={};$[0]&4&&(z.style=`width: ${p[2]}px; margin-top: 40px`),$[1]&32&&(z.$$scope={dirty:$,ctx:p}),s.$set(z),$[0]&2&&oe(e,"question",p[1].name.charAt(p[1].name.length-1)==="?")},i(p){if(!f){m(o.$$.fragment,p);for(let $=0;$<_.length;$+=1)m(n[$]);m(s.$$.fragment,p),f=!0}},o(p){h(o.$$.fragment,p);for(let $=0;$<n.length;$+=1)h(n[$]);h(s.$$.fragment,p),f=!1},d(p){p&&b(e),I(o);for(let $=0;$<n.length;$+=1)n[$].d();I(s),u=!1,c()}}}function fe(a){let e,o,t,n,l,r=a[30]&&ue(a);const s=[lt,at],i=[];function f(u,c){return u[27].audioDownloadURL?0:1}return o=f(a),t=i[o]=s[o](a),{c(){r&&r.c(),e=E(),t.c(),n=y()},l(u){r&&r.l(u),e=M(u),t.l(u),n=y()},m(u,c){r&&r.m(u,c),g(u,e,c),i[o].m(u,c),g(u,n,c),l=!0},p(u,c){u[30]?r?(r.p(u,c),c[0]&1073741824&&m(r,1)):(r=ue(u),r.c(),m(r,1),r.m(e.parentNode,e)):r&&(U(),h(r,1,1,()=>{r=null}),N());let _=o;o=f(u),o===_?i[o].p(u,c):(U(),h(i[_],1,1,()=>{i[_]=null}),N(),t=i[o],t?t.p(u,c):(t=i[o]=s[o](u),t.c()),m(t,1),t.m(n.parentNode,n))},i(u){l||(m(r),m(t),l=!0)},o(u){h(r),h(t),l=!1},d(u){r&&r.d(u),u&&b(e),i[o].d(u),u&&b(n)}}}function ue(a){let e,o;function t(...n){return a[14](a[24],...n)}return e=new Ge({props:{value:a[27].description||""}}),e.$on("input",t),{c(){v(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,l){R(e,n,l),o=!0},p(n,l){a=n;const r={};l[0]&134217728&&(r.value=a[27].description||""),e.$set(r)},i(n){o||(m(e.$$.fragment,n),o=!0)},o(n){h(e.$$.fragment,n),o=!1},d(n){I(e,n)}}}function at(a){let e,o,t,n,l,r,s=a[30]&&ce(a);return{c(){e=q("div"),s&&s.c(),this.h()},l(i){e=H(i,"DIV",{style:!0});var f=F(e);s&&s.l(f),f.forEach(b),this.h()},h(){W(e,"style",o=`width: ${a[2]}px; height: ${a[3]}px; position: relative`)},m(i,f){g(i,e,f),s&&s.m(e,null),n=!0,l||(r=Z(t=re.call(null,e,a[29])),l=!0)},p(i,f){i[30]?s?(s.p(i,f),f[0]&1073741824&&m(s,1)):(s=ce(i),s.c(),m(s,1),s.m(e,null)):s&&(U(),h(s,1,1,()=>{s=null}),N()),(!n||f[0]&12&&o!==(o=`width: ${i[2]}px; height: ${i[3]}px; position: relative`))&&W(e,"style",o),t&&j(t.update)&&f[0]&536870912&&t.update.call(null,i[29])},i(i){n||(m(s),n=!0)},o(i){h(s),n=!1},d(i){i&&b(e),s&&s.d(),l=!1,r()}}}function lt(a){let e,o,t,n,l,r,s=a[30]&&de(a);return{c(){e=q("div"),s&&s.c(),this.h()},l(i){e=H(i,"DIV",{style:!0});var f=F(e);s&&s.l(f),f.forEach(b),this.h()},h(){W(e,"style",o=`width: ${a[2]}px; height: ${a[3]+80}px; position: relative`)},m(i,f){g(i,e,f),s&&s.m(e,null),n=!0,l||(r=Z(t=re.call(null,e,a[28])),l=!0)},p(i,f){i[30]?s?(s.p(i,f),f[0]&1073741824&&m(s,1)):(s=de(i),s.c(),m(s,1),s.m(e,null)):s&&(U(),h(s,1,1,()=>{s=null}),N()),(!n||f[0]&12&&o!==(o=`width: ${i[2]}px; height: ${i[3]+80}px; position: relative`))&&W(e,"style",o),t&&j(t.update)&&f[0]&268435456&&t.update.call(null,i[28])},i(i){n||(m(s),n=!0)},o(i){h(s),n=!1},d(i){i&&b(e),s&&s.d(),l=!1,r()}}}function ce(a){let e,o;function t(...n){return a[18](a[24],...n)}return e=new Je({props:{$$slots:{default:[mt,({startRecording:n,stopRecording:l,currentTime:r})=>({33:n,34:l,35:r}),({startRecording:n,stopRecording:l,currentTime:r})=>[0,(n?4:0)|(l?8:0)|(r?16:0)]]},$$scope:{ctx:a}}}),e.$on("record-end",t),{c(){v(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,l){R(e,n,l),o=!0},p(n,l){a=n;const r={};l[0]&1073741841|l[1]&62&&(r.$$scope={dirty:l,ctx:a}),e.$set(r)},i(n){o||(m(e.$$.fragment,n),o=!0)},o(n){h(e.$$.fragment,n),o=!1},d(n){I(e,n)}}}function rt(a){let e;return{c(){e=S("Uploading...")},l(o){e=B(o,"Uploading...")},m(o,t){g(o,e,t)},p:X,i:X,o:X,d(o){o&&b(e)}}}function st(a){let e,o;return e=new G({props:{color:"secondary",$$slots:{default:[ft]},$$scope:{ctx:a}}}),e.$on("click",function(){j(a[34])&&a[34].apply(this,arguments)}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){a=t;const l={};n[1]&32&&(l.$$scope={dirty:n,ctx:a}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function it(a){let e,o,t,n,l,r,s,i,f;e=new G({props:{style:"color: #f5862c",$$slots:{default:[ut]},$$scope:{ctx:a}}}),e.$on("click",function(){j(a[33])&&a[33].apply(this,arguments)});let u={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[pt]},$$scope:{ctx:a}};return r=new We({props:u}),a[16](r),{c(){v(e.$$.fragment),o=E(),t=q("span"),n=S("more_horiz"),l=E(),v(r.$$.fragment),this.h()},l(c){D(e.$$.fragment,c),o=M(c),t=H(c,"SPAN",{class:!0,style:!0});var _=F(t);n=B(_,"more_horiz"),_.forEach(b),l=M(c),D(r.$$.fragment,c),this.h()},h(){W(t,"class","material-icons"),Q(t,"margin-right","10px"),Q(t,"color","white")},m(c,_){R(e,c,_),g(c,o,_),g(c,t,_),Y(t,n),g(c,l,_),R(r,c,_),s=!0,i||(f=qe(t,"click",a[15]),i=!0)},p(c,_){a=c;const A={};_[1]&32&&(A.$$scope={dirty:_,ctx:a}),e.$set(A);const p={};_[1]&34&&(p.$$scope={dirty:_,ctx:a}),r.$set(p)},i(c){s||(m(e.$$.fragment,c),m(r.$$.fragment,c),s=!0)},o(c){h(e.$$.fragment,c),h(r.$$.fragment,c),s=!1},d(c){I(e,c),c&&b(o),c&&b(t),c&&b(l),a[16](null),I(r,c),i=!1,f()}}}function ft(a){let e;return{c(){e=S("Stop")},l(o){e=B(o,"Stop")},m(o,t){g(o,e,t)},d(o){o&&b(e)}}}function ut(a){let e;return{c(){e=S("Record")},l(o){e=B(o,"Record")},m(o,t){g(o,e,t)},d(o){o&&b(e)}}}function ct(a){let e;return{c(){e=S("Wipe board")},l(o){e=B(o,"Wipe board")},m(o,t){g(o,e,t)},d(o){o&&b(e)}}}function dt(a){let e,o;return e=new Fe({props:{$$slots:{default:[ct]},$$scope:{ctx:a}}}),e.$on("SMUI:action",function(){j(a[32])&&a[32].apply(this,arguments)}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){a=t;const l={};n[1]&32&&(l.$$scope={dirty:n,ctx:a}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function pt(a){let e,o;return e=new He({props:{$$slots:{default:[dt]},$$scope:{ctx:a}}}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){const l={};n[1]&34&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function $t(a){let e,o,t,n;const l=[it,st,rt],r=[];function s(i,f){return i[4]==="pre_record"?0:i[4]==="mid_record"?1:2}return e=s(a),o=r[e]=l[e](a),{c(){o.c(),t=y()},l(i){o.l(i),t=y()},m(i,f){r[e].m(i,f),g(i,t,f),n=!0},p(i,f){let u=e;e=s(i),e===u?r[e].p(i,f):(U(),h(r[u],1,1,()=>{r[u]=null}),N(),o=r[e],o?o.p(i,f):(o=r[e]=l[e](i),o.c()),m(o,1),o.m(t.parentNode,t))},i(i){n||(m(o),n=!0)},o(i){h(o),n=!1},d(i){r[e].d(i),i&&b(t)}}}function mt(a){let e,o;function t(...n){return a[17](a[31],...n)}return e=new Qe({props:{strokesArray:a[30],currentTime:a[35],$$slots:{default:[$t]},$$scope:{ctx:a}}}),e.$on("stroke-drawn",t),{c(){v(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,l){R(e,n,l),o=!0},p(n,l){a=n;const r={};l[0]&1073741824&&(r.strokesArray=a[30]),l[1]&16&&(r.currentTime=a[35]),l[0]&17|l[1]&46&&(r.$$scope={dirty:l,ctx:a}),e.$set(r)},i(n){o||(m(e.$$.fragment,n),o=!0)},o(n){h(e.$$.fragment,n),o=!1},d(n){I(e,n)}}}function de(a){let e,o;return e=new Ye({props:{strokesArray:a[30],audioDownloadURL:a[27].audioDownloadURL,$$slots:{default:[ht]},$$scope:{ctx:a}}}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){const l={};n[0]&1073741824&&(l.strokesArray=t[30]),n[0]&134217728&&(l.audioDownloadURL=t[27].audioDownloadURL),n[0]&134217728|n[1]&32&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function _t(a){let e;return{c(){e=S("Revert to board")},l(o){e=B(o,"Revert to board")},m(o,t){g(o,e,t)},d(o){o&&b(e)}}}function ht(a){let e,o;return e=new G({props:{$$slots:{default:[_t]},$$scope:{ctx:a}}}),e.$on("click",function(){j(a[9](a[27]))&&a[9](a[27]).apply(this,arguments)}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){a=t;const l={};n[1]&32&&(l.$$scope={dirty:n,ctx:a}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function bt(a){let e,o,t=a[27]&&fe(a);return{c(){t&&t.c(),e=y()},l(n){t&&t.l(n),e=y()},m(n,l){t&&t.m(n,l),g(n,e,l),o=!0},p(n,l){n[27]?t?(t.p(n,l),l[0]&134217728&&m(t,1)):(t=fe(n),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(U(),h(t,1,1,()=>{t=null}),N())},i(n){o||(m(t),o=!0)},o(n){h(t),o=!1},d(n){t&&t.d(n),n&&b(e)}}}function pe(a,e){let o,t,n;return t=new Ke({props:{dbPath:e[5]+e[24],$$slots:{default:[bt,({boardDoc:l,fetchStrokes:r,listenToStrokes:s,strokesArray:i,handleNewlyDrawnStroke:f,deleteAllStrokesFromDb:u})=>({27:l,28:r,29:s,30:i,31:f,32:u}),({boardDoc:l,fetchStrokes:r,listenToStrokes:s,strokesArray:i,handleNewlyDrawnStroke:f,deleteAllStrokesFromDb:u})=>[(l?134217728:0)|(r?268435456:0)|(s?536870912:0)|(i?1073741824:0),(f?1:0)|(u?2:0)]]},$$scope:{ctx:e}}}),{key:a,first:null,c(){o=y(),v(t.$$.fragment),this.h()},l(l){o=y(),D(t.$$.fragment,l),this.h()},h(){this.first=o},m(l,r){g(l,o,r),R(t,l,r),n=!0},p(l,r){e=l;const s={};r[0]&2&&(s.dbPath=e[5]+e[24]),r[0]&2013265951|r[1]&34&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(l){n||(m(t.$$.fragment,l),n=!0)},o(l){h(t.$$.fragment,l),n=!1},d(l){l&&b(o),I(t,l)}}}function gt(a){let e;return{c(){e=S("New blackboard")},l(o){e=B(o,"New blackboard")},m(o,t){g(o,e,t)},d(o){o&&b(e)}}}function kt(a){let e,o;return e=new Be({props:{$$slots:{default:[gt]},$$scope:{ctx:a}}}),{c(){v(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){const l={};n[1]&32&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(m(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){I(e,t)}}}function wt(a){let e,o,t=a[1]&&ie(a);return{c(){t&&t.c(),e=y()},l(n){t&&t.l(n),e=y()},m(n,l){t&&t.m(n,l),g(n,e,l),o=!0},p(n,l){n[1]?t?(t.p(n,l),l[0]&2&&m(t,1)):(t=ie(n),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(U(),h(t,1,1,()=>{t=null}),N())},i(n){o||(m(t),o=!0)},o(n){h(t),o=!1},d(n){t&&t.d(n),n&&b(e)}}}async function Pt({page:a}){return{props:{classID:a.params.class,roomID:a.params.room}}}function vt(a,e,o){let t,n,l,r,s;K(a,xe,d=>o(20,n=d)),K(a,et,d=>o(2,l=d)),K(a,tt,d=>o(3,r=d)),K(a,ot,d=>o(4,s=d));let{classID:i}=e,{roomID:f}=e,u,c;const _=`classes/${i}/blackboards/`,A=`classes/${i}/rooms/`;n.uid||Xe("/");async function p(d){const{value:w}=d.srcElement;await V(t,{name:w})}async function $(d,w){const{value:L}=d.srcElement,P=T(O(),_+w);await V(P,{description:L})}Pe(async()=>{ze(t,d=>{o(1,c=te({id:d.id},d.data()))})});async function k(){o(1,c=await Ze(A+f))}async function z(d,w){console.log("saveVideo(), audioBlob =",d);const L=ne(),P=ae(L,`audio/${le()}`);await je(P,d);const J=await Ee(P),ve=T(O(),_+w);await V(ve,{creatorUID:n.uid,creatorPhoneNumber:n.phoneNumber,date:new Date().toISOString(),audioDownloadURL:J,audioRefFullPath:P.fullPath})}async function $e({id:d,audioRefFullPath:w}){const L=[],P=T(O(),_+d);if(w){const J=ae(ne(),w);L.push(Me(J))}L.push(V(P,{creator:C(),creatorPhoneNumber:C(),date:C(),audioDownloadURL:C(),audioRefFullPath:C()})),await Promise.all(L)}async function me(){const d=le(),w=T(O(),_+d);await Promise.all([Te(w,{}),V(t,{blackboards:Oe(d)})]),await Ve()}const _e=d=>p(d),he=(d,w)=>$(w,d),be=()=>u.setOpen(!0);function ge(d){Ce[d?"unshift":"push"](()=>{u=d,o(0,u)})}const ke=(d,w)=>d(w.detail.newStroke),we=(d,w)=>z(w.detail.audioBlob,d);return a.$$set=d=>{"classID"in d&&o(11,i=d.classID),"roomID"in d&&o(12,f=d.roomID)},a.$$.update=()=>{a.$$.dirty[0]&4096&&(t=T(O(),A+f)),a.$$.dirty[0]&4096&&k()},[u,c,l,r,s,_,p,$,z,$e,me,i,f,_e,he,be,ge,ke,we]}class St extends ye{constructor(e){super();Ae(this,e,vt,wt,Ne,{classID:11,roomID:12},null,[-1,-1])}}export{St as default,Pt as load};
