var Ee=Object.defineProperty;var ie=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var fe=(a,e,r)=>e in a?Ee(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,ue=(a,e)=>{for(var r in e||(e={}))Oe.call(e,r)&&fe(a,r,e[r]);if(ie)for(var r of ie(e))Qe.call(e,r)&&fe(a,r,e[r]);return a};import{S as qe,i as Ve,s as We,e as T,j as N,k as Q,c as z,a as C,m as U,n as q,d as m,K as I,W as ce,f as b,o as A,L as V,a1 as le,aA as Fe,aB as He,w as L,x as $,u as h,v as P,l as S,D as x,A as Ke,N as Y,O as F,Z as Ge,a2 as pe,r as B,a0 as Je,aE as Ye,av as H,aF as Ze,aG as Xe,U as xe,ah as et,aH as tt,T as lt,ag as rt,aI as de,aJ as me,aK as at,aL as ot,aM as st,Q as nt,aN as it,Y as ft,_ as ut,t as R,g as y,h as ee,aO as Z,b as W,a8 as K,aP as ct,M as re,a4 as ae,al as pt,a5 as dt,am as mt,an as _t}from"../../../chunks/vendor-0e75e25c.js";import{R as $t,T as ht,a as bt,B as kt,D as gt}from"../../../chunks/TextAreaAutoResizing-fa6e996d.js";import{a as vt}from"../../../chunks/database-ed07b1b5.js";import{g as wt}from"../../../chunks/canvas-5b7b0e82.js";import{g as _e,r as $e,k as te,u as Dt,c as It,a as Rt}from"../../../chunks/store-328ab542.js";import"../../../chunks/preload-helper-ec9aa979.js";import"../../../chunks/singletons-12a22614.js";function yt(a,e){let r=document.getElementById(e);return r==null||r.appendChild(a),{destroy(){a.remove()}}}function he(a,e){let r=new IntersectionObserver(t=>{for(const l of t)if(l.isIntersecting){e(),r.unobserve(a);return}},{root:null,threshold:.2,rootMargin:"0px"});r.observe(a)}function be(a,e,r){const t=a.slice();return t[29]=e[r],t}function ke(a){let e,r,t,l,o,n=[],s=new Map,i,f,u,k,_,w;r=new Ge({props:{disabled:j(a[1].name)&&a[1].askerUID&&a[4].uid!==a[1].askerUID,value:a[1].name,class:"room-title",style:`width: ${a[5]}px;`,$$slots:{helper:[Pt]},$$scope:{ctx:a}}}),r.$on("input",a[16]);let D=a[1].blackboards;const E=d=>d[29];for(let d=0;d<D.length;d+=1){let c=be(a,D,d),v=E(c);s.set(v,n[d]=ye(v,c))}return f=new pe({props:{variant:"unelevated",color:"#2e3131",style:`width: ${a[5]}px; margin-top: 40px`,$$slots:{default:[Ft]},$$scope:{ctx:a}}}),f.$on("click",a[13]),{c(){e=T("div"),N(r.$$.fragment),t=Q(),l=T("div"),o=Q();for(let d=0;d<n.length;d+=1)n[d].c();i=Q(),N(f.$$.fragment),this.h()},l(d){e=z(d,"DIV",{style:!0});var c=C(e);U(r.$$.fragment,c),t=q(c),l=z(c,"DIV",{style:!0}),C(l).forEach(m),o=q(c);for(let v=0;v<n.length;v+=1)n[v].l(c);i=q(c),U(f.$$.fragment,c),c.forEach(m),this.h()},h(){I(l,"margin-bottom","20px"),I(e,"padding","16px"),ce(e,"question",j(a[1].name))},m(d,c){b(d,e,c),A(r,e,null),V(e,t),V(e,l),V(e,o);for(let v=0;v<n.length;v+=1)n[v].m(e,null);V(e,i),A(f,e,null),k=!0,_||(w=le(u=yt.call(null,e,"main-content")),_=!0)},p(d,c){const v={};c[0]&18&&(v.disabled=j(d[1].name)&&d[1].askerUID&&d[4].uid!==d[1].askerUID),c[0]&2&&(v.value=d[1].name),c[0]&32&&(v.style=`width: ${d[5]}px;`),c[0]&14|c[1]&1024&&(v.$$scope={dirty:c,ctx:d}),r.$set(v),c[0]&7667|c[1]&990&&(D=d[1].blackboards,B(),n=Fe(n,c,E,1,d,D,s,e,He,ye,i,be),L());const G={};c[0]&32&&(G.style=`width: ${d[5]}px; margin-top: 40px`),c[1]&1024&&(G.$$scope={dirty:c,ctx:d}),f.$set(G),c[0]&2&&ce(e,"question",j(d[1].name))},i(d){if(!k){$(r.$$.fragment,d);for(let c=0;c<D.length;c+=1)$(n[c]);$(f.$$.fragment,d),k=!0}},o(d){h(r.$$.fragment,d);for(let c=0;c<n.length;c+=1)h(n[c]);h(f.$$.fragment,d),k=!1},d(d){d&&m(e),P(r);for(let c=0;c<n.length;c+=1)n[c].d();P(f),_=!1,w()}}}function Nt(a){let e,r=a[1].askerName+"",t,l,o=te(a[1].dateAsked)+"",n;return{c(){e=R("Marked as question by "),t=R(r),l=R(" on "),n=R(o)},l(s){e=y(s,"Marked as question by "),t=y(s,r),l=y(s," on "),n=y(s,o)},m(s,i){b(s,e,i),b(s,t,i),b(s,l,i),b(s,n,i)},p(s,i){i[0]&2&&r!==(r=s[1].askerName+"")&&ee(t,r),i[0]&2&&o!==(o=te(s[1].dateAsked)+"")&&ee(n,o)},d(s){s&&m(e),s&&m(t),s&&m(l),s&&m(n)}}}function Ut(a){let e,r,t;return{c(){e=R("Pinging server members in "),r=R(a[3]),t=R(", cancel by backtracking the ?")},l(l){e=y(l,"Pinging server members in "),r=y(l,a[3]),t=y(l,", cancel by backtracking the ?")},m(l,o){b(l,e,o),b(l,r,o),b(l,t,o)},p(l,o){o[0]&8&&ee(r,l[3])},d(l){l&&m(e),l&&m(r),l&&m(t)}}}function ge(a){let e,r=te(a[1].dateResolved)+"",t;return{c(){e=R(", resolved "),t=R(r)},l(l){e=y(l,", resolved "),t=y(l,r)},m(l,o){b(l,e,o),b(l,t,o)},p(l,o){o[0]&2&&r!==(r=te(l[1].dateResolved)+"")&&ee(t,r)},d(l){l&&m(e),l&&m(t)}}}function At(a){let e,r;function t(s,i){if(s[2])return Ut;if(s[1].askerName&&s[1].askerUID&&s[1].date)return Nt}let l=t(a),o=l&&l(a),n=a[1].dateResolved&&ge(a);return{c(){o&&o.c(),e=Q(),n&&n.c(),r=S()},l(s){o&&o.l(s),e=q(s),n&&n.l(s),r=S()},m(s,i){o&&o.m(s,i),b(s,e,i),n&&n.m(s,i),b(s,r,i)},p(s,i){l===(l=t(s))&&o?o.p(s,i):(o&&o.d(1),o=l&&l(s),o&&(o.c(),o.m(e.parentNode,e))),s[1].dateResolved?n?n.p(s,i):(n=ge(s),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},d(s){o&&o.d(s),s&&m(e),n&&n.d(s),s&&m(r)}}}function Pt(a){let e,r;return e=new Je({props:{slot:"helper",persistent:!0,$$slots:{default:[At]},$$scope:{ctx:a}}}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){const o={};l[0]&14|l[1]&1024&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function ve(a){let e,r,t,l,o,n=a[35]&&we(a);const s=[Mt,St],i=[];function f(u,k){return u[32].audioDownloadURL?0:1}return r=f(a),t=i[r]=s[r](a),{c(){n&&n.c(),e=Q(),t.c(),l=S()},l(u){n&&n.l(u),e=q(u),t.l(u),l=S()},m(u,k){n&&n.m(u,k),b(u,e,k),i[r].m(u,k),b(u,l,k),o=!0},p(u,k){u[35]?n?(n.p(u,k),k[1]&16&&$(n,1)):(n=we(u),n.c(),$(n,1),n.m(e.parentNode,e)):n&&(B(),h(n,1,1,()=>{n=null}),L());let _=r;r=f(u),r===_?i[r].p(u,k):(B(),h(i[_],1,1,()=>{i[_]=null}),L(),t=i[r],t?t.p(u,k):(t=i[r]=s[r](u),t.c()),$(t,1),t.m(l.parentNode,l))},i(u){o||($(n),$(t),o=!0)},o(u){h(n),h(t),o=!1},d(u){n&&n.d(u),u&&m(e),i[r].d(u),u&&m(l)}}}function we(a){let e,r;function t(...l){return a[17](a[29],...l)}return e=new ht({props:{value:a[32].description||""}}),e.$on("input",t),{c(){N(e.$$.fragment)},l(l){U(e.$$.fragment,l)},m(l,o){A(e,l,o),r=!0},p(l,o){a=l;const n={};o[1]&2&&(n.value=a[32].description||""),e.$set(n)},i(l){r||($(e.$$.fragment,l),r=!0)},o(l){h(e.$$.fragment,l),r=!1},d(l){P(e,l)}}}function St(a){let e,r,t,l,o,n,s=a[35]&&De(a);return{c(){e=T("div"),s&&s.c(),this.h()},l(i){e=z(i,"DIV",{style:!0});var f=C(e);s&&s.l(f),f.forEach(m),this.h()},h(){W(e,"style",r=`width: ${a[5]}px; height: ${a[6]}px; position: relative`)},m(i,f){b(i,e,f),s&&s.m(e,null),l=!0,o||(n=le(t=he.call(null,e,a[34])),o=!0)},p(i,f){i[35]?s?(s.p(i,f),f[1]&16&&$(s,1)):(s=De(i),s.c(),$(s,1),s.m(e,null)):s&&(B(),h(s,1,1,()=>{s=null}),L()),(!l||f[0]&96&&r!==(r=`width: ${i[5]}px; height: ${i[6]}px; position: relative`))&&W(e,"style",r),t&&K(t.update)&&f[1]&8&&t.update.call(null,i[34])},i(i){l||($(s),l=!0)},o(i){h(s),l=!1},d(i){i&&m(e),s&&s.d(),o=!1,n()}}}function Mt(a){let e,r,t,l,o,n,s=a[35]&&Ie(a);return{c(){e=T("div"),s&&s.c(),this.h()},l(i){e=z(i,"DIV",{style:!0});var f=C(e);s&&s.l(f),f.forEach(m),this.h()},h(){W(e,"style",r=`width: ${a[5]}px; height: ${a[6]+80}px; position: relative`)},m(i,f){b(i,e,f),s&&s.m(e,null),l=!0,o||(n=le(t=he.call(null,e,a[33])),o=!0)},p(i,f){i[35]?s?(s.p(i,f),f[1]&16&&$(s,1)):(s=Ie(i),s.c(),$(s,1),s.m(e,null)):s&&(B(),h(s,1,1,()=>{s=null}),L()),(!l||f[0]&96&&r!==(r=`width: ${i[5]}px; height: ${i[6]+80}px; position: relative`))&&W(e,"style",r),t&&K(t.update)&&f[1]&4&&t.update.call(null,i[33])},i(i){l||($(s),l=!0)},o(i){h(s),l=!1},d(i){i&&m(e),s&&s.d(),o=!1,n()}}}function De(a){let e,r;function t(...l){return a[21](a[29],...l)}return e=new bt({props:{$$slots:{default:[Ot,({startRecording:l,stopRecording:o,currentTime:n})=>({38:l,39:o,40:n}),({startRecording:l,stopRecording:o,currentTime:n})=>[0,(l?128:0)|(o?256:0)|(n?512:0)]]},$$scope:{ctx:a}}}),e.$on("record-end",t),{c(){N(e.$$.fragment)},l(l){U(e.$$.fragment,l)},m(l,o){A(e,l,o),r=!0},p(l,o){a=l;const n={};o[0]&129|o[1]&2e3&&(n.$$scope={dirty:o,ctx:a}),e.$set(n)},i(l){r||($(e.$$.fragment,l),r=!0)},o(l){h(e.$$.fragment,l),r=!1},d(l){P(e,l)}}}function Lt(a){let e,r,t;return r=new ct({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=T("div"),N(r.$$.fragment),this.h()},l(l){e=z(l,"DIV",{style:!0});var o=C(e);U(r.$$.fragment,o),o.forEach(m),this.h()},h(){I(e,"display","flex"),I(e,"justify-content","center"),I(e,"margin-left","20px"),I(e,"margin-right","20px")},m(l,o){b(l,e,o),A(r,e,null),t=!0},p:re,i(l){t||($(r.$$.fragment,l),t=!0)},o(l){h(r.$$.fragment,l),t=!1},d(l){l&&m(e),P(r)}}}function Bt(a){let e,r,t,l;return{c(){e=T("span"),r=R("stop_circle"),this.h()},l(o){e=z(o,"SPAN",{class:!0,style:!0});var n=C(e);r=y(n,"stop_circle"),n.forEach(m),this.h()},h(){W(e,"class","material-icons"),I(e,"font-size","2.5rem"),I(e,"color","cyan"),I(e,"margin-left","20px"),I(e,"margin-right","20px")},m(o,n){b(o,e,n),V(e,r),t||(l=ae(e,"click",function(){K(a[39])&&a[39].apply(this,arguments)}),t=!0)},p(o,n){a=o},i:re,o:re,d(o){o&&m(e),t=!1,l()}}}function Tt(a){let e,r,t,l,o,n,s,i,f,u,k={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[jt]},$$scope:{ctx:a}};return s=new pt({props:k}),a[19](s),{c(){e=T("span"),r=R("radio_button_checked"),t=Q(),l=T("span"),o=R("more_horiz"),n=Q(),N(s.$$.fragment),this.h()},l(_){e=z(_,"SPAN",{class:!0,style:!0});var w=C(e);r=y(w,"radio_button_checked"),w.forEach(m),t=q(_),l=z(_,"SPAN",{class:!0,style:!0});var D=C(l);o=y(D,"more_horiz"),D.forEach(m),n=q(_),U(s.$$.fragment,_),this.h()},h(){W(e,"class","material-icons"),I(e,"font-size","2.5rem"),I(e,"color","cyan"),I(e,"margin-left","20px"),I(e,"margin-right","20px"),W(l,"class","material-icons"),I(l,"margin-right","10px"),I(l,"color","white"),I(l,"font-size","1.5rem")},m(_,w){b(_,e,w),V(e,r),b(_,t,w),b(_,l,w),V(l,o),b(_,n,w),A(s,_,w),i=!0,f||(u=[ae(e,"click",function(){K(a[38])&&a[38].apply(this,arguments)}),ae(l,"click",a[18])],f=!0)},p(_,w){a=_;const D={};w[1]&1088&&(D.$$scope={dirty:w,ctx:a}),s.$set(D)},i(_){i||($(s.$$.fragment,_),i=!0)},o(_){h(s.$$.fragment,_),i=!1},d(_){_&&m(e),_&&m(t),_&&m(l),_&&m(n),a[19](null),P(s,_),f=!1,dt(u)}}}function zt(a){let e;return{c(){e=R("Wipe board")},l(r){e=y(r,"Wipe board")},m(r,t){b(r,e,t)},d(r){r&&m(e)}}}function Ct(a){let e,r;return e=new _t({props:{$$slots:{default:[zt]},$$scope:{ctx:a}}}),e.$on("SMUI:action",function(){K(a[37])&&a[37].apply(this,arguments)}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){a=t;const o={};l[1]&1024&&(o.$$scope={dirty:l,ctx:a}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function jt(a){let e,r;return e=new mt({props:{$$slots:{default:[Ct]},$$scope:{ctx:a}}}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){const o={};l[1]&1088&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Et(a){let e,r,t,l;const o=[Tt,Bt,Lt],n=[];function s(i,f){return i[7]==="pre_record"?0:i[7]==="mid_record"?1:2}return e=s(a),r=n[e]=o[e](a),{c(){r.c(),t=S()},l(i){r.l(i),t=S()},m(i,f){n[e].m(i,f),b(i,t,f),l=!0},p(i,f){let u=e;e=s(i),e===u?n[e].p(i,f):(B(),h(n[u],1,1,()=>{n[u]=null}),L(),r=n[e],r?r.p(i,f):(r=n[e]=o[e](i),r.c()),$(r,1),r.m(t.parentNode,t))},i(i){l||($(r),l=!0)},o(i){h(r),l=!1},d(i){n[e].d(i),i&&m(t)}}}function Ot(a){let e,r;function t(...l){return a[20](a[36],...l)}return e=new kt({props:{strokesArray:a[35],currentTime:a[40],$$slots:{default:[Et]},$$scope:{ctx:a}}}),e.$on("stroke-drawn",t),{c(){N(e.$$.fragment)},l(l){U(e.$$.fragment,l)},m(l,o){A(e,l,o),r=!0},p(l,o){a=l;const n={};o[1]&16&&(n.strokesArray=a[35]),o[1]&512&&(n.currentTime=a[40]),o[0]&129|o[1]&1472&&(n.$$scope={dirty:o,ctx:a}),e.$set(n)},i(l){r||($(e.$$.fragment,l),r=!0)},o(l){h(e.$$.fragment,l),r=!1},d(l){P(e,l)}}}function Ie(a){let e,r;return e=new gt({props:{strokesArray:a[35],audioDownloadURL:a[32].audioDownloadURL,$$slots:{default:[qt]},$$scope:{ctx:a}}}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){const o={};l[1]&16&&(o.strokesArray=t[35]),l[1]&2&&(o.audioDownloadURL=t[32].audioDownloadURL),l[0]&16|l[1]&1026&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Re(a){let e,r;return e=new pe({props:{color:"primary",$$slots:{default:[Qt]},$$scope:{ctx:a}}}),e.$on("click",function(){K(a[12](a[32]))&&a[12](a[32]).apply(this,arguments)}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){a=t;const o={};l[1]&1024&&(o.$$scope={dirty:l,ctx:a}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Qt(a){let e;return{c(){e=R("Revert to board")},l(r){e=y(r,"Revert to board")},m(r,t){b(r,e,t)},d(r){r&&m(e)}}}function qt(a){let e,r,t=a[4].uid===a[32].creatorUID&&Re(a);return{c(){t&&t.c(),e=S()},l(l){t&&t.l(l),e=S()},m(l,o){t&&t.m(l,o),b(l,e,o),r=!0},p(l,o){l[4].uid===l[32].creatorUID?t?(t.p(l,o),o[0]&16|o[1]&2&&$(t,1)):(t=Re(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(B(),h(t,1,1,()=>{t=null}),L())},i(l){r||($(t),r=!0)},o(l){h(t),r=!1},d(l){t&&t.d(l),l&&m(e)}}}function Vt(a){let e,r,t=a[32]&&ve(a);return{c(){t&&t.c(),e=S()},l(l){t&&t.l(l),e=S()},m(l,o){t&&t.m(l,o),b(l,e,o),r=!0},p(l,o){l[32]?t?(t.p(l,o),o[1]&2&&$(t,1)):(t=ve(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(B(),h(t,1,1,()=>{t=null}),L())},i(l){r||($(t),r=!0)},o(l){h(t),r=!1},d(l){t&&t.d(l),l&&m(e)}}}function ye(a,e){let r,t,l;return t=new $t({props:{dbPath:e[8]+e[29],$$slots:{default:[Vt,({boardDoc:o,fetchStrokes:n,listenToStrokes:s,strokesArray:i,handleNewlyDrawnStroke:f,deleteAllStrokesFromDb:u})=>({32:o,33:n,34:s,35:i,36:f,37:u}),({boardDoc:o,fetchStrokes:n,listenToStrokes:s,strokesArray:i,handleNewlyDrawnStroke:f,deleteAllStrokesFromDb:u})=>[0,(o?2:0)|(n?4:0)|(s?8:0)|(i?16:0)|(f?32:0)|(u?64:0)]]},$$scope:{ctx:e}}}),{key:a,first:null,c(){r=S(),N(t.$$.fragment),this.h()},l(o){r=S(),U(t.$$.fragment,o),this.h()},h(){this.first=r},m(o,n){b(o,r,n),A(t,o,n),l=!0},p(o,n){e=o;const s={};n[0]&2&&(s.dbPath=e[8]+e[29]),n[0]&243|n[1]&1118&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(o){l||($(t.$$.fragment,o),l=!0)},o(o){h(t.$$.fragment,o),l=!1},d(o){o&&m(r),P(t,o)}}}function Wt(a){let e;return{c(){e=R("New blackboard")},l(r){e=y(r,"New blackboard")},m(r,t){b(r,e,t)},d(r){r&&m(e)}}}function Ft(a){let e,r;return e=new Ye({props:{$$slots:{default:[Wt]},$$scope:{ctx:a}}}),{c(){N(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,l){A(e,t,l),r=!0},p(t,l){const o={};l[1]&1024&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){r||($(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Ht(a){let e,r,t=a[1]&&ke(a);return{c(){t&&t.c(),e=S()},l(l){t&&t.l(l),e=S()},m(l,o){t&&t.m(l,o),b(l,e,o),r=!0},p(l,o){l[1]?t?(t.p(l,o),o[0]&2&&$(t,1)):(t=ke(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(B(),h(t,1,1,()=>{t=null}),L())},i(l){r||($(t),r=!0)},o(l){h(t),r=!1},d(l){t&&t.d(l),l&&m(e)}}}async function ll({page:a}){return{props:{classID:a.params.class,roomID:a.params.room}}}function j(a){return a.charAt(a.length-1)==="?"}function Ne(a){return a.askerName&&a.dateAsked&&a.askerUID}function Kt(a,e,r){let t,l,o,n,s;x(a,Dt,p=>r(4,l=p)),x(a,It,p=>r(5,o=p)),x(a,Rt,p=>r(6,n=p)),x(a,$e,p=>r(7,s=p));let{classID:i}=e,{roomID:f}=e,u,k;const _=`classes/${i}/blackboards/`,w=`classes/${i}/rooms/`;let D="",E=5;l.uid||wt("/");async function d({srcElement:p}){const{value:g}=p,M={name:g};!j(k.name)&&j(g)&&!Ne(k)?c():D&&!j(g)?v():!j(g)&&Ne(k)&&(M.dateResolved=new Date().toISOString()),await H(t,M)}function c(){r(3,E=5),r(2,D=setInterval(()=>{r(3,E-=1),E===0&&(G(),Ue(),v())},1e3))}function v(){clearTimeout(D),r(2,D="")}function G(){H(t,{askerName:l.name||"Beaver #999",askerUID:l.uid,dateAsked:new Date().toISOString()})}async function Ue(){const p=[],g=Ze(),M=Xe(g,"sendTextMessage"),O=xe(F(),"users"),J=et(O,tt("willReceiveText","==",!0)),X=await lt(J);if(X.docs)for(const ne of X.docs){console.log("phoneNumber =",ne.data().phoneNumber);try{p.push(M({content:`${l.name} asked: "${k.name||"Fake question here"}"`,toWho:ne.data().phoneNumber}))}catch(je){alert(je)}}await Promise.all(p),console.log("success, sent all texts.")}async function oe({detail:p},g){const M=Y(F(),_+g);await H(M,{description:p})}Ke(async()=>{rt(t,p=>{r(1,k=ue({id:p.id},p.data()))})});async function Ae(){r(1,k=await vt(w+f))}async function se(p,g){const M=de(),O=me(M,`audio/${_e()}`);await at(O,p);const J=await ot(O),X=Y(F(),_+g);await H(X,{creatorUID:l.uid,creatorPhoneNumber:l.phoneNumber,date:new Date().toISOString(),audioDownloadURL:J,audioRefFullPath:O.fullPath}),$e.set("pre_record")}async function Pe({id:p,audioRefFullPath:g}){const M=[],O=Y(F(),_+p);if(g){const J=me(de(),g);M.push(st(J))}M.push(H(O,{creator:Z(),creatorPhoneNumber:Z(),date:Z(),audioDownloadURL:Z(),audioRefFullPath:Z()})),await Promise.all(M)}async function Se(){const p=_e(),g=Y(F(),_+p);await Promise.all([nt(g,{}),H(t,{blackboards:it(p)})]),await ft()}const Me=p=>d(p),Le=(p,g)=>oe(g,p),Be=()=>u.setOpen(!0);function Te(p){ut[p?"unshift":"push"](()=>{u=p,r(0,u)})}const ze=(p,g)=>p(g.detail.newStroke),Ce=(p,g)=>se(g.detail.audioBlob,p);return a.$$set=p=>{"classID"in p&&r(14,i=p.classID),"roomID"in p&&r(15,f=p.roomID)},a.$$.update=()=>{a.$$.dirty[0]&32768&&(t=Y(F(),w+f)),a.$$.dirty[0]&32768&&Ae()},[u,k,D,E,l,o,n,s,_,d,oe,se,Pe,Se,i,f,Me,Le,Be,Te,ze,Ce]}class rl extends qe{constructor(e){super();Ve(this,e,Kt,Ht,We,{classID:14,roomID:15},null,[-1,-1])}}export{rl as default,ll as load};
