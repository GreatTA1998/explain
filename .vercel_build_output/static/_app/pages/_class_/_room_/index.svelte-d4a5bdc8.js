var zt=Object.defineProperty;var rt=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable;var st=(r,e,t)=>e in r?zt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ie=(r,e)=>{for(var t in e||(e={}))Mt.call(e,t)&&st(r,t,e[t]);if(rt)for(var t of rt(e))Vt.call(e,t)&&st(r,t,e[t]);return r};import{S as ae,i as ie,s as ue,ax as jt,k as O,e as C,n as q,c as B,b as D,M as b,W as Ft,aw as oe,f as I,a1 as X,aB as ce,t as U,a as N,aC as fe,d as k,g as E,N as L,ag as Wt,I as he,j as M,m as V,o as j,ay as Ot,az as qt,h as de,J as ge,K as be,L as ke,x as R,u as T,v as F,F as H,r as ne,w as re,a2 as Te,aD as Ke,A as lt,ab as Qt,a3 as $e,ae as Ht,ai as Je,aE as Pe,O as se,a5 as at,Q,a6 as it,a7 as Xt,X as ut,a4 as ct,aF as Gt,T as ft,P as G,aG as Yt,a9 as dt,au as Kt,av as Jt,l as Y,aH as Zt,aI as xt,_ as K,aJ as Ze,aK as xe,aL as pt,aM as mt,aN as pe,aO as eo,aP as to,aQ as oo,a8 as no,aR as ro,af as so,aA as et,Y as lo,aS as ao}from"../../../chunks/vendor-17ac3c4e.js";import{R as io,a as uo,D as co}from"../../../chunks/RenderlessFetchStrokes-81b0db41.js";import{_ as fo}from"../../../chunks/preload-helper-ec9aa979.js";import{o as tt,u as _t,j as Se,a as ht,c as ot,d as Ae,f as po,e as mo,g as _o,k as Le,b as ho}from"../../../chunks/navigation-1456a012.js";/* empty css                                                                */import{d as Ne,r as go,a as bo}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const ko=r=>({}),gt=r=>({});function bt(r,e,t){const o=r.slice();return o[9]=e[t],o}function kt(r){let e,t,o,n,s,l=r[1].pencilColors,i=[];for(let c=0;c<l.length;c+=1)i[c]=$t(bt(r,l,c));return{c(){for(let c=0;c<i.length;c+=1)i[c].c();e=O(),t=C("img"),this.h()},l(c){for(let a=0;a<i.length;a+=1)i[a].l(c);e=q(c),t=B(c,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){D(t,"width","46"),D(t,"height","33"),b(t,"margin-left","8px"),Ft(t.src,o="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||D(t,"src",o),D(t,"alt","eraser"),D(t,"class","svelte-1bgxyxs"),oe(t,"eraser-selected",r[2].type==="eraser")},m(c,a){for(let f=0;f<i.length;f+=1)i[f].m(c,a);I(c,e,a),I(c,t,a),n||(s=X(t,"click",r[7]),n=!0)},p(c,a){if(a&6){l=c[1].pencilColors;let f;for(f=0;f<l.length;f+=1){const d=bt(c,l,f);i[f]?i[f].p(d,a):(i[f]=$t(d),i[f].c(),i[f].m(e.parentNode,e))}for(;f<i.length;f+=1)i[f].d(1);i.length=l.length}a&4&&oe(t,"eraser-selected",c[2].type==="eraser")},d(c){Wt(i,c),c&&k(e),c&&k(t),n=!1,s()}}}function $t(r){let e,t,o,n,s,l,i,c,a,f,d,m;function g(){return r[6](r[9])}return{c(){e=C("div"),t=ce("svg"),o=ce("g"),n=ce("path"),s=U(`;\r
            `),l=ce("polygon"),c=ce("path"),a=ce("path"),this.h()},l(w){e=B(w,"DIV",{style:!0,class:!0});var p=N(e);t=fe(p,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var P=N(t);o=fe(P,"g",{});var _=N(o);n=fe(_,"path",{d:!0}),N(n).forEach(k),s=E(_,`;\r
            `),l=fe(_,"polygon",{style:!0,points:!0}),N(l).forEach(k),c=fe(_,"path",{style:!0,d:!0}),N(c).forEach(k),a=fe(_,"path",{style:!0,d:!0}),N(a).forEach(k),_.forEach(k),P.forEach(k),p.forEach(k),this.h()},h(){D(n,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),D(l,"style",i=`fill: ${r[9]};`),D(l,"points","50,211.978 38.879,175.24 61.122,175.24"),b(c,"fill","#424242"),D(c,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),D(a,"style",f=`fill: ${r[9]};`),D(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),D(t,"preserveAspectRatio","none"),D(t,"version","1.1"),D(t,"id","Layer_1"),D(t,"xmlns","http://www.w3.org/2000/svg"),D(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),D(t,"x","0px"),D(t,"y","0px"),D(t,"width","16px"),D(t,"height","30px"),D(t,"viewBox","0 0 100 230"),b(t,"enable-background","new 0 0 100 230"),D(t,"xml:space","preserve"),D(t,"class","svelte-1bgxyxs"),b(e,"margin","0 4px"),b(e,"width","30px"),b(e,"height","42px"),b(e,"border-radius","3px"),b(e,"align-items","center"),b(e,"display","flex"),b(e,"justify-content","center"),D(e,"class","svelte-1bgxyxs"),oe(e,"pencil-selected",r[2].color===r[9])},m(w,p){I(w,e,p),L(e,t),L(t,o),L(o,n),L(o,s),L(o,l),L(o,c),L(o,a),d||(m=X(e,"click",g),d=!0)},p(w,p){r=w,p&2&&i!==(i=`fill: ${r[9]};`)&&D(l,"style",i),p&2&&f!==(f=`fill: ${r[9]};`)&&D(a,"style",f),p&6&&oe(e,"pencil-selected",r[2].color===r[9])},d(w){w&&k(e),d=!1,m()}}}function $o(r){let e,t,o,n,s,l=(r[0]?"No touch":"Touch draw")+"",i,c,a=Object.keys(r[1]).length>0,f,d,m,g,w;o=new jt({props:{icons:!1,checked:!r[0],style:"margin: 0 !important"}});let p=a&&kt(r);const P=r[5].default,_=he(P,r,r[4],null),$=r[5]["dropdown-menu"],v=he($,r,r[4],gt);return{c(){e=C("div"),t=C("div"),M(o.$$.fragment),n=O(),s=C("div"),i=U(l),c=O(),p&&p.c(),f=O(),_&&_.c(),d=O(),v&&v.c(),this.h()},l(y){e=B(y,"DIV",{style:!0});var S=N(e);t=B(S,"DIV",{style:!0});var W=N(t);V(o.$$.fragment,W),n=q(W),s=B(W,"DIV",{style:!0});var x=N(s);i=E(x,l),x.forEach(k),W.forEach(k),c=q(S),p&&p.l(S),f=q(S),_&&_.l(S),d=q(S),v&&v.l(S),S.forEach(k),this.h()},h(){b(s,"margin-top","2px"),b(s,"font-size","0.55rem"),b(s,"font-family","Roboto,sans-serif"),b(s,"color","white"),b(t,"margin-right","10px"),b(t,"text-align","center"),b(e,"position","absolute"),b(e,"display","flex"),b(e,"align-items","center"),b(e,"height","50px"),b(e,"left","0"),b(e,"right","auto"),b(e,"top","0"),b(e,"bottom","auto"),b(e,"z-index","100"),b(e,"background-color","grey"),b(e,"padding-left","10px"),b(e,"border-radius","2px")},m(y,S){I(y,e,S),L(e,t),j(o,t,null),L(t,n),L(t,s),L(s,i),L(e,c),p&&p.m(e,null),L(e,f),_&&_.m(e,null),L(e,d),v&&v.m(e,null),m=!0,g||(w=X(t,"click",Ot(qt(r[3]))),g=!0)},p(y,[S]){const W={};S&1&&(W.checked=!y[0]),o.$set(W),(!m||S&1)&&l!==(l=(y[0]?"No touch":"Touch draw")+"")&&de(i,l),S&2&&(a=Object.keys(y[1]).length>0),a?p?p.p(y,S):(p=kt(y),p.c(),p.m(e,f)):p&&(p.d(1),p=null),_&&_.p&&(!m||S&16)&&ge(_,P,y,y[4],m?ke(P,y[4],S,null):be(y[4]),null),v&&v.p&&(!m||S&16)&&ge(v,$,y,y[4],m?ke($,y[4],S,ko):be(y[4]),gt)},i(y){m||(R(o.$$.fragment,y),R(_,y),R(v,y),m=!0)},o(y){T(o.$$.fragment,y),T(_,y),T(v,y),m=!1},d(y){y&&k(e),F(o),p&&p.d(),_&&_.d(y),v&&v.d(y),g=!1,w()}}}function wo(r,e,t){let o,n,s;H(r,tt,d=>t(0,o=d)),H(r,_t,d=>t(1,n=d)),H(r,Se,d=>t(2,s=d));let{$$slots:l={},$$scope:i}=e;function c(){tt.set(!o)}const a=d=>Se.set({type:"pencil",color:d,lineWidth:3}),f=()=>Se.set({type:"eraser",color:"",lineWidth:40});return r.$$set=d=>{"$$scope"in d&&t(4,i=d.$$scope)},[o,n,s,c,i,l,a,f]}class vo extends ae{constructor(e){super();ie(this,e,wo,$o,ue,{})}}function wt(r){let e,t;return e=new vo({props:{$$slots:{"dropdown-menu":[Lo],default:[yo]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&134217922&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function yo(r){let e;const t=r[20].default,o=he(t,r,r[27],null);return{c(){o&&o.c()},l(n){o&&o.l(n)},m(n,s){o&&o.m(n,s),e=!0},p(n,s){o&&o.p&&(!e||s[0]&134217728)&&ge(o,t,n,n[27],e?ke(t,n[27],s,null):be(n[27]),null)},i(n){e||(R(o,n),e=!0)},o(n){T(o,n),e=!1},d(n){o&&o.d(n)}}}function Do(r){let e,t;return e=new Je({props:{$$slots:{default:[Io]},$$scope:{ctx:r}}}),e.$on("click",r[11]),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&134217728&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function Ro(r){let e,t;return e=new Je({props:{$$slots:{default:[To]},$$scope:{ctx:r}}}),e.$on("click",r[10]),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&134217728&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function Io(r){let e;return{c(){e=U("Set background")},l(t){e=E(t,"Set background")},m(t,o){I(t,e,o)},d(t){t&&k(e)}}}function To(r){let e;return{c(){e=U("Remove background")},l(t){e=E(t,"Remove background")},m(t,o){I(t,e,o)},d(t){t&&k(e)}}}function Po(r){let e;return{c(){e=U("Wipe board")},l(t){e=E(t,"Wipe board")},m(t,o){I(t,e,o)},d(t){t&&k(e)}}}function So(r){let e,t,o,n,s;const l=[Ro,Do],i=[];function c(a,f){return a[1]?0:1}return e=c(r),t=i[e]=l[e](r),n=new Je({props:{$$slots:{default:[Po]},$$scope:{ctx:r}}}),n.$on("SMUI:action",r[9]),{c(){t.c(),o=O(),M(n.$$.fragment)},l(a){t.l(a),o=q(a),V(n.$$.fragment,a)},m(a,f){i[e].m(a,f),I(a,o,f),j(n,a,f),s=!0},p(a,f){let d=e;e=c(a),e===d?i[e].p(a,f):(ne(),T(i[d],1,1,()=>{i[d]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=l[e](a),t.c()),R(t,1),t.m(o.parentNode,o));const m={};f[0]&134217728&&(m.$$scope={dirty:f,ctx:a}),n.$set(m)},i(a){s||(R(t),R(n.$$.fragment,a),s=!0)},o(a){T(t),T(n.$$.fragment,a),s=!1},d(a){i[e].d(a),a&&k(o),F(n,a)}}}function Ao(r){let e,t;return e=new Ht({props:{$$slots:{default:[So]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&134217730&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function Lo(r){let e,t,o,n,s,l,i,c,a,f,d={style:"width: 300px",$$slots:{default:[Ao]},$$scope:{ctx:r}};return i=new Qt({props:d}),r[24](i),{c(){e=C("div"),t=C("span"),o=U("more_horiz"),n=O(),s=C("input"),l=O(),M(i.$$.fragment),this.h()},l(m){e=B(m,"DIV",{slot:!0});var g=N(e);t=B(g,"SPAN",{class:!0,style:!0});var w=N(t);o=E(w,"more_horiz"),w.forEach(k),n=q(g),s=B(g,"INPUT",{style:!0,type:!0,accept:!0}),l=q(g),V(i.$$.fragment,g),g.forEach(k),this.h()},h(){D(t,"class","material-icons"),b(t,"margin-right","10px"),b(t,"color","white"),b(t,"font-size","2rem"),b(s,"display","none"),D(s,"type","file"),D(s,"accept","image/gif, image/jpeg, image/png"),D(e,"slot","dropdown-menu")},m(m,g){I(m,e,g),L(e,t),L(t,o),L(e,n),L(e,s),r[22](s),L(e,l),j(i,e,null),c=!0,a||(f=[X(t,"click",r[21]),X(s,"change",r[23])],a=!0)},p(m,g){const w={};g[0]&134217730&&(w.$$scope={dirty:g,ctx:m}),i.$set(w)},i(m){c||(R(i.$$.fragment,m),c=!0)},o(m){T(i.$$.fragment,m),c=!1},d(m){m&&k(e),r[22](null),r[24](null),F(i),a=!1,Te(f)}}}function No(r){let e,t,o,n,s,l,i,c,a,f=r[0]&&wt(r);return{c(){f&&f.c(),e=O(),t=C("canvas"),n=O(),s=C("canvas"),this.h()},l(d){f&&f.l(d),e=q(d),t=B(d,"CANVAS",{style:!0});var m=N(t);m.forEach(k),n=q(d),s=B(d,"CANVAS",{style:!0});var g=N(s);g.forEach(k),this.h()},h(){D(t,"style",o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[5]}px; height: ${r[4]}px`),D(s,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[5]}px; height: ${r[4]}px`)},m(d,m){f&&f.m(d,m),I(d,e,m),I(d,t,m),r[25](t),I(d,n,m),I(d,s,m),r[26](s),i=!0,c||(a=[X(t,"touchstart",r[12]),X(t,"touchmove",r[13]),X(t,"touchend",r[14])],c=!0)},p(d,m){d[0]?f?(f.p(d,m),m[0]&1&&R(f,1)):(f=wt(d),f.c(),R(f,1),f.m(e.parentNode,e)):f&&(ne(),T(f,1,1,()=>{f=null}),re()),(!i||m[0]&48&&o!==(o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${d[5]}px; height: ${d[4]}px`))&&D(t,"style",o),(!i||m[0]&48&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${d[5]}px; height: ${d[4]}px`))&&D(s,"style",l)},i(d){i||(R(f),i=!0)},o(d){T(f),i=!1},d(d){f&&f.d(d),d&&k(e),d&&k(t),r[25](null),d&&k(n),d&&k(s),r[26](null),c=!1,Te(a)}}}function Uo(r){return(r.endTime-r.startTime)/r.points.length}function Eo(r,e,t){let o,n,s,l;H(r,ht,u=>t(4,o=u)),H(r,ot,u=>t(5,n=u)),H(r,Se,u=>t(31,s=u)),H(r,tt,u=>t(32,l=u));let{$$slots:i={},$$scope:c}=e,{strokesArray:a}=e,{currentTime:f=0}=e,{backgroundImageDownloadURL:d=""}=e;const m=Ke();let g,w,p,P,_=[],$=!1,v={x:-1,y:-1},y={points:[]},S,W,x;lt(()=>{t(16,g=p.getContext("2d")),t(17,w=P.getContext("2d"))});function we(u){m("background-upload",{imageFile:u.target.files[0]})}function Ue(u){m("board-wipe")}function Ee(){m("background-reset")}function Ce(){x.click()}function ve(u){if(u.touches.length>1)return;const h=u.touches[0].touchType==="stylus";if(l&&!h){console.log("error: cannot use finger during Apple Pencil mode");return}me(u,{isInitialContact:!0})}function Be(u){if(!$)return;if(u.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const h=u.touches[0].touchType==="stylus";if(l&&!h){console.log("error: cannot use finger during Apple Pencil mode");return}me(u,{isInitialContact:!1})}function ze(u){if(!$||u.touches.length>0)return;const h=u.changedTouches[0].touchType==="stylus";if(l&&!h){console.log("error: cannot use finger during Apple Pencil mode");return}Me(y),$=!1}function ye(u){$=!0,v={x:-1,y:-1},y={strokeNumber:a.length+1,startTime:Number(f.toFixed(1)),color:s.color,lineWidth:s.lineWidth,isErasing:s.type==="eraser",points:[],sessionID:"123"}}function me(u,{isInitialContact:h}){u.preventDefault(),h&&ye();const A=Ve(u);De(u,A)}function De(u,h){y.points.push({unitX:parseFloat(h.x/p.width).toFixed(4),unitY:parseFloat(h.y/p.height).toFixed(4)}),v.x!==-1&&v.y!==-1&&bo([Re(v),Re(h)],1,s.type==="eraser",g,s.color,s.lineWidth,p),v=h}function Me(u){u.endTime=Number(f.toFixed(1)),u.id=Ae(),_.push(u),m("stroke-drawn",{newStroke:u})}function Ve(u){const{left:h,top:A}=p.getBoundingClientRect();return{x:u.touches[0].pageX-h-window.scrollX,y:u.touches[0].pageY-A-window.scrollY}}function Re({x:u,y:h}){return{unitX:u/p.width,unitY:h/p.height}}function je(){g.clearRect(0,0,n,o)}const Fe=()=>W.setOpen(!0);function We(u){$e[u?"unshift":"push"](()=>{x=u,t(7,x)})}const Oe=u=>we(u);function qe(u){$e[u?"unshift":"push"](()=>{W=u,t(6,W)})}function Qe(u){$e[u?"unshift":"push"](()=>{p=u,t(2,p),t(16,g),t(5,n),t(4,o),t(0,a)})}function He(u){$e[u?"unshift":"push"](()=>{P=u,t(3,P),t(16,g),t(5,n),t(4,o),t(0,a),t(2,p)})}return r.$$set=u=>{"strokesArray"in u&&t(0,a=u.strokesArray),"currentTime"in u&&t(15,f=u.currentTime),"backgroundImageDownloadURL"in u&&t(1,d=u.backgroundImageDownloadURL),"$$scope"in u&&t(27,c=u.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&65589&&g&&(t(2,p.width=n,p),t(2,p.height=o,p),t(3,P.width=n,P),t(3,P.height=o,P),a))for(const u of a)Ne(u,null,g,p);if(r.$$.dirty[0]&131086&&w&&(w.clearRect(0,0,P.scrollWidth,P.scrollHeight),go(d,p,w)),r.$$.dirty[0]&851973&&g&&a){let u=_.length,h=a.length;if(u!==h)if(u<h)if(u===0){for(const A of a)Ne(A,null,g,p);t(18,_=[...a])}else for(let A=u;A<h;A++){const z=a[A];Ne(z,z.startTime!==z.endTime?Uo(z):null,g,p),_.push(z)}else{let A=function(){je(),t(18,_=[]),v={x:-1,y:-1};for(const J of a)Ne(J,null,g,p)};(function(){console.log("debounced board reset"),S&&clearTimeout(S),t(19,S=setTimeout(A,1e3))})()}}},[a,d,p,P,o,n,W,x,we,Ue,Ee,Ce,ve,Be,ze,f,g,w,_,S,i,Fe,We,Oe,qe,Qe,He,c]}class Co extends ae{constructor(e){super();ie(this,e,Eo,No,ue,{strokesArray:0,currentTime:15,backgroundImageDownloadURL:1},null,[-1,-1])}}const Bo=r=>({currentTime:r&1}),vt=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function zo(r){let e;const t=r[4].default,o=he(t,r,r[3],vt);return{c(){o&&o.c()},l(n){o&&o.l(n)},m(n,s){o&&o.m(n,s),e=!0},p(n,[s]){o&&o.p&&(!e||s&9)&&ge(o,t,n,n[3],e?ke(t,n[3],s,Bo):be(n[3]),vt)},i(n){e||(R(o,n),e=!0)},o(n){T(o,n),e=!1},d(n){o&&o.d(n)}}}function Mo(r,e,t){let o,n;H(r,po,w=>t(8,o=w)),H(r,mo,w=>t(9,n=w));let{$$slots:s={},$$scope:l}=e,i,c=0,a;lt(async()=>{window&&(i=await fo(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=i.default)});const f=Ke();let d=null;function m(){return new Promise(async(w,p)=>{if(!n.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),p("Cannot start recording because mic stream is muted");return}const P=o.clone();d=new MediaRecorder(P),d.start(),a=setInterval(()=>t(0,c+=.1),100),f("record-start"),w()})}function g(){return new Promise((w,p)=>{clearTimeout(a),d.addEventListener("dataavailable",P=>{const _=P.data;f("record-end",{audioBlob:_}),w()}),d.stop();for(const P of d.stream.getTracks())P.stop()})}return r.$$set=w=>{"$$scope"in w&&t(3,l=w.$$scope)},[c,m,g,l,s]}class Vo extends ae{constructor(e){super();ie(this,e,Mo,zo,ue,{})}}function jo(r,e){let t=document.getElementById(e);return t==null||t.appendChild(r),{destroy(){r.remove()}}}function yt(r,e){let t=new IntersectionObserver(o=>{for(const n of o)if(n.isIntersecting){e(),t.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});t.observe(r)}function Fo(r){let e,t,o,n;return{c(){e=C("div"),t=C("textarea"),this.h()},l(s){e=B(s,"DIV",{class:!0,style:!0});var l=N(e);t=B(l,"TEXTAREA",{style:!0,class:!0}),N(t).forEach(k),l.forEach(k),this.h()},h(){t.value=r[0],b(t,"box-sizing","border-box"),b(t,"width",r[2]+"px"),b(t,"padding","6px"),b(t,"border-radius","2px"),b(t,"font-family","Roboto, sans-serif"),b(t,"color","rgb(60 55 56 / 87%)"),D(t,"class","svelte-tv3wak"),D(e,"class","grow-wrap svelte-tv3wak"),b(e,"font-family","Roboto, sans-serif"),b(e,"margin","10px 0px")},m(s,l){I(s,e,l),L(e,t),r[6](e),o||(n=[X(t,"input",r[5]),Pe(r[4].call(null,e))],o=!0)},p(s,[l]){l&1&&(t.value=s[0]),l&4&&b(t,"width",s[2]+"px")},i:se,o:se,d(s){s&&k(e),r[6](null),o=!1,Te(n)}}}function Wo(r,e,t){let o;H(r,ot,f=>t(2,o=f));let{value:n}=e,s;const l=Ke();function i(f){f.dataset.replicatedValue=n}const c=f=>{t(1,s.dataset.replicatedValue=f.target.value,s),l("input",f.target.value)};function a(f){$e[f?"unshift":"push"](()=>{s=f,t(1,s)})}return r.$$set=f=>{"value"in f&&t(0,n=f.value)},[n,s,o,l,i,c,a]}class Oo extends ae{constructor(e){super();ie(this,e,Wo,Fo,ue,{value:0})}}const qo=r=>({strokesArray:r&1}),Dt=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function Qo(r){let e;const t=r[6].default,o=he(t,r,r[5],Dt);return{c(){o&&o.c()},l(n){o&&o.l(n)},m(n,s){o&&o.m(n,s),e=!0},p(n,[s]){o&&o.p&&(!e||s&33)&&ge(o,t,n,n[5],e?ke(t,n[5],s,qo):be(n[5]),Dt)},i(n){e||(R(o,n),e=!0)},o(n){T(o,n),e=!1},d(n){o&&o.d(n)}}}function Rt(r){const e=Ie({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function Ho(r,e,t){let{$$slots:o={},$$scope:n}=e,{dbPath:s}=e,l,i;const c=at(Q(),`${s}/strokes`),a=it(c,Xt("timestamp"));ut(()=>{i&&i()});async function f(){i=ct(a,async g=>{g.docChanges().filter(p=>p.type==="removed").length>0?(t(0,l=[]),await Gt(),g.docs.length>0&&g.docs.forEach(p=>{l.push(Rt(p))})):(l||t(0,l=[]),g.docs.length===l.length||g.docChanges().filter(p=>p.type==="added").forEach(p=>{t(0,l=[...l,Rt(p.doc)])}))})}function d(g){l.push(g);try{ft(G(Q(),`${s}/strokes/${g.id}`),Ie({timestamp:Yt()},g))}catch(w){alert(w)}}async function m(){return new Promise(async g=>{const w=[];let p=dt(Q()),P=0;for(const _ of l){P>=500&&(w.push(p.commit()),p=dt(Q()),P=0);const $=G(Q(),`${s}/strokes/${_.id}`);p.delete($),P+=1}w.push(p.commit()),await Promise.all(w),t(0,l=[]),g()})}return r.$$set=g=>{"dbPath"in g&&t(4,s=g.dbPath),"$$scope"in g&&t(5,n=g.$$scope)},[l,f,d,m,s,n,o]}class Xo extends ae{constructor(e){super();ie(this,e,Ho,Qo,ue,{dbPath:4})}}function It(r,e,t){const o=r.slice();return o[41]=e[t],o}function Tt(r){let e,t,o,n,s,l=[],i=new Map,c,a,f,d,m,g,w;t=new Zt({props:{disabled:te(r[0].name)&&r[0].askerUID&&r[6].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[8]}px;`,$$slots:{helper:[Zo]},$$scope:{ctx:r}}}),t.$on("input",r[22]);let p=r[0].blackboards;const P=_=>_[41];for(let _=0;_<p.length;_+=1){let $=It(r,p,_),v=P($);i.set(v,l[_]=Lt(v,$))}return{c(){e=C("div"),M(t.$$.fragment),o=O(),n=C("div"),s=O();for(let _=0;_<l.length;_+=1)l[_].c();c=O(),a=C("div"),f=U("New blackboard"),this.h()},l(_){e=B(_,"DIV",{style:!0});var $=N(e);V(t.$$.fragment,$),o=q($),n=B($,"DIV",{style:!0}),N(n).forEach(k),s=q($);for(let y=0;y<l.length;y+=1)l[y].l($);c=q($),a=B($,"DIV",{style:!0});var v=N(a);f=E(v,"New blackboard"),v.forEach(k),$.forEach(k),this.h()},h(){b(n,"margin-bottom","20px"),b(a,"display","flex"),b(a,"justify-content","center"),b(a,"align-items","center"),b(a,"margin-top","40px"),b(a,"background-color","#2e3131"),b(a,"font-family","Roboto, sans-serif"),b(a,"text-transform","uppercase"),b(a,"color","white"),b(a,"height","35px"),b(a,"width",r[8]+"px"),b(e,"padding","16px"),oe(e,"question",te(r[0].name))},m(_,$){I(_,e,$),j(t,e,null),L(e,o),L(e,n),L(e,s);for(let v=0;v<l.length;v+=1)l[v].m(e,null);L(e,c),L(e,a),L(a,f),m=!0,g||(w=[X(a,"click",r[18]),Pe(d=jo.call(null,e,"main-content"))],g=!0)},p(_,$){const v={};$[0]&65&&(v.disabled=te(_[0].name)&&_[0].askerUID&&_[6].uid!==_[0].askerUID),$[0]&1&&(v.value=_[0].name),$[0]&256&&(v.style=`width: ${_[8]}px;`),$[0]&31|$[1]&4194304&&(v.$$scope={dirty:$,ctx:_}),t.$set(v),$[0]&245729|$[1]&2351104&&(p=_[0].blackboards,ne(),l=Kt(l,$,P,1,_,p,i,e,Jt,Lt,c,It),re()),(!m||$[0]&256)&&b(a,"width",_[8]+"px"),$[0]&1&&oe(e,"question",te(_[0].name))},i(_){if(!m){R(t.$$.fragment,_);for(let $=0;$<p.length;$+=1)R(l[$]);m=!0}},o(_){T(t.$$.fragment,_);for(let $=0;$<l.length;$+=1)T(l[$]);m=!1},d(_){_&&k(e),F(t);for(let $=0;$<l.length;$+=1)l[$].d();g=!1,Te(w)}}}function Go(r){let e=r[0].askerName+"",t,o,n=Le(r[0].dateAsked)+"",s;return{c(){t=U(e),o=U(" asked on "),s=U(n)},l(l){t=E(l,e),o=E(l," asked on "),s=E(l,n)},m(l,i){I(l,t,i),I(l,o,i),I(l,s,i)},p(l,i){i[0]&1&&e!==(e=l[0].askerName+"")&&de(t,e),i[0]&1&&n!==(n=Le(l[0].dateAsked)+"")&&de(s,n)},d(l){l&&k(t),l&&k(o),l&&k(s)}}}function Yo(r){let e,t,o;return{c(){e=U("Resolving this question in "),t=U(r[4]),o=U(", cancel by re-adding ?")},l(n){e=E(n,"Resolving this question in "),t=E(n,r[4]),o=E(n,", cancel by re-adding ?")},m(n,s){I(n,e,s),I(n,t,s),I(n,o,s)},p(n,s){s[0]&16&&de(t,n[4])},d(n){n&&k(e),n&&k(t),n&&k(o)}}}function Ko(r){let e,t,o;return{c(){e=U("Pinging server members in "),t=U(r[2]),o=U(", cancel by backtracking the ?")},l(n){e=E(n,"Pinging server members in "),t=E(n,r[2]),o=E(n,", cancel by backtracking the ?")},m(n,s){I(n,e,s),I(n,t,s),I(n,o,s)},p(n,s){s[0]&4&&de(t,n[2])},d(n){n&&k(e),n&&k(t),n&&k(o)}}}function Pt(r){let e,t=Le(r[0].dateResolved)+"",o;return{c(){e=U(", resolved "),o=U(t)},l(n){e=E(n,", resolved "),o=E(n,t)},m(n,s){I(n,e,s),I(n,o,s)},p(n,s){s[0]&1&&t!==(t=Le(n[0].dateResolved)+"")&&de(o,t)},d(n){n&&k(e),n&&k(o)}}}function Jo(r){let e,t;function o(i,c){if(i[1])return Ko;if(i[3])return Yo;if(i[0].askerName&&i[0].askerUID&&i[0].date)return Go}let n=o(r),s=n&&n(r),l=r[0].dateResolved&&Pt(r);return{c(){s&&s.c(),e=O(),l&&l.c(),t=Y()},l(i){s&&s.l(i),e=q(i),l&&l.l(i),t=Y()},m(i,c){s&&s.m(i,c),I(i,e,c),l&&l.m(i,c),I(i,t,c)},p(i,c){n===(n=o(i))&&s?s.p(i,c):(s&&s.d(1),s=n&&n(i),s&&(s.c(),s.m(e.parentNode,e))),i[0].dateResolved?l?l.p(i,c):(l=Pt(i),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(i){s&&s.d(i),i&&k(e),l&&l.d(i),i&&k(t)}}}function Zo(r){let e,t;return e=new xt({props:{slot:"helper",persistent:!0,$$slots:{default:[Jo]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&31|n[1]&4194304&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function St(r){let e,t,o,n,s,l;function i(...d){return r[23](r[41],...d)}e=new Oo({props:{value:r[44].description||""}}),e.$on("input",i);const c=[en,xo],a=[];function f(d,m){return d[44].audioDownloadURL?0:1}return o=f(r),n=a[o]=c[o](r),{c(){M(e.$$.fragment),t=O(),n.c(),s=Y()},l(d){V(e.$$.fragment,d),t=q(d),n.l(d),s=Y()},m(d,m){j(e,d,m),I(d,t,m),a[o].m(d,m),I(d,s,m),l=!0},p(d,m){r=d;const g={};m[1]&8192&&(g.value=r[44].description||""),e.$set(g);let w=o;o=f(r),o===w?a[o].p(r,m):(ne(),T(a[w],1,1,()=>{a[w]=null}),re(),n=a[o],n?n.p(r,m):(n=a[o]=c[o](r),n.c()),R(n,1),n.m(s.parentNode,s))},i(d){l||(R(e.$$.fragment,d),R(n),l=!0)},o(d){T(e.$$.fragment,d),T(n),l=!1},d(d){F(e,d),d&&k(t),a[o].d(d),d&&k(s)}}}function xo(r){let e,t;return e=new Xo({props:{dbPath:r[5]+r[41],$$slots:{default:[ln,({listenToStrokes:o,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>({48:o,46:n,49:s,47:l}),({listenToStrokes:o,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>[0,(o?131072:0)|(n?32768:0)|(s?262144:0)|(l?65536:0)]]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&33&&(s.dbPath=o[5]+o[41]),n[0]&897|n[1]&4431872&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function en(r){let e,t;return e=new uo({props:{dbPath:r[5]+r[41],$$slots:{default:[cn,({fetchStrokes:o,strokesArray:n,deleteAllStrokesFromDb:s})=>({45:o,46:n,47:s}),({fetchStrokes:o,strokesArray:n,deleteAllStrokesFromDb:s})=>[0,(o?16384:0)|(n?32768:0)|(s?65536:0)]]},$$scope:{ctx:r}}}),{c(){M(e.$$.fragment)},l(o){V(e.$$.fragment,o)},m(o,n){j(e,o,n),t=!0},p(o,n){const s={};n[0]&33&&(s.dbPath=o[5]+o[41]),n[0]&832|n[1]&4251648&&(s.$$scope={dirty:n,ctx:o}),e.$set(s)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){F(e,o)}}}function tn(r){let e,t,o;return t=new ao({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=C("div"),M(t.$$.fragment),this.h()},l(n){e=B(n,"DIV",{style:!0});var s=N(e);V(t.$$.fragment,s),s.forEach(k),this.h()},h(){b(e,"display","flex"),b(e,"justify-content","center"),b(e,"margin-left","20px"),b(e,"margin-right","20px")},m(n,s){I(n,e,s),j(t,e,null),o=!0},p:se,i(n){o||(R(t.$$.fragment,n),o=!0)},o(n){T(t.$$.fragment,n),o=!1},d(n){n&&k(e),F(t)}}}function on(r){let e,t,o,n;function s(){return r[26](r[51],r[41])}return{c(){e=C("span"),t=U("stop_circle"),this.h()},l(l){e=B(l,"SPAN",{class:!0,style:!0});var i=N(e);t=E(i,"stop_circle"),i.forEach(k),this.h()},h(){D(e,"class","material-icons svelte-53fhoc"),b(e,"font-size","2.5rem"),b(e,"color","cyan"),b(e,"margin-left","30px"),b(e,"margin-right","26px"),oe(e,"unclickable",r[7]!==r[44].recorderBrowserTabID)},m(l,i){I(l,e,i),L(e,t),o||(n=X(e,"click",s),o=!0)},p(l,i){r=l,i[0]&128|i[1]&8192&&oe(e,"unclickable",r[7]!==r[44].recorderBrowserTabID)},i:se,o:se,d(l){l&&k(e),o=!1,n()}}}function nn(r){let e,t,o,n;function s(){return r[25](r[50],r[41])}return{c(){e=C("span"),t=U("radio_button_checked"),this.h()},l(l){e=B(l,"SPAN",{class:!0,style:!0});var i=N(e);t=E(i,"radio_button_checked"),i.forEach(k),this.h()},h(){D(e,"class","material-icons"),b(e,"font-size","2.5rem"),b(e,"color","cyan"),b(e,"margin-left","30px"),b(e,"margin-right","26px")},m(l,i){I(l,e,i),L(e,t),o||(n=X(e,"click",s),o=!0)},p(l,i){r=l},i:se,o:se,d(l){l&&k(e),o=!1,n()}}}function rn(r){let e,t,o,n;const s=[nn,on,tn],l=[];function i(c,a){return!c[44].recordState||c[44].recordState==="pre_record"?0:c[44].recordState==="mid_record"?1:2}return e=i(r),t=l[e]=s[e](r),{c(){t.c(),o=Y()},l(c){t.l(c),o=Y()},m(c,a){l[e].m(c,a),I(c,o,a),n=!0},p(c,a){let f=e;e=i(c),e===f?l[e].p(c,a):(ne(),T(l[f],1,1,()=>{l[f]=null}),re(),t=l[e],t?t.p(c,a):(t=l[e]=s[e](c),t.c()),R(t,1),t.m(o.parentNode,o))},i(c){n||(R(t),n=!0)},o(c){T(t),n=!1},d(c){l[e].d(c),c&&k(o)}}}function sn(r){let e,t;function o(...l){return r[27](r[41],...l)}function n(){return r[28](r[41])}function s(...l){return r[29](r[49],...l)}return e=new Co({props:{strokesArray:r[46],currentTime:r[52],backgroundImageDownloadURL:r[44].backgroundImageDownloadURL,$$slots:{default:[rn]},$$scope:{ctx:r}}}),e.$on("background-upload",o),e.$on("background-reset",n),e.$on("stroke-drawn",s),e.$on("board-wipe",function(){et(r[47])&&r[47].apply(this,arguments)}),{c(){M(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,i){j(e,l,i),t=!0},p(l,i){r=l;const c={};i[1]&32768&&(c.strokesArray=r[46]),i[1]&2097152&&(c.currentTime=r[52]),i[1]&8192&&(c.backgroundImageDownloadURL=r[44].backgroundImageDownloadURL),i[0]&129|i[1]&4202496&&(c.$$scope={dirty:i,ctx:r}),e.$set(c)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){T(e.$$.fragment,l),t=!1},d(l){F(e,l)}}}function ln(r){let e,t,o,n,s,l,i;function c(...a){return r[30](r[46],r[41],...a)}return t=new Vo({props:{$$slots:{default:[sn,({startRecording:a,stopRecording:f,currentTime:d})=>({50:a,51:f,52:d}),({startRecording:a,stopRecording:f,currentTime:d})=>[0,(a?524288:0)|(f?1048576:0)|(d?2097152:0)]]},$$scope:{ctx:r}}}),t.$on("record-end",c),{c(){e=C("div"),M(t.$$.fragment),this.h()},l(a){e=B(a,"DIV",{style:!0});var f=N(e);V(t.$$.fragment,f),f.forEach(k),this.h()},h(){D(e,"style",o=`width: ${r[8]}px; height: ${r[9]}px; position: relative`)},m(a,f){I(a,e,f),j(t,e,null),s=!0,l||(i=Pe(n=yt.call(null,e,r[48])),l=!0)},p(a,f){r=a;const d={};f[0]&129|f[1]&6397952&&(d.$$scope={dirty:f,ctx:r}),t.$set(d),(!s||f[0]&768&&o!==(o=`width: ${r[8]}px; height: ${r[9]}px; position: relative`))&&D(e,"style",o),n&&et(n.update)&&f[1]&131072&&n.update.call(null,r[48])},i(a){s||(R(t.$$.fragment,a),s=!0)},o(a){T(t.$$.fragment,a),s=!1},d(a){a&&k(e),F(t),l=!1,i()}}}function At(r){let e,t;function o(){return r[24](r[44],r[47])}return e=new lo({props:{color:"primary",$$slots:{default:[an]},$$scope:{ctx:r}}}),e.$on("click",o),{c(){M(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,s){j(e,n,s),t=!0},p(n,s){r=n;const l={};s[1]&4194304&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function an(r){let e;return{c(){e=U("Delete video")},l(t){e=E(t,"Delete video")},m(t,o){I(t,e,o)},d(t){t&&k(e)}}}function un(r){let e,t,o=r[6].uid===r[44].creatorUID&&At(r);return{c(){o&&o.c(),e=Y()},l(n){o&&o.l(n),e=Y()},m(n,s){o&&o.m(n,s),I(n,e,s),t=!0},p(n,s){n[6].uid===n[44].creatorUID?o?(o.p(n,s),s[0]&64|s[1]&8192&&R(o,1)):(o=At(n),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),T(o,1,1,()=>{o=null}),re())},i(n){t||(R(o),t=!0)},o(n){T(o),t=!1},d(n){o&&o.d(n),n&&k(e)}}}function cn(r){let e,t,o,n,s,l,i;return t=new co({props:{strokesArray:r[46],audioDownloadURL:r[44].audioDownloadURL,backgroundImageDownloadURL:r[44].backgroundImageDownloadURL,$$slots:{default:[un]},$$scope:{ctx:r}}}),{c(){e=C("div"),M(t.$$.fragment),this.h()},l(c){e=B(c,"DIV",{style:!0});var a=N(e);V(t.$$.fragment,a),a.forEach(k),this.h()},h(){D(e,"style",o=`width: ${r[8]}px; height: ${r[9]+40}px; position: relative`)},m(c,a){I(c,e,a),j(t,e,null),s=!0,l||(i=Pe(n=yt.call(null,e,r[45])),l=!0)},p(c,a){const f={};a[1]&32768&&(f.strokesArray=c[46]),a[1]&8192&&(f.audioDownloadURL=c[44].audioDownloadURL),a[1]&8192&&(f.backgroundImageDownloadURL=c[44].backgroundImageDownloadURL),a[0]&64|a[1]&4202496&&(f.$$scope={dirty:a,ctx:c}),t.$set(f),(!s||a[0]&768&&o!==(o=`width: ${c[8]}px; height: ${c[9]+40}px; position: relative`))&&D(e,"style",o),n&&et(n.update)&&a[1]&16384&&n.update.call(null,c[45])},i(c){s||(R(t.$$.fragment,c),s=!0)},o(c){T(t.$$.fragment,c),s=!1},d(c){c&&k(e),F(t),l=!1,i()}}}function fn(r){let e,t,o=r[44]&&St(r);return{c(){o&&o.c(),e=O()},l(n){o&&o.l(n),e=q(n)},m(n,s){o&&o.m(n,s),I(n,e,s),t=!0},p(n,s){n[44]?o?(o.p(n,s),s[1]&8192&&R(o,1)):(o=St(n),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),T(o,1,1,()=>{o=null}),re())},i(n){t||(R(o),t=!0)},o(n){T(o),t=!1},d(n){o&&o.d(n),n&&k(e)}}}function Lt(r,e){let t,o,n;return o=new io({props:{dbPath:e[5]+e[41],$$slots:{default:[fn,({boardDoc:s})=>({44:s}),({boardDoc:s})=>[0,s?8192:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){t=Y(),M(o.$$.fragment),this.h()},l(s){t=Y(),V(o.$$.fragment,s),this.h()},h(){this.first=t},m(s,l){I(s,t,l),j(o,s,l),n=!0},p(s,l){e=s;const i={};l[0]&33&&(i.dbPath=e[5]+e[41]),l[0]&993|l[1]&4202496&&(i.$$scope={dirty:l,ctx:e}),o.$set(i)},i(s){n||(R(o.$$.fragment,s),n=!0)},o(s){T(o.$$.fragment,s),n=!1},d(s){s&&k(t),F(o,s)}}}function dn(r){let e,t,o=r[0]&&Tt(r);return{c(){o&&o.c(),e=Y()},l(n){o&&o.l(n),e=Y()},m(n,s){o&&o.m(n,s),I(n,e,s),t=!0},p(n,s){n[0]?o?(o.p(n,s),s[0]&1&&R(o,1)):(o=Tt(n),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),T(o,1,1,()=>{o=null}),re())},i(n){t||(R(o),t=!0)},o(n){T(o),t=!1},d(n){o&&o.d(n),n&&k(e)}}}async function vn({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Nt(...r){for(const e of r)e()}function te(r){return r?r.charAt(r.length-1)==="?":!1}function nt(r){return r.askerName&&r.dateAsked&&r.askerUID}function pn(r,e,t){let o,n,s,l,i,c,a;H(r,_t,u=>t(6,l=u)),H(r,ho,u=>t(7,i=u)),H(r,ot,u=>t(8,c=u)),H(r,ht,u=>t(9,a=u));let{classID:f}=e,{roomID:d}=e,m,g;l.uid||_o("/");async function w(){m&&m(),m=ct(s,u=>{t(0,g=Ie({id:u.id},u.data()))})}ut(()=>{m()});function p(u){const h=G(Q(),o+u);K(h,{recorderBrowserTabID:i})}function P(u,h){const A=G(Q(),o+u);K(A,{recordState:h})}async function _(u,h){const A=G(Q(),o+h);if(!!u)if(u.type.split("/")[0]==="image"){const z=Ze(),J=xe(z,`images/${Ae()}`);await pt(J,u);const ee=await mt(J);K(A,{backgroundImageDownloadURL:ee})}else alert("Error: only images can be used")}function $(u){const h=G(Q(),o+u);K(h,{backgroundImageDownloadURL:pe()})}let v="",y=5,S,W=5;async function x({srcElement:u}){const{value:h}=u,A={name:h};!te(g.name)&&te(h)&&!nt(g)?we():v&&!te(h)?ve():!te(h)&&nt(g)?Ue():S&&te(h)&&nt(g)&&Ce(),await K(s,A)}function we(){t(2,y=5),t(1,v=setInterval(()=>{t(2,y-=1),y===0&&(Be(),ze(),ve())},1e3))}function Ue(){t(4,W=5),t(3,S=setInterval(()=>{t(4,W-=1),W===0&&Ee()},1e3))}function Ee(){K(s,{dateResolved:new Date().toISOString()})}function Ce(){clearTimeout(S),t(3,S="")}function ve(){clearTimeout(v),t(1,v="")}function Be(){K(s,{askerName:l.name||"Beaver #999",askerUID:l.uid,dateAsked:new Date().toISOString()})}async function ze(){const u=[],h=eo(),A=to(h,"sendTextMessage"),z=at(Q(),"users"),J=it(z,oo("willReceiveText","==",!0)),ee=await no(J);if(ee.docs)for(const _e of ee.docs){console.log("phoneNumber =",_e.data().phoneNumber);try{_e.id!==l.uid&&u.push(A({content:`${l.name} asked on https://ihtfp.app: "${g.name||"Fake question here"}"`,toWho:_e.data().phoneNumber}))}catch(Xe){alert(Xe)}}await Promise.all(u),console.log("success, sent all texts.")}async function ye({detail:u},h){const A=G(Q(),o+h);await K(A,{description:u})}async function me(u,h,A){function z(Z){return Z.startTime!==0&&Z.endTime!==J}const J=.5,ee=[],_e=h.length;for(let Z=0;Z<_e;Z++){if(!z(h[Z])){let le=Z-1;for(;le>=0;){if(z(h[le])){h[Z].startTime=h[le].endTime,h[Z].endTime=h[Z].startTime+J,ee.push(Z);break}le-=1}}for(let le of ee){const Ye=h[le],Ct=o+A,Bt=G(Q(),`${Ct}/strokes/${Ye.id}`);K(Bt,{startTime:Ye.startTime,endTime:Ye.endTime})}}const Xe=Ze(),Ge=xe(Xe,`audio/${Ae()}`);await pt(Ge,u);const Ut=await mt(Ge),Et=G(Q(),o+A);await K(Et,{creatorUID:l.uid,creatorPhoneNumber:l.phoneNumber,date:new Date().toISOString(),audioDownloadURL:Ut,audioRefFullPath:Ge.fullPath}),P(A,"pre_record")}async function De({id:u,audioRefFullPath:h},A){const z=[],J=G(Q(),o+u);if(h){const ee=xe(Ze(),h);z.push(ro(ee))}z.push(K(J,{creator:pe(),creatorPhoneNumber:pe(),date:pe(),audioDownloadURL:pe(),audioRefFullPath:pe()})),z.push(A()),await Promise.all(z)}async function Me(){const u=Ae(),h=G(Q(),o+u);await Promise.all([ft(h,{}),K(s,{blackboards:so(u)})])}const Ve=u=>x(u),Re=(u,h)=>ye(h,u),je=(u,h)=>De(u,h),Fe=(u,h)=>Nt(u,()=>P(h,"mid_record"),()=>p(h)),We=(u,h)=>Nt(u,()=>P(h,"post_record")),Oe=(u,h)=>_(h.detail.imageFile,u),qe=u=>$(u),Qe=(u,h)=>u(h.detail.newStroke),He=(u,h,A)=>me(A.detail.audioBlob,u,h);return r.$$set=u=>{"classID"in u&&t(19,f=u.classID),"roomID"in u&&t(20,d=u.roomID)},r.$$.update=()=>{r.$$.dirty[0]&524288&&t(5,o=`classes/${f}/blackboards/`),r.$$.dirty[0]&524288&&t(21,n=`classes/${f}/rooms/`),r.$$.dirty[0]&3145728&&(s=G(Q(),n+d)),r.$$.dirty[0]&1048576&&w()},[g,v,y,S,W,o,l,i,c,a,p,P,_,$,x,ye,me,De,Me,f,d,n,Ve,Re,je,Fe,We,Oe,qe,Qe,He]}class yn extends ae{constructor(e){super();ie(this,e,pn,dn,ue,{classID:19,roomID:20},null,[-1,-1])}}export{yn as default,vn as load};
