var je=Object.defineProperty;var ke=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var be=(r,e,o)=>e in r?je(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,te=(r,e)=>{for(var o in e||(e={}))Xe.call(e,o)&&be(r,o,e[o]);if(ke)for(var o of ke(e))Oe.call(e,o)&&be(r,o,e[o]);return r};import{S as q,i as J,s as G,G as se,H as ie,I as ae,J as ce,x as p,u as k,T as Ve,O as K,aa as ye,af as Ye,ag as He,ab as qe,ah as Je,P as Ge,M as $e,ai as Ke,aj as we,V as ue,j as P,m as L,o as R,v as W,k as j,l as F,n as X,f as w,r as N,w as U,d as m,a2 as Qe,D as fe,t as Te,g as De,ak as O,al as V,a as C,b as y,a7 as oe,K as Q,e as Y,c as H,ac as Z,am as x,an as ee,ao as ve,ap as Ze,A as de,X as he,a9 as Ae,L as ne,ad as xe,ae as et}from"../../../chunks/vendor-5e1023d0.js";import{f as me,a as tt}from"../../../chunks/database-6ecf91d4.js";import{u as Se,c as _e}from"../../../chunks/store-b050bf8d.js";import{p as ot,l as Ce}from"../../../chunks/actions-31a3ae93.js";import{g as nt}from"../../../chunks/navigation-51f4a605.js";import"../../../chunks/singletons-12a22614.js";const rt=r=>({boardDoc:r&4,isFetchingStrokes:r&2,strokesArray:r&1}),Ee=r=>({boardDoc:r[2],fetchStrokes:r[3],listenToStrokes:r[4],isFetchingStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[5],deleteAllStrokesFromDb:r[6]});function lt(r){let e;const o=r[9].default,t=se(o,r,r[8],Ee);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,[s]){t&&t.p&&(!e||s&263)&&ie(t,o,n,n[8],e?ce(o,n[8],s,rt):ae(n[8]),Ee)},i(n){e||(p(t,n),e=!0)},o(n){k(t,n),e=!1},d(n){t&&t.d(n)}}}function Ie(r){const e=te({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function st(r,e,o){let{$$slots:t={},$$scope:n}=e,{dbPath:s}=e,c,d=!1,i,a;const u=Ve(K(),`${s}/strokes`);async function l(){const $=await me(s);o(2,i=$)}l(),ye(()=>{a&&a()});async function f(){o(1,d=!0),o(0,c=await tt(s+"/strokes"))}async function g(){o(1,d=!0);const $=Ye(u,He("timestamp"));a=qe($,async v=>{v.docChanges().filter(A=>A.type==="removed").length>0?(o(0,c=[]),await Je(),v.docs.length>0&&v.docs.forEach(A=>{c.push(Ie(A))})):(c||(o(1,d=!1),o(0,c=[])),v.docs.length===c.length||v.docChanges().filter(A=>A.type==="added").forEach(A=>{o(0,c=[...c,Ie(A.doc)])}))})}function b($){c.push($);try{Ge($e(K(),`${s}/strokes/${$.id}`),te({timestamp:Ke()},$))}catch(v){alert(v)}}async function z(){const $=[];let v=we(K()),I=0;for(const A of c){I>=500&&($.push(v.commit()),v=we(K()),I=0);const _=$e(K(),`${s}/strokes/${A.id}`);v.delete(_),I+=1}$.push(v.commit()),console.log("number of strokes =",c.length),console.log("number of batches to be deleted =",I),await Promise.all($)}return r.$$set=$=>{"dbPath"in $&&o(7,s=$.dbPath),"$$scope"in $&&o(8,n=$.$$scope)},[c,d,i,f,g,b,z,s,n,t]}class it extends q{constructor(e){super();J(this,e,st,lt,G,{dbPath:7})}}function Pe(r,e,o){const t=r.slice();return t[5]=e[o],t}function at(r){let e;return{c(){e=Te("Eraser")},l(o){e=De(o,"Eraser")},m(o,t){w(o,e,t)},d(o){o&&m(e)}}}function ct(r){let e,o,t,n,s,c,d,i,a;return{c(){e=O("svg"),o=O("g"),t=O("path"),n=O("polygon"),c=O("path"),d=O("path"),a=j(),this.h()},l(u){e=V(u,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,":viewbox":!0,style:!0,"xml:space":!0});var l=C(e);o=V(l,"g",{});var f=C(o);t=V(f,"path",{d:!0}),C(t).forEach(m),n=V(f,"polygon",{style:!0,points:!0}),C(n).forEach(m),c=V(f,"path",{style:!0,d:!0}),C(c).forEach(m),d=V(f,"path",{style:!0,d:!0}),C(d).forEach(m),f.forEach(m),l.forEach(m),a=X(u),this.h()},h(){y(t,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
          L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),y(n,"style",s=`fill: ${r[5]};`),y(n,"points","50,211.978 38.879,175.24 61.122,175.24"),oe(c,"fill","#424242"),y(c,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
            l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),y(d,"style",i=`fill: ${r[5]};`),y(d,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
            c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
            c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),y(e,"preserveAspectRatio","none"),y(e,"version","1.1"),y(e,"id","Layer_1"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(e,"x","0px"),y(e,"y","0px"),y(e,"width","16px"),y(e,"height","35px"),y(e,":viewbox","`0 0 100 230`"),oe(e,"enable-background","new 0 0 100 230"),y(e,"xml:space","preserve")},m(u,l){w(u,e,l),Q(e,o),Q(o,t),Q(o,n),Q(o,c),Q(o,d),w(u,a,l)},p(u,l){l&1&&s!==(s=`fill: ${u[5]};`)&&y(n,"style",s),l&1&&i!==(i=`fill: ${u[5]};`)&&y(d,"style",i)},d(u){u&&m(e),u&&m(a)}}}function Le(r){let e,o;function t(){return r[3](r[5])}return e=new ue({props:{$$slots:{default:[ct]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){P(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,s){R(e,n,s),o=!0},p(n,s){r=n;const c={};s&17&&(c.$$scope={dirty:s,ctx:r}),e.$set(c)},i(n){o||(p(e.$$.fragment,n),o=!0)},o(n){k(e.$$.fragment,n),o=!1},d(n){W(e,n)}}}function ut(r){let e,o,t,n,s;e=new ue({props:{$$slots:{default:[at]},$$scope:{ctx:r}}}),e.$on("click",r[2]);const c=r[1].default,d=se(c,r,r[4],null);let i=r[0].pencilColors,a=[];for(let l=0;l<i.length;l+=1)a[l]=Le(Pe(r,i,l));const u=l=>k(a[l],1,1,()=>{a[l]=null});return{c(){P(e.$$.fragment),o=j(),d&&d.c(),t=j();for(let l=0;l<a.length;l+=1)a[l].c();n=F()},l(l){L(e.$$.fragment,l),o=X(l),d&&d.l(l),t=X(l);for(let f=0;f<a.length;f+=1)a[f].l(l);n=F()},m(l,f){R(e,l,f),w(l,o,f),d&&d.m(l,f),w(l,t,f);for(let g=0;g<a.length;g+=1)a[g].m(l,f);w(l,n,f),s=!0},p(l,[f]){const g={};if(f&16&&(g.$$scope={dirty:f,ctx:l}),e.$set(g),d&&d.p&&(!s||f&16)&&ie(d,c,l,l[4],s?ce(c,l[4],f,null):ae(l[4]),null),f&1){i=l[0].pencilColors;let b;for(b=0;b<i.length;b+=1){const z=Pe(l,i,b);a[b]?(a[b].p(z,f),p(a[b],1)):(a[b]=Le(z),a[b].c(),p(a[b],1),a[b].m(n.parentNode,n))}for(N(),b=i.length;b<a.length;b+=1)u(b);U()}},i(l){if(!s){p(e.$$.fragment,l),p(d,l);for(let f=0;f<i.length;f+=1)p(a[f]);s=!0}},o(l){k(e.$$.fragment,l),k(d,l),a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)k(a[f]);s=!1},d(l){W(e,l),l&&m(o),d&&d.d(l),l&&m(t),Qe(a,l),l&&m(n)}}}function ft(r,e,o){let t;fe(r,Se,i=>o(0,t=i));let{$$slots:n={},$$scope:s}=e;const c=()=>_e.set({type:"eraser",color:"",lineWidth:40}),d=i=>_e.set({type:"pencil",color:i,lineWidth:3});return r.$$set=i=>{"$$scope"in i&&o(4,s=i.$$scope)},[t,n,c,d,s]}class dt extends q{constructor(e){super();J(this,e,ft,ut,G,{})}}function re({points:r,color:e,lineWidth:o,isErasing:t},n=null,s,c){return new Promise(async d=>{for(let i=1;i<r.length;i++)pe(r,i,t,s,e,o,c),n!==null&&await new Promise(a=>setTimeout(a,n));d()})}function pe(r,e,o,t,n="white",s=3,c){ht(n,s,o,t);const d=r[e-1],i=d.unitX*c.width,a=d.unitY*c.height,u=r[e],l=u.unitX*c.width,f=u.unitY*c.height;t.beginPath(),t.moveTo(i,a),t.lineTo(l,f),t.stroke()}function ht(r,e,o,t){t.globalCompositeOperation=o?"destination-out":"source-over",t.strokeStyle=r,t.lineWidth=e,t.lineJoin="round",t.lineCap="round"}function Re(r,{strokesArray:e,specialRedrawFunc:o}){let t=r.getContext("2d");r.style["background-color"]="#2e3131";const n=100;function s(){setTimeout(()=>{c(),o?o():d()},n)}function c(){let i,a;const u=document.getElementById("main-content"),l=u.clientHeight,f=u.clientWidth,g=4/3;f*(1/g)<l?(a=f,i=a*(1/g)):(i=l,a=i*g),r.width=a,r.height=i,window.addEventListener("resize",s)}function d(){for(const i of e)re(i,null,t,r)}return c(),o?o():d(),{destroy(){window.removeEventListener("resize",s)}}}const mt=function(){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let o=0;o<20;o++)e+=r.charAt(Math.floor(Math.random()*r.length));return e};function _t(r){let e;const o=r[8].default,t=se(o,r,r[10],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&1024)&&ie(t,o,n,n[10],e?ce(o,n[10],s,null):ae(n[10]),null)},i(n){e||(p(t,n),e=!0)},o(n){k(t,n),e=!1},d(n){t&&t.d(n)}}}function pt(r){let e,o,t,n,s,c,d;return e=new dt({props:{$$slots:{default:[_t]},$$scope:{ctx:r}}}),{c(){P(e.$$.fragment),o=j(),t=Y("canvas")},l(i){L(e.$$.fragment,i),o=X(i),t=H(i,"CANVAS",{});var a=C(t);a.forEach(m)},m(i,a){R(e,i,a),w(i,o,a),w(i,t,a),r[9](t),s=!0,c||(d=[Z(n=Re.call(null,t,{strokesArray:r[0]})),x(t,"touchstart",r[2]),x(t,"touchmove",r[3]),x(t,"touchend",r[4])],c=!0)},p(i,[a]){const u={};a&1024&&(u.$$scope={dirty:a,ctx:i}),e.$set(u),n&&ee(n.update)&&a&1&&n.update.call(null,{strokesArray:i[0]})},i(i){s||(p(e.$$.fragment,i),s=!0)},o(i){k(e.$$.fragment,i),s=!1},d(i){W(e,i),i&&m(o),i&&m(t),r[9](null),c=!1,ve(d)}}}let We=0;function gt(r){return(r.endTime-r.startTime)/r.points.length}function kt(r,e,o){let t;fe(r,_e,h=>o(14,t=h));let{$$slots:n={},$$scope:s}=e,{strokesArray:c}=e;const d=Ze();let i,a=[],u,l=!1,f={x:-1,y:-1},g={points:[]},b;de(()=>{o(5,i=u.getContext("2d"))});function z(h){h.touches.length>1||(h.touches[0].touchType,A(h,{isInitialContact:!0}))}function $(h){if(!!l){if(h.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}h.touches[0].touchType,A(h,{isInitialContact:!1})}}function v(h){!l||h.touches.length>0||(h.changedTouches[0].touchType,T(g),l=!1)}function I(h){l=!0,f={x:-1,y:-1},g={strokeNumber:c.length+1,startTime:Number(We.toFixed(1)),color:t.color,lineWidth:t.lineWidth,isErasing:t.type==="eraser",points:[],sessionID:"123"}}function A(h,{isInitialContact:S}){h.preventDefault(),S&&I();const E=D(h);_(h,E)}function _(h,S){g.points.push({unitX:parseFloat(S.x/u.width).toFixed(4),unitY:parseFloat(S.y/u.height).toFixed(4)}),f.x!==-1&&f.y!==-1&&pe([M(f),M(S)],1,t.type==="eraser",i,t.color,t.lineWidth,u),f=S}function T(h){h.endTime=Number(We.toFixed(1)),h.id=mt(),a.push(h),d("stroke-drawn",{newStroke:h})}function D(h){const{left:S,top:E}=u.getBoundingClientRect();return{x:h.touches[0].pageX-S-window.scrollX,y:h.touches[0].pageY-E-window.scrollY}}function M({x:h,y:S}){return{unitX:h/u.width,unitY:S/u.height}}function le(){i.clearRect(0,0,u.scrollWidth,u.scrollHeight)}function Me(h){he[h?"unshift":"push"](()=>{u=h,o(1,u)})}return r.$$set=h=>{"strokesArray"in h&&o(0,c=h.strokesArray),"$$scope"in h&&o(10,s=h.$$scope)},r.$$.update=()=>{if(r.$$.dirty&227&&c&&i){console.log("strokesArray changed and NOT localStrokesArray");let h=a.length,S=c.length;if(h!==S)if(h<S)if(h===0){for(const E of c)re(E,null,i,u);o(6,a=[...c])}else for(let E=h;E<S;E++){const B=c[E];re(B,B.startTime!==B.endTime?gt(B):null,i,u),a.push(B)}else{let E=function(){le(),o(6,a=[]),f={x:-1,y:-1};for(const Be of c)re(Be,null,i,u)};(function(){console.log("debounced board reset"),b&&clearTimeout(b),o(7,b=setTimeout(E,1e3))})()}}},[c,u,z,$,v,i,a,b,n,Me,s]}class ge extends q{constructor(e){super();J(this,e,kt,pt,G,{strokesArray:0})}}function bt(r){let e,o,t,n,s,c,d;return{c(){e=Y("canvas"),t=j(),n=Y("audio"),this.h()},l(i){e=H(i,"CANVAS",{});var a=C(e);a.forEach(m),t=X(i),n=H(i,"AUDIO",{src:!0,style:!0});var u=C(n);u.forEach(m),this.h()},h(){Ae(n.src,s=r[1])||y(n,"src",s),n.controls=!0,oe(n,"width","100%")},m(i,a){w(i,e,a),r[6](e),w(i,t,a),w(i,n,a),r[7](n),c||(d=[Z(o=Re.call(null,e,{strokesArray:r[0],handleResize:r[5]})),x(e,"resized",r[5]),x(n,"play",r[4])],c=!0)},p(i,[a]){o&&ee(o.update)&&a&1&&o.update.call(null,{strokesArray:i[0],handleResize:i[5]}),a&2&&!Ae(n.src,s=i[1])&&y(n,"src",s)},i:ne,o:ne,d(i){i&&m(e),r[6](null),i&&m(t),i&&m(n),r[7](null),c=!1,ve(d)}}}let yt=1;function $t(r){return(r.endTime-r.startTime)/r.points.length}function wt(r,e,o){let{strokesArray:t}=e,{audioDownloadURL:n}=e,s,c=0,d,i,a,u;ye(()=>{u&&clearTimeout(u)}),de(()=>{i=d.getContext("2d");const _=[];for(let T=0;T<t.length;T++)for(let D=1;D<t[T].points.length;D++){const M={strokeIndex:T,pointIndex:D};_.push(te({startTime:l(M)},M))}s=_.sort((T,D)=>T.startTime-D.startTime)});function l({strokeIndex:_,pointIndex:T}){const D=t[_];return D.startTime+(T-1)*$t(D)}function f(){c=0,i.clearRect(0,0,d.width,d.height),g()}function g(){if(!!a&&(b(),c<s.length)){const _=s[c],T=1e3*(_.startTime-a.currentTime);u=setTimeout(g,T/yt)}}function b(){if(!a)return;const _=s[c];(!_||_.startTime>a.currentTime)&&(i.clearRect(0,0,d.width,d.height),c=0),z()}function z(){const{currentTime:_}=a;for(let T=c;T<s.length;T++){const D=s[T];if(D.startTime>_)break;$(D),c+=1}}function $({strokeIndex:_,pointIndex:T}){const D=t[_],le=D.lineWidth*(d.scrollWidth/1e3);pe(D.points,T,D.isErasing,i,D.color,le,d)}function v(){return new Promise(async _=>{u?(c=0,this.syncStrokesToAudio()):this.renderFramesUntilCurrentTime(),_()})}function I(_){he[_?"unshift":"push"](()=>{d=_,o(2,d)})}function A(_){he[_?"unshift":"push"](()=>{a=_,o(3,a)})}return r.$$set=_=>{"strokesArray"in _&&o(0,t=_.strokesArray),"audioDownloadURL"in _&&o(1,n=_.audioDownloadURL)},[t,n,d,a,f,v,I,A]}class Tt extends q{constructor(e){super();J(this,e,wt,bt,G,{strokesArray:0,audioDownloadURL:1})}}function ze(r,e,o){const t=r.slice();return t[8]=e[o],t}function Fe(r){let e,o=[],t=new Map,n,s,c,d,i=r[0].blackboards;const a=u=>u[8];for(let u=0;u<i.length;u+=1){let l=ze(r,i,u),f=a(l);t.set(f,o[u]=Ue(f,l))}return{c(){e=Y("div");for(let u=0;u<o.length;u+=1)o[u].c();this.h()},l(u){e=H(u,"DIV",{style:!0});var l=C(e);for(let f=0;f<o.length;f+=1)o[f].l(l);l.forEach(m),this.h()},h(){oe(e,"height","100vh")},m(u,l){w(u,e,l);for(let f=0;f<o.length;f+=1)o[f].m(e,null);s=!0,c||(d=Z(n=ot.call(null,e,"main-content")),c=!0)},p(u,l){l&178179&&(i=u[0].blackboards,N(),o=xe(o,l,a,1,u,i,t,e,et,Ue,null,ze),U())},i(u){if(!s){for(let l=0;l<i.length;l+=1)p(o[l]);s=!0}},o(u){for(let l=0;l<o.length;l+=1)k(o[l]);s=!1},d(u){u&&m(e);for(let l=0;l<o.length;l+=1)o[l].d();c=!1,d()}}}function Ne(r){let e,o,t,n;const s=[vt,Dt],c=[];function d(i,a){return i[11].audioDownloadURL?0:1}return e=d(r),o=c[e]=s[e](r),{c(){o.c(),t=F()},l(i){o.l(i),t=F()},m(i,a){c[e].m(i,a),w(i,t,a),n=!0},p(i,a){let u=e;e=d(i),e===u?c[e].p(i,a):(N(),k(c[u],1,1,()=>{c[u]=null}),U(),o=c[e],o?o.p(i,a):(o=c[e]=s[e](i),o.c()),p(o,1),o.m(t.parentNode,t))},i(i){n||(p(o),n=!0)},o(i){k(o),n=!1},d(i){c[e].d(i),i&&m(t)}}}function Dt(r){let e,o,t,n,s,c,d;const i=[St,At],a=[];function u(l,f){return l[15]?1:0}return o=u(r),t=a[o]=i[o](r),{c(){e=Y("div"),t.c()},l(l){e=H(l,"DIV",{});var f=C(e);t.l(f),f.forEach(m)},m(l,f){w(l,e,f),a[o].m(e,null),s=!0,c||(d=Z(n=Ce.call(null,e,r[13])),c=!0)},p(l,f){let g=o;o=u(l),o===g?a[o].p(l,f):(N(),k(a[g],1,1,()=>{a[g]=null}),U(),t=a[o],t?t.p(l,f):(t=a[o]=i[o](l),t.c()),p(t,1),t.m(e,null)),n&&ee(n.update)&&f&8192&&n.update.call(null,l[13])},i(l){s||(p(t),s=!0)},o(l){k(t),s=!1},d(l){l&&m(e),a[o].d(),c=!1,d()}}}function vt(r){let e,o,t,n,s,c,d;const i=[Pt,It],a=[];function u(l,f){return l[15]?1:0}return o=u(r),t=a[o]=i[o](r),{c(){e=Y("div"),t.c()},l(l){e=H(l,"DIV",{});var f=C(e);t.l(f),f.forEach(m)},m(l,f){w(l,e,f),a[o].m(e,null),s=!0,c||(d=Z(n=Ce.call(null,e,r[12])),c=!0)},p(l,f){let g=o;o=u(l),o===g?a[o].p(l,f):(N(),k(a[g],1,1,()=>{a[g]=null}),U(),t=a[o],t?t.p(l,f):(t=a[o]=i[o](l),t.c()),p(t,1),t.m(e,null)),n&&ee(n.update)&&f&4096&&n.update.call(null,l[12])},i(l){s||(p(t),s=!0)},o(l){k(t),s=!1},d(l){l&&m(e),a[o].d(),c=!1,d()}}}function At(r){let e,o;function t(...n){return r[4](r[16],...n)}return e=new ge({props:{strokesArray:r[15],$$slots:{default:[Et]},$$scope:{ctx:r}}}),e.$on("stroke-drawn",t),{c(){P(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,s){R(e,n,s),o=!0},p(n,s){r=n;const c={};s&32768&&(c.strokesArray=r[15]),s&393216&&(c.$$scope={dirty:s,ctx:r}),e.$set(c)},i(n){o||(p(e.$$.fragment,n),o=!0)},o(n){k(e.$$.fragment,n),o=!1},d(n){W(e,n)}}}function St(r){let e,o;return e=new ge({props:{strokesArray:[]}}),{c(){P(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p:ne,i(t){o||(p(e.$$.fragment,t),o=!0)},o(t){k(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Ct(r){let e;return{c(){e=Te("Wipe board")},l(o){e=De(o,"Wipe board")},m(o,t){w(o,e,t)},d(o){o&&m(e)}}}function Et(r){let e,o;return e=new ue({props:{$$slots:{default:[Ct]},$$scope:{ctx:r}}}),e.$on("click",function(){ee(r[17])&&r[17].apply(this,arguments)}),{c(){P(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){r=t;const s={};n&262144&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(t){o||(p(e.$$.fragment,t),o=!0)},o(t){k(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function It(r){let e,o;return e=new Tt({props:{strokesArray:r[15],audioDownloadURL:r[11].audioDownloadURL}}),{c(){P(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p(t,n){const s={};n&32768&&(s.strokesArray=t[15]),n&2048&&(s.audioDownloadURL=t[11].audioDownloadURL),e.$set(s)},i(t){o||(p(e.$$.fragment,t),o=!0)},o(t){k(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Pt(r){let e,o;return e=new ge({props:{strokesArray:[]}}),{c(){P(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){R(e,t,n),o=!0},p:ne,i(t){o||(p(e.$$.fragment,t),o=!0)},o(t){k(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Lt(r){let e,o,t=r[11]&&Ne(r);return{c(){t&&t.c(),e=j()},l(n){t&&t.l(n),e=X(n)},m(n,s){t&&t.m(n,s),w(n,e,s),o=!0},p(n,s){n[11]?t?(t.p(n,s),s&2048&&p(t,1)):(t=Ne(n),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(N(),k(t,1,1,()=>{t=null}),U())},i(n){o||(p(t),o=!0)},o(n){k(t),o=!1},d(n){t&&t.d(n),n&&m(e)}}}function Ue(r,e){let o,t,n;return t=new it({props:{dbPath:e[1]+e[8],$$slots:{default:[Lt,({boardDoc:s,fetchStrokes:c,listenToStrokes:d,isFetchingStrokes:i,strokesArray:a,handleNewlyDrawnStroke:u,deleteAllStrokesFromDb:l})=>({11:s,12:c,13:d,14:i,15:a,16:u,17:l}),({boardDoc:s,fetchStrokes:c,listenToStrokes:d,isFetchingStrokes:i,strokesArray:a,handleNewlyDrawnStroke:u,deleteAllStrokesFromDb:l})=>(s?2048:0)|(c?4096:0)|(d?8192:0)|(i?16384:0)|(a?32768:0)|(u?65536:0)|(l?131072:0)]},$$scope:{ctx:e}}}),{key:r,first:null,c(){o=F(),P(t.$$.fragment),this.h()},l(s){o=F(),L(t.$$.fragment,s),this.h()},h(){this.first=o},m(s,c){w(s,o,c),R(t,s,c),n=!0},p(s,c){e=s;const d={};c&1&&(d.dbPath=e[1]+e[8]),c&440320&&(d.$$scope={dirty:c,ctx:e}),t.$set(d)},i(s){n||(p(t.$$.fragment,s),n=!0)},o(s){k(t.$$.fragment,s),n=!1},d(s){s&&m(o),W(t,s)}}}function Rt(r){let e,o,t=r[0]&&Fe(r);return{c(){t&&t.c(),e=F()},l(n){t&&t.l(n),e=F()},m(n,s){t&&t.m(n,s),w(n,e,s),o=!0},p(n,[s]){n[0]?t?(t.p(n,s),s&1&&p(t,1)):(t=Fe(n),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(N(),k(t,1,1,()=>{t=null}),U())},i(n){o||(p(t),o=!0)},o(n){k(t),o=!1},d(n){t&&t.d(n),n&&m(e)}}}function Xt({page:r}){return console.log("load function from [room].svelte"),{props:{classID:r.params.class,roomID:r.params.room}}}function Wt(r,e,o){let t;fe(r,Se,l=>o(5,t=l));let{classID:n}=e,{roomID:s}=e,c;const d=`classes/${n}/blackboards/`,i=`classes/${n}/rooms/`;t.uid||(console.log("redirecting to tutorial"),nt("/")),de(async()=>{o(0,c=await me(i+s))});async function a(){o(0,c=await me(i+s))}const u=(l,f)=>l(f.detail.newStroke);return r.$$set=l=>{"classID"in l&&o(2,n=l.classID),"roomID"in l&&o(3,s=l.roomID)},r.$$.update=()=>{r.$$.dirty&8&&a()},[c,d,n,s,u]}class Ot extends q{constructor(e){super();J(this,e,Wt,Rt,G,{classID:2,roomID:3})}}export{Ot as default,Xt as load};
