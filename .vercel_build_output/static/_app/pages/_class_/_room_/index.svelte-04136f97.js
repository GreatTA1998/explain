var Mt=Object.defineProperty;var Ze=Object.getOwnPropertySymbols;var Vt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var xe=(r,e,o)=>e in r?Mt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,Ue=(r,e)=>{for(var o in e||(e={}))Vt.call(e,o)&&xe(r,o,e[o]);if(Ze)for(var o of Ze(e))jt.call(e,o)&&xe(r,o,e[o]);return r};import{S as ge,i as be,s as ke,ax as Ft,k as Q,e as C,n as H,c as B,b as D,M as d,W as Wt,aw as ue,f as R,a1 as J,aB as we,t as z,a as N,aC as $e,d as p,g as M,N as S,ag as Ot,I as ve,ab as qt,j,m as F,o as W,ay as Qt,az as Ht,h as fe,J as ye,K as De,L as Re,x as I,u as P,v as O,a2 as Ne,F as G,a3 as Ee,ae as Xt,r as de,w as pe,aD as He,A as et,aE as Ce,O as me,a5 as tt,Q as X,a6 as ot,a7 as Gt,X as nt,a4 as rt,aF as Yt,T as st,P as Z,aG as Kt,a9 as lt,au as Jt,av as Zt,l as x,aH as xt,aI as eo,_ as ee,aJ as Xe,aK as Ge,aL as at,aM as it,aN as Ie,aO as to,aP as oo,aQ as no,a8 as ro,aR as so,af as lo,aA as Be,ai as ut,Y as ao,aS as io}from"../../../chunks/vendor-577628cf.js";import{R as uo,a as co,D as fo}from"../../../chunks/RenderlessFetchStrokes-1c2db2ae.js";import{_ as po}from"../../../chunks/preload-helper-ec9aa979.js";import{o as Ye,u as ct,j as ze,a as ft,c as Ke,d as Me,f as mo,e as ho,g as _o,k as Ve,b as go}from"../../../chunks/navigation-a5eee486.js";/* empty css                                                                */import{d as je,r as bo,a as ko}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const wo=r=>({}),dt=r=>({});function pt(r,e,o){const t=r.slice();return t[11]=e[o],t}function mt(r){let e,o,t,n,s,l=r[2].pencilColors,i=[];for(let u=0;u<l.length;u+=1)i[u]=ht(pt(r,l,u));return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=Q(),o=C("img"),this.h()},l(u){for(let a=0;a<i.length;a+=1)i[a].l(u);e=H(u),o=B(u,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){D(o,"width","46"),D(o,"height","33"),d(o,"margin-left","8px"),Wt(o.src,t="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||D(o,"src",t),D(o,"alt","eraser"),D(o,"class","svelte-1bgxyxs"),ue(o,"eraser-selected",r[3].type==="eraser")},m(u,a){for(let c=0;c<i.length;c+=1)i[c].m(u,a);R(u,e,a),R(u,o,a),n||(s=J(o,"click",r[7]),n=!0)},p(u,a){if(a&12){l=u[2].pencilColors;let c;for(c=0;c<l.length;c+=1){const f=pt(u,l,c);i[c]?i[c].p(f,a):(i[c]=ht(f),i[c].c(),i[c].m(e.parentNode,e))}for(;c<i.length;c+=1)i[c].d(1);i.length=l.length}a&8&&ue(o,"eraser-selected",u[3].type==="eraser")},d(u){Ot(i,u),u&&p(e),u&&p(o),n=!1,s()}}}function ht(r){let e,o,t,n,s,l,i,u,a,c,f,k;function b(){return r[6](r[11])}return{c(){e=C("div"),o=we("svg"),t=we("g"),n=we("path"),s=z(`;\r
            `),l=we("polygon"),u=we("path"),a=we("path"),this.h()},l(h){e=B(h,"DIV",{style:!0,class:!0});var m=N(e);o=$e(m,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var T=N(o);t=$e(T,"g",{});var g=N(t);n=$e(g,"path",{d:!0}),N(n).forEach(p),s=M(g,`;\r
            `),l=$e(g,"polygon",{style:!0,points:!0}),N(l).forEach(p),u=$e(g,"path",{style:!0,d:!0}),N(u).forEach(p),a=$e(g,"path",{style:!0,d:!0}),N(a).forEach(p),g.forEach(p),T.forEach(p),m.forEach(p),this.h()},h(){D(n,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),D(l,"style",i=`fill: ${r[11]};`),D(l,"points","50,211.978 38.879,175.24 61.122,175.24"),d(u,"fill","#424242"),D(u,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),D(a,"style",c=`fill: ${r[11]};`),D(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),D(o,"preserveAspectRatio","none"),D(o,"version","1.1"),D(o,"id","Layer_1"),D(o,"xmlns","http://www.w3.org/2000/svg"),D(o,"xmlns:xlink","http://www.w3.org/1999/xlink"),D(o,"x","0px"),D(o,"y","0px"),D(o,"width","16px"),D(o,"height","30px"),D(o,"viewBox","0 0 100 230"),d(o,"enable-background","new 0 0 100 230"),D(o,"xml:space","preserve"),D(o,"class","svelte-1bgxyxs"),d(e,"margin","0 4px"),d(e,"width","30px"),d(e,"height","42px"),d(e,"border-radius","3px"),d(e,"align-items","center"),d(e,"display","flex"),d(e,"justify-content","center"),D(e,"class","svelte-1bgxyxs"),ue(e,"pencil-selected",r[3].color===r[11])},m(h,m){R(h,e,m),S(e,o),S(o,t),S(t,n),S(t,s),S(t,l),S(t,u),S(t,a),f||(k=J(e,"click",b),f=!0)},p(h,m){r=h,m&4&&i!==(i=`fill: ${r[11]};`)&&D(l,"style",i),m&4&&c!==(c=`fill: ${r[11]};`)&&D(a,"style",c),m&12&&ue(e,"pencil-selected",r[3].color===r[11])},d(h){h&&p(e),f=!1,k()}}}function $o(r){let e;const o=r[5]["dropdown-menu"],t=ve(o,r,r[10],dt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&1024)&&ye(t,o,n,n[10],e?Re(o,n[10],s,wo):De(n[10]),dt)},i(n){e||(I(t,n),e=!0)},o(n){P(t,n),e=!1},d(n){t&&t.d(n)}}}function vo(r){let e,o;return e=new Xt({props:{$$slots:{default:[$o]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n&1024&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(I(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){O(e,t)}}}function yo(r){let e,o,t,n,s,l=(r[1]?"No touch":"Touch draw")+"",i,u,a=Object.keys(r[2]).length>0,c,f,k,b,h,m,T,g,$;t=new Ft({props:{icons:!1,checked:!r[1],style:"margin: 0 !important"}});let y=a&&mt(r);const q=r[5].default,U=ve(q,r,r[10],null);let le={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[vo]},$$scope:{ctx:r}};return m=new qt({props:le}),r[9](m),{c(){e=C("div"),o=C("div"),j(t.$$.fragment),n=Q(),s=C("div"),i=z(l),u=Q(),y&&y.c(),c=Q(),U&&U.c(),f=Q(),k=C("span"),b=z("more_horiz"),h=Q(),j(m.$$.fragment),this.h()},l(L){e=B(L,"DIV",{style:!0});var A=N(e);o=B(A,"DIV",{style:!0});var te=N(o);F(t.$$.fragment,te),n=H(te),s=B(te,"DIV",{style:!0});var ne=N(s);i=M(ne,l),ne.forEach(p),te.forEach(p),u=H(A),y&&y.l(A),c=H(A),U&&U.l(A),f=H(A),k=B(A,"SPAN",{class:!0,style:!0});var he=N(k);b=M(he,"more_horiz"),he.forEach(p),h=H(A),F(m.$$.fragment,A),A.forEach(p),this.h()},h(){d(s,"margin-top","2px"),d(s,"font-size","0.55rem"),d(s,"font-family","Roboto,sans-serif"),d(s,"color","white"),d(o,"margin-right","10px"),d(o,"text-align","center"),D(k,"class","material-icons"),d(k,"margin-right","10px"),d(k,"color","white"),d(k,"font-size","2rem"),d(e,"position","absolute"),d(e,"display","flex"),d(e,"align-items","center"),d(e,"height","50px"),d(e,"left","0"),d(e,"right","auto"),d(e,"top","0"),d(e,"bottom","auto"),d(e,"z-index","100"),d(e,"background-color","grey"),d(e,"padding-left","10px"),d(e,"border-radius","2px")},m(L,A){R(L,e,A),S(e,o),W(t,o,null),S(o,n),S(o,s),S(s,i),S(e,u),y&&y.m(e,null),S(e,c),U&&U.m(e,null),S(e,f),S(e,k),S(k,b),S(e,h),W(m,e,null),T=!0,g||($=[J(o,"click",Qt(Ht(r[4]))),J(k,"click",r[8])],g=!0)},p(L,[A]){const te={};A&2&&(te.checked=!L[1]),t.$set(te),(!T||A&2)&&l!==(l=(L[1]?"No touch":"Touch draw")+"")&&fe(i,l),A&4&&(a=Object.keys(L[2]).length>0),a?y?y.p(L,A):(y=mt(L),y.c(),y.m(e,c)):y&&(y.d(1),y=null),U&&U.p&&(!T||A&1024)&&ye(U,q,L,L[10],T?Re(q,L[10],A,null):De(L[10]),null);const ne={};A&1024&&(ne.$$scope={dirty:A,ctx:L}),m.$set(ne)},i(L){T||(I(t.$$.fragment,L),I(U,L),I(m.$$.fragment,L),T=!0)},o(L){P(t.$$.fragment,L),P(U,L),P(m.$$.fragment,L),T=!1},d(L){L&&p(e),O(t),y&&y.d(),U&&U.d(L),r[9](null),O(m),g=!1,Ne($)}}}function Do(r,e,o){let t,n,s;G(r,Ye,h=>o(1,t=h)),G(r,ct,h=>o(2,n=h)),G(r,ze,h=>o(3,s=h));let{$$slots:l={},$$scope:i}=e,u;function a(){Ye.set(!t)}const c=h=>ze.set({type:"pencil",color:h,lineWidth:3}),f=()=>ze.set({type:"eraser",color:"",lineWidth:40}),k=()=>u.setOpen(!0);function b(h){Ee[h?"unshift":"push"](()=>{u=h,o(0,u)})}return r.$$set=h=>{"$$scope"in h&&o(10,i=h.$$scope)},[u,t,n,s,a,l,c,f,k,b,i]}class Ro extends ge{constructor(e){super();be(this,e,Do,yo,ke,{})}}const Io=r=>({}),_t=r=>({slot:"dropdown-menu"});function gt(r){let e,o;return e=new Ro({props:{$$slots:{"dropdown-menu":[Po],default:[To]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n&131072&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(I(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){O(e,t)}}}function To(r){let e;const o=r[14].default,t=ve(o,r,r[17],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&131072)&&ye(t,o,n,n[17],e?Re(o,n[17],s,null):De(n[17]),null)},i(n){e||(I(t,n),e=!0)},o(n){P(t,n),e=!1},d(n){t&&t.d(n)}}}function Po(r){let e;const o=r[14]["dropdown-menu"],t=ve(o,r,r[17],_t);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&131072)&&ye(t,o,n,n[17],e?Re(o,n[17],s,Io):De(n[17]),_t)},i(n){e||(I(t,n),e=!0)},o(n){P(t,n),e=!1},d(n){t&&t.d(n)}}}function Lo(r){let e,o,t,n,s,l,i,u,a,c=r[0]&&gt(r);return{c(){c&&c.c(),e=Q(),o=C("canvas"),n=Q(),s=C("canvas"),this.h()},l(f){c&&c.l(f),e=H(f),o=B(f,"CANVAS",{style:!0});var k=N(o);k.forEach(p),n=H(f),s=B(f,"CANVAS",{style:!0});var b=N(s);b.forEach(p),this.h()},h(){D(o,"style",t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[4]}px; height: ${r[3]}px`),D(s,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[4]}px; height: ${r[3]}px`)},m(f,k){c&&c.m(f,k),R(f,e,k),R(f,o,k),r[15](o),R(f,n,k),R(f,s,k),r[16](s),i=!0,u||(a=[J(o,"touchstart",r[5]),J(o,"touchmove",r[6]),J(o,"touchend",r[7])],u=!0)},p(f,[k]){f[0]?c?(c.p(f,k),k&1&&I(c,1)):(c=gt(f),c.c(),I(c,1),c.m(e.parentNode,e)):c&&(de(),P(c,1,1,()=>{c=null}),pe()),(!i||k&24&&t!==(t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${f[4]}px; height: ${f[3]}px`))&&D(o,"style",t),(!i||k&24&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${f[4]}px; height: ${f[3]}px`))&&D(s,"style",l)},i(f){i||(I(c),i=!0)},o(f){P(c),i=!1},d(f){c&&c.d(f),f&&p(e),f&&p(o),r[15](null),f&&p(n),f&&p(s),r[16](null),u=!1,Ne(a)}}}function So(r){return(r.endTime-r.startTime)/r.points.length}function Ao(r,e,o){let t,n,s,l;G(r,ft,_=>o(3,t=_)),G(r,Ke,_=>o(4,n=_)),G(r,ze,_=>o(21,s=_)),G(r,Ye,_=>o(22,l=_));let{$$slots:i={},$$scope:u}=e,{strokesArray:a}=e,{currentTime:c=0}=e,{backgroundImageDownloadURL:f=""}=e;const k=He();let b,h,m,T,g=[],$=!1,y={x:-1,y:-1},q={points:[]},U;et(()=>{o(10,b=m.getContext("2d")),o(11,h=T.getContext("2d"))});function le(_){if(_.touches.length>1)return;const E=_.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ne(_,{isInitialContact:!0})}function L(_){if(!$)return;if(_.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const E=_.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ne(_,{isInitialContact:!1})}function A(_){if(!$||_.touches.length>0)return;const E=_.changedTouches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}Te(q),$=!1}function te(_){$=!0,y={x:-1,y:-1},q={strokeNumber:a.length+1,startTime:Number(c.toFixed(1)),color:s.color,lineWidth:s.lineWidth,isErasing:s.type==="eraser",points:[],sessionID:"123"}}function ne(_,{isInitialContact:E}){_.preventDefault(),E&&te();const Y=Fe(_);he(_,Y)}function he(_,E){q.points.push({unitX:parseFloat(E.x/m.width).toFixed(4),unitY:parseFloat(E.y/m.height).toFixed(4)}),y.x!==-1&&y.y!==-1&&ko([Pe(y),Pe(E)],1,s.type==="eraser",b,s.color,s.lineWidth,m),y=E}function Te(_){_.endTime=Number(c.toFixed(1)),_.id=Me(),g.push(_),k("stroke-drawn",{newStroke:_})}function Fe(_){const{left:E,top:Y}=m.getBoundingClientRect();return{x:_.touches[0].pageX-E-window.scrollX,y:_.touches[0].pageY-Y-window.scrollY}}function Pe({x:_,y:E}){return{unitX:_/m.width,unitY:E/m.height}}function Le(){b.clearRect(0,0,n,t)}function Se(_){Ee[_?"unshift":"push"](()=>{m=_,o(1,m),o(10,b),o(4,n),o(3,t),o(0,a)})}function Ae(_){Ee[_?"unshift":"push"](()=>{T=_,o(2,T),o(10,b),o(4,n),o(3,t),o(0,a),o(1,m)})}return r.$$set=_=>{"strokesArray"in _&&o(0,a=_.strokesArray),"currentTime"in _&&o(8,c=_.currentTime),"backgroundImageDownloadURL"in _&&o(9,f=_.backgroundImageDownloadURL),"$$scope"in _&&o(17,u=_.$$scope)},r.$$.update=()=>{if(r.$$.dirty&1051&&b&&(o(1,m.width=n,m),o(1,m.height=t,m),o(2,T.width=n,T),o(2,T.height=t,T),a))for(const _ of a)je(_,null,b,m);if(r.$$.dirty&2566&&h&&(h.clearRect(0,0,T.scrollWidth,T.scrollHeight),bo(f,m,h)),r.$$.dirty&13315&&b&&a){let _=g.length,E=a.length;if(_!==E)if(_<E)if(_===0){for(const Y of a)je(Y,null,b,m);o(12,g=[...a])}else for(let Y=_;Y<E;Y++){const ae=a[Y];je(ae,ae.startTime!==ae.endTime?So(ae):null,b,m),g.push(ae)}else{let Y=function(){Le(),o(12,g=[]),y={x:-1,y:-1};for(const We of a)je(We,null,b,m)};(function(){console.log("debounced board reset"),U&&clearTimeout(U),o(13,U=setTimeout(Y,1e3))})()}}},[a,m,T,t,n,le,L,A,c,f,b,h,g,U,i,Se,Ae,u]}class Uo extends ge{constructor(e){super();be(this,e,Ao,Lo,ke,{strokesArray:0,currentTime:8,backgroundImageDownloadURL:9})}}const No=r=>({currentTime:r&1}),bt=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function Eo(r){let e;const o=r[4].default,t=ve(o,r,r[3],bt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,[s]){t&&t.p&&(!e||s&9)&&ye(t,o,n,n[3],e?Re(o,n[3],s,No):De(n[3]),bt)},i(n){e||(I(t,n),e=!0)},o(n){P(t,n),e=!1},d(n){t&&t.d(n)}}}function Co(r,e,o){let t,n;G(r,mo,h=>o(8,t=h)),G(r,ho,h=>o(9,n=h));let{$$slots:s={},$$scope:l}=e,i,u=0,a;et(async()=>{window&&(i=await po(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=i.default)});const c=He();let f=null;function k(){return new Promise(async(h,m)=>{if(!n.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),m("Cannot start recording because mic stream is muted");return}const T=t.clone();f=new MediaRecorder(T),f.start(),a=setInterval(()=>o(0,u+=.1),100),c("record-start"),h()})}function b(){return new Promise((h,m)=>{clearTimeout(a),f.addEventListener("dataavailable",T=>{const g=T.data;c("record-end",{audioBlob:g}),h()}),f.stop();for(const T of f.stream.getTracks())T.stop()})}return r.$$set=h=>{"$$scope"in h&&o(3,l=h.$$scope)},[u,k,b,l,s]}class Bo extends ge{constructor(e){super();be(this,e,Co,Eo,ke,{})}}function zo(r,e){let o=document.getElementById(e);return o==null||o.appendChild(r),{destroy(){r.remove()}}}function kt(r,e){let o=new IntersectionObserver(t=>{for(const n of t)if(n.isIntersecting){e(),o.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});o.observe(r)}function Mo(r){let e,o,t,n;return{c(){e=C("div"),o=C("textarea"),this.h()},l(s){e=B(s,"DIV",{class:!0,style:!0});var l=N(e);o=B(l,"TEXTAREA",{style:!0,class:!0}),N(o).forEach(p),l.forEach(p),this.h()},h(){o.value=r[0],d(o,"box-sizing","border-box"),d(o,"width",r[2]+"px"),d(o,"padding","6px"),d(o,"border-radius","2px"),d(o,"font-family","Roboto, sans-serif"),d(o,"color","rgb(60 55 56 / 87%)"),D(o,"class","svelte-tv3wak"),D(e,"class","grow-wrap svelte-tv3wak"),d(e,"font-family","Roboto, sans-serif"),d(e,"margin","10px 0px")},m(s,l){R(s,e,l),S(e,o),r[6](e),t||(n=[J(o,"input",r[5]),Ce(r[4].call(null,e))],t=!0)},p(s,[l]){l&1&&(o.value=s[0]),l&4&&d(o,"width",s[2]+"px")},i:me,o:me,d(s){s&&p(e),r[6](null),t=!1,Ne(n)}}}function Vo(r,e,o){let t;G(r,Ke,c=>o(2,t=c));let{value:n}=e,s;const l=He();function i(c){c.dataset.replicatedValue=n}const u=c=>{o(1,s.dataset.replicatedValue=c.target.value,s),l("input",c.target.value)};function a(c){Ee[c?"unshift":"push"](()=>{s=c,o(1,s)})}return r.$$set=c=>{"value"in c&&o(0,n=c.value)},[n,s,t,l,i,u,a]}class jo extends ge{constructor(e){super();be(this,e,Vo,Mo,ke,{value:0})}}const Fo=r=>({strokesArray:r&1}),wt=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function Wo(r){let e;const o=r[6].default,t=ve(o,r,r[5],wt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,[s]){t&&t.p&&(!e||s&33)&&ye(t,o,n,n[5],e?Re(o,n[5],s,Fo):De(n[5]),wt)},i(n){e||(I(t,n),e=!0)},o(n){P(t,n),e=!1},d(n){t&&t.d(n)}}}function $t(r){const e=Ue({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function Oo(r,e,o){let{$$slots:t={},$$scope:n}=e,{dbPath:s}=e,l,i;const u=tt(X(),`${s}/strokes`),a=ot(u,Gt("timestamp"));nt(()=>{i&&i()});async function c(){i=rt(a,async b=>{b.docChanges().filter(m=>m.type==="removed").length>0?(o(0,l=[]),await Yt(),b.docs.length>0&&b.docs.forEach(m=>{l.push($t(m))})):(l||o(0,l=[]),b.docs.length===l.length||b.docChanges().filter(m=>m.type==="added").forEach(m=>{o(0,l=[...l,$t(m.doc)])}))})}function f(b){l.push(b);try{st(Z(X(),`${s}/strokes/${b.id}`),Ue({timestamp:Kt()},b))}catch(h){alert(h)}}async function k(){return new Promise(async b=>{const h=[];let m=lt(X()),T=0;for(const g of l){T>=500&&(h.push(m.commit()),m=lt(X()),T=0);const $=Z(X(),`${s}/strokes/${g.id}`);m.delete($),T+=1}h.push(m.commit()),await Promise.all(h),o(0,l=[]),b()})}return r.$$set=b=>{"dbPath"in b&&o(4,s=b.dbPath),"$$scope"in b&&o(5,n=b.$$scope)},[l,c,f,k,s,n,t]}class qo extends ge{constructor(e){super();be(this,e,Oo,Wo,ke,{dbPath:4})}}function vt(r,e,o){const t=r.slice();return t[40]=e[o],t}function yt(r){let e,o,t,n,s,l=[],i=new Map,u,a,c,f,k,b,h;o=new xt({props:{disabled:se(r[0].name)&&r[0].askerUID&&r[6].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[8]}px;`,$$slots:{helper:[Yo]},$$scope:{ctx:r}}}),o.$on("input",r[22]);let m=r[0].blackboards;const T=g=>g[40];for(let g=0;g<m.length;g+=1){let $=vt(r,m,g),y=T($);i.set(y,l[g]=Tt(y,$))}return{c(){e=C("div"),j(o.$$.fragment),t=Q(),n=C("div"),s=Q();for(let g=0;g<l.length;g+=1)l[g].c();u=Q(),a=C("div"),c=z("New blackboard"),this.h()},l(g){e=B(g,"DIV",{style:!0});var $=N(e);F(o.$$.fragment,$),t=H($),n=B($,"DIV",{style:!0}),N(n).forEach(p),s=H($);for(let q=0;q<l.length;q+=1)l[q].l($);u=H($),a=B($,"DIV",{style:!0});var y=N(a);c=M(y,"New blackboard"),y.forEach(p),$.forEach(p),this.h()},h(){d(n,"margin-bottom","20px"),d(a,"display","flex"),d(a,"justify-content","center"),d(a,"align-items","center"),d(a,"margin-top","40px"),d(a,"background-color","#2e3131"),d(a,"font-family","Roboto, sans-serif"),d(a,"text-transform","uppercase"),d(a,"color","white"),d(a,"height","35px"),d(a,"width",r[8]+"px"),d(e,"padding","16px"),ue(e,"question",se(r[0].name))},m(g,$){R(g,e,$),W(o,e,null),S(e,t),S(e,n),S(e,s);for(let y=0;y<l.length;y+=1)l[y].m(e,null);S(e,u),S(e,a),S(a,c),k=!0,b||(h=[J(a,"click",r[18]),Ce(f=zo.call(null,e,"main-content"))],b=!0)},p(g,$){const y={};$[0]&65&&(y.disabled=se(g[0].name)&&g[0].askerUID&&g[6].uid!==g[0].askerUID),$[0]&1&&(y.value=g[0].name),$[0]&256&&(y.style=`width: ${g[8]}px;`),$[0]&31|$[1]&2097152&&(y.$$scope={dirty:$,ctx:g}),o.$set(y),$[0]&245729|$[1]&1175552&&(m=g[0].blackboards,de(),l=Jt(l,$,T,1,g,m,i,e,Zt,Tt,u,vt),pe()),(!k||$[0]&256)&&d(a,"width",g[8]+"px"),$[0]&1&&ue(e,"question",se(g[0].name))},i(g){if(!k){I(o.$$.fragment,g);for(let $=0;$<m.length;$+=1)I(l[$]);k=!0}},o(g){P(o.$$.fragment,g);for(let $=0;$<l.length;$+=1)P(l[$]);k=!1},d(g){g&&p(e),O(o);for(let $=0;$<l.length;$+=1)l[$].d();b=!1,Ne(h)}}}function Qo(r){let e=r[0].askerName+"",o,t,n=Ve(r[0].dateAsked)+"",s;return{c(){o=z(e),t=z(" asked on "),s=z(n)},l(l){o=M(l,e),t=M(l," asked on "),s=M(l,n)},m(l,i){R(l,o,i),R(l,t,i),R(l,s,i)},p(l,i){i[0]&1&&e!==(e=l[0].askerName+"")&&fe(o,e),i[0]&1&&n!==(n=Ve(l[0].dateAsked)+"")&&fe(s,n)},d(l){l&&p(o),l&&p(t),l&&p(s)}}}function Ho(r){let e,o,t;return{c(){e=z("Resolving this question in "),o=z(r[4]),t=z(", cancel by re-adding ?")},l(n){e=M(n,"Resolving this question in "),o=M(n,r[4]),t=M(n,", cancel by re-adding ?")},m(n,s){R(n,e,s),R(n,o,s),R(n,t,s)},p(n,s){s[0]&16&&fe(o,n[4])},d(n){n&&p(e),n&&p(o),n&&p(t)}}}function Xo(r){let e,o,t;return{c(){e=z("Pinging server members in "),o=z(r[2]),t=z(", cancel by backtracking the ?")},l(n){e=M(n,"Pinging server members in "),o=M(n,r[2]),t=M(n,", cancel by backtracking the ?")},m(n,s){R(n,e,s),R(n,o,s),R(n,t,s)},p(n,s){s[0]&4&&fe(o,n[2])},d(n){n&&p(e),n&&p(o),n&&p(t)}}}function Dt(r){let e,o=Ve(r[0].dateResolved)+"",t;return{c(){e=z(", resolved "),t=z(o)},l(n){e=M(n,", resolved "),t=M(n,o)},m(n,s){R(n,e,s),R(n,t,s)},p(n,s){s[0]&1&&o!==(o=Ve(n[0].dateResolved)+"")&&fe(t,o)},d(n){n&&p(e),n&&p(t)}}}function Go(r){let e,o;function t(i,u){if(i[1])return Xo;if(i[3])return Ho;if(i[0].askerName&&i[0].askerUID&&i[0].date)return Qo}let n=t(r),s=n&&n(r),l=r[0].dateResolved&&Dt(r);return{c(){s&&s.c(),e=Q(),l&&l.c(),o=x()},l(i){s&&s.l(i),e=H(i),l&&l.l(i),o=x()},m(i,u){s&&s.m(i,u),R(i,e,u),l&&l.m(i,u),R(i,o,u)},p(i,u){n===(n=t(i))&&s?s.p(i,u):(s&&s.d(1),s=n&&n(i),s&&(s.c(),s.m(e.parentNode,e))),i[0].dateResolved?l?l.p(i,u):(l=Dt(i),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null)},d(i){s&&s.d(i),i&&p(e),l&&l.d(i),i&&p(o)}}}function Yo(r){let e,o;return e=new eo({props:{slot:"helper",persistent:!0,$$slots:{default:[Go]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&31|n[1]&2097152&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(I(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){O(e,t)}}}function Rt(r){let e,o,t,n,s,l;function i(...f){return r[23](r[40],...f)}e=new jo({props:{value:r[43].description||""}}),e.$on("input",i);const u=[Jo,Ko],a=[];function c(f,k){return f[43].audioDownloadURL?0:1}return t=c(r),n=a[t]=u[t](r),{c(){j(e.$$.fragment),o=Q(),n.c(),s=x()},l(f){F(e.$$.fragment,f),o=H(f),n.l(f),s=x()},m(f,k){W(e,f,k),R(f,o,k),a[t].m(f,k),R(f,s,k),l=!0},p(f,k){r=f;const b={};k[1]&4096&&(b.value=r[43].description||""),e.$set(b);let h=t;t=c(r),t===h?a[t].p(r,k):(de(),P(a[h],1,1,()=>{a[h]=null}),pe(),n=a[t],n?n.p(r,k):(n=a[t]=u[t](r),n.c()),I(n,1),n.m(s.parentNode,s))},i(f){l||(I(e.$$.fragment,f),I(n),l=!0)},o(f){P(e.$$.fragment,f),P(n),l=!1},d(f){O(e,f),f&&p(o),a[t].d(f),f&&p(s)}}}function Ko(r){let e,o;return e=new qo({props:{dbPath:r[5]+r[40],$$slots:{default:[ln,({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>({47:t,45:n,48:s,46:l}),({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>[0,(t?65536:0)|(n?16384:0)|(s?131072:0)|(l?32768:0)]]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&33&&(s.dbPath=t[5]+t[40]),n[0]&897|n[1]&2215936&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(I(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){O(e,t)}}}function Jo(r){let e,o;return e=new co({props:{dbPath:r[5]+r[40],$$slots:{default:[cn,({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:s})=>({44:t,45:n,46:s}),({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:s})=>[0,(t?8192:0)|(n?16384:0)|(s?32768:0)]]},$$scope:{ctx:r}}}),{c(){j(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&33&&(s.dbPath=t[5]+t[40]),n[0]&832|n[1]&2125824&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(I(e.$$.fragment,t),o=!0)},o(t){P(e.$$.fragment,t),o=!1},d(t){O(e,t)}}}function Zo(r){let e,o,t;return o=new io({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=C("div"),j(o.$$.fragment),this.h()},l(n){e=B(n,"DIV",{style:!0});var s=N(e);F(o.$$.fragment,s),s.forEach(p),this.h()},h(){d(e,"display","flex"),d(e,"justify-content","center"),d(e,"margin-left","20px"),d(e,"margin-right","20px")},m(n,s){R(n,e,s),W(o,e,null),t=!0},p:me,i(n){t||(I(o.$$.fragment,n),t=!0)},o(n){P(o.$$.fragment,n),t=!1},d(n){n&&p(e),O(o)}}}function xo(r){let e,o,t,n;function s(){return r[27](r[50],r[40])}return{c(){e=C("span"),o=z("stop_circle"),this.h()},l(l){e=B(l,"SPAN",{class:!0,style:!0});var i=N(e);o=M(i,"stop_circle"),i.forEach(p),this.h()},h(){D(e,"class","material-icons svelte-53fhoc"),d(e,"font-size","2.5rem"),d(e,"color","cyan"),d(e,"margin-left","30px"),d(e,"margin-right","26px"),ue(e,"unclickable",r[7]!==r[43].recorderBrowserTabID)},m(l,i){R(l,e,i),S(e,o),t||(n=J(e,"click",s),t=!0)},p(l,i){r=l,i[0]&128|i[1]&4096&&ue(e,"unclickable",r[7]!==r[43].recorderBrowserTabID)},i:me,o:me,d(l){l&&p(e),t=!1,n()}}}function en(r){let e,o,t,n;function s(){return r[26](r[49],r[40])}return{c(){e=C("span"),o=z("radio_button_checked"),this.h()},l(l){e=B(l,"SPAN",{class:!0,style:!0});var i=N(e);o=M(i,"radio_button_checked"),i.forEach(p),this.h()},h(){D(e,"class","material-icons"),d(e,"font-size","2.5rem"),d(e,"color","cyan"),d(e,"margin-left","30px"),d(e,"margin-right","26px")},m(l,i){R(l,e,i),S(e,o),t||(n=J(e,"click",s),t=!0)},p(l,i){r=l},i:me,o:me,d(l){l&&p(e),t=!1,n()}}}function tn(r){let e,o,t,n;const s=[en,xo,Zo],l=[];function i(u,a){return!u[43].recordState||u[43].recordState==="pre_record"?0:u[43].recordState==="mid_record"?1:2}return e=i(r),o=l[e]=s[e](r),{c(){o.c(),t=x()},l(u){o.l(u),t=x()},m(u,a){l[e].m(u,a),R(u,t,a),n=!0},p(u,a){let c=e;e=i(u),e===c?l[e].p(u,a):(de(),P(l[c],1,1,()=>{l[c]=null}),pe(),o=l[e],o?o.p(u,a):(o=l[e]=s[e](u),o.c()),I(o,1),o.m(t.parentNode,t))},i(u){n||(I(o),n=!0)},o(u){P(o),n=!1},d(u){l[e].d(u),u&&p(t)}}}function on(r){let e;return{c(){e=z("Wipe board")},l(o){e=M(o,"Wipe board")},m(o,t){R(o,e,t)},d(o){o&&p(e)}}}function nn(r){let e=(r[43].backgroundImageDownloadURL?"Remove background":"Set background")+"",o,t,n,s,l,i;function u(...a){return r[25](r[43],...a)}return{c(){o=z(e),t=Q(),n=C("input"),this.h()},l(a){o=M(a,e),t=H(a),n=B(a,"INPUT",{id:!0,style:!0,type:!0,accept:!0}),this.h()},h(){D(n,"id",s="input-"+r[43].id),d(n,"display","none"),D(n,"type","file"),D(n,"accept","image/gif, image/jpeg, image/png")},m(a,c){R(a,o,c),R(a,t,c),R(a,n,c),l||(i=J(n,"change",u),l=!0)},p(a,c){r=a,c[1]&4096&&e!==(e=(r[43].backgroundImageDownloadURL?"Remove background":"Set background")+"")&&fe(o,e),c[1]&4096&&s!==(s="input-"+r[43].id)&&D(n,"id",s)},d(a){a&&p(o),a&&p(t),a&&p(n),l=!1,i()}}}function rn(r){let e,o,t,n,s;return o=new ut({props:{slot:"dropdown-menu",$$slots:{default:[on]},$$scope:{ctx:r}}}),o.$on("SMUI:action",function(){Be(r[46])&&r[46].apply(this,arguments)}),n=new ut({props:{$$slots:{default:[nn]},$$scope:{ctx:r}}}),n.$on("click",function(){Be(r[43].backgroundImageDownloadURL?r[13](r[43].id):Lt(r[43].id))&&(r[43].backgroundImageDownloadURL?r[13](r[43].id):Lt(r[43].id)).apply(this,arguments)}),{c(){e=C("div"),j(o.$$.fragment),t=Q(),j(n.$$.fragment),this.h()},l(l){e=B(l,"DIV",{slot:!0});var i=N(e);F(o.$$.fragment,i),t=H(i),F(n.$$.fragment,i),i.forEach(p),this.h()},h(){D(e,"slot","dropdown-menu")},m(l,i){R(l,e,i),W(o,e,null),S(e,t),W(n,e,null),s=!0},p(l,i){r=l;const u={};i[1]&2097152&&(u.$$scope={dirty:i,ctx:r}),o.$set(u);const a={};i[1]&2101248&&(a.$$scope={dirty:i,ctx:r}),n.$set(a)},i(l){s||(I(o.$$.fragment,l),I(n.$$.fragment,l),s=!0)},o(l){P(o.$$.fragment,l),P(n.$$.fragment,l),s=!1},d(l){l&&p(e),O(o),O(n)}}}function sn(r){let e,o;function t(...n){return r[28](r[48],...n)}return e=new Uo({props:{strokesArray:r[45],currentTime:r[51],backgroundImageDownloadURL:r[43].backgroundImageDownloadURL,$$slots:{"dropdown-menu":[rn],default:[tn]},$$scope:{ctx:r}}}),e.$on("stroke-drawn",t),{c(){j(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,s){W(e,n,s),o=!0},p(n,s){r=n;const l={};s[1]&16384&&(l.strokesArray=r[45]),s[1]&1048576&&(l.currentTime=r[51]),s[1]&4096&&(l.backgroundImageDownloadURL=r[43].backgroundImageDownloadURL),s[0]&129|s[1]&2134016&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(n){o||(I(e.$$.fragment,n),o=!0)},o(n){P(e.$$.fragment,n),o=!1},d(n){O(e,n)}}}function ln(r){let e,o,t,n,s,l,i;function u(...a){return r[29](r[45],r[40],...a)}return o=new Bo({props:{$$slots:{default:[sn,({startRecording:a,stopRecording:c,currentTime:f})=>({49:a,50:c,51:f}),({startRecording:a,stopRecording:c,currentTime:f})=>[0,(a?262144:0)|(c?524288:0)|(f?1048576:0)]]},$$scope:{ctx:r}}}),o.$on("record-end",u),{c(){e=C("div"),j(o.$$.fragment),this.h()},l(a){e=B(a,"DIV",{style:!0});var c=N(e);F(o.$$.fragment,c),c.forEach(p),this.h()},h(){D(e,"style",t=`width: ${r[8]}px; height: ${r[9]}px; position: relative`)},m(a,c){R(a,e,c),W(o,e,null),s=!0,l||(i=Ce(n=kt.call(null,e,r[47])),l=!0)},p(a,c){r=a;const f={};c[0]&129|c[1]&3198976&&(f.$$scope={dirty:c,ctx:r}),o.$set(f),(!s||c[0]&768&&t!==(t=`width: ${r[8]}px; height: ${r[9]}px; position: relative`))&&D(e,"style",t),n&&Be(n.update)&&c[1]&65536&&n.update.call(null,r[47])},i(a){s||(I(o.$$.fragment,a),s=!0)},o(a){P(o.$$.fragment,a),s=!1},d(a){a&&p(e),O(o),l=!1,i()}}}function It(r){let e,o;function t(){return r[24](r[43],r[46])}return e=new ao({props:{color:"primary",$$slots:{default:[an]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){j(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,s){W(e,n,s),o=!0},p(n,s){r=n;const l={};s[1]&2097152&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(n){o||(I(e.$$.fragment,n),o=!0)},o(n){P(e.$$.fragment,n),o=!1},d(n){O(e,n)}}}function an(r){let e;return{c(){e=z("Delete video")},l(o){e=M(o,"Delete video")},m(o,t){R(o,e,t)},d(o){o&&p(e)}}}function un(r){let e,o,t=r[6].uid===r[43].creatorUID&&It(r);return{c(){t&&t.c(),e=x()},l(n){t&&t.l(n),e=x()},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[6].uid===n[43].creatorUID?t?(t.p(n,s),s[0]&64|s[1]&4096&&I(t,1)):(t=It(n),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(de(),P(t,1,1,()=>{t=null}),pe())},i(n){o||(I(t),o=!0)},o(n){P(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}function cn(r){let e,o,t,n,s,l,i;return o=new fo({props:{strokesArray:r[45],audioDownloadURL:r[43].audioDownloadURL,backgroundImageDownloadURL:r[43].backgroundImageDownloadURL,$$slots:{default:[un]},$$scope:{ctx:r}}}),{c(){e=C("div"),j(o.$$.fragment),this.h()},l(u){e=B(u,"DIV",{style:!0});var a=N(e);F(o.$$.fragment,a),a.forEach(p),this.h()},h(){D(e,"style",t=`width: ${r[8]}px; height: ${r[9]+40}px; position: relative`)},m(u,a){R(u,e,a),W(o,e,null),s=!0,l||(i=Ce(n=kt.call(null,e,r[44])),l=!0)},p(u,a){const c={};a[1]&16384&&(c.strokesArray=u[45]),a[1]&4096&&(c.audioDownloadURL=u[43].audioDownloadURL),a[1]&4096&&(c.backgroundImageDownloadURL=u[43].backgroundImageDownloadURL),a[0]&64|a[1]&2101248&&(c.$$scope={dirty:a,ctx:u}),o.$set(c),(!s||a[0]&768&&t!==(t=`width: ${u[8]}px; height: ${u[9]+40}px; position: relative`))&&D(e,"style",t),n&&Be(n.update)&&a[1]&8192&&n.update.call(null,u[44])},i(u){s||(I(o.$$.fragment,u),s=!0)},o(u){P(o.$$.fragment,u),s=!1},d(u){u&&p(e),O(o),l=!1,i()}}}function fn(r){let e,o,t=r[43]&&Rt(r);return{c(){t&&t.c(),e=Q()},l(n){t&&t.l(n),e=H(n)},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[43]?t?(t.p(n,s),s[1]&4096&&I(t,1)):(t=Rt(n),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(de(),P(t,1,1,()=>{t=null}),pe())},i(n){o||(I(t),o=!0)},o(n){P(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}function Tt(r,e){let o,t,n;return t=new uo({props:{dbPath:e[5]+e[40],$$slots:{default:[fn,({boardDoc:s})=>({43:s}),({boardDoc:s})=>[0,s?4096:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){o=x(),j(t.$$.fragment),this.h()},l(s){o=x(),F(t.$$.fragment,s),this.h()},h(){this.first=o},m(s,l){R(s,o,l),W(t,s,l),n=!0},p(s,l){e=s;const i={};l[0]&33&&(i.dbPath=e[5]+e[40]),l[0]&993|l[1]&2101248&&(i.$$scope={dirty:l,ctx:e}),t.$set(i)},i(s){n||(I(t.$$.fragment,s),n=!0)},o(s){P(t.$$.fragment,s),n=!1},d(s){s&&p(o),O(t,s)}}}function dn(r){let e,o,t=r[0]&&yt(r);return{c(){t&&t.c(),e=x()},l(n){t&&t.l(n),e=x()},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[0]?t?(t.p(n,s),s[0]&1&&I(t,1)):(t=yt(n),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(de(),P(t,1,1,()=>{t=null}),pe())},i(n){o||(I(t),o=!0)},o(n){P(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}async function vn({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Pt(...r){for(const e of r)e()}function Lt(r){document.getElementById(`input-${r}`).click()}function se(r){return r?r.charAt(r.length-1)==="?":!1}function Je(r){return r.askerName&&r.dateAsked&&r.askerUID}function pn(r,e,o){let t,n,s,l,i,u,a;G(r,ct,w=>o(6,l=w)),G(r,go,w=>o(7,i=w)),G(r,Ke,w=>o(8,u=w)),G(r,ft,w=>o(9,a=w));let{classID:c}=e,{roomID:f}=e,k,b;l.uid||_o("/");async function h(){k&&k(),k=rt(s,w=>{o(0,b=Ue({id:w.id},w.data()))})}nt(()=>{k()});function m(w){const v=Z(X(),t+w);ee(v,{recorderBrowserTabID:i})}function T(w,v){const V=Z(X(),t+w);ee(V,{recordState:v})}async function g(w,v){const V=Z(X(),t+v),K=w.target.files[0];if(!!K)if(K.type.split("/")[0]==="image"){const ie=Xe(),re=Ge(ie,`images/${Me()}`);await at(re,K);const ce=await it(re);ee(V,{backgroundImageDownloadURL:ce})}else alert("Error: only images can be used")}function $(w){const v=Z(X(),t+w);ee(v,{backgroundImageDownloadURL:Ie()})}let y="",q=5,U,le=5;async function L({srcElement:w}){const{value:v}=w,V={name:v};!se(b.name)&&se(v)&&!Je(b)?A():y&&!se(v)?Te():!se(v)&&Je(b)?te():U&&se(v)&&Je(b)&&he(),await ee(s,V)}function A(){o(2,q=5),o(1,y=setInterval(()=>{o(2,q-=1),q===0&&(Fe(),Pe(),Te())},1e3))}function te(){o(4,le=5),o(3,U=setInterval(()=>{o(4,le-=1),le===0&&ne()},1e3))}function ne(){ee(s,{dateResolved:new Date().toISOString()})}function he(){clearTimeout(U),o(3,U="")}function Te(){clearTimeout(y),o(1,y="")}function Fe(){ee(s,{askerName:l.name||"Beaver #999",askerUID:l.uid,dateAsked:new Date().toISOString()})}async function Pe(){const w=[],v=to(),V=oo(v,"sendTextMessage"),K=tt(X(),"users"),ie=ot(K,no("willReceiveText","==",!0)),re=await ro(ie);if(re.docs)for(const ce of re.docs){console.log("phoneNumber =",ce.data().phoneNumber);try{ce.id!==l.uid&&w.push(V({content:`${l.name} asked on https://ihtfp.app: "${b.name||"Fake question here"}"`,toWho:ce.data().phoneNumber}))}catch(Oe){alert(Oe)}}await Promise.all(w),console.log("success, sent all texts.")}async function Le({detail:w},v){const V=Z(X(),t+v);await ee(V,{description:w})}async function Se(w,v,V){function K(oe){return oe.startTime!==0&&oe.endTime!==ie}const ie=.5,re=[],ce=v.length;for(let oe=0;oe<ce;oe++){if(!K(v[oe])){let _e=oe-1;for(;_e>=0;){if(K(v[_e])){v[oe].startTime=v[_e].endTime,v[oe].endTime=v[oe].startTime+ie,re.push(oe);break}_e-=1}}for(let _e of re){const Qe=v[_e],Bt=t+V,zt=Z(X(),`${Bt}/strokes/${Qe.id}`);ee(zt,{startTime:Qe.startTime,endTime:Qe.endTime})}}const Oe=Xe(),qe=Ge(Oe,`audio/${Me()}`);await at(qe,w);const Et=await it(qe),Ct=Z(X(),t+V);await ee(Ct,{creatorUID:l.uid,creatorPhoneNumber:l.phoneNumber,date:new Date().toISOString(),audioDownloadURL:Et,audioRefFullPath:qe.fullPath}),T(V,"pre_record")}async function Ae({id:w,audioRefFullPath:v},V){const K=[],ie=Z(X(),t+w);if(v){const re=Ge(Xe(),v);K.push(so(re))}K.push(ee(ie,{creator:Ie(),creatorPhoneNumber:Ie(),date:Ie(),audioDownloadURL:Ie(),audioRefFullPath:Ie()})),K.push(V()),await Promise.all(K)}async function _(){const w=Me(),v=Z(X(),t+w);await Promise.all([st(v,{}),ee(s,{blackboards:lo(w)})])}const E=w=>L(w),Y=(w,v)=>Le(v,w),ae=(w,v)=>Ae(w,v),We=(w,v)=>g(v,w.id),St=(w,v)=>Pt(w,()=>T(v,"mid_record"),()=>m(v)),At=(w,v)=>Pt(w,()=>T(v,"post_record")),Ut=(w,v)=>w(v.detail.newStroke),Nt=(w,v,V)=>Se(V.detail.audioBlob,w,v);return r.$$set=w=>{"classID"in w&&o(19,c=w.classID),"roomID"in w&&o(20,f=w.roomID)},r.$$.update=()=>{r.$$.dirty[0]&524288&&o(5,t=`classes/${c}/blackboards/`),r.$$.dirty[0]&524288&&o(21,n=`classes/${c}/rooms/`),r.$$.dirty[0]&3145728&&(s=Z(X(),n+f)),r.$$.dirty[0]&1048576&&h()},[b,y,q,U,le,t,l,i,u,a,m,T,g,$,L,Le,Se,Ae,_,c,f,n,E,Y,ae,We,St,At,Ut,Nt]}class yn extends ge{constructor(e){super();be(this,e,pn,dn,ke,{classID:19,roomID:20},null,[-1,-1])}}export{yn as default,vn as load};
