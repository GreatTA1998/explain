var Wt=Object.defineProperty;var it=Object.getOwnPropertySymbols;var Ot=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable;var at=(r,e,o)=>e in r?Wt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,Ae=(r,e)=>{for(var o in e||(e={}))Ot.call(e,o)&&at(r,o,e[o]);if(it)for(var o of it(e))qt.call(e,o)&&at(r,o,e[o]);return r};import{S as ae,i as ue,s as ce,aE as Qt,k as V,e as N,n as M,c as U,b as R,M as $,W as Ht,aD as re,f as v,a1 as K,aH as fe,t as E,a as L,aI as de,d as h,g as C,N as B,ag as Xt,I as he,j as z,m as j,o as F,aF as Gt,aG as Yt,h as pe,J as ge,K as be,L as ke,x as y,u as I,v as W,F as H,r as ee,w as te,a2 as xe,aJ as et,A as ut,a3 as $e,ab as Kt,ae as Jt,ai as Le,aK as we,aL as Zt,aA as Ne,O as le,a6 as ct,Q,a7 as ft,a8 as xt,X as dt,a4 as pt,aM as eo,T as mt,P as G,aN as to,a5 as _t,aB as oo,l as X,aO as no,aC as ro,aP as lo,_ as Y,aw as tt,av as ot,aQ as ht,aR as gt,aS as me,ax as so,ay as io,aT as ao,a9 as uo,au as co,af as fo,aU as po,an as mo,Y as _o,aV as ho}from"../../../chunks/vendor-d35e056c.js";import{R as go,a as bo,D as ko}from"../../../chunks/RenderlessFetchStrokes-80310fd5.js";import{_ as $o}from"../../../chunks/preload-helper-ec9aa979.js";import{o as nt,u as rt,j as Ue,a as bt,c as lt,d as Ee,f as wo,e as vo,k as Ce,b as yo,g as Do}from"../../../chunks/navigation-e96c681c.js";/* empty css                                                                */import{d as Be,r as Ro,a as Io}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const To=r=>({}),kt=r=>({});function $t(r,e,o){const t=r.slice();return t[9]=e[o],t}function wt(r){let e,o,t,n,l,s=r[1].pencilColors,i=[];for(let u=0;u<s.length;u+=1)i[u]=vt($t(r,s,u));return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=V(),o=N("img"),this.h()},l(u){for(let d=0;d<i.length;d+=1)i[d].l(u);e=M(u),o=U(u,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){R(o,"width","46"),R(o,"height","33"),$(o,"margin-left","8px"),Ht(o.src,t="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||R(o,"src",t),R(o,"alt","eraser"),R(o,"class","svelte-1bgxyxs"),re(o,"eraser-selected",r[2].type==="eraser")},m(u,d){for(let f=0;f<i.length;f+=1)i[f].m(u,d);v(u,e,d),v(u,o,d),n||(l=K(o,"click",r[7]),n=!0)},p(u,d){if(d&6){s=u[1].pencilColors;let f;for(f=0;f<s.length;f+=1){const a=$t(u,s,f);i[f]?i[f].p(a,d):(i[f]=vt(a),i[f].c(),i[f].m(e.parentNode,e))}for(;f<i.length;f+=1)i[f].d(1);i.length=s.length}d&4&&re(o,"eraser-selected",u[2].type==="eraser")},d(u){Xt(i,u),u&&h(e),u&&h(o),n=!1,l()}}}function vt(r){let e,o,t,n,l,s,i,u,d,f,a,b;function w(){return r[6](r[9])}return{c(){e=N("div"),o=fe("svg"),t=fe("g"),n=fe("path"),l=E(`;\r
            `),s=fe("polygon"),u=fe("path"),d=fe("path"),this.h()},l(m){e=U(m,"DIV",{style:!0,class:!0});var p=L(e);o=de(p,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var g=L(o);t=de(g,"g",{});var _=L(t);n=de(_,"path",{d:!0}),L(n).forEach(h),l=C(_,`;\r
            `),s=de(_,"polygon",{style:!0,points:!0}),L(s).forEach(h),u=de(_,"path",{style:!0,d:!0}),L(u).forEach(h),d=de(_,"path",{style:!0,d:!0}),L(d).forEach(h),_.forEach(h),g.forEach(h),p.forEach(h),this.h()},h(){R(n,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),R(s,"style",i=`fill: ${r[9]};`),R(s,"points","50,211.978 38.879,175.24 61.122,175.24"),$(u,"fill","#424242"),R(u,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),R(d,"style",f=`fill: ${r[9]};`),R(d,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),R(o,"preserveAspectRatio","none"),R(o,"version","1.1"),R(o,"id","Layer_1"),R(o,"xmlns","http://www.w3.org/2000/svg"),R(o,"xmlns:xlink","http://www.w3.org/1999/xlink"),R(o,"x","0px"),R(o,"y","0px"),R(o,"width","16px"),R(o,"height","30px"),R(o,"viewBox","0 0 100 230"),$(o,"enable-background","new 0 0 100 230"),R(o,"xml:space","preserve"),R(o,"class","svelte-1bgxyxs"),$(e,"margin","0 4px"),$(e,"width","30px"),$(e,"height","42px"),$(e,"border-radius","3px"),$(e,"align-items","center"),$(e,"display","flex"),$(e,"justify-content","center"),R(e,"class","svelte-1bgxyxs"),re(e,"pencil-selected",r[2].color===r[9])},m(m,p){v(m,e,p),B(e,o),B(o,t),B(t,n),B(t,l),B(t,s),B(t,u),B(t,d),a||(b=K(e,"click",w),a=!0)},p(m,p){r=m,p&2&&i!==(i=`fill: ${r[9]};`)&&R(s,"style",i),p&2&&f!==(f=`fill: ${r[9]};`)&&R(d,"style",f),p&6&&re(e,"pencil-selected",r[2].color===r[9])},d(m){m&&h(e),a=!1,b()}}}function Po(r){let e,o,t,n,l,s=(r[0]?"No touch":"Touch draw")+"",i,u,d=Object.keys(r[1]).length>0,f,a,b,w,m;t=new Qt({props:{icons:!1,checked:!r[0],style:"margin: 0 !important"}});let p=d&&wt(r);const g=r[5].default,_=he(g,r,r[4],null),T=r[5]["dropdown-menu"],A=he(T,r,r[4],kt);return{c(){e=N("div"),o=N("div"),z(t.$$.fragment),n=V(),l=N("div"),i=E(s),u=V(),p&&p.c(),f=V(),_&&_.c(),a=V(),A&&A.c(),this.h()},l(D){e=U(D,"DIV",{style:!0});var P=L(e);o=U(P,"DIV",{style:!0});var q=L(o);j(t.$$.fragment,q),n=M(q),l=U(q,"DIV",{style:!0});var x=L(l);i=C(x,s),x.forEach(h),q.forEach(h),u=M(P),p&&p.l(P),f=M(P),_&&_.l(P),a=M(P),A&&A.l(P),P.forEach(h),this.h()},h(){$(l,"margin-top","2px"),$(l,"font-size","0.55rem"),$(l,"font-family","Roboto,sans-serif"),$(l,"color","white"),$(o,"margin-right","10px"),$(o,"text-align","center"),$(e,"position","absolute"),$(e,"display","flex"),$(e,"align-items","center"),$(e,"height","50px"),$(e,"left","0"),$(e,"right","auto"),$(e,"top","0"),$(e,"bottom","auto"),$(e,"z-index","100"),$(e,"background-color","grey"),$(e,"padding-left","10px"),$(e,"border-radius","2px")},m(D,P){v(D,e,P),B(e,o),F(t,o,null),B(o,n),B(o,l),B(l,i),B(e,u),p&&p.m(e,null),B(e,f),_&&_.m(e,null),B(e,a),A&&A.m(e,null),b=!0,w||(m=K(o,"click",Gt(Yt(r[3]))),w=!0)},p(D,[P]){const q={};P&1&&(q.checked=!D[0]),t.$set(q),(!b||P&1)&&s!==(s=(D[0]?"No touch":"Touch draw")+"")&&pe(i,s),P&2&&(d=Object.keys(D[1]).length>0),d?p?p.p(D,P):(p=wt(D),p.c(),p.m(e,f)):p&&(p.d(1),p=null),_&&_.p&&(!b||P&16)&&ge(_,g,D,D[4],b?ke(g,D[4],P,null):be(D[4]),null),A&&A.p&&(!b||P&16)&&ge(A,T,D,D[4],b?ke(T,D[4],P,To):be(D[4]),kt)},i(D){b||(y(t.$$.fragment,D),y(_,D),y(A,D),b=!0)},o(D){I(t.$$.fragment,D),I(_,D),I(A,D),b=!1},d(D){D&&h(e),W(t),p&&p.d(),_&&_.d(D),A&&A.d(D),w=!1,m()}}}function So(r,e,o){let t,n,l;H(r,nt,a=>o(0,t=a)),H(r,rt,a=>o(1,n=a)),H(r,Ue,a=>o(2,l=a));let{$$slots:s={},$$scope:i}=e;function u(){nt.set(!t)}const d=a=>Ue.set({type:"pencil",color:a,lineWidth:3}),f=()=>Ue.set({type:"eraser",color:"",lineWidth:40});return r.$$set=a=>{"$$scope"in a&&o(4,i=a.$$scope)},[t,n,l,u,i,s,d,f]}class Ao extends ae{constructor(e){super();ue(this,e,So,Po,ce,{})}}function yt(r){let e,o;return e=new Ao({props:{$$slots:{"dropdown-menu":[jo],default:[Lo]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&536871362&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Lo(r){let e;const o=r[22].default,t=he(o,r,r[29],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,l){t&&t.m(n,l),e=!0},p(n,l){t&&t.p&&(!e||l[0]&536870912)&&ge(t,o,n,n[29],e?ke(o,n[29],l,null):be(n[29]),null)},i(n){e||(y(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function Dt(r){let e,o,t,n,l,s,i,u,d,f={style:"width: 300px",$$slots:{default:[zo]},$$scope:{ctx:r}};return s=new Kt({props:f}),r[26](s),{c(){e=N("span"),o=E("more_horiz"),t=V(),n=N("input"),l=V(),z(s.$$.fragment),this.h()},l(a){e=U(a,"SPAN",{class:!0,style:!0});var b=L(e);o=C(b,"more_horiz"),b.forEach(h),t=M(a),n=U(a,"INPUT",{style:!0,type:!0,accept:!0}),l=M(a),j(s.$$.fragment,a),this.h()},h(){R(e,"class","material-icons"),$(e,"margin-right","10px"),$(e,"color","white"),$(e,"font-size","2rem"),$(n,"display","none"),R(n,"type","file"),R(n,"accept","image/gif, image/jpeg, image/png")},m(a,b){v(a,e,b),B(e,o),v(a,t,b),v(a,n,b),r[24](n),v(a,l,b),F(s,a,b),i=!0,u||(d=[K(e,"click",r[23]),K(n,"change",r[25])],u=!0)},p(a,b){const w={};b[0]&536870914&&(w.$$scope={dirty:b,ctx:a}),s.$set(w)},i(a){i||(y(s.$$.fragment,a),i=!0)},o(a){I(s.$$.fragment,a),i=!1},d(a){a&&h(e),a&&h(t),a&&h(n),r[24](null),a&&h(l),r[26](null),W(s,a),u=!1,xe(d)}}}function No(r){let e,o;return e=new Le({props:{$$slots:{default:[Eo]},$$scope:{ctx:r}}}),e.$on("click",r[9]),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&536870912&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Uo(r){let e,o;return e=new Le({props:{$$slots:{default:[Co]},$$scope:{ctx:r}}}),e.$on("click",r[11]),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&536870912&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Eo(r){let e;return{c(){e=E("Set background")},l(o){e=C(o,"Set background")},m(o,t){v(o,e,t)},d(o){o&&h(e)}}}function Co(r){let e;return{c(){e=E("Remove background")},l(o){e=C(o,"Remove background")},m(o,t){v(o,e,t)},d(o){o&&h(e)}}}function Bo(r){let e;return{c(){e=E("Wipe board")},l(o){e=C(o,"Wipe board")},m(o,t){v(o,e,t)},d(o){o&&h(e)}}}function Vo(r){let e;return{c(){e=E("Delete board")},l(o){e=C(o,"Delete board")},m(o,t){v(o,e,t)},d(o){o&&h(e)}}}function Mo(r){let e,o,t,n,l,s,i;const u=[Uo,No],d=[];function f(a,b){return a[1]?0:1}return e=f(r),o=d[e]=u[e](r),n=new Le({props:{$$slots:{default:[Bo]},$$scope:{ctx:r}}}),n.$on("SMUI:action",r[12]),s=new Le({props:{$$slots:{default:[Vo]},$$scope:{ctx:r}}}),s.$on("SMUI:action",r[13]),{c(){o.c(),t=V(),z(n.$$.fragment),l=V(),z(s.$$.fragment)},l(a){o.l(a),t=M(a),j(n.$$.fragment,a),l=M(a),j(s.$$.fragment,a)},m(a,b){d[e].m(a,b),v(a,t,b),F(n,a,b),v(a,l,b),F(s,a,b),i=!0},p(a,b){let w=e;e=f(a),e===w?d[e].p(a,b):(ee(),I(d[w],1,1,()=>{d[w]=null}),te(),o=d[e],o?o.p(a,b):(o=d[e]=u[e](a),o.c()),y(o,1),o.m(t.parentNode,t));const m={};b[0]&536870912&&(m.$$scope={dirty:b,ctx:a}),n.$set(m);const p={};b[0]&536870912&&(p.$$scope={dirty:b,ctx:a}),s.$set(p)},i(a){i||(y(o),y(n.$$.fragment,a),y(s.$$.fragment,a),i=!0)},o(a){I(o),I(n.$$.fragment,a),I(s.$$.fragment,a),i=!1},d(a){d[e].d(a),a&&h(t),W(n,a),a&&h(l),W(s,a)}}}function zo(r){let e,o;return e=new Jt({props:{$$slots:{default:[Mo]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&536870914&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function jo(r){let e,o,t=r[8].uid&&Dt(r);return{c(){e=N("div"),t&&t.c(),this.h()},l(n){e=U(n,"DIV",{slot:!0});var l=L(e);t&&t.l(l),l.forEach(h),this.h()},h(){R(e,"slot","dropdown-menu")},m(n,l){v(n,e,l),t&&t.m(e,null),o=!0},p(n,l){n[8].uid?t?(t.p(n,l),l[0]&256&&y(t,1)):(t=Dt(n),t.c(),y(t,1),t.m(e,null)):t&&(ee(),I(t,1,1,()=>{t=null}),te())},i(n){o||(y(t),o=!0)},o(n){I(t),o=!1},d(n){n&&h(e),t&&t.d()}}}function Fo(r){let e,o,t,n,l,s,i,u,d,f=r[0]&&yt(r);return{c(){f&&f.c(),e=V(),o=N("canvas"),n=V(),l=N("canvas"),this.h()},l(a){f&&f.l(a),e=M(a),o=U(a,"CANVAS",{style:!0});var b=L(o);b.forEach(h),n=M(a),l=U(a,"CANVAS",{style:!0});var w=L(l);w.forEach(h),this.h()},h(){R(o,"style",t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[5]}px; height: ${r[4]}px`),R(l,"style",s=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[5]}px; height: ${r[4]}px`)},m(a,b){f&&f.m(a,b),v(a,e,b),v(a,o,b),r[27](o),v(a,n,b),v(a,l,b),r[28](l),i=!0,u||(d=[K(o,"touchstart",r[14]),K(o,"touchmove",r[15]),K(o,"touchend",r[16])],u=!0)},p(a,b){a[0]?f?(f.p(a,b),b[0]&1&&y(f,1)):(f=yt(a),f.c(),y(f,1),f.m(e.parentNode,e)):f&&(ee(),I(f,1,1,()=>{f=null}),te()),(!i||b[0]&48&&t!==(t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${a[5]}px; height: ${a[4]}px`))&&R(o,"style",t),(!i||b[0]&48&&s!==(s=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${a[5]}px; height: ${a[4]}px`))&&R(l,"style",s)},i(a){i||(y(f),i=!0)},o(a){I(f),i=!1},d(a){f&&f.d(a),a&&h(e),a&&h(o),r[27](null),a&&h(n),a&&h(l),r[28](null),u=!1,xe(d)}}}function Wo(r){return(r.endTime-r.startTime)/r.points.length}function Oo(r,e,o){let t,n,l,s,i;H(r,bt,c=>o(4,t=c)),H(r,lt,c=>o(5,n=c)),H(r,Ue,c=>o(33,l=c)),H(r,nt,c=>o(34,s=c)),H(r,rt,c=>o(8,i=c));let{$$slots:u={},$$scope:d}=e,{strokesArray:f}=e,{currentTime:a=0}=e,{backgroundImageDownloadURL:b=""}=e;const w=et();let m,p,g,_,T=[],A=!1,D={x:-1,y:-1},P={points:[]},q,x,se;ut(()=>{o(18,m=g.getContext("2d")),o(19,p=_.getContext("2d"))});function Ve(){se.click()}function ve(c){w("background-upload",{imageFile:c.target.files[0]})}function Me(){w("background-reset")}function ye(){w("board-wipe")}function ze(){w("board-delete")}function je(c){if(c.touches.length>1)return;const k=c.touches[0].touchType==="stylus";if(s&&!k){console.log("error: cannot use finger during Apple Pencil mode");return}Te(c,{isInitialContact:!0})}function De(c){if(!A)return;if(c.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const k=c.touches[0].touchType==="stylus";if(s&&!k){console.log("error: cannot use finger during Apple Pencil mode");return}Te(c,{isInitialContact:!1})}function Re(c){if(!A||c.touches.length>0)return;const k=c.changedTouches[0].touchType==="stylus";if(s&&!k){console.log("error: cannot use finger during Apple Pencil mode");return}Fe(P),A=!1}function Ie(c){A=!0,D={x:-1,y:-1},P={strokeNumber:f.length+1,startTime:Number(a.toFixed(1)),color:l.color,lineWidth:l.lineWidth,isErasing:l.type==="eraser",points:[],sessionID:"123"}}function Te(c,{isInitialContact:k}){c.preventDefault(),k&&Ie();const S=We(c);Pe(c,S)}function Pe(c,k){P.points.push({unitX:parseFloat(k.x/g.width).toFixed(4),unitY:parseFloat(k.y/g.height).toFixed(4)}),D.x!==-1&&D.y!==-1&&Io([Se(D),Se(k)],1,l.type==="eraser",m,l.color,l.lineWidth,g),D=k}function Fe(c){c.endTime=Number(a.toFixed(1)),c.id=Ee(),T.push(c),w("stroke-drawn",{newStroke:c})}function We(c){const{left:k,top:S}=g.getBoundingClientRect();return{x:c.touches[0].pageX-k-window.scrollX,y:c.touches[0].pageY-S-window.scrollY}}function Se({x:c,y:k}){return{unitX:c/g.width,unitY:k/g.height}}function Oe(){m.clearRect(0,0,n,t)}const qe=()=>x.setOpen(!0);function Qe(c){$e[c?"unshift":"push"](()=>{se=c,o(7,se)})}const He=c=>ve(c);function Xe(c){$e[c?"unshift":"push"](()=>{x=c,o(6,x)})}function Ge(c){$e[c?"unshift":"push"](()=>{g=c,o(2,g),o(18,m),o(5,n),o(4,t),o(0,f)})}function Ye(c){$e[c?"unshift":"push"](()=>{_=c,o(3,_),o(18,m),o(5,n),o(4,t),o(0,f),o(2,g)})}return r.$$set=c=>{"strokesArray"in c&&o(0,f=c.strokesArray),"currentTime"in c&&o(17,a=c.currentTime),"backgroundImageDownloadURL"in c&&o(1,b=c.backgroundImageDownloadURL),"$$scope"in c&&o(29,d=c.$$scope)},r.$$.update=()=>{if(r.$$.dirty[0]&262197&&m&&(o(2,g.width=n,g),o(2,g.height=t,g),o(3,_.width=n,_),o(3,_.height=t,_),f))for(const c of f)Be(c,null,m,g);if(r.$$.dirty[0]&524302&&p&&(p.clearRect(0,0,_.scrollWidth,_.scrollHeight),Ro(b,g,p)),r.$$.dirty[0]&3407877&&m&&f){let c=T.length,k=f.length;if(c!==k)if(c<k)if(c===0){for(const S of f)Be(S,null,m,g);o(20,T=[...f])}else for(let S=c;S<k;S++){const O=f[S];Be(O,O.startTime!==O.endTime?Wo(O):null,m,g),T.push(O)}else{let S=function(){Oe(),o(20,T=[]),D={x:-1,y:-1};for(const J of f)Be(J,null,m,g)};(function(){console.log("debounced board reset"),q&&clearTimeout(q),o(21,q=setTimeout(S,1e3))})()}}},[f,b,g,_,t,n,x,se,i,Ve,ve,Me,ye,ze,je,De,Re,a,m,p,T,q,u,qe,Qe,He,Xe,Ge,Ye,d]}class qo extends ae{constructor(e){super();ue(this,e,Oo,Fo,ce,{strokesArray:0,currentTime:17,backgroundImageDownloadURL:1},null,[-1,-1])}}const Qo=r=>({currentTime:r&1}),Rt=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function Ho(r){let e;const o=r[4].default,t=he(o,r,r[3],Rt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,l){t&&t.m(n,l),e=!0},p(n,[l]){t&&t.p&&(!e||l&9)&&ge(t,o,n,n[3],e?ke(o,n[3],l,Qo):be(n[3]),Rt)},i(n){e||(y(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function Xo(r,e,o){let t,n;H(r,wo,m=>o(8,t=m)),H(r,vo,m=>o(9,n=m));let{$$slots:l={},$$scope:s}=e,i,u=0,d;ut(async()=>{window&&(i=await $o(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=i.default)});const f=et();let a=null;function b(){return new Promise(async(m,p)=>{if(!n.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),p("Cannot start recording because mic stream is muted");return}const g=t.clone();a=new MediaRecorder(g),a.start(),d=setInterval(()=>o(0,u+=.1),100),f("record-start"),m()})}function w(){return new Promise((m,p)=>{clearTimeout(d),a.addEventListener("dataavailable",g=>{const _=g.data;f("record-end",{audioBlob:_}),m()}),a.stop();for(const g of a.stream.getTracks())g.stop()})}return r.$$set=m=>{"$$scope"in m&&o(3,s=m.$$scope)},[u,b,w,s,l]}class Go extends ae{constructor(e){super();ue(this,e,Xo,Ho,ce,{})}}function Yo(r,e){let o=document.getElementById(e);return o==null||o.appendChild(r),{destroy(){r.remove()}}}function It(r,e){let o=new IntersectionObserver(t=>{for(const n of t)if(n.isIntersecting){e(),o.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});o.observe(r)}function Ko(r){let e,o,t,n,l;return{c(){e=N("div"),o=N("textarea"),this.h()},l(s){e=U(s,"DIV",{class:!0,style:!0});var i=L(e);o=U(i,"TEXTAREA",{rows:!0,style:!0,class:!0}),L(o).forEach(h),i.forEach(h),this.h()},h(){o.value=r[0],R(o,"rows","1"),$(o,"width",r[1]+"px"),R(o,"class","svelte-1xi77cs"),R(e,"class","grow-wrap svelte-1xi77cs"),$(e,"display","grid")},m(s,i){v(s,e,i),B(e,o),r[7](e),n||(l=[K(o,"input",r[6]),we(r[5].call(null,e)),we(t=Zt.call(null,e,r[3]))],n=!0)},p(s,[i]){i&1&&(o.value=s[0]),i&2&&$(o,"width",s[1]+"px"),t&&Ne(t.update)&&i&8&&t.update.call(null,s[3])},i:le,o:le,d(s){s&&h(e),r[7](null),n=!1,xe(l)}}}function Jo(r,e,o){let t,n;H(r,lt,a=>o(1,n=a));let{value:l}=e,s;const i=et();function u(a){a.dataset.replicatedValue=l}const d=a=>{o(2,s.dataset.replicatedValue=a.target.value,s),i("input",a.target.value)};function f(a){$e[a?"unshift":"push"](()=>{s=a,o(2,s)})}return r.$$set=a=>{"value"in a&&o(0,l=a.value)},r.$$.update=()=>{r.$$.dirty&2&&o(3,t={width:`${n}px`})},[l,n,s,t,i,u,d,f]}class Zo extends ae{constructor(e){super();ue(this,e,Jo,Ko,ce,{value:0})}}const xo=r=>({strokesArray:r&1}),Tt=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function en(r){let e;const o=r[6].default,t=he(o,r,r[5],Tt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,l){t&&t.m(n,l),e=!0},p(n,[l]){t&&t.p&&(!e||l&33)&&ge(t,o,n,n[5],e?ke(o,n[5],l,xo):be(n[5]),Tt)},i(n){e||(y(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function Pt(r){const e=Ae({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function tn(r,e,o){let{$$slots:t={},$$scope:n}=e,{dbPath:l}=e,s,i;const u=ct(Q(),`${l}/strokes`),d=ft(u,xt("timestamp"));dt(()=>{i&&i()});async function f(){i=pt(d,async w=>{w.docChanges().filter(p=>p.type==="removed").length>0?(o(0,s=[]),await eo(),w.docs.length>0&&w.docs.forEach(p=>{s.push(Pt(p))})):(s||o(0,s=[]),w.docs.length===s.length||w.docChanges().filter(p=>p.type==="added").forEach(p=>{o(0,s=[...s,Pt(p.doc)])}))})}function a(w){s.push(w);try{mt(G(Q(),`${l}/strokes/${w.id}`),Ae({timestamp:to()},w))}catch(m){alert(m)}}async function b(){return new Promise(async w=>{const m=[];let p=_t(Q()),g=0;for(const _ of s){g>=500&&(m.push(p.commit()),p=_t(Q()),g=0);const T=G(Q(),`${l}/strokes/${_.id}`);p.delete(T),g+=1}m.push(p.commit()),await Promise.all(m),o(0,s=[]),w()})}return r.$$set=w=>{"dbPath"in w&&o(4,l=w.dbPath),"$$scope"in w&&o(5,n=w.$$scope)},[s,f,a,b,l,n,t]}class on extends ae{constructor(e){super();ue(this,e,tn,en,ce,{dbPath:4})}}function St(r,e,o){const t=r.slice();return t[43]=e[o],t[45]=o,t}function At(r){let e,o,t,n,l,s=[],i=new Map,u,d,f,a;o=new no({props:{disabled:ne(r[0].name)&&r[0].askerUID&&r[6].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[8]}px;`,$$slots:{helper:[an]},$$scope:{ctx:r}}}),o.$on("input",r[23]);let b=r[0].blackboards;const w=m=>m[43];for(let m=0;m<b.length;m+=1){let p=St(r,b,m),g=w(p);i.set(g,s[m]=Bt(g,p))}return{c(){e=N("div"),z(o.$$.fragment),t=V(),n=N("div"),l=V();for(let m=0;m<s.length;m+=1)s[m].c();this.h()},l(m){e=U(m,"DIV",{style:!0});var p=L(e);j(o.$$.fragment,p),t=M(p),n=U(p,"DIV",{style:!0}),L(n).forEach(h),l=M(p);for(let g=0;g<s.length;g+=1)s[g].l(p);p.forEach(h),this.h()},h(){$(n,"margin-bottom","20px"),$(e,"padding","16px"),re(e,"question",ne(r[0].name))},m(m,p){v(m,e,p),F(o,e,null),B(e,t),B(e,n),B(e,l);for(let g=0;g<s.length;g+=1)s[g].m(e,null);d=!0,f||(a=we(u=Yo.call(null,e,"main-content")),f=!0)},p(m,p){const g={};p[0]&65&&(g.disabled=ne(m[0].name)&&m[0].askerUID&&m[6].uid!==m[0].askerUID),p[0]&1&&(g.value=m[0].name),p[0]&256&&(g.style=`width: ${m[8]}px;`),p[0]&31|p[1]&16777216&&(g.$$scope={dirty:p,ctx:m}),o.$set(g),p[0]&1032161|p[1]&9404416&&(b=m[0].blackboards,ee(),s=oo(s,p,w,1,m,b,i,e,ro,Bt,null,St),te()),p[0]&1&&re(e,"question",ne(m[0].name))},i(m){if(!d){y(o.$$.fragment,m);for(let p=0;p<b.length;p+=1)y(s[p]);d=!0}},o(m){I(o.$$.fragment,m);for(let p=0;p<s.length;p+=1)I(s[p]);d=!1},d(m){m&&h(e),W(o);for(let p=0;p<s.length;p+=1)s[p].d();f=!1,a()}}}function nn(r){let e=r[0].askerName+"",o,t,n=Ce(r[0].dateAsked)+"",l;return{c(){o=E(e),t=E(" asked on "),l=E(n)},l(s){o=C(s,e),t=C(s," asked on "),l=C(s,n)},m(s,i){v(s,o,i),v(s,t,i),v(s,l,i)},p(s,i){i[0]&1&&e!==(e=s[0].askerName+"")&&pe(o,e),i[0]&1&&n!==(n=Ce(s[0].dateAsked)+"")&&pe(l,n)},d(s){s&&h(o),s&&h(t),s&&h(l)}}}function rn(r){let e,o,t;return{c(){e=E("Resolving this question in "),o=E(r[4]),t=E(", cancel by re-adding ?")},l(n){e=C(n,"Resolving this question in "),o=C(n,r[4]),t=C(n,", cancel by re-adding ?")},m(n,l){v(n,e,l),v(n,o,l),v(n,t,l)},p(n,l){l[0]&16&&pe(o,n[4])},d(n){n&&h(e),n&&h(o),n&&h(t)}}}function ln(r){let e,o,t;return{c(){e=E("Pinging server members in "),o=E(r[2]),t=E(", cancel by backtracking the ?")},l(n){e=C(n,"Pinging server members in "),o=C(n,r[2]),t=C(n,", cancel by backtracking the ?")},m(n,l){v(n,e,l),v(n,o,l),v(n,t,l)},p(n,l){l[0]&4&&pe(o,n[2])},d(n){n&&h(e),n&&h(o),n&&h(t)}}}function Lt(r){let e,o=Ce(r[0].dateResolved)+"",t;return{c(){e=E(", resolved "),t=E(o)},l(n){e=C(n,", resolved "),t=C(n,o)},m(n,l){v(n,e,l),v(n,t,l)},p(n,l){l[0]&1&&o!==(o=Ce(n[0].dateResolved)+"")&&pe(t,o)},d(n){n&&h(e),n&&h(t)}}}function sn(r){let e,o;function t(i,u){if(i[1])return ln;if(i[3])return rn;if(i[0].askerName&&i[0].askerUID&&i[0].date)return nn}let n=t(r),l=n&&n(r),s=r[0].dateResolved&&Lt(r);return{c(){l&&l.c(),e=V(),s&&s.c(),o=X()},l(i){l&&l.l(i),e=M(i),s&&s.l(i),o=X()},m(i,u){l&&l.m(i,u),v(i,e,u),s&&s.m(i,u),v(i,o,u)},p(i,u){n===(n=t(i))&&l?l.p(i,u):(l&&l.d(1),l=n&&n(i),l&&(l.c(),l.m(e.parentNode,e))),i[0].dateResolved?s?s.p(i,u):(s=Lt(i),s.c(),s.m(o.parentNode,o)):s&&(s.d(1),s=null)},d(i){l&&l.d(i),i&&h(e),s&&s.d(i),i&&h(o)}}}function an(r){let e,o;return e=new lo({props:{slot:"helper",persistent:!0,$$slots:{default:[sn]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&31|n[1]&16777216&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Nt(r){let e,o,t,n,l,s,i,u,d,f,a;function b(..._){return r[24](r[43],..._)}t=new Zo({props:{value:r[46].description||""}}),t.$on("input",b);const w=[cn,un],m=[];function p(_,T){return _[46].audioDownloadURL?0:1}i=p(r),u=m[i]=w[i](r);let g=r[45]===r[0].blackboards.length-1&&Ct(r);return{c(){e=N("div"),o=V(),z(t.$$.fragment),n=V(),l=N("div"),s=V(),u.c(),d=V(),g&&g.c(),f=X(),this.h()},l(_){e=U(_,"DIV",{style:!0}),L(e).forEach(h),o=M(_),j(t.$$.fragment,_),n=M(_),l=U(_,"DIV",{style:!0}),L(l).forEach(h),s=M(_),u.l(_),d=M(_),g&&g.l(_),f=X(),this.h()},h(){$(e,"margin-top","10px"),$(l,"margin-bottom","10px")},m(_,T){v(_,e,T),v(_,o,T),F(t,_,T),v(_,n,T),v(_,l,T),v(_,s,T),m[i].m(_,T),v(_,d,T),g&&g.m(_,T),v(_,f,T),a=!0},p(_,T){r=_;const A={};T[1]&32768&&(A.value=r[46].description||""),t.$set(A);let D=i;i=p(r),i===D?m[i].p(r,T):(ee(),I(m[D],1,1,()=>{m[D]=null}),te(),u=m[i],u?u.p(r,T):(u=m[i]=w[i](r),u.c()),y(u,1),u.m(d.parentNode,d)),r[45]===r[0].blackboards.length-1?g?g.p(r,T):(g=Ct(r),g.c(),g.m(f.parentNode,f)):g&&(g.d(1),g=null)},i(_){a||(y(t.$$.fragment,_),y(u),a=!0)},o(_){I(t.$$.fragment,_),I(u),a=!1},d(_){_&&h(e),_&&h(o),W(t,_),_&&h(n),_&&h(l),_&&h(s),m[i].d(_),_&&h(d),g&&g.d(_),_&&h(f)}}}function un(r){let e,o;return e=new on({props:{dbPath:r[5]+r[43],$$slots:{default:[hn,({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:l,deleteAllStrokesFromDb:s})=>({50:t,48:n,51:l,49:s}),({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:l,deleteAllStrokesFromDb:s})=>[0,(t?524288:0)|(n?131072:0)|(l?1048576:0)|(s?262144:0)]]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&33&&(l.dbPath=t[5]+t[43]),n[0]&961|n[1]&17727488&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function cn(r){let e,o;return e=new bo({props:{dbPath:r[5]+r[43],$$slots:{default:[kn,({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:l})=>({47:t,48:n,49:l}),({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:l})=>[0,(t?65536:0)|(n?131072:0)|(l?262144:0)]]},$$scope:{ctx:r}}}),{c(){z(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){F(e,t,n),o=!0},p(t,n){const l={};n[0]&33&&(l.dbPath=t[5]+t[43]),n[0]&832|n[1]&17006592&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){o||(y(e.$$.fragment,t),o=!0)},o(t){I(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function Ut(r){let e,o,t,n;const l=[pn,dn,fn],s=[];function i(u,d){return!u[46].recordState||u[46].recordState==="pre_record"?0:u[46].recordState==="mid_record"?1:2}return e=i(r),o=s[e]=l[e](r),{c(){o.c(),t=X()},l(u){o.l(u),t=X()},m(u,d){s[e].m(u,d),v(u,t,d),n=!0},p(u,d){let f=e;e=i(u),e===f?s[e].p(u,d):(ee(),I(s[f],1,1,()=>{s[f]=null}),te(),o=s[e],o?o.p(u,d):(o=s[e]=l[e](u),o.c()),y(o,1),o.m(t.parentNode,t))},i(u){n||(y(o),n=!0)},o(u){I(o),n=!1},d(u){s[e].d(u),u&&h(t)}}}function fn(r){let e,o,t;return o=new ho({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=N("div"),z(o.$$.fragment),this.h()},l(n){e=U(n,"DIV",{style:!0});var l=L(e);j(o.$$.fragment,l),l.forEach(h),this.h()},h(){$(e,"display","flex"),$(e,"justify-content","center"),$(e,"margin-left","20px"),$(e,"margin-right","20px")},m(n,l){v(n,e,l),F(o,e,null),t=!0},p:le,i(n){t||(y(o.$$.fragment,n),t=!0)},o(n){I(o.$$.fragment,n),t=!1},d(n){n&&h(e),W(o)}}}function dn(r){let e,o,t,n;function l(){return r[27](r[53],r[43])}return{c(){e=N("span"),o=E("stop_circle"),this.h()},l(s){e=U(s,"SPAN",{class:!0,style:!0});var i=L(e);o=C(i,"stop_circle"),i.forEach(h),this.h()},h(){R(e,"class","material-icons svelte-53fhoc"),$(e,"font-size","2.5rem"),$(e,"color","cyan"),$(e,"margin-left","30px"),$(e,"margin-right","26px"),re(e,"unclickable",r[7]!==r[46].recorderBrowserTabID)},m(s,i){v(s,e,i),B(e,o),t||(n=K(e,"click",l),t=!0)},p(s,i){r=s,i[0]&128|i[1]&32768&&re(e,"unclickable",r[7]!==r[46].recorderBrowserTabID)},i:le,o:le,d(s){s&&h(e),t=!1,n()}}}function pn(r){let e,o,t,n;function l(){return r[26](r[52],r[43])}return{c(){e=N("span"),o=E("radio_button_checked"),this.h()},l(s){e=U(s,"SPAN",{class:!0,style:!0});var i=L(e);o=C(i,"radio_button_checked"),i.forEach(h),this.h()},h(){R(e,"class","material-icons"),$(e,"font-size","2.5rem"),$(e,"color","cyan"),$(e,"margin-left","30px"),$(e,"margin-right","26px")},m(s,i){v(s,e,i),B(e,o),t||(n=K(e,"click",l),t=!0)},p(s,i){r=s},i:le,o:le,d(s){s&&h(e),t=!1,n()}}}function mn(r){let e,o,t=r[6].uid&&Ut(r);return{c(){t&&t.c(),e=X()},l(n){t&&t.l(n),e=X()},m(n,l){t&&t.m(n,l),v(n,e,l),o=!0},p(n,l){n[6].uid?t?(t.p(n,l),l[0]&64&&y(t,1)):(t=Ut(n),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(ee(),I(t,1,1,()=>{t=null}),te())},i(n){o||(y(t),o=!0)},o(n){I(t),o=!1},d(n){t&&t.d(n),n&&h(e)}}}function _n(r){let e,o;function t(...i){return r[28](r[43],...i)}function n(){return r[29](r[43])}function l(...i){return r[30](r[51],...i)}function s(){return r[31](r[43],r[49])}return e=new qo({props:{strokesArray:r[48],currentTime:r[54],backgroundImageDownloadURL:r[46].backgroundImageDownloadURL,$$slots:{default:[mn]},$$scope:{ctx:r}}}),e.$on("background-upload",t),e.$on("background-reset",n),e.$on("stroke-drawn",l),e.$on("board-wipe",function(){Ne(r[49])&&r[49].apply(this,arguments)}),e.$on("board-delete",s),{c(){z(e.$$.fragment)},l(i){j(e.$$.fragment,i)},m(i,u){F(e,i,u),o=!0},p(i,u){r=i;const d={};u[1]&131072&&(d.strokesArray=r[48]),u[1]&8388608&&(d.currentTime=r[54]),u[1]&32768&&(d.backgroundImageDownloadURL=r[46].backgroundImageDownloadURL),u[0]&193|u[1]&16809984&&(d.$$scope={dirty:u,ctx:r}),e.$set(d)},i(i){o||(y(e.$$.fragment,i),o=!0)},o(i){I(e.$$.fragment,i),o=!1},d(i){W(e,i)}}}function hn(r){let e,o,t,n,l,s,i;function u(...d){return r[32](r[48],r[43],...d)}return o=new Go({props:{$$slots:{default:[_n,({startRecording:d,stopRecording:f,currentTime:a})=>({52:d,53:f,54:a}),({startRecording:d,stopRecording:f,currentTime:a})=>[0,(d?2097152:0)|(f?4194304:0)|(a?8388608:0)]]},$$scope:{ctx:r}}}),o.$on("record-end",u),{c(){e=N("div"),z(o.$$.fragment),this.h()},l(d){e=U(d,"DIV",{style:!0});var f=L(e);j(o.$$.fragment,f),f.forEach(h),this.h()},h(){R(e,"style",t=`width: ${r[8]}px; height: ${r[9]}px; position: relative`)},m(d,f){v(d,e,f),F(o,e,null),l=!0,s||(i=we(n=It.call(null,e,r[50])),s=!0)},p(d,f){r=d;const a={};f[0]&193|f[1]&25591808&&(a.$$scope={dirty:f,ctx:r}),o.$set(a),(!l||f[0]&768&&t!==(t=`width: ${r[8]}px; height: ${r[9]}px; position: relative`))&&R(e,"style",t),n&&Ne(n.update)&&f[1]&524288&&n.update.call(null,r[50])},i(d){l||(y(o.$$.fragment,d),l=!0)},o(d){I(o.$$.fragment,d),l=!1},d(d){d&&h(e),W(o),s=!1,i()}}}function Et(r){let e,o;function t(){return r[25](r[46],r[49])}return e=new _o({props:{color:"primary",$$slots:{default:[gn]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){z(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,l){F(e,n,l),o=!0},p(n,l){r=n;const s={};l[1]&16777216&&(s.$$scope={dirty:l,ctx:r}),e.$set(s)},i(n){o||(y(e.$$.fragment,n),o=!0)},o(n){I(e.$$.fragment,n),o=!1},d(n){W(e,n)}}}function gn(r){let e;return{c(){e=E("Delete video")},l(o){e=C(o,"Delete video")},m(o,t){v(o,e,t)},d(o){o&&h(e)}}}function bn(r){let e,o,t=r[6].uid===r[46].creatorUID&&Et(r);return{c(){t&&t.c(),e=X()},l(n){t&&t.l(n),e=X()},m(n,l){t&&t.m(n,l),v(n,e,l),o=!0},p(n,l){n[6].uid===n[46].creatorUID?t?(t.p(n,l),l[0]&64|l[1]&32768&&y(t,1)):(t=Et(n),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(ee(),I(t,1,1,()=>{t=null}),te())},i(n){o||(y(t),o=!0)},o(n){I(t),o=!1},d(n){t&&t.d(n),n&&h(e)}}}function kn(r){let e,o,t,n,l,s,i;return o=new ko({props:{strokesArray:r[48],audioDownloadURL:r[46].audioDownloadURL,backgroundImageDownloadURL:r[46].backgroundImageDownloadURL,$$slots:{default:[bn]},$$scope:{ctx:r}}}),{c(){e=N("div"),z(o.$$.fragment),this.h()},l(u){e=U(u,"DIV",{style:!0});var d=L(e);j(o.$$.fragment,d),d.forEach(h),this.h()},h(){R(e,"style",t=`width: ${r[8]}px; height: ${r[9]+40}px; position: relative`)},m(u,d){v(u,e,d),F(o,e,null),l=!0,s||(i=we(n=It.call(null,e,r[47])),s=!0)},p(u,d){const f={};d[1]&131072&&(f.strokesArray=u[48]),d[1]&32768&&(f.audioDownloadURL=u[46].audioDownloadURL),d[1]&32768&&(f.backgroundImageDownloadURL=u[46].backgroundImageDownloadURL),d[0]&64|d[1]&16809984&&(f.$$scope={dirty:d,ctx:u}),o.$set(f),(!l||d[0]&768&&t!==(t=`width: ${u[8]}px; height: ${u[9]+40}px; position: relative`))&&R(e,"style",t),n&&Ne(n.update)&&d[1]&65536&&n.update.call(null,u[47])},i(u){l||(y(o.$$.fragment,u),l=!0)},o(u){I(o.$$.fragment,u),l=!1},d(u){u&&h(e),W(o),s=!1,i()}}}function Ct(r){let e,o,t,n;return{c(){e=N("div"),o=E("New blackboard"),this.h()},l(l){e=U(l,"DIV",{style:!0});var s=L(e);o=C(s,"New blackboard"),s.forEach(h),this.h()},h(){$(e,"display","flex"),$(e,"justify-content","center"),$(e,"align-items","center"),$(e,"margin-top","40px"),$(e,"background-color","#2e3131"),$(e,"font-family","Roboto, sans-serif"),$(e,"text-transform","uppercase"),$(e,"color","white"),$(e,"height","35px"),$(e,"width",r[8]+"px")},m(l,s){v(l,e,s),B(e,o),t||(n=K(e,"click",r[18]),t=!0)},p(l,s){s[0]&256&&$(e,"width",l[8]+"px")},d(l){l&&h(e),t=!1,n()}}}function $n(r){let e,o,t=r[46]&&Nt(r);return{c(){t&&t.c(),e=V()},l(n){t&&t.l(n),e=M(n)},m(n,l){t&&t.m(n,l),v(n,e,l),o=!0},p(n,l){n[46]?t?(t.p(n,l),l[1]&32768&&y(t,1)):(t=Nt(n),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(ee(),I(t,1,1,()=>{t=null}),te())},i(n){o||(y(t),o=!0)},o(n){I(t),o=!1},d(n){t&&t.d(n),n&&h(e)}}}function Bt(r,e){let o,t,n;return t=new go({props:{dbPath:e[5]+e[43],$$slots:{default:[$n,({boardDoc:l})=>({46:l}),({boardDoc:l})=>[0,l?32768:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){o=X(),z(t.$$.fragment),this.h()},l(l){o=X(),j(t.$$.fragment,l),this.h()},h(){this.first=o},m(l,s){v(l,o,s),F(t,l,s),n=!0},p(l,s){e=l;const i={};s[0]&33&&(i.dbPath=e[5]+e[43]),s[0]&993|s[1]&16809984&&(i.$$scope={dirty:s,ctx:e}),t.$set(i)},i(l){n||(y(t.$$.fragment,l),n=!0)},o(l){I(t.$$.fragment,l),n=!1},d(l){l&&h(o),W(t,l)}}}function wn(r){let e,o,t=r[0]&&At(r);return{c(){t&&t.c(),e=X()},l(n){t&&t.l(n),e=X()},m(n,l){t&&t.m(n,l),v(n,e,l),o=!0},p(n,l){n[0]?t?(t.p(n,l),l[0]&1&&y(t,1)):(t=At(n),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(ee(),I(t,1,1,()=>{t=null}),te())},i(n){o||(y(t),o=!0)},o(n){I(t),o=!1},d(n){t&&t.d(n),n&&h(e)}}}async function Ln({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Vt(...r){for(const e of r)e()}function ne(r){return r?r.charAt(r.length-1)==="?":!1}function st(r){return r.askerName&&r.dateAsked&&r.askerUID}function vn(r,e,o){let t,n,l,s,i,u,d;H(r,rt,c=>o(6,s=c)),H(r,yo,c=>o(7,i=c)),H(r,lt,c=>o(8,u=c)),H(r,bt,c=>o(9,d=c));let{classID:f}=e,{roomID:a}=e,b,w={name:"",blackboards:[]};async function m(){b&&b(),b=pt(l,c=>{c.exists()?o(0,w=Ae({id:c.id},c.data())):Do(`/${f}/${f}`)})}dt(()=>{b()});function p(c){const k=G(Q(),t+c);Y(k,{recorderBrowserTabID:i})}function g(c,k){const S=G(Q(),t+c);Y(S,{recordState:k})}async function _(c,k){const S=G(Q(),t+k);if(!!c)if(c.type.split("/")[0]==="image"){const O=tt(),J=ot(O,`images/${Ee()}`);await ht(J,c);const oe=await gt(J);Y(S,{backgroundImageDownloadURL:oe})}else alert("Error: only images can be used")}function T(c){const k=G(Q(),t+c);Y(k,{backgroundImageDownloadURL:me()})}let A="",D=5,P,q=5;async function x({srcElement:c}){const{value:k}=c,S={name:k};!ne(w.name)&&ne(k)&&!st(w)?se():A&&!ne(k)?ye():!ne(k)&&st(w)?Ve():P&&ne(k)&&st(w)&&Me(),await Y(l,S)}function se(){o(2,D=5),o(1,A=setInterval(()=>{o(2,D-=1),D===0&&(ze(),je(),ye())},1e3))}function Ve(){o(4,q=5),o(3,P=setInterval(()=>{o(4,q-=1),q===0&&ve()},1e3))}function ve(){Y(l,{dateResolved:new Date().toISOString()})}function Me(){clearTimeout(P),o(3,P="")}function ye(){clearTimeout(A),o(1,A="")}function ze(){Y(l,{askerName:s.name||"Beaver #999",askerUID:s.uid,dateAsked:new Date().toISOString()})}async function je(){const c=[],k=so(),S=io(k,"sendTextMessage"),O=ct(Q(),"users"),J=ft(O,ao("willReceiveText","==",!0)),oe=await uo(J);if(oe.docs)for(const _e of oe.docs){console.log("phoneNumber =",_e.data().phoneNumber);try{_e.id!==s.uid&&c.push(S({content:`${s.name} asked on https://ihtfp.app: "${w.name||"Fake question here"}"`,toWho:_e.data().phoneNumber}))}catch(Ke){alert(Ke)}}await Promise.all(c),console.log("success, sent all texts.")}async function De({detail:c},k){const S=G(Q(),t+k);await Y(S,{description:c})}async function Re(c,k,S){function O(Z){return Z.startTime!==0&&Z.endTime!==J}const J=.5,oe=[],_e=k.length;for(let Z=0;Z<_e;Z++){if(!O(k[Z])){let ie=Z-1;for(;ie>=0;){if(O(k[ie])){k[Z].startTime=k[ie].endTime,k[Z].endTime=k[Z].startTime+J,oe.push(Z);break}ie-=1}}for(let ie of oe){const Ze=k[ie],jt=t+S,Ft=G(Q(),`${jt}/strokes/${Ze.id}`);Y(Ft,{startTime:Ze.startTime,endTime:Ze.endTime})}}const Ke=tt(),Je=ot(Ke,`audio/${Ee()}`);await ht(Je,c);const Mt=await gt(Je),zt=G(Q(),t+S);await Y(zt,{creatorUID:s.uid,creatorPhoneNumber:s.phoneNumber,date:new Date().toISOString(),audioDownloadURL:Mt,audioRefFullPath:Je.fullPath}),g(S,"pre_record")}async function Ie({id:c,audioRefFullPath:k},S){const O=[],J=G(Q(),t+c);if(k){const oe=ot(tt(),k);O.push(co(oe))}O.push(Y(J,{creator:me(),creatorPhoneNumber:me(),date:me(),audioDownloadURL:me(),audioRefFullPath:me()})),O.push(S()),await Promise.all(O)}async function Te(){const c=Ee(),k=G(Q(),t+c);await Promise.all([mt(k,{}),Y(l,{blackboards:fo(c)})])}function Pe(c,k){if(w.blackboards.length===1){alert("Can't delete the last blackboard");return}Y(l,{blackboards:po(c)}),k(),mo(G(Q(),t+c))}const Fe=c=>x(c),We=(c,k)=>De(k,c),Se=(c,k)=>Ie(c,k),Oe=(c,k)=>Vt(c,()=>g(k,"mid_record"),()=>p(k)),qe=(c,k)=>Vt(c,()=>g(k,"post_record")),Qe=(c,k)=>_(k.detail.imageFile,c),He=c=>T(c),Xe=(c,k)=>c(k.detail.newStroke),Ge=(c,k)=>Pe(c,k),Ye=(c,k,S)=>Re(S.detail.audioBlob,c,k);return r.$$set=c=>{"classID"in c&&o(20,f=c.classID),"roomID"in c&&o(21,a=c.roomID)},r.$$.update=()=>{r.$$.dirty[0]&1048576&&o(5,t=`classes/${f}/blackboards/`),r.$$.dirty[0]&1048576&&o(22,n=`classes/${f}/rooms/`),r.$$.dirty[0]&6291456&&(l=G(Q(),n+a)),r.$$.dirty[0]&2097152&&m()},[w,A,D,P,q,t,s,i,u,d,p,g,_,T,x,De,Re,Ie,Te,Pe,f,a,n,Fe,We,Se,Oe,qe,Qe,He,Xe,Ge,Ye]}class Nn extends ae{constructor(e){super();ue(this,e,vn,wn,ce,{classID:20,roomID:21},null,[-1,-1])}}export{Nn as default,Ln as load};
