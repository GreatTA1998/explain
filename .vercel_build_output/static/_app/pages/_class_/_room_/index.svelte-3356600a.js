var Be=Object.defineProperty;var he=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var me=(l,e,n)=>e in l?Be(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,_e=(l,e)=>{for(var n in e||(e={}))je.call(e,n)&&me(l,n,e[n]);if(he)for(var n of he(e))Ve.call(e,n)&&me(l,n,e[n]);return l};import{S as Y,i as H,s as O,G as Xe,H as Ye,I as He,J as Oe,x as k,u as y,V as ie,j as R,m as P,o as L,v as C,k as W,l as F,n as N,f as $,r as M,w as B,d as p,a2 as pe,D as ae,t as ce,g as ue,aa as Q,ab as q,ac as J,a as S,b as w,a7 as Z,K as x,e as j,c as V,ad as G,ae as ee,af as ge,ag as qe,A as re,X as te,a9 as ke,L as K,ah as be,ai as Je,Y as Ge,U as Ke,aj as Qe,a3 as Ze,h as xe,ak as et}from"../../../chunks/vendor-c302d6cd.js";import{f as fe,a as ye}from"../../../chunks/database-455ca249.js";import{c as oe,u as $e}from"../../../chunks/store-85d9d053.js";import{g as we}from"../../../chunks/navigation-51f4a605.js";import"../../../chunks/singletons-12a22614.js";const tt=l=>({boardDoc:l&2,isFetchingStrokes:l&1,strokesArray:l&4}),ve=l=>({boardDoc:l[1],fetchStrokes:l[3],isFetchingStrokes:l[0],strokesArray:l[2]});function nt(l){let e;const n=l[6].default,t=Xe(n,l,l[5],ve);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,i){t&&t.m(r,i),e=!0},p(r,[i]){t&&t.p&&(!e||i&39)&&Ye(t,n,r,r[5],e?Oe(n,r[5],i,tt):He(r[5]),ve)},i(r){e||(k(t,r),e=!0)},o(r){y(t,r),e=!1},d(r){t&&t.d(r)}}}function rt(l,e,n){let{$$slots:t={},$$scope:r}=e,{dbPath:i}=e,s=!1,c,o;async function a(){const f=await fe(i);n(1,c=f)}a();async function u(){n(0,s=!0),n(2,o=await ye(i+"/strokes"))}return l.$$set=f=>{"dbPath"in f&&n(4,i=f.dbPath),"$$scope"in f&&n(5,r=f.$$scope)},[s,c,o,u,i,r,t]}class ot extends Y{constructor(e){super();H(this,e,rt,nt,O,{dbPath:4})}}function Ae(l,e,n){const t=l.slice();return t[1]=e[n],t}function lt(l){let e;return{c(){e=ce("Eraser")},l(n){e=ue(n,"Eraser")},m(n,t){$(n,e,t)},d(n){n&&p(e)}}}function st(l){let e,n,t,r,i,s,c,o,a;return{c(){e=q("svg"),n=q("g"),t=q("path"),r=q("polygon"),s=q("path"),c=q("path"),a=W(),this.h()},l(u){e=J(u,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,":viewbox":!0,style:!0,"xml:space":!0});var f=S(e);n=J(f,"g",{});var d=S(n);t=J(d,"path",{d:!0}),S(t).forEach(p),r=J(d,"polygon",{style:!0,points:!0}),S(r).forEach(p),s=J(d,"path",{style:!0,d:!0}),S(s).forEach(p),c=J(d,"path",{style:!0,d:!0}),S(c).forEach(p),d.forEach(p),f.forEach(p),a=N(u),this.h()},h(){w(t,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
          L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),w(r,"style",i=`fill: ${l[1]};`),w(r,"points","50,211.978 38.879,175.24 61.122,175.24"),Z(s,"fill","#424242"),w(s,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
            l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),w(c,"style",o=`fill: ${l[1]};`),w(c,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
            c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
            c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),w(e,"preserveAspectRatio","none"),w(e,"version","1.1"),w(e,"id","Layer_1"),w(e,"xmlns","http://www.w3.org/2000/svg"),w(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),w(e,"x","0px"),w(e,"y","0px"),w(e,"width","16px"),w(e,"height","35px"),w(e,":viewbox","`0 0 100 230`"),Z(e,"enable-background","new 0 0 100 230"),w(e,"xml:space","preserve")},m(u,f){$(u,e,f),x(e,n),x(n,t),x(n,r),x(n,s),x(n,c),$(u,a,f)},p(u,f){f&1&&i!==(i=`fill: ${u[1]};`)&&w(r,"style",i),f&1&&o!==(o=`fill: ${u[1]};`)&&w(c,"style",o)},d(u){u&&p(e),u&&p(a)}}}function De(l){let e,n;return e=new ie({props:{$$slots:{default:[st]},$$scope:{ctx:l}}}),e.$on("click",function(){Q(oe.set({type:"pencil",color:l[1],lineWidth:3}))&&oe.set({type:"pencil",color:l[1],lineWidth:3}).apply(this,arguments)}),{c(){R(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,r){L(e,t,r),n=!0},p(t,r){l=t;const i={};r&17&&(i.$$scope={dirty:r,ctx:l}),e.$set(i)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function it(l){let e,n,t,r;e=new ie({props:{$$slots:{default:[lt]},$$scope:{ctx:l}}}),e.$on("click",oe.set({type:"eraser",color:"",lineWidth:40}));let i=l[0].pencilColors,s=[];for(let o=0;o<i.length;o+=1)s[o]=De(Ae(l,i,o));const c=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){R(e.$$.fragment),n=W();for(let o=0;o<s.length;o+=1)s[o].c();t=F()},l(o){P(e.$$.fragment,o),n=N(o);for(let a=0;a<s.length;a+=1)s[a].l(o);t=F()},m(o,a){L(e,o,a),$(o,n,a);for(let u=0;u<s.length;u+=1)s[u].m(o,a);$(o,t,a),r=!0},p(o,[a]){const u={};if(a&16&&(u.$$scope={dirty:a,ctx:o}),e.$set(u),a&1){i=o[0].pencilColors;let f;for(f=0;f<i.length;f+=1){const d=Ae(o,i,f);s[f]?(s[f].p(d,a),k(s[f],1)):(s[f]=De(d),s[f].c(),k(s[f],1),s[f].m(t.parentNode,t))}for(M(),f=i.length;f<s.length;f+=1)c(f);B()}},i(o){if(!r){k(e.$$.fragment,o);for(let a=0;a<i.length;a+=1)k(s[a]);r=!0}},o(o){y(e.$$.fragment,o),s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)y(s[a]);r=!1},d(o){C(e,o),o&&p(n),pe(s,o),o&&p(t)}}}function at(l,e,n){let t;return ae(l,$e,r=>n(0,t=r)),[t]}class ct extends Y{constructor(e){super();H(this,e,at,it,O,{})}}function le({points:l,color:e,lineWidth:n,isErasing:t},r=null,i,s){return new Promise(async c=>{for(let o=1;o<l.length;o++)se(l,o,t,i,e,n,s),r!==null&&await new Promise(a=>setTimeout(a,r));c()})}function se(l,e,n,t,r="white",i=3,s){ut(r,i,n,t);const c=l[e-1],o=c.unitX*s.width,a=c.unitY*s.height,u=l[e],f=u.unitX*s.width,d=u.unitY*s.height;t.beginPath(),t.moveTo(o,a),t.lineTo(f,d),t.stroke()}function ut(l,e,n,t){t.globalCompositeOperation=n?"destination-out":"source-over",t.strokeStyle=l,t.lineWidth=e,t.lineJoin="round",t.lineCap="round"}function de(l,{strokesArray:e,specialRedrawFunc:n}){let t=l.getContext("2d");l.style["background-color"]="#2e3131";const r=100;function i(){setTimeout(()=>{s(),n?n():c()},r)}function s(){let o,a;const u=document.getElementById("main-content"),f=u.clientHeight,d=u.clientWidth,m=4/3;d*(1/m)<f?(a=d,o=a*(1/m)):(o=f,a=o*m),l.width=a,l.height=o,window.addEventListener("resize",i)}function c(){for(const o of e)le(o,null,t,l)}return s(),n?n():c(),{destroy(){window.removeEventListener("resize",i)}}}const ft=function(){const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<20;n++)e+=l.charAt(Math.floor(Math.random()*l.length));return e};function dt(l){let e,n,t,r,i,s,c;return e=new ct({}),{c(){R(e.$$.fragment),n=W(),t=j("canvas")},l(o){P(e.$$.fragment,o),n=N(o),t=V(o,"CANVAS",{});var a=S(t);a.forEach(p)},m(o,a){L(e,o,a),$(o,n,a),$(o,t,a),l[7](t),i=!0,s||(c=[G(r=de.call(null,t,{strokesArray:l[0]})),ee(t,"touchstart",l[2]),ee(t,"touchmove",l[3]),ee(t,"touchend",l[4])],s=!0)},p(o,[a]){r&&Q(r.update)&&a&1&&r.update.call(null,{strokesArray:o[0]})},i(o){i||(k(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){C(e,o),o&&p(n),o&&p(t),l[7](null),s=!1,ge(c)}}}let Te=0,Ie=!1;function ht(l,e,n){let t;ae(l,oe,h=>n(11,t=h));let{strokesArray:r}=e;const i=qe();let s,c=[],o,a=!1,u={x:-1,y:-1},f={points:[]};re(()=>{n(5,s=o.getContext("2d"))});function d(h){h.touches.length>1||(h.touches[0].touchType,I(h,{isInitialContact:!0}))}function m(h){if(!!a){if(h.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}h.touches[0].touchType,I(h,{isInitialContact:!1})}}function A(h){!a||h.touches.length>0||(h.changedTouches[0].touchType,z(f),a=!1)}function g(h){a=!0,u={x:-1,y:-1},f={strokeNumber:r.length+1,startTime:Number(Te.toFixed(1)),color:t.color,lineWidth:t.lineWidth,isErasing:Ie,points:[],sessionID:"123"}}function I(h,{isInitialContact:T}){h.preventDefault(),T&&g();const E=ne(h);U(h,E)}function U(h,T){f.points.push({unitX:parseFloat(T.x/o.width).toFixed(4),unitY:parseFloat(T.y/o.height).toFixed(4)}),u.x!==-1&&u.y!==-1&&se([b(u),b(T)],1,Ie,s,t.color,t.lineWidth,o),u=T}function z(h){h.endTime=Number(Te.toFixed(1)),h.id=ft(),c.push(h),i("stroke-drawn",h)}function ne(h){const{left:T,top:E}=o.getBoundingClientRect();return{x:h.touches[0].pageX-T-window.scrollX,y:h.touches[0].pageY-E-window.scrollY}}function b({x:h,y:T}){return{unitX:h/o.width,unitY:T/o.height}}function v(){s.clearRect(0,0,o.scrollWidth,o.scrollHeight)}function D(h){te[h?"unshift":"push"](()=>{o=h,n(1,o)})}return l.$$set=h=>{"strokesArray"in h&&n(0,r=h.strokesArray)},l.$$.update=()=>{if(l.$$.dirty&99&&r&&s){console.log("strokesArray changed and NOT localStrokesArray");let h=c.length,T=r.length;if(h!==T)if(h<T)if(h===0){for(const E of r)le(E,null,s,o);n(6,c=[...r])}else for(let E=h;E<T;E++){const X=this.strokesArray[E];le(X,X.startTime!==X.endTime?this.$_getPointDuration(X):null,s,o),c.push(X)}else{const E=1e3;_.debounce(()=>{console.log("debounced board reset"),v(),n(6,c=[]),u={x:-1,y:-1};for(const Me of r)le(Me,null,s,o)},E)()}}},[r,o,d,m,A,s,c,D]}class Se extends Y{constructor(e){super();H(this,e,ht,dt,O,{strokesArray:0})}}function mt(l){let e,n,t,r,i,s,c;return{c(){e=j("canvas"),t=W(),r=j("audio"),this.h()},l(o){e=V(o,"CANVAS",{});var a=S(e);a.forEach(p),t=N(o),r=V(o,"AUDIO",{src:!0,style:!0});var u=S(r);u.forEach(p),this.h()},h(){ke(r.src,i=l[1])||w(r,"src",i),r.controls=!0,Z(r,"width","100%")},m(o,a){$(o,e,a),l[6](e),$(o,t,a),$(o,r,a),l[7](r),s||(c=[G(n=de.call(null,e,{strokesArray:l[0],handleResize:l[5]})),ee(e,"resized",l[5]),ee(r,"play",l[4])],s=!0)},p(o,[a]){n&&Q(n.update)&&a&1&&n.update.call(null,{strokesArray:o[0],handleResize:o[5]}),a&2&&!ke(r.src,i=o[1])&&w(r,"src",i)},i:K,o:K,d(o){o&&p(e),l[6](null),o&&p(t),o&&p(r),l[7](null),s=!1,ge(c)}}}let _t=1;function pt(l){return(l.endTime-l.startTime)/l.points.length}function gt(l,e,n){let{strokesArray:t}=e,{audioDownloadURL:r}=e,i,s=0,c,o,a,u;be(()=>{u&&clearTimeout(u)}),re(()=>{o=c.getContext("2d");const b=[];for(let v=0;v<t.length;v++)for(let D=1;D<t[v].points.length;D++){const h={strokeIndex:v,pointIndex:D};b.push(_e({startTime:f(h)},h))}i=b.sort((v,D)=>v.startTime-D.startTime)});function f({strokeIndex:b,pointIndex:v}){const D=t[b];return D.startTime+(v-1)*pt(D)}function d(){s=0,o.clearRect(0,0,c.width,c.height),m()}function m(){if(!!a&&(A(),s<i.length)){const b=i[s],v=1e3*(b.startTime-a.currentTime);u=setTimeout(m,v/_t)}}function A(){if(!a)return;const b=i[s];(!b||b.startTime>a.currentTime)&&(o.clearRect(0,0,c.width,c.height),s=0),g()}function g(){const{currentTime:b}=a;for(let v=s;v<i.length;v++){const D=i[v];if(D.startTime>b)break;I(D),s+=1}}function I({strokeIndex:b,pointIndex:v}){const D=t[b],T=D.lineWidth*(c.scrollWidth/1e3);se(D.points,v,D.isErasing,o,D.color,T,c)}function U(){return new Promise(async b=>{u?(s=0,this.syncStrokesToAudio()):this.renderFramesUntilCurrentTime(),b()})}function z(b){te[b?"unshift":"push"](()=>{c=b,n(2,c)})}function ne(b){te[b?"unshift":"push"](()=>{a=b,n(3,a)})}return l.$$set=b=>{"strokesArray"in b&&n(0,t=b.strokesArray),"audioDownloadURL"in b&&n(1,r=b.audioDownloadURL)},[t,r,c,a,d,U,z,ne]}class kt extends Y{constructor(e){super();H(this,e,gt,mt,O,{strokesArray:0,audioDownloadURL:1})}}function bt(l){let e;return{c(){e=ce("Play")},l(n){e=ue(n,"Play")},m(n,t){$(n,e,t)},d(n){n&&p(e)}}}function yt(l){let e,n,t,r,i,s,c,o,a,u;r=new ie({props:{$$slots:{default:[bt]},$$scope:{ctx:l}}}),r.$on("click",l[4]);function f(m){l[9](m)}let d={min:0,max:l[2].length+1,step:1,discrete:!0};return l[3]!==void 0&&(d.value=l[3]),s=new Je({props:d}),te.push(()=>Ge(s,"value",f)),{c(){e=j("canvas"),t=W(),R(r.$$.fragment),i=W(),R(s.$$.fragment)},l(m){e=V(m,"CANVAS",{});var A=S(e);A.forEach(p),t=N(m),P(r.$$.fragment,m),i=N(m),P(s.$$.fragment,m)},m(m,A){$(m,e,A),l[8](e),$(m,t,A),L(r,m,A),$(m,i,A),L(s,m,A),o=!0,a||(u=G(n=de.call(null,e,{strokesArray:l[0],onResize:l[5]})),a=!0)},p(m,[A]){n&&Q(n.update)&&A&1&&n.update.call(null,{strokesArray:m[0],onResize:m[5]});const g={};A&4096&&(g.$$scope={dirty:A,ctx:m}),r.$set(g);const I={};A&4&&(I.max=m[2].length+1),!c&&A&8&&(c=!0,I.value=m[3],Ke(()=>c=!1)),s.$set(I)},i(m){o||(k(r.$$.fragment,m),k(s.$$.fragment,m),o=!0)},o(m){y(r.$$.fragment,m),y(s.$$.fragment,m),o=!1},d(m){m&&p(e),l[8](null),m&&p(t),C(r,m),m&&p(i),C(s,m),a=!1,u()}}}let Ee=1;function $t(l,e,n){let{strokesArray:t}=e,r,i,s=[],c=0,o=0,a;be(()=>{a&&clearTimeout(a)}),re(()=>{n(6,i=r.getContext("2d"));const g=[];for(let I=0;I<t.length;I++)for(let U=1;U<t[I].points.length;U++){const z={strokeIndex:I,pointIndex:U};g.push(z)}n(2,s=g)});async function u(){if(console.log("sync recursively"),a||(i.clearRect(0,0,r.width,r.height),n(7,c=0),n(3,o=0)),console.log("nextFrameIdx =",c),c<s.length-1){const g=0;n(3,o+=1),a=setTimeout(u,g/Ee)}else clearTimeout(a),a=null,console.log("I expect it to be null recursiveSyncer =",a)}async function f(){console.log("resized"),i.clearRect(0,0,r.width,r.height);for(let g=0;g<=c;g++)await d(s[g],!0)}async function d({strokeIndex:g,pointIndex:I},U=!1){const z=t[g],b=z.lineWidth*(r.scrollWidth/1e3);se(z.points,I,z.isErasing,i,z.color,b,r),U||await new Promise(v=>setTimeout(v,10/Ee))}function m(g){te[g?"unshift":"push"](()=>{r=g,n(1,r)})}function A(g){o=g,n(3,o)}return l.$$set=g=>{"strokesArray"in g&&n(0,t=g.strokesArray)},l.$$.update=()=>{if(l.$$.dirty&206){if(c<o)for(let g=c;g<Math.min(o,s.length);g++)d(s[g],!1);else if(c>o){i.clearRect(0,0,r.width,r.height);for(let g=0;g<Math.min(o,s.length);g++)d(s[g],!0)}n(7,c=o)}},[t,r,s,o,u,f,i,c,m,A]}class wt extends Y{constructor(e){super();H(this,e,$t,yt,O,{strokesArray:0})}}function Re(l,e){let n=document.getElementById(e);return n==null||n.appendChild(l),{destroy(){l.remove()}}}function Pe(l,e,n){const t=l.slice();return t[10]=e[n],t}function Le(l,e,n){const t=l.slice();return t[3]=e[n],t}function Ce(l){let e,n,t,r,i,s=l[2],c=[];for(let a=0;a<s.length;a+=1)c[a]=We(Le(l,s,a));const o=a=>y(c[a],1,1,()=>{c[a]=null});return{c(){e=j("div");for(let a=0;a<c.length;a+=1)c[a].c()},l(a){e=V(a,"DIV",{});var u=S(e);for(let f=0;f<c.length;f+=1)c[f].l(u);u.forEach(p)},m(a,u){$(a,e,u);for(let f=0;f<c.length;f+=1)c[f].m(e,null);t=!0,r||(i=G(n=Re.call(null,e,"side-drawer-list")),r=!0)},p(a,u){if(u&7){s=a[2];let f;for(f=0;f<s.length;f+=1){const d=Le(a,s,f);c[f]?(c[f].p(d,u),k(c[f],1)):(c[f]=We(d),c[f].c(),k(c[f],1),c[f].m(e,null))}for(M(),f=s.length;f<c.length;f+=1)o(f);B()}},i(a){if(!t){for(let u=0;u<s.length;u+=1)k(c[u]);t=!0}},o(a){c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)y(c[u]);t=!1},d(a){a&&p(e),pe(c,a),r=!1,i()}}}function ze(l){let e,n;function t(){return l[5](l[3])}return e=new Ze({props:{selected:l[3].id===l[1],$$slots:{default:[vt]},$$scope:{ctx:l}}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(r){P(e.$$.fragment,r)},m(r,i){L(e,r,i),n=!0},p(r,i){l=r;const s={};i&6&&(s.selected=l[3].id===l[1]),i&524292&&(s.$$scope={dirty:i,ctx:l}),e.$set(s)},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){y(e.$$.fragment,r),n=!1},d(r){C(e,r)}}}function vt(l){let e=l[3].name+"",n,t;return{c(){n=ce(e),t=W()},l(r){n=ue(r,e),t=N(r)},m(r,i){$(r,n,i),$(r,t,i)},p(r,i){i&4&&e!==(e=r[3].name+"")&&xe(n,e)},d(r){r&&p(n),r&&p(t)}}}function We(l){let e,n,t=l[3].name&&ze(l);return{c(){t&&t.c(),e=F()},l(r){t&&t.l(r),e=F()},m(r,i){t&&t.m(r,i),$(r,e,i),n=!0},p(r,i){r[3].name?t?(t.p(r,i),i&4&&k(t,1)):(t=ze(r),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(M(),y(t,1,1,()=>{t=null}),B())},i(r){n||(k(t),n=!0)},o(r){y(t),n=!1},d(r){t&&t.d(r),r&&p(e)}}}function Fe(l){let e,n=[],t=new Map,r,i,s,c,o=l[3].blackboards;const a=u=>u[10];for(let u=0;u<o.length;u+=1){let f=Pe(l,o,u),d=a(f);t.set(d,n[u]=Ue(d,f))}return{c(){e=j("div");for(let u=0;u<n.length;u+=1)n[u].c();this.h()},l(u){e=V(u,"DIV",{style:!0});var f=S(e);for(let d=0;d<n.length;d+=1)n[d].l(f);f.forEach(p),this.h()},h(){Z(e,"height","100vh")},m(u,f){$(u,e,f);for(let d=0;d<n.length;d+=1)n[d].m(e,null);i=!0,s||(c=G(r=Re.call(null,e,"main-content")),s=!0)},p(u,f){f&122904&&(o=u[3].blackboards,M(),n=Qe(n,f,a,1,u,o,t,e,et,Ue,null,Pe),B())},i(u){if(!i){for(let f=0;f<o.length;f+=1)k(n[f]);i=!0}},o(u){for(let f=0;f<n.length;f+=1)y(n[f]);i=!1},d(u){u&&p(e);for(let f=0;f<n.length;f+=1)n[f].d();s=!1,c()}}}function At(l){let e,n,t,r;const i=[St,It,Tt],s=[];function c(o,a){return o[13].audioDownloadURL?0:o[13].creator?1:2}return e=c(l),n=s[e]=i[e](l),{c(){n.c(),t=F()},l(o){n.l(o),t=F()},m(o,a){s[e].m(o,a),$(o,t,a),r=!0},p(o,a){let u=e;e=c(o),e===u?s[e].p(o,a):(M(),y(s[u],1,1,()=>{s[u]=null}),B(),n=s[e],n?n.p(o,a):(n=s[e]=i[e](o),n.c()),k(n,1),n.m(t.parentNode,t))},i(o){r||(k(n),r=!0)},o(o){y(n),r=!1},d(o){s[e].d(o),o&&p(t)}}}function Dt(l){let e,n,t,r,i,s,c,o=l[15]&&Ne();return t=new Se({props:{strokesArray:[]}}),{c(){o&&o.c(),e=W(),n=j("div"),R(t.$$.fragment),this.h()},l(a){o&&o.l(a),e=N(a),n=V(a,"DIV",{style:!0});var u=S(n);P(t.$$.fragment,u),u.forEach(p),this.h()},h(){Z(n,"height","500px")},m(a,u){o&&o.m(a,u),$(a,e,u),$(a,n,u),L(t,n,null),i=!0,s||(c=G(r=Pt.call(null,n,l[14])),s=!0)},p(a,u){a[15]?o||(o=Ne(),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),r&&Q(r.update)&&u&16384&&r.update.call(null,a[14])},i(a){i||(k(t.$$.fragment,a),i=!0)},o(a){y(t.$$.fragment,a),i=!1},d(a){o&&o.d(a),a&&p(e),a&&p(n),C(t),s=!1,c()}}}function Tt(l){let e,n;return e=new Se({props:{strokesArray:l[16]}}),{c(){R(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,r){L(e,t,r),n=!0},p(t,r){const i={};r&65536&&(i.strokesArray=t[16]),e.$set(i)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function It(l){let e,n;return e=new wt({props:{strokesArray:l[16]}}),{c(){R(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,r){L(e,t,r),n=!0},p(t,r){const i={};r&65536&&(i.strokesArray=t[16]),e.$set(i)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function St(l){let e,n;return e=new kt({props:{strokesArray:l[16],audioDownloadURL:l[13].audioDownloadURL}}),{c(){R(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,r){L(e,t,r),n=!0},p(t,r){const i={};r&65536&&(i.strokesArray=t[16]),r&8192&&(i.audioDownloadURL=t[13].audioDownloadURL),e.$set(i)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){C(e,t)}}}function Ne(l){return{c:K,l:K,m:K,d:K}}function Et(l){let e,n,t,r;const i=[Dt,At],s=[];function c(o,a){return o[16]?o[13]?1:-1:0}return~(e=c(l))&&(n=s[e]=i[e](l)),{c(){n&&n.c(),t=W()},l(o){n&&n.l(o),t=N(o)},m(o,a){~e&&s[e].m(o,a),$(o,t,a),r=!0},p(o,a){let u=e;e=c(o),e===u?~e&&s[e].p(o,a):(n&&(M(),y(s[u],1,1,()=>{s[u]=null}),B()),~e?(n=s[e],n?n.p(o,a):(n=s[e]=i[e](o),n.c()),k(n,1),n.m(t.parentNode,t)):n=null)},i(o){r||(k(n),r=!0)},o(o){y(n),r=!1},d(o){~e&&s[e].d(o),o&&p(t)}}}function Ue(l,e){let n,t,r;return t=new ot({props:{dbPath:e[4]+e[10],$$slots:{default:[Et,({boardDoc:i,fetchStrokes:s,isFetchingStrokes:c,strokesArray:o})=>({13:i,14:s,15:c,16:o}),({boardDoc:i,fetchStrokes:s,isFetchingStrokes:c,strokesArray:o})=>(i?8192:0)|(s?16384:0)|(c?32768:0)|(o?65536:0)]},$$scope:{ctx:e}}}),{key:l,first:null,c(){n=F(),R(t.$$.fragment),this.h()},l(i){n=F(),P(t.$$.fragment,i),this.h()},h(){this.first=n},m(i,s){$(i,n,s),L(t,i,s),r=!0},p(i,s){e=i;const c={};s&8&&(c.dbPath=e[4]+e[10]),s&647168&&(c.$$scope={dirty:s,ctx:e}),t.$set(c)},i(i){r||(k(t.$$.fragment,i),r=!0)},o(i){y(t.$$.fragment,i),r=!1},d(i){i&&p(n),C(t,i)}}}function Rt(l){let e,n,t,r=l[2].length>0&&Ce(l),i=l[3]&&Fe(l);return{c(){r&&r.c(),e=W(),i&&i.c(),n=F()},l(s){r&&r.l(s),e=N(s),i&&i.l(s),n=F()},m(s,c){r&&r.m(s,c),$(s,e,c),i&&i.m(s,c),$(s,n,c),t=!0},p(s,[c]){s[2].length>0?r?(r.p(s,c),c&4&&k(r,1)):(r=Ce(s),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(M(),y(r,1,1,()=>{r=null}),B()),s[3]?i?(i.p(s,c),c&8&&k(i,1)):(i=Fe(s),i.c(),k(i,1),i.m(n.parentNode,n)):i&&(M(),y(i,1,1,()=>{i=null}),B())},i(s){t||(k(r),k(i),t=!0)},o(s){y(r),y(i),t=!1},d(s){r&&r.d(s),s&&p(e),i&&i.d(s),s&&p(n)}}}function Mt({page:l}){return console.log("load function from [room].svelte"),{props:{classID:l.params.class,roomID:l.params.room}}}function Pt(l,e){new IntersectionObserver(t=>{for(const r of t)if(r.isIntersecting){e();return}},{root:null,threshold:.1,rootMargin:"0px"}).observe(l)}function Lt(l,e,n){let t;ae(l,$e,d=>n(6,t=d));let{classID:r}=e,{roomID:i}=e,s,c=[];const o=`classes/${r}/blackboards/`,a=`classes/${r}/rooms/`;t.uid||(console.log("redirecting to tutorial"),we("/")),re(async()=>{n(2,c=await ye(a)),n(3,s=await fe(a+i))});async function u(){n(3,s=await fe(a+i))}const f=d=>we(`/${r}/${d.id}`);return l.$$set=d=>{"classID"in d&&n(0,r=d.classID),"roomID"in d&&n(1,i=d.roomID)},l.$$.update=()=>{l.$$.dirty&2&&u()},[r,i,c,s,o,f]}class Bt extends Y{constructor(e){super();H(this,e,Lt,Rt,O,{classID:0,roomID:1})}}export{Bt as default,Mt as load};
