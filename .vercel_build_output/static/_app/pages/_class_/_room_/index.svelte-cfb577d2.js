var It=Object.defineProperty;var Ge=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var Ye=(r,e,n)=>e in r?It(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,Le=(r,e)=>{for(var n in e||(e={}))Tt.call(e,n)&&Ye(r,n,e[n]);if(Ge)for(var n of Ge(e))At.call(e,n)&&Ye(r,n,e[n]);return r};import{S as de,i as pe,s as me,az as Lt,k as O,e as C,n as q,c as z,b as y,L as m,U as Pt,av as he,f as R,a0 as J,aA as _e,t as B,a as S,aB as ge,d,g as M,M as P,af as Ut,H as be,aa as St,j as V,m as j,o as W,aw as Et,ax as Nt,h as ae,I as ke,J as we,K as $e,x as I,u as T,v as F,a1 as Pe,E as X,a2 as Ue,ad as Ct,r as ie,w as ue,aC as Fe,A as Ke,aD as Se,N as ce,a4 as Je,P as Y,a5 as Ze,a6 as zt,W as xe,a3 as et,aE as Bt,R as tt,O as oe,aF as Mt,a8 as ot,at as Vt,au as jt,l as Z,aG as Wt,aH as Ft,aI as Oe,aJ as qe,aK as nt,aL as rt,_ as ne,aM as Ot,aN as qt,aO as Qt,a7 as Ht,aP as Xt,ae as Gt,aQ as ve,ay as ye,ah as st,Z as Yt,aR as Kt}from"../../../chunks/vendor-dda63b98.js";import{R as Jt,a as Zt,D as xt}from"../../../chunks/RenderlessFetchStrokes-7e6db0eb.js";import{_ as eo}from"../../../chunks/preload-helper-ec9aa979.js";import{o as Qe,u as lt,j as Ee,c as at,a as He,d as Ne,f as to,e as oo,k as Ce,g as no,l as ze}from"../../../chunks/navigation-85f32556.js";import{d as Be,r as ro,a as so}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const lo=r=>({}),it=r=>({});function ut(r,e,n){const t=r.slice();return t[11]=e[n],t}function ct(r){let e,n,t,o,s,l=r[2].pencilColors,u=[];for(let i=0;i<l.length;i+=1)u[i]=ft(ut(r,l,i));return{c(){for(let i=0;i<u.length;i+=1)u[i].c();e=O(),n=C("img"),this.h()},l(i){for(let a=0;a<u.length;a+=1)u[a].l(i);e=q(i),n=z(i,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){y(n,"width","46"),y(n,"height","33"),m(n,"margin-left","8px"),Pt(n.src,t="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||y(n,"src",t),y(n,"alt","eraser"),y(n,"class","svelte-1bgxyxs"),he(n,"eraser-selected",r[3].type==="eraser")},m(i,a){for(let c=0;c<u.length;c+=1)u[c].m(i,a);R(i,e,a),R(i,n,a),o||(s=J(n,"click",r[7]),o=!0)},p(i,a){if(a&12){l=i[2].pencilColors;let c;for(c=0;c<l.length;c+=1){const f=ut(i,l,c);u[c]?u[c].p(f,a):(u[c]=ft(f),u[c].c(),u[c].m(e.parentNode,e))}for(;c<u.length;c+=1)u[c].d(1);u.length=l.length}a&8&&he(n,"eraser-selected",i[3].type==="eraser")},d(i){Ut(u,i),i&&d(e),i&&d(n),o=!1,s()}}}function ft(r){let e,n,t,o,s,l,u,i,a,c,f,b;function w(){return r[6](r[11])}return{c(){e=C("div"),n=_e("svg"),t=_e("g"),o=_e("path"),s=B(`;\r
            `),l=_e("polygon"),i=_e("path"),a=_e("path"),this.h()},l(h){e=z(h,"DIV",{style:!0,class:!0});var p=S(e);n=ge(p,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var D=S(n);t=ge(D,"g",{});var _=S(t);o=ge(_,"path",{d:!0}),S(o).forEach(d),s=M(_,`;\r
            `),l=ge(_,"polygon",{style:!0,points:!0}),S(l).forEach(d),i=ge(_,"path",{style:!0,d:!0}),S(i).forEach(d),a=ge(_,"path",{style:!0,d:!0}),S(a).forEach(d),_.forEach(d),D.forEach(d),p.forEach(d),this.h()},h(){y(o,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),y(l,"style",u=`fill: ${r[11]};`),y(l,"points","50,211.978 38.879,175.24 61.122,175.24"),m(i,"fill","#424242"),y(i,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),y(a,"style",c=`fill: ${r[11]};`),y(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),y(n,"preserveAspectRatio","none"),y(n,"version","1.1"),y(n,"id","Layer_1"),y(n,"xmlns","http://www.w3.org/2000/svg"),y(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(n,"x","0px"),y(n,"y","0px"),y(n,"width","16px"),y(n,"height","30px"),y(n,"viewBox","0 0 100 230"),m(n,"enable-background","new 0 0 100 230"),y(n,"xml:space","preserve"),y(n,"class","svelte-1bgxyxs"),m(e,"margin","0 4px"),m(e,"width","30px"),m(e,"height","42px"),m(e,"border-radius","3px"),m(e,"align-items","center"),m(e,"display","flex"),m(e,"justify-content","center"),y(e,"class","svelte-1bgxyxs"),he(e,"pencil-selected",r[3].color===r[11])},m(h,p){R(h,e,p),P(e,n),P(n,t),P(t,o),P(t,s),P(t,l),P(t,i),P(t,a),f||(b=J(e,"click",w),f=!0)},p(h,p){r=h,p&4&&u!==(u=`fill: ${r[11]};`)&&y(l,"style",u),p&4&&c!==(c=`fill: ${r[11]};`)&&y(a,"style",c),p&12&&he(e,"pencil-selected",r[3].color===r[11])},d(h){h&&d(e),f=!1,b()}}}function ao(r){let e;const n=r[5]["dropdown-menu"],t=be(n,r,r[10],it);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&1024)&&ke(t,n,o,o[10],e?$e(n,o[10],s,lo):we(o[10]),it)},i(o){e||(I(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function io(r){let e,n;return e=new Ct({props:{$$slots:{default:[ao]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o&1024&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function uo(r){let e,n,t,o,s,l=(r[1]?"No touch":"Touch draw")+"",u,i,a=Object.keys(r[2]).length>0,c,f,b,w,h,p,D,_,k;t=new Lt({props:{icons:!1,checked:!r[1],style:"margin: 0 !important"}});let v=a&&ct(r);const Q=r[5].default,N=be(Q,r,r[10],null);let Re={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[io]},$$scope:{ctx:r}};return p=new St({props:Re}),r[9](p),{c(){e=C("div"),n=C("div"),V(t.$$.fragment),o=O(),s=C("div"),u=B(l),i=O(),v&&v.c(),c=O(),N&&N.c(),f=O(),b=C("span"),w=B("more_horiz"),h=O(),V(p.$$.fragment),this.h()},l(L){e=z(L,"DIV",{style:!0});var U=S(e);n=z(U,"DIV",{style:!0});var K=S(n);j(t.$$.fragment,K),o=q(K),s=z(K,"DIV",{style:!0});var ee=S(s);u=M(ee,l),ee.forEach(d),K.forEach(d),i=q(U),v&&v.l(U),c=q(U),N&&N.l(U),f=q(U),b=z(U,"SPAN",{class:!0,style:!0});var fe=S(b);w=M(fe,"more_horiz"),fe.forEach(d),h=q(U),j(p.$$.fragment,U),U.forEach(d),this.h()},h(){m(s,"margin-top","2px"),m(s,"font-size","0.55rem"),m(s,"font-family","Roboto,sans-serif"),m(s,"color","white"),m(n,"margin-right","10px"),m(n,"text-align","center"),y(b,"class","material-icons"),m(b,"margin-right","10px"),m(b,"color","white"),m(b,"font-size","2rem"),m(e,"position","absolute"),m(e,"display","flex"),m(e,"align-items","center"),m(e,"height","50px"),m(e,"left","0"),m(e,"right","auto"),m(e,"top","0"),m(e,"bottom","auto"),m(e,"z-index","100"),m(e,"background-color","grey"),m(e,"padding-left","10px"),m(e,"border-radius","2px")},m(L,U){R(L,e,U),P(e,n),W(t,n,null),P(n,o),P(n,s),P(s,u),P(e,i),v&&v.m(e,null),P(e,c),N&&N.m(e,null),P(e,f),P(e,b),P(b,w),P(e,h),W(p,e,null),D=!0,_||(k=[J(n,"click",Et(Nt(r[4]))),J(b,"click",r[8])],_=!0)},p(L,[U]){const K={};U&2&&(K.checked=!L[1]),t.$set(K),(!D||U&2)&&l!==(l=(L[1]?"No touch":"Touch draw")+"")&&ae(u,l),U&4&&(a=Object.keys(L[2]).length>0),a?v?v.p(L,U):(v=ct(L),v.c(),v.m(e,c)):v&&(v.d(1),v=null),N&&N.p&&(!D||U&1024)&&ke(N,Q,L,L[10],D?$e(Q,L[10],U,null):we(L[10]),null);const ee={};U&1024&&(ee.$$scope={dirty:U,ctx:L}),p.$set(ee)},i(L){D||(I(t.$$.fragment,L),I(N,L),I(p.$$.fragment,L),D=!0)},o(L){T(t.$$.fragment,L),T(N,L),T(p.$$.fragment,L),D=!1},d(L){L&&d(e),F(t),v&&v.d(),N&&N.d(L),r[9](null),F(p),_=!1,Pe(k)}}}function co(r,e,n){let t,o,s;X(r,Qe,h=>n(1,t=h)),X(r,lt,h=>n(2,o=h)),X(r,Ee,h=>n(3,s=h));let{$$slots:l={},$$scope:u}=e,i;function a(){Qe.set(!t)}const c=h=>Ee.set({type:"pencil",color:h,lineWidth:3}),f=()=>Ee.set({type:"eraser",color:"",lineWidth:40}),b=()=>i.setOpen(!0);function w(h){Ue[h?"unshift":"push"](()=>{i=h,n(0,i)})}return r.$$set=h=>{"$$scope"in h&&n(10,u=h.$$scope)},[i,t,o,s,a,l,c,f,b,w,u]}class fo extends de{constructor(e){super();pe(this,e,co,uo,me,{})}}const po=r=>({}),dt=r=>({slot:"dropdown-menu"});function pt(r){let e,n;return e=new fo({props:{$$slots:{"dropdown-menu":[ho],default:[mo]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o&131072&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function mo(r){let e;const n=r[14].default,t=be(n,r,r[17],null);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&131072)&&ke(t,n,o,o[17],e?$e(n,o[17],s,null):we(o[17]),null)},i(o){e||(I(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function ho(r){let e;const n=r[14]["dropdown-menu"],t=be(n,r,r[17],dt);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&131072)&&ke(t,n,o,o[17],e?$e(n,o[17],s,po):we(o[17]),dt)},i(o){e||(I(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function _o(r){let e,n,t,o,s,l,u,i,a,c=r[0]&&pt(r);return{c(){c&&c.c(),e=O(),n=C("canvas"),o=O(),s=C("canvas"),this.h()},l(f){c&&c.l(f),e=q(f),n=z(f,"CANVAS",{style:!0});var b=S(n);b.forEach(d),o=q(f),s=z(f,"CANVAS",{style:!0});var w=S(s);w.forEach(d),this.h()},h(){y(n,"style",t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[4]}px; height: ${r[3]}px`),y(s,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[4]}px; height: ${r[3]}px`)},m(f,b){c&&c.m(f,b),R(f,e,b),R(f,n,b),r[15](n),R(f,o,b),R(f,s,b),r[16](s),u=!0,i||(a=[J(n,"touchstart",r[5]),J(n,"touchmove",r[6]),J(n,"touchend",r[7])],i=!0)},p(f,[b]){f[0]?c?(c.p(f,b),b&1&&I(c,1)):(c=pt(f),c.c(),I(c,1),c.m(e.parentNode,e)):c&&(ie(),T(c,1,1,()=>{c=null}),ue()),(!u||b&24&&t!==(t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${f[4]}px; height: ${f[3]}px`))&&y(n,"style",t),(!u||b&24&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${f[4]}px; height: ${f[3]}px`))&&y(s,"style",l)},i(f){u||(I(c),u=!0)},o(f){T(c),u=!1},d(f){c&&c.d(f),f&&d(e),f&&d(n),r[15](null),f&&d(o),f&&d(s),r[16](null),i=!1,Pe(a)}}}function go(r){return(r.endTime-r.startTime)/r.points.length}function bo(r,e,n){let t,o,s,l;X(r,at,g=>n(3,t=g)),X(r,He,g=>n(4,o=g)),X(r,Ee,g=>n(21,s=g)),X(r,Qe,g=>n(22,l=g));let{$$slots:u={},$$scope:i}=e,{strokesArray:a}=e,{currentTime:c=0}=e,{backgroundImageDownloadURL:f=""}=e;const b=Fe();let w,h,p,D,_=[],k=!1,v={x:-1,y:-1},Q={points:[]},N;Ke(()=>{n(10,w=p.getContext("2d")),n(11,h=D.getContext("2d"))});function Re(g){if(g.touches.length>1)return;const E=g.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ee(g,{isInitialContact:!0})}function L(g){if(!k)return;if(g.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const E=g.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ee(g,{isInitialContact:!1})}function U(g){if(!k||g.touches.length>0)return;const E=g.changedTouches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}Te(Q),k=!1}function K(g){k=!0,v={x:-1,y:-1},Q={strokeNumber:a.length+1,startTime:Number(c.toFixed(1)),color:s.color,lineWidth:s.lineWidth,isErasing:s.type==="eraser",points:[],sessionID:"123"}}function ee(g,{isInitialContact:E}){g.preventDefault(),E&&K();const G=Me(g);fe(g,G)}function fe(g,E){Q.points.push({unitX:parseFloat(E.x/p.width).toFixed(4),unitY:parseFloat(E.y/p.height).toFixed(4)}),v.x!==-1&&v.y!==-1&&so([De(v),De(E)],1,s.type==="eraser",w,s.color,s.lineWidth,p),v=E}function Te(g){g.endTime=Number(c.toFixed(1)),g.id=Ne(),_.push(g),b("stroke-drawn",{newStroke:g})}function Me(g){const{left:E,top:G}=p.getBoundingClientRect();return{x:g.touches[0].pageX-E-window.scrollX,y:g.touches[0].pageY-G-window.scrollY}}function De({x:g,y:E}){return{unitX:g/p.width,unitY:E/p.height}}function Ae(){w.clearRect(0,0,o,t)}function Ve(g){Ue[g?"unshift":"push"](()=>{p=g,n(1,p),n(10,w),n(4,o),n(3,t),n(0,a)})}function je(g){Ue[g?"unshift":"push"](()=>{D=g,n(2,D),n(10,w),n(4,o),n(3,t),n(0,a),n(1,p)})}return r.$$set=g=>{"strokesArray"in g&&n(0,a=g.strokesArray),"currentTime"in g&&n(8,c=g.currentTime),"backgroundImageDownloadURL"in g&&n(9,f=g.backgroundImageDownloadURL),"$$scope"in g&&n(17,i=g.$$scope)},r.$$.update=()=>{if(r.$$.dirty&1051&&w&&(n(1,p.width=o,p),n(1,p.height=t,p),n(2,D.width=o,D),n(2,D.height=t,D),a))for(const g of a)Be(g,null,w,p);if(r.$$.dirty&2566&&h&&(h.clearRect(0,0,D.scrollWidth,D.scrollHeight),ro(f,p,h)),r.$$.dirty&13315&&w&&a){let g=_.length,E=a.length;if(g!==E)if(g<E)if(g===0){for(const G of a)Be(G,null,w,p);n(12,_=[...a])}else for(let G=g;G<E;G++){const se=a[G];Be(se,se.startTime!==se.endTime?go(se):null,w,p),_.push(se)}else{let G=function(){Ae(),n(12,_=[]),v={x:-1,y:-1};for(const We of a)Be(We,null,w,p)};(function(){console.log("debounced board reset"),N&&clearTimeout(N),n(13,N=setTimeout(G,1e3))})()}}},[a,p,D,t,o,Re,L,U,c,f,w,h,_,N,u,Ve,je,i]}class ko extends de{constructor(e){super();pe(this,e,bo,_o,me,{strokesArray:0,currentTime:8,backgroundImageDownloadURL:9})}}const wo=r=>({currentTime:r&1}),mt=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function $o(r){let e;const n=r[4].default,t=be(n,r,r[3],mt);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,[s]){t&&t.p&&(!e||s&9)&&ke(t,n,o,o[3],e?$e(n,o[3],s,wo):we(o[3]),mt)},i(o){e||(I(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function vo(r,e,n){let t,o;X(r,to,h=>n(8,t=h)),X(r,oo,h=>n(9,o=h));let{$$slots:s={},$$scope:l}=e,u,i=0,a;Ke(async()=>{window&&(u=await eo(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=u.default)});const c=Fe();let f=null;function b(){return new Promise(async(h,p)=>{if(!o.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),p("Cannot start recording because mic stream is muted");return}const D=t.clone();f=new MediaRecorder(D),f.start(),a=setInterval(()=>n(0,i+=.1),100),c("record-start"),Ce.set("mid_record"),h()})}function w(){return new Promise((h,p)=>{clearTimeout(a),Ce.set("post_record"),f.addEventListener("dataavailable",D=>{const _=D.data;c("record-end",{audioBlob:_}),h()}),f.stop();for(const D of f.stream.getTracks())D.stop()})}return r.$$set=h=>{"$$scope"in h&&n(3,l=h.$$scope)},[i,b,w,l,s]}class yo extends de{constructor(e){super();pe(this,e,vo,$o,me,{})}}function Ro(r,e){let n=document.getElementById(e);return n==null||n.appendChild(r),{destroy(){r.remove()}}}function ht(r,e){let n=new IntersectionObserver(t=>{for(const o of t)if(o.isIntersecting){e(),n.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});n.observe(r)}function Do(r){let e,n,t,o;return{c(){e=C("div"),n=C("textarea"),this.h()},l(s){e=z(s,"DIV",{class:!0,style:!0});var l=S(e);n=z(l,"TEXTAREA",{style:!0,class:!0}),S(n).forEach(d),l.forEach(d),this.h()},h(){n.value=r[0],m(n,"box-sizing","border-box"),m(n,"width",r[2]+"px"),m(n,"padding","6px"),m(n,"border-radius","2px"),m(n,"font-family","Roboto, sans-serif"),m(n,"color","rgb(60 55 56 / 87%)"),y(n,"class","svelte-tv3wak"),y(e,"class","grow-wrap svelte-tv3wak"),m(e,"font-family","Roboto, sans-serif"),m(e,"margin","10px 0px")},m(s,l){R(s,e,l),P(e,n),r[6](e),t||(o=[J(n,"input",r[5]),Se(r[4].call(null,e))],t=!0)},p(s,[l]){l&1&&(n.value=s[0]),l&4&&m(n,"width",s[2]+"px")},i:ce,o:ce,d(s){s&&d(e),r[6](null),t=!1,Pe(o)}}}function Io(r,e,n){let t;X(r,He,c=>n(2,t=c));let{value:o}=e,s;const l=Fe();function u(c){c.dataset.replicatedValue=o}const i=c=>{n(1,s.dataset.replicatedValue=c.target.value,s),l("input",c.target.value)};function a(c){Ue[c?"unshift":"push"](()=>{s=c,n(1,s)})}return r.$$set=c=>{"value"in c&&n(0,o=c.value)},[o,s,t,l,u,i,a]}class To extends de{constructor(e){super();pe(this,e,Io,Do,me,{value:0})}}const Ao=r=>({strokesArray:r&1}),_t=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function Lo(r){let e;const n=r[6].default,t=be(n,r,r[5],_t);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,[s]){t&&t.p&&(!e||s&33)&&ke(t,n,o,o[5],e?$e(n,o[5],s,Ao):we(o[5]),_t)},i(o){e||(I(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function gt(r){const e=Le({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function Po(r,e,n){let{$$slots:t={},$$scope:o}=e,{dbPath:s}=e,l,u;const i=Je(Y(),`${s}/strokes`),a=Ze(i,zt("timestamp"));xe(()=>{u&&u()});async function c(){u=et(a,async w=>{w.docChanges().filter(p=>p.type==="removed").length>0?(n(0,l=[]),await Bt(),w.docs.length>0&&w.docs.forEach(p=>{l.push(gt(p))})):(l||n(0,l=[]),w.docs.length===l.length||w.docChanges().filter(p=>p.type==="added").forEach(p=>{n(0,l=[...l,gt(p.doc)])}))})}function f(w){l.push(w);try{tt(oe(Y(),`${s}/strokes/${w.id}`),Le({timestamp:Mt()},w))}catch(h){alert(h)}}async function b(){return new Promise(async w=>{const h=[];let p=ot(Y()),D=0;for(const _ of l){D>=500&&(h.push(p.commit()),p=ot(Y()),D=0);const k=oe(Y(),`${s}/strokes/${_.id}`);p.delete(k),D+=1}h.push(p.commit()),await Promise.all(h),n(0,l=[]),w()})}return r.$$set=w=>{"dbPath"in w&&n(4,s=w.dbPath),"$$scope"in w&&n(5,o=w.$$scope)},[l,c,f,b,s,o,t]}class Uo extends de{constructor(e){super();pe(this,e,Po,Lo,me,{dbPath:4})}}function bt(r,e,n){const t=r.slice();return t[36]=e[n],t}function kt(r){let e,n,t,o,s,l=[],u=new Map,i,a,c,f,b,w,h;n=new Wt({props:{disabled:re(r[0].name)&&r[0].askerUID&&r[5].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[6]}px;`,$$slots:{helper:[zo]},$$scope:{ctx:r}}}),n.$on("input",r[19]);let p=r[0].blackboards;const D=_=>_[36];for(let _=0;_<p.length;_+=1){let k=bt(r,p,_),v=D(k);u.set(v,l[_]=yt(v,k))}return{c(){e=C("div"),V(n.$$.fragment),t=O(),o=C("div"),s=O();for(let _=0;_<l.length;_+=1)l[_].c();i=O(),a=C("div"),c=B("New blackboard"),this.h()},l(_){e=z(_,"DIV",{style:!0});var k=S(e);j(n.$$.fragment,k),t=q(k),o=z(k,"DIV",{style:!0}),S(o).forEach(d),s=q(k);for(let Q=0;Q<l.length;Q+=1)l[Q].l(k);i=q(k),a=z(k,"DIV",{style:!0});var v=S(a);c=M(v,"New blackboard"),v.forEach(d),k.forEach(d),this.h()},h(){m(o,"margin-bottom","20px"),m(a,"display","flex"),m(a,"justify-content","center"),m(a,"align-items","center"),m(a,"margin-top","40px"),m(a,"background-color","#2e3131"),m(a,"font-family","Roboto, sans-serif"),m(a,"text-transform","uppercase"),m(a,"height","35px"),m(e,"padding","16px"),he(e,"question",re(r[0].name))},m(_,k){R(_,e,k),W(n,e,null),P(e,t),P(e,o),P(e,s);for(let v=0;v<l.length;v+=1)l[v].m(e,null);P(e,i),P(e,a),P(a,c),b=!0,w||(h=[J(a,"click",r[16]),Se(f=Ro.call(null,e,"main-content"))],w=!0)},p(_,k){const v={};k[0]&33&&(v.disabled=re(_[0].name)&&_[0].askerUID&&_[5].uid!==_[0].askerUID),k[0]&1&&(v.value=_[0].name),k[0]&64&&(v.style=`width: ${_[6]}px;`),k[0]&31|k[1]&131072&&(v.$$scope={dirty:k,ctx:_}),n.$set(v),k[0]&61409|k[1]&122624&&(p=_[0].blackboards,ie(),l=Vt(l,k,D,1,_,p,u,e,jt,yt,i,bt),ue()),k[0]&1&&he(e,"question",re(_[0].name))},i(_){if(!b){I(n.$$.fragment,_);for(let k=0;k<p.length;k+=1)I(l[k]);b=!0}},o(_){T(n.$$.fragment,_);for(let k=0;k<l.length;k+=1)T(l[k]);b=!1},d(_){_&&d(e),F(n);for(let k=0;k<l.length;k+=1)l[k].d();w=!1,Pe(h)}}}function So(r){let e=r[0].askerName+"",n,t,o=ze(r[0].dateAsked)+"",s;return{c(){n=B(e),t=B(" asked on "),s=B(o)},l(l){n=M(l,e),t=M(l," asked on "),s=M(l,o)},m(l,u){R(l,n,u),R(l,t,u),R(l,s,u)},p(l,u){u[0]&1&&e!==(e=l[0].askerName+"")&&ae(n,e),u[0]&1&&o!==(o=ze(l[0].dateAsked)+"")&&ae(s,o)},d(l){l&&d(n),l&&d(t),l&&d(s)}}}function Eo(r){let e,n,t;return{c(){e=B("Resolving this question in "),n=B(r[4]),t=B(", cancel by re-adding ?")},l(o){e=M(o,"Resolving this question in "),n=M(o,r[4]),t=M(o,", cancel by re-adding ?")},m(o,s){R(o,e,s),R(o,n,s),R(o,t,s)},p(o,s){s[0]&16&&ae(n,o[4])},d(o){o&&d(e),o&&d(n),o&&d(t)}}}function No(r){let e,n,t;return{c(){e=B("Pinging server members in "),n=B(r[2]),t=B(", cancel by backtracking the ?")},l(o){e=M(o,"Pinging server members in "),n=M(o,r[2]),t=M(o,", cancel by backtracking the ?")},m(o,s){R(o,e,s),R(o,n,s),R(o,t,s)},p(o,s){s[0]&4&&ae(n,o[2])},d(o){o&&d(e),o&&d(n),o&&d(t)}}}function wt(r){let e,n=ze(r[0].dateResolved)+"",t;return{c(){e=B(", resolved "),t=B(n)},l(o){e=M(o,", resolved "),t=M(o,n)},m(o,s){R(o,e,s),R(o,t,s)},p(o,s){s[0]&1&&n!==(n=ze(o[0].dateResolved)+"")&&ae(t,n)},d(o){o&&d(e),o&&d(t)}}}function Co(r){let e,n;function t(u,i){if(u[1])return No;if(u[3])return Eo;if(u[0].askerName&&u[0].askerUID&&u[0].date)return So}let o=t(r),s=o&&o(r),l=r[0].dateResolved&&wt(r);return{c(){s&&s.c(),e=O(),l&&l.c(),n=Z()},l(u){s&&s.l(u),e=q(u),l&&l.l(u),n=Z()},m(u,i){s&&s.m(u,i),R(u,e,i),l&&l.m(u,i),R(u,n,i)},p(u,i){o===(o=t(u))&&s?s.p(u,i):(s&&s.d(1),s=o&&o(u),s&&(s.c(),s.m(e.parentNode,e))),u[0].dateResolved?l?l.p(u,i):(l=wt(u),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(u){s&&s.d(u),u&&d(e),l&&l.d(u),u&&d(n)}}}function zo(r){let e,n;return e=new Ft({props:{slot:"helper",persistent:!0,$$slots:{default:[Co]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&31|o[1]&131072&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function $t(r){let e,n,t,o,s,l;function u(...f){return r[20](r[36],...f)}e=new To({props:{value:r[39].description||""}}),e.$on("input",u);const i=[Mo,Bo],a=[];function c(f,b){return f[39].audioDownloadURL?0:1}return t=c(r),o=a[t]=i[t](r),{c(){V(e.$$.fragment),n=O(),o.c(),s=Z()},l(f){j(e.$$.fragment,f),n=q(f),o.l(f),s=Z()},m(f,b){W(e,f,b),R(f,n,b),a[t].m(f,b),R(f,s,b),l=!0},p(f,b){r=f;const w={};b[1]&256&&(w.value=r[39].description||""),e.$set(w);let h=t;t=c(r),t===h?a[t].p(r,b):(ie(),T(a[h],1,1,()=>{a[h]=null}),ue(),o=a[t],o?o.p(r,b):(o=a[t]=i[t](r),o.c()),I(o,1),o.m(s.parentNode,s))},i(f){l||(I(e.$$.fragment,f),I(o),l=!0)},o(f){T(e.$$.fragment,f),T(o),l=!1},d(f){F(e,f),f&&d(n),a[t].d(f),f&&d(s)}}}function Bo(r){let e,n;return e=new Uo({props:{dbPath:r[9]+r[36],$$slots:{default:[Xo,({listenToStrokes:t,strokesArray:o,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>({43:t,41:o,44:s,42:l}),({listenToStrokes:t,strokesArray:o,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>[0,(t?4096:0)|(o?1024:0)|(s?8192:0)|(l?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&1&&(s.dbPath=t[9]+t[36]),o[0]&449|o[1]&138496&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Mo(r){let e,n;return e=new Zt({props:{dbPath:r[9]+r[36],$$slots:{default:[Ko,({fetchStrokes:t,strokesArray:o,deleteAllStrokesFromDb:s})=>({40:t,41:o,42:s}),({fetchStrokes:t,strokesArray:o,deleteAllStrokesFromDb:s})=>[0,(t?512:0)|(o?1024:0)|(s?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&1&&(s.dbPath=t[9]+t[36]),o[0]&224|o[1]&132864&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Vo(r){let e,n,t;return n=new Kt({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(o){e=z(o,"DIV",{style:!0});var s=S(e);j(n.$$.fragment,s),s.forEach(d),this.h()},h(){m(e,"display","flex"),m(e,"justify-content","center"),m(e,"margin-left","20px"),m(e,"margin-right","20px")},m(o,s){R(o,e,s),W(n,e,null),t=!0},p:ce,i(o){t||(I(n.$$.fragment,o),t=!0)},o(o){T(n.$$.fragment,o),t=!1},d(o){o&&d(e),F(n)}}}function jo(r){let e,n,t,o;return{c(){e=C("span"),n=B("stop_circle"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);n=M(l,"stop_circle"),l.forEach(d),this.h()},h(){y(e,"class","material-icons"),m(e,"font-size","2.5rem"),m(e,"color","cyan"),m(e,"margin-left","30px"),m(e,"margin-right","26px")},m(s,l){R(s,e,l),P(e,n),t||(o=J(e,"click",function(){ye(r[46])&&r[46].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&d(e),t=!1,o()}}}function Wo(r){let e,n,t,o;return{c(){e=C("span"),n=B("radio_button_checked"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);n=M(l,"radio_button_checked"),l.forEach(d),this.h()},h(){y(e,"class","material-icons"),m(e,"font-size","2.5rem"),m(e,"color","cyan"),m(e,"margin-left","30px"),m(e,"margin-right","26px")},m(s,l){R(s,e,l),P(e,n),t||(o=J(e,"click",function(){ye(r[45])&&r[45].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&d(e),t=!1,o()}}}function Fo(r){let e,n,t,o;const s=[Wo,jo,Vo],l=[];function u(i,a){return i[8]==="pre_record"?0:i[8]==="mid_record"?1:2}return e=u(r),n=l[e]=s[e](r),{c(){n.c(),t=Z()},l(i){n.l(i),t=Z()},m(i,a){l[e].m(i,a),R(i,t,a),o=!0},p(i,a){let c=e;e=u(i),e===c?l[e].p(i,a):(ie(),T(l[c],1,1,()=>{l[c]=null}),ue(),n=l[e],n?n.p(i,a):(n=l[e]=s[e](i),n.c()),I(n,1),n.m(t.parentNode,t))},i(i){o||(I(n),o=!0)},o(i){T(n),o=!1},d(i){l[e].d(i),i&&d(t)}}}function Oo(r){let e;return{c(){e=B("Wipe board")},l(n){e=M(n,"Wipe board")},m(n,t){R(n,e,t)},d(n){n&&d(e)}}}function qo(r){let e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"",n,t,o,s,l,u;function i(...a){return r[22](r[39],...a)}return{c(){n=B(e),t=O(),o=C("input"),this.h()},l(a){n=M(a,e),t=q(a),o=z(a,"INPUT",{id:!0,style:!0,type:!0,accept:!0}),this.h()},h(){y(o,"id",s="input-"+r[39].id),m(o,"display","none"),y(o,"type","file"),y(o,"accept","image/gif, image/jpeg, image/png")},m(a,c){R(a,n,c),R(a,t,c),R(a,o,c),l||(u=J(o,"change",i),l=!0)},p(a,c){r=a,c[1]&256&&e!==(e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"")&&ae(n,e),c[1]&256&&s!==(s="input-"+r[39].id)&&y(o,"id",s)},d(a){a&&d(n),a&&d(t),a&&d(o),l=!1,u()}}}function Qo(r){let e,n,t,o,s;return n=new st({props:{slot:"dropdown-menu",$$slots:{default:[Oo]},$$scope:{ctx:r}}}),n.$on("SMUI:action",function(){ye(r[42])&&r[42].apply(this,arguments)}),o=new st({props:{$$slots:{default:[qo]},$$scope:{ctx:r}}}),o.$on("click",function(){ye(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id))&&(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id)).apply(this,arguments)}),{c(){e=C("div"),V(n.$$.fragment),t=O(),V(o.$$.fragment),this.h()},l(l){e=z(l,"DIV",{slot:!0});var u=S(e);j(n.$$.fragment,u),t=q(u),j(o.$$.fragment,u),u.forEach(d),this.h()},h(){y(e,"slot","dropdown-menu")},m(l,u){R(l,e,u),W(n,e,null),P(e,t),W(o,e,null),s=!0},p(l,u){r=l;const i={};u[1]&131072&&(i.$$scope={dirty:u,ctx:r}),n.$set(i);const a={};u[1]&131328&&(a.$$scope={dirty:u,ctx:r}),o.$set(a)},i(l){s||(I(n.$$.fragment,l),I(o.$$.fragment,l),s=!0)},o(l){T(n.$$.fragment,l),T(o.$$.fragment,l),s=!1},d(l){l&&d(e),F(n),F(o)}}}function Ho(r){let e,n;function t(...o){return r[23](r[44],...o)}return e=new ko({props:{strokesArray:r[41],currentTime:r[47],backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{"dropdown-menu":[Qo],default:[Fo]},$$scope:{ctx:r}}}),e.$on("stroke-drawn",t),{c(){V(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,s){W(e,o,s),n=!0},p(o,s){r=o;const l={};s[1]&1024&&(l.strokesArray=r[41]),s[1]&65536&&(l.currentTime=r[47]),s[1]&256&&(l.backgroundImageDownloadURL=r[39].backgroundImageDownloadURL),s[0]&256|s[1]&182528&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(o){n||(I(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){F(e,o)}}}function Xo(r){let e,n,t,o,s,l,u;function i(...a){return r[24](r[36],...a)}return n=new yo({props:{$$slots:{default:[Ho,({startRecording:a,stopRecording:c,currentTime:f})=>({45:a,46:c,47:f}),({startRecording:a,stopRecording:c,currentTime:f})=>[0,(a?16384:0)|(c?32768:0)|(f?65536:0)]]},$$scope:{ctx:r}}}),n.$on("record-end",i),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(a){e=z(a,"DIV",{style:!0});var c=S(e);j(n.$$.fragment,c),c.forEach(d),this.h()},h(){y(e,"style",t=`width: ${r[6]}px; height: ${r[7]}px; position: relative`)},m(a,c){R(a,e,c),W(n,e,null),s=!0,l||(u=Se(o=ht.call(null,e,r[43])),l=!0)},p(a,c){r=a;const f={};c[0]&256|c[1]&249088&&(f.$$scope={dirty:c,ctx:r}),n.$set(f),(!s||c[0]&192&&t!==(t=`width: ${r[6]}px; height: ${r[7]}px; position: relative`))&&y(e,"style",t),o&&ye(o.update)&&c[1]&4096&&o.update.call(null,r[43])},i(a){s||(I(n.$$.fragment,a),s=!0)},o(a){T(n.$$.fragment,a),s=!1},d(a){a&&d(e),F(n),l=!1,u()}}}function vt(r){let e,n;function t(){return r[21](r[39],r[42])}return e=new Yt({props:{color:"primary",$$slots:{default:[Go]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,s){W(e,o,s),n=!0},p(o,s){r=o;const l={};s[1]&131072&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(o){n||(I(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){F(e,o)}}}function Go(r){let e;return{c(){e=B("Delete video")},l(n){e=M(n,"Delete video")},m(n,t){R(n,e,t)},d(n){n&&d(e)}}}function Yo(r){let e,n,t=r[5].uid===r[39].creatorUID&&vt(r);return{c(){t&&t.c(),e=Z()},l(o){t&&t.l(o),e=Z()},m(o,s){t&&t.m(o,s),R(o,e,s),n=!0},p(o,s){o[5].uid===o[39].creatorUID?t?(t.p(o,s),s[0]&32|s[1]&256&&I(t,1)):(t=vt(o),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(I(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&d(e)}}}function Ko(r){let e,n,t,o,s,l,u;return n=new xt({props:{strokesArray:r[41],audioDownloadURL:r[39].audioDownloadURL,backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{default:[Yo]},$$scope:{ctx:r}}}),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(i){e=z(i,"DIV",{style:!0});var a=S(e);j(n.$$.fragment,a),a.forEach(d),this.h()},h(){y(e,"style",t=`width: ${r[6]}px; height: ${r[7]+40}px; position: relative`)},m(i,a){R(i,e,a),W(n,e,null),s=!0,l||(u=Se(o=ht.call(null,e,r[40])),l=!0)},p(i,a){const c={};a[1]&1024&&(c.strokesArray=i[41]),a[1]&256&&(c.audioDownloadURL=i[39].audioDownloadURL),a[1]&256&&(c.backgroundImageDownloadURL=i[39].backgroundImageDownloadURL),a[0]&32|a[1]&131328&&(c.$$scope={dirty:a,ctx:i}),n.$set(c),(!s||a[0]&192&&t!==(t=`width: ${i[6]}px; height: ${i[7]+40}px; position: relative`))&&y(e,"style",t),o&&ye(o.update)&&a[1]&512&&o.update.call(null,i[40])},i(i){s||(I(n.$$.fragment,i),s=!0)},o(i){T(n.$$.fragment,i),s=!1},d(i){i&&d(e),F(n),l=!1,u()}}}function Jo(r){let e,n,t=r[39]&&$t(r);return{c(){t&&t.c(),e=O()},l(o){t&&t.l(o),e=q(o)},m(o,s){t&&t.m(o,s),R(o,e,s),n=!0},p(o,s){o[39]?t?(t.p(o,s),s[1]&256&&I(t,1)):(t=$t(o),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(I(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&d(e)}}}function yt(r,e){let n,t,o;return t=new Jt({props:{dbPath:e[9]+e[36],$$slots:{default:[Jo,({boardDoc:s})=>({39:s}),({boardDoc:s})=>[0,s?256:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){n=Z(),V(t.$$.fragment),this.h()},l(s){n=Z(),j(t.$$.fragment,s),this.h()},h(){this.first=n},m(s,l){R(s,n,l),W(t,s,l),o=!0},p(s,l){e=s;const u={};l[0]&1&&(u.dbPath=e[9]+e[36]),l[0]&481|l[1]&131328&&(u.$$scope={dirty:l,ctx:e}),t.$set(u)},i(s){o||(I(t.$$.fragment,s),o=!0)},o(s){T(t.$$.fragment,s),o=!1},d(s){s&&d(n),F(t,s)}}}function Zo(r){let e,n,t=r[0]&&kt(r);return{c(){t&&t.c(),e=Z()},l(o){t&&t.l(o),e=Z()},m(o,s){t&&t.m(o,s),R(o,e,s),n=!0},p(o,s){o[0]?t?(t.p(o,s),s[0]&1&&I(t,1)):(t=kt(o),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(I(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&d(e)}}}async function an({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Rt(r){document.getElementById(`input-${r}`).click()}function re(r){return r?r.charAt(r.length-1)==="?":!1}function Xe(r){return r.askerName&&r.dateAsked&&r.askerUID}function xo(r,e,n){let t,o,s,l,u;X(r,lt,$=>n(5,o=$)),X(r,He,$=>n(6,s=$)),X(r,at,$=>n(7,l=$)),X(r,Ce,$=>n(8,u=$));let{classID:i}=e,{roomID:a}=e,c,f;const b=`classes/${i}/blackboards/`,w=`classes/${i}/rooms/`;o.uid||no("/");async function h($,A){const x=oe(Y(),b+A),H=$.target.files[0];if(!!H)if(H.type.split("/")[0]==="image"){const le=Oe(),te=qe(le,`images/${Ne()}`);await nt(te,H);const Ie=await rt(te);ne(x,{backgroundImageDownloadURL:Ie})}else alert("Error: only images can be used")}function p($){const A=oe(Y(),b+$);ne(A,{backgroundImageDownloadURL:ve()})}let D="",_=5,k,v=5;async function Q({srcElement:$}){const{value:A}=$,x={name:A};!re(f.name)&&re(A)&&!Xe(f)?N():D&&!re(A)?K():!re(A)&&Xe(f)?Re():k&&re(A)&&Xe(f)&&U(),await ne(t,x)}function N(){n(2,_=5),n(1,D=setInterval(()=>{n(2,_-=1),_===0&&(ee(),fe(),K())},1e3))}function Re(){n(4,v=5),n(3,k=setInterval(()=>{n(4,v-=1),v===0&&L()},1e3))}function L(){ne(t,{dateResolved:new Date().toISOString()})}function U(){clearTimeout(k),n(3,k="")}function K(){clearTimeout(D),n(1,D="")}function ee(){ne(t,{askerName:o.name||"Beaver #999",askerUID:o.uid,dateAsked:new Date().toISOString()})}async function fe(){const $=[],A=Ot(),x=qt(A,"sendTextMessage"),H=Je(Y(),"users"),le=Ze(H,Qt("willReceiveText","==",!0)),te=await Ht(le);if(te.docs)for(const Ie of te.docs){console.log("phoneNumber =",Ie.data().phoneNumber);try{Ie.id!==o.uid&&$.push(x({content:`${o.name} asked on https://ihtfp.app: "${f.name||"Fake question here"}"`,toWho:Ie.data().phoneNumber}))}catch(Dt){alert(Dt)}}await Promise.all($),console.log("success, sent all texts.")}async function Te({detail:$},A){const x=oe(Y(),b+A);await ne(x,{description:$})}async function Me(){c&&c(),c=et(t,$=>{n(0,f=Le({id:$.id},$.data()))})}xe(()=>{c()});async function De($,A){const x=Oe(),H=qe(x,`audio/${Ne()}`);await nt(H,$);const le=await rt(H),te=oe(Y(),b+A);await ne(te,{creatorUID:o.uid,creatorPhoneNumber:o.phoneNumber,date:new Date().toISOString(),audioDownloadURL:le,audioRefFullPath:H.fullPath}),Ce.set("pre_record")}async function Ae({id:$,audioRefFullPath:A},x){const H=[],le=oe(Y(),b+$);if(A){const te=qe(Oe(),A);H.push(Xt(te))}H.push(ne(le,{creator:ve(),creatorPhoneNumber:ve(),date:ve(),audioDownloadURL:ve(),audioRefFullPath:ve()})),H.push(x()),await Promise.all(H)}async function Ve(){const $=Ne(),A=oe(Y(),b+$);await Promise.all([tt(A,{}),ne(t,{blackboards:Gt($)})])}const je=$=>Q($),g=($,A)=>Te(A,$),E=($,A)=>Ae($,A),G=($,A)=>h(A,$.id),se=($,A)=>$(A.detail.newStroke),We=($,A)=>De(A.detail.audioBlob,$);return r.$$set=$=>{"classID"in $&&n(17,i=$.classID),"roomID"in $&&n(18,a=$.roomID)},r.$$.update=()=>{r.$$.dirty[0]&262144&&(t=oe(Y(),w+a)),r.$$.dirty[0]&262144&&Me()},[f,D,_,k,v,o,s,l,u,b,h,p,Q,Te,De,Ae,Ve,i,a,je,g,E,G,se,We]}class un extends de{constructor(e){super();pe(this,e,xo,Zo,me,{classID:17,roomID:18},null,[-1,-1])}}export{un as default,an as load};
