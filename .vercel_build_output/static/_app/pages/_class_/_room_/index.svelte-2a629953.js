var zt=Object.defineProperty;var ot=Object.getOwnPropertySymbols;var Ft=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable;var nt=(s,e,n)=>e in s?zt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,ye=(s,e)=>{for(var n in e||(e={}))Ft.call(e,n)&&nt(s,n,e[n]);if(ot)for(var n of ot(e))Vt.call(e,n)&&nt(s,n,e[n]);return s};import{S as ae,i as ue,s as ce,aw as Bt,k as q,e as z,n as Q,c as F,b as D,L as _,U as qe,as as Te,f as R,a3 as x,ax as Ae,t as M,a as N,ay as Pe,d as h,g as j,M as U,a8 as Wt,H as fe,a6 as Mt,j as X,m as G,o as Y,at as jt,au as Ot,h as ve,I as de,J as pe,K as me,x as T,u as P,v as K,a4 as Ce,E as ee,Z as De,a7 as qt,r as $e,w as Re,az as Qe,A as He,N as be,ad as Xe,O as re,P as H,an as Ge,aA as ze,ak as Ye,al as Ke,am as st,aB as rt,aC as Fe,aD as Qt,R as lt,aE as Ht,aq as Xt,ar as Gt,l as ne,Y as Yt,a5 as Kt,aF as Je,aG as Ze,aH as it,aI as at,_ as he,aJ as Jt,aK as Zt,aL as xt,aM as eo,aN as to,aO as Se,av as Le,a9 as ut,a0 as oo,aP as no}from"../../../chunks/vendor-22b599bd.js";import{_ as so}from"../../../chunks/preload-helper-ec9aa979.js";import{o as xe,u as ct,f as Ve,a as et,c as Be,g as We,e as ft,j as Me,k as je}from"../../../chunks/store-86428912.js";/* empty css                                                                         */import{d as Ue,r as dt,a as pt,g as ro}from"../../../chunks/canvas-226d237d.js";import"../../../chunks/singletons-12a22614.js";const lo=s=>({}),mt=s=>({});function ht(s,e,n){const o=s.slice();return o[11]=e[n],o}function _t(s){let e,n,o,t,r,l=s[2].pencilColors,a=[];for(let u=0;u<l.length;u+=1)a[u]=gt(ht(s,l,u));return{c(){for(let u=0;u<a.length;u+=1)a[u].c();e=q(),n=z("img"),this.h()},l(u){for(let i=0;i<a.length;i+=1)a[i].l(u);e=Q(u),n=F(u,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){D(n,"width","46"),D(n,"height","33"),_(n,"margin-left","8px"),qe(n.src,o="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||D(n,"src",o),D(n,"alt","eraser"),D(n,"class","svelte-1bgxyxs"),Te(n,"eraser-selected",s[3].type==="eraser")},m(u,i){for(let c=0;c<a.length;c+=1)a[c].m(u,i);R(u,e,i),R(u,n,i),t||(r=x(n,"click",s[7]),t=!0)},p(u,i){if(i&12){l=u[2].pencilColors;let c;for(c=0;c<l.length;c+=1){const f=ht(u,l,c);a[c]?a[c].p(f,i):(a[c]=gt(f),a[c].c(),a[c].m(e.parentNode,e))}for(;c<a.length;c+=1)a[c].d(1);a.length=l.length}i&8&&Te(n,"eraser-selected",u[3].type==="eraser")},d(u){Wt(a,u),u&&h(e),u&&h(n),t=!1,r()}}}function gt(s){let e,n,o,t,r,l,a,u,i,c,f,p;function m(){return s[6](s[11])}return{c(){e=z("div"),n=Ae("svg"),o=Ae("g"),t=Ae("path"),r=M(`;\r
            `),l=Ae("polygon"),u=Ae("path"),i=Ae("path"),this.h()},l(g){e=F(g,"DIV",{style:!0,class:!0});var d=N(e);n=Pe(d,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var $=N(n);o=Pe($,"g",{});var b=N(o);t=Pe(b,"path",{d:!0}),N(t).forEach(h),r=j(b,`;\r
            `),l=Pe(b,"polygon",{style:!0,points:!0}),N(l).forEach(h),u=Pe(b,"path",{style:!0,d:!0}),N(u).forEach(h),i=Pe(b,"path",{style:!0,d:!0}),N(i).forEach(h),b.forEach(h),$.forEach(h),d.forEach(h),this.h()},h(){D(t,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),D(l,"style",a=`fill: ${s[11]};`),D(l,"points","50,211.978 38.879,175.24 61.122,175.24"),_(u,"fill","#424242"),D(u,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),D(i,"style",c=`fill: ${s[11]};`),D(i,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),D(n,"preserveAspectRatio","none"),D(n,"version","1.1"),D(n,"id","Layer_1"),D(n,"xmlns","http://www.w3.org/2000/svg"),D(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),D(n,"x","0px"),D(n,"y","0px"),D(n,"width","16px"),D(n,"height","30px"),D(n,"viewBox","0 0 100 230"),_(n,"enable-background","new 0 0 100 230"),D(n,"xml:space","preserve"),D(n,"class","svelte-1bgxyxs"),_(e,"margin","0 4px"),_(e,"width","30px"),_(e,"height","42px"),_(e,"border-radius","3px"),_(e,"align-items","center"),_(e,"display","flex"),_(e,"justify-content","center"),D(e,"class","svelte-1bgxyxs"),Te(e,"pencil-selected",s[3].color===s[11])},m(g,d){R(g,e,d),U(e,n),U(n,o),U(o,t),U(o,r),U(o,l),U(o,u),U(o,i),f||(p=x(e,"click",m),f=!0)},p(g,d){s=g,d&4&&a!==(a=`fill: ${s[11]};`)&&D(l,"style",a),d&4&&c!==(c=`fill: ${s[11]};`)&&D(i,"style",c),d&12&&Te(e,"pencil-selected",s[3].color===s[11])},d(g){g&&h(e),f=!1,p()}}}function io(s){let e;const n=s[5]["dropdown-menu"],o=fe(n,s,s[10],mt);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,r){o&&o.p&&(!e||r&1024)&&de(o,n,t,t[10],e?me(n,t[10],r,lo):pe(t[10]),mt)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function ao(s){let e,n;return e=new qt({props:{$$slots:{default:[io]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,t){Y(e,o,t),n=!0},p(o,t){const r={};t&1024&&(r.$$scope={dirty:t,ctx:o}),e.$set(r)},i(o){n||(T(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function uo(s){let e,n,o,t,r,l=(s[1]?"No touch":"Touch draw")+"",a,u,i=Object.keys(s[2]).length>0,c,f,p,m,g,d,$,b,w;o=new Bt({props:{icons:!1,checked:!s[1],style:"margin: 0 !important"}});let v=i&&_t(s);const L=s[5].default,k=fe(L,s,s[10],null);let V={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[ao]},$$scope:{ctx:s}};return d=new Mt({props:V}),s[9](d),{c(){e=z("div"),n=z("div"),X(o.$$.fragment),t=q(),r=z("div"),a=M(l),u=q(),v&&v.c(),c=q(),k&&k.c(),f=q(),p=z("span"),m=M("more_horiz"),g=q(),X(d.$$.fragment),this.h()},l(S){e=F(S,"DIV",{style:!0});var E=N(e);n=F(E,"DIV",{style:!0});var J=N(n);G(o.$$.fragment,J),t=Q(J),r=F(J,"DIV",{style:!0});var Z=N(r);a=j(Z,l),Z.forEach(h),J.forEach(h),u=Q(E),v&&v.l(E),c=Q(E),k&&k.l(E),f=Q(E),p=F(E,"SPAN",{class:!0,style:!0});var le=N(p);m=j(le,"more_horiz"),le.forEach(h),g=Q(E),G(d.$$.fragment,E),E.forEach(h),this.h()},h(){_(r,"margin-top","2px"),_(r,"font-size","0.55rem"),_(r,"font-family","Roboto,sans-serif"),_(r,"color","white"),_(n,"margin-right","10px"),_(n,"text-align","center"),D(p,"class","material-icons"),_(p,"margin-right","10px"),_(p,"color","white"),_(p,"font-size","2rem"),_(e,"position","absolute"),_(e,"display","flex"),_(e,"align-items","center"),_(e,"height","50px"),_(e,"left","0"),_(e,"right","auto"),_(e,"top","0"),_(e,"bottom","auto"),_(e,"z-index","100"),_(e,"background-color","grey"),_(e,"padding-left","10px"),_(e,"border-radius","2px")},m(S,E){R(S,e,E),U(e,n),Y(o,n,null),U(n,t),U(n,r),U(r,a),U(e,u),v&&v.m(e,null),U(e,c),k&&k.m(e,null),U(e,f),U(e,p),U(p,m),U(e,g),Y(d,e,null),$=!0,b||(w=[x(n,"click",jt(Ot(s[4]))),x(p,"click",s[8])],b=!0)},p(S,[E]){const J={};E&2&&(J.checked=!S[1]),o.$set(J),(!$||E&2)&&l!==(l=(S[1]?"No touch":"Touch draw")+"")&&ve(a,l),E&4&&(i=Object.keys(S[2]).length>0),i?v?v.p(S,E):(v=_t(S),v.c(),v.m(e,c)):v&&(v.d(1),v=null),k&&k.p&&(!$||E&1024)&&de(k,L,S,S[10],$?me(L,S[10],E,null):pe(S[10]),null);const Z={};E&1024&&(Z.$$scope={dirty:E,ctx:S}),d.$set(Z)},i(S){$||(T(o.$$.fragment,S),T(k,S),T(d.$$.fragment,S),$=!0)},o(S){P(o.$$.fragment,S),P(k,S),P(d.$$.fragment,S),$=!1},d(S){S&&h(e),K(o),v&&v.d(),k&&k.d(S),s[9](null),K(d),b=!1,Ce(w)}}}function co(s,e,n){let o,t,r;ee(s,xe,g=>n(1,o=g)),ee(s,ct,g=>n(2,t=g)),ee(s,Ve,g=>n(3,r=g));let{$$slots:l={},$$scope:a}=e,u;function i(){xe.set(!o)}const c=g=>Ve.set({type:"pencil",color:g,lineWidth:3}),f=()=>Ve.set({type:"eraser",color:"",lineWidth:40}),p=()=>u.setOpen(!0);function m(g){De[g?"unshift":"push"](()=>{u=g,n(0,u)})}return s.$$set=g=>{"$$scope"in g&&n(10,a=g.$$scope)},[u,o,t,r,i,l,c,f,p,m,a]}class fo extends ae{constructor(e){super();ue(this,e,co,uo,ce,{})}}const po=s=>({}),bt=s=>({slot:"dropdown-menu"});function kt(s){let e,n;return e=new fo({props:{$$slots:{"dropdown-menu":[ho],default:[mo]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,t){Y(e,o,t),n=!0},p(o,t){const r={};t&131072&&(r.$$scope={dirty:t,ctx:o}),e.$set(r)},i(o){n||(T(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function mo(s){let e;const n=s[14].default,o=fe(n,s,s[17],null);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,r){o&&o.p&&(!e||r&131072)&&de(o,n,t,t[17],e?me(n,t[17],r,null):pe(t[17]),null)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function ho(s){let e;const n=s[14]["dropdown-menu"],o=fe(n,s,s[17],bt);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,r){o&&o.p&&(!e||r&131072)&&de(o,n,t,t[17],e?me(n,t[17],r,po):pe(t[17]),bt)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function _o(s){let e,n,o,t,r,l,a,u,i,c=s[0]&&kt(s);return{c(){c&&c.c(),e=q(),n=z("canvas"),t=q(),r=z("canvas"),this.h()},l(f){c&&c.l(f),e=Q(f),n=F(f,"CANVAS",{style:!0});var p=N(n);p.forEach(h),t=Q(f),r=F(f,"CANVAS",{style:!0});var m=N(r);m.forEach(h),this.h()},h(){D(n,"style",o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${s[4]}px; height: ${s[3]}px`),D(r,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${s[4]}px; height: ${s[3]}px`)},m(f,p){c&&c.m(f,p),R(f,e,p),R(f,n,p),s[15](n),R(f,t,p),R(f,r,p),s[16](r),a=!0,u||(i=[x(n,"touchstart",s[5]),x(n,"touchmove",s[6]),x(n,"touchend",s[7])],u=!0)},p(f,[p]){f[0]?c?(c.p(f,p),p&1&&T(c,1)):(c=kt(f),c.c(),T(c,1),c.m(e.parentNode,e)):c&&($e(),P(c,1,1,()=>{c=null}),Re()),(!a||p&24&&o!==(o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${f[4]}px; height: ${f[3]}px`))&&D(n,"style",o),(!a||p&24&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${f[4]}px; height: ${f[3]}px`))&&D(r,"style",l)},i(f){a||(T(c),a=!0)},o(f){P(c),a=!1},d(f){c&&c.d(f),f&&h(e),f&&h(n),s[15](null),f&&h(t),f&&h(r),s[16](null),u=!1,Ce(i)}}}function go(s){return(s.endTime-s.startTime)/s.points.length}function bo(s,e,n){let o,t,r,l;ee(s,et,y=>n(3,o=y)),ee(s,Be,y=>n(4,t=y)),ee(s,Ve,y=>n(21,r=y)),ee(s,xe,y=>n(22,l=y));let{$$slots:a={},$$scope:u}=e,{strokesArray:i}=e,{currentTime:c=0}=e,{backgroundImageDownloadURL:f=""}=e;const p=Qe();let m,g,d,$,b=[],w=!1,v={x:-1,y:-1},L={points:[]},k;He(()=>{n(10,m=d.getContext("2d")),n(11,g=$.getContext("2d"))});function V(y){if(y.touches.length>1)return;const W=y.touches[0].touchType==="stylus";if(l&&!W){console.log("error: cannot use finger during Apple Pencil mode");return}Z(y,{isInitialContact:!0})}function S(y){if(!w)return;if(y.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const W=y.touches[0].touchType==="stylus";if(l&&!W){console.log("error: cannot use finger during Apple Pencil mode");return}Z(y,{isInitialContact:!1})}function E(y){if(!w||y.touches.length>0)return;const W=y.changedTouches[0].touchType==="stylus";if(l&&!W){console.log("error: cannot use finger during Apple Pencil mode");return}Ie(L),w=!1}function J(y){w=!0,v={x:-1,y:-1},L={strokeNumber:i.length+1,startTime:Number(c.toFixed(1)),color:r.color,lineWidth:r.lineWidth,isErasing:r.type==="eraser",points:[],sessionID:"123"}}function Z(y,{isInitialContact:W}){y.preventDefault(),W&&J();const oe=Ee(y);le(y,oe)}function le(y,W){L.points.push({unitX:parseFloat(W.x/d.width).toFixed(4),unitY:parseFloat(W.y/d.height).toFixed(4)}),v.x!==-1&&v.y!==-1&&pt([ke(v),ke(W)],1,r.type==="eraser",m,r.color,r.lineWidth,d),v=W}function Ie(y){y.endTime=Number(c.toFixed(1)),y.id=We(),b.push(y),p("stroke-drawn",{newStroke:y})}function Ee(y){const{left:W,top:oe}=d.getBoundingClientRect();return{x:y.touches[0].pageX-W-window.scrollX,y:y.touches[0].pageY-oe-window.scrollY}}function ke({x:y,y:W}){return{unitX:y/d.width,unitY:W/d.height}}function A(){m.clearRect(0,0,t,o)}function B(y){De[y?"unshift":"push"](()=>{d=y,n(1,d),n(10,m),n(4,t),n(3,o),n(0,i)})}function O(y){De[y?"unshift":"push"](()=>{$=y,n(2,$),n(10,m),n(4,t),n(3,o),n(0,i),n(1,d)})}return s.$$set=y=>{"strokesArray"in y&&n(0,i=y.strokesArray),"currentTime"in y&&n(8,c=y.currentTime),"backgroundImageDownloadURL"in y&&n(9,f=y.backgroundImageDownloadURL),"$$scope"in y&&n(17,u=y.$$scope)},s.$$.update=()=>{if(s.$$.dirty&1051&&m&&(n(1,d.width=t,d),n(1,d.height=o,d),n(2,$.width=t,$),n(2,$.height=o,$),i))for(const y of i)Ue(y,null,m,d);if(s.$$.dirty&2566&&g&&(g.clearRect(0,0,$.scrollWidth,$.scrollHeight),dt(f,d,g)),s.$$.dirty&13315&&m&&i){let y=b.length,W=i.length;if(y!==W)if(y<W)if(y===0){for(const oe of i)Ue(oe,null,m,d);n(12,b=[...i])}else for(let oe=y;oe<W;oe++){const ge=i[oe];Ue(ge,ge.startTime!==ge.endTime?go(ge):null,m,d),b.push(ge)}else{let oe=function(){A(),n(12,b=[]),v={x:-1,y:-1};for(const Oe of i)Ue(Oe,null,m,d)};(function(){console.log("debounced board reset"),k&&clearTimeout(k),n(13,k=setTimeout(oe,1e3))})()}}},[i,d,$,o,t,V,S,E,c,f,m,g,b,k,a,B,O,u]}class ko extends ae{constructor(e){super();ue(this,e,bo,_o,ce,{strokesArray:0,currentTime:8,backgroundImageDownloadURL:9})}}function wt(s){let e,n,o,t;return{c(){e=z("span"),n=M("play_circle"),this.h()},l(r){e=F(r,"SPAN",{class:!0,style:!0});var l=N(e);n=j(l,"play_circle"),l.forEach(h),this.h()},h(){D(e,"class","material-icons overlay-center svelte-12w6n3q"),_(e,"color","white"),_(e,"font-size","6rem"),_(e,"width","120px"),_(e,"height","120px"),_(e,"z-index","5")},m(r,l){R(r,e,l),U(e,n),o||(t=x(e,"click",s[9]),o=!0)},p:be,d(r){r&&h(e),o=!1,t()}}}function wo(s){let e,n,o,t,r,l,a,u,i,c,f,p,m,g,d,$,b;const w=s[17].default,v=fe(w,s,s[16],null);let L=!s[8]&&s[6]===!1&&s[0]&&wt(s);return{c(){e=z("div"),v&&v.c(),n=q(),L&&L.c(),o=q(),t=z("div"),r=z("canvas"),a=q(),u=z("canvas"),c=q(),f=z("div"),p=z("audio"),this.h()},l(k){e=F(k,"DIV",{style:!0});var V=N(e);v&&v.l(V),V.forEach(h),n=Q(k),L&&L.l(k),o=Q(k),t=F(k,"DIV",{style:!0});var S=N(t);r=F(S,"CANVAS",{style:!0});var E=N(r);E.forEach(h),a=Q(S),u=F(S,"CANVAS",{style:!0});var J=N(u);J.forEach(h),S.forEach(h),c=Q(k),f=F(k,"DIV",{});var Z=N(f);p=F(Z,"AUDIO",{src:!0,style:!0});var le=N(p);le.forEach(h),Z.forEach(h),this.h()},h(){_(e,"position","absolute"),_(e,"right","0"),_(e,"left","auto"),_(e,"top","0"),_(e,"bottom","auto"),_(e,"display","flex"),_(e,"padding-top","4px"),_(e,"padding-bottom","4px"),_(e,"z-index","5"),D(r,"style",l=`position: absolute; z-index: 1; z-index: 1; margin-top: 0; margin-left: 0; width: ${s[5]}px; height: ${s[4]}px; background-color: transparent`),D(u,"style",i=`position: absolute;
    top: 0;
    left: 0;
    z-index: 0;
    display: block;
    background-color: rgb(46, 49, 49); width: ${s[5]}px; height: ${s[4]}px`),_(t,"position","relative"),qe(p.src,m=s[1])||D(p,"src",m),p.controls=!0,D(p,"style",g=`width: ${s[5]}px; height: 40px; position: absolute; bottom: 0; top: auto;`)},m(k,V){R(k,e,V),v&&v.m(e,null),R(k,n,V),L&&L.m(k,V),R(k,o,V),R(k,t,V),U(t,r),s[18](r),U(t,a),U(t,u),s[19](u),R(k,c,V),R(k,f,V),U(f,p),s[20](p),d=!0,$||(b=[x(p,"play",s[10]),x(p,"seeking",s[11])],$=!0)},p(k,[V]){v&&v.p&&(!d||V&65536)&&de(v,w,k,k[16],d?me(w,k[16],V,null):pe(k[16]),null),!k[8]&&k[6]===!1&&k[0]?L?L.p(k,V):(L=wt(k),L.c(),L.m(o.parentNode,o)):L&&(L.d(1),L=null),(!d||V&48&&l!==(l=`position: absolute; z-index: 1; z-index: 1; margin-top: 0; margin-left: 0; width: ${k[5]}px; height: ${k[4]}px; background-color: transparent`))&&D(r,"style",l),(!d||V&48&&i!==(i=`position: absolute;
    top: 0;
    left: 0;
    z-index: 0;
    display: block;
    background-color: rgb(46, 49, 49); width: ${k[5]}px; height: ${k[4]}px`))&&D(u,"style",i),(!d||V&2&&!qe(p.src,m=k[1]))&&D(p,"src",m),(!d||V&32&&g!==(g=`width: ${k[5]}px; height: 40px; position: absolute; bottom: 0; top: auto;`))&&D(p,"style",g)},i(k){d||(T(v,k),d=!0)},o(k){P(v,k),d=!1},d(k){k&&h(e),v&&v.d(k),k&&h(n),L&&L.d(k),k&&h(o),k&&h(t),s[18](null),s[19](null),k&&h(c),k&&h(f),s[20](null),$=!1,Ce(b)}}}let yt=2;function yo(s){return(s.endTime-s.startTime)/s.points.length}function vo(s,e,n){let o,t;ee(s,et,A=>n(4,o=A)),ee(s,Be,A=>n(5,t=A));let{$$slots:r={},$$scope:l}=e,{strokesArray:a}=e,{audioDownloadURL:u}=e,{backgroundImageDownloadURL:i}=e,c=!1,f,p,m,g,d,$,b,w;He(()=>{n(14,d=m.getContext("2d")),n(15,$=g.getContext("2d"))}),Xe(()=>{w&&clearTimeout(w)});function v(){for(const B of a)Ue(B,null,d,m);const A=[];for(let B=0;B<a.length;B++)for(let O=1;O<a[B].points.length;O++){const y={strokeIndex:B,pointIndex:O};A.push(ye({startTime:k(y)},y))}n(13,f=A.sort((B,O)=>B.startTime-O.startTime))}function L(){n(7,b.playbackRate=yt,b),b.play()}function k({strokeIndex:A,pointIndex:B}){const O=a[A];return O.startTime+(B-1)*yo(O)}function V(){n(6,c=!0),p=0,d.clearRect(0,0,t,o),S()}function S(){if(!!b&&(E(),p<f.length)){const A=f[p],B=1e3*(A.startTime-b.currentTime);n(8,w=setTimeout(S,B/yt))}}function E(){if(!b)return;const A=f[p];(!A||A.startTime>b.currentTime)&&(d.clearRect(0,0,m.width,m.height),p=0),J()}function J(){const{currentTime:A}=b;for(let B=p;B<f.length;B++){const O=f[B];if(O.startTime>A)break;Z(O),p+=1}}function Z({strokeIndex:A,pointIndex:B}){const O=a[A],W=O.lineWidth*(m.scrollWidth/1e3);pt(O.points,B,O.isErasing,d,O.color,W,m)}function le(){return new Promise(async A=>{if(w)p=0,E();else for(const B of a)Ue(B,null,d,m);A()})}function Ie(A){De[A?"unshift":"push"](()=>{m=A,n(2,m),n(14,d),n(5,t),n(4,o),n(0,a)})}function Ee(A){De[A?"unshift":"push"](()=>{g=A,n(3,g),n(14,d),n(5,t),n(4,o),n(0,a)})}function ke(A){De[A?"unshift":"push"](()=>{b=A,n(7,b)})}return s.$$set=A=>{"strokesArray"in A&&n(0,a=A.strokesArray),"audioDownloadURL"in A&&n(1,u=A.audioDownloadURL),"backgroundImageDownloadURL"in A&&n(12,i=A.backgroundImageDownloadURL),"$$scope"in A&&n(16,l=A.$$scope)},s.$$.update=()=>{s.$$.dirty&16433&&d&&(n(2,m.width=t,m),n(2,m.height=o,m),n(3,g.width=t,g),n(3,g.height=o,g),a&&le()),s.$$.dirty&24577&&d&&a&&!f&&v(),s.$$.dirty&36876&&$&&($.clearRect(0,0,g.scrollWidth,g.scrollHeight),dt(i,m,$))},[a,u,m,g,o,t,c,b,w,L,V,E,i,f,d,$,l,r,Ie,Ee,ke]}class Do extends ae{constructor(e){super();ue(this,e,vo,wo,ce,{strokesArray:0,audioDownloadURL:1,backgroundImageDownloadURL:12})}}const $o=s=>({currentTime:s&1}),vt=s=>({startRecording:s[1],stopRecording:s[2],currentTime:s[0]});function Ro(s){let e;const n=s[4].default,o=fe(n,s,s[3],vt);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,[r]){o&&o.p&&(!e||r&9)&&de(o,n,t,t[3],e?me(n,t[3],r,$o):pe(t[3]),vt)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function Io(s,e,n){let o;ee(s,ft,m=>n(8,o=m));let{$$slots:t={},$$scope:r}=e,l,a=0,u;He(async()=>{window&&(l=await so(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=l.default)});const i=Qe();let c=null;function f(){return new Promise(async m=>{if(!o){const d=await navigator.mediaDevices.getUserMedia({audio:!0});ft.set(d)}const g=o.clone();c=new MediaRecorder(g),c.start(),u=setInterval(()=>n(0,a+=.1),100),i("record-start"),Me.set("mid_record"),m()})}function p(){return new Promise((m,g)=>{clearTimeout(u),Me.set("post_record"),c.addEventListener("dataavailable",d=>{const $=d.data;i("record-end",{audioBlob:$}),m()}),c.stop();for(const d of c.stream.getTracks())d.stop()})}return s.$$set=m=>{"$$scope"in m&&n(3,r=m.$$scope)},[a,f,p,r,t]}class To extends ae{constructor(e){super();ue(this,e,Io,Ro,ce,{})}}const Ao=s=>({boardDoc:s&1}),Dt=s=>({boardDoc:s[0]});function Po(s){let e;const n=s[3].default,o=fe(n,s,s[2],Dt);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,[r]){o&&o.p&&(!e||r&5)&&de(o,n,t,t[2],e?me(n,t[2],r,Ao):pe(t[2]),Dt)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function So(s,e,n){let{$$slots:o={},$$scope:t}=e,{dbPath:r}=e,l;const a=re(H(),r);return Ge(a,u=>{n(0,l=ye({id:u.id},u.data()))}),s.$$set=u=>{"dbPath"in u&&n(1,r=u.dbPath),"$$scope"in u&&n(2,t=u.$$scope)},[l,r,t,o]}class Lo extends ae{constructor(e){super();ue(this,e,So,Po,ce,{dbPath:1})}}function Uo(s){let e,n,o,t;return{c(){e=z("div"),n=z("textarea"),this.h()},l(r){e=F(r,"DIV",{class:!0,style:!0});var l=N(e);n=F(l,"TEXTAREA",{style:!0,class:!0}),N(n).forEach(h),l.forEach(h),this.h()},h(){n.value=s[0],_(n,"box-sizing","border-box"),_(n,"width",s[2]+"px"),_(n,"padding","6px"),_(n,"border-radius","2px"),_(n,"font-family","Roboto, sans-serif"),_(n,"color","rgb(60 55 56 / 87%)"),D(n,"class","svelte-tv3wak"),D(e,"class","grow-wrap svelte-tv3wak"),_(e,"font-family","Roboto, sans-serif"),_(e,"margin","10px 0px")},m(r,l){R(r,e,l),U(e,n),s[6](e),o||(t=[x(n,"input",s[5]),ze(s[4].call(null,e))],o=!0)},p(r,[l]){l&1&&(n.value=r[0]),l&4&&_(n,"width",r[2]+"px")},i:be,o:be,d(r){r&&h(e),s[6](null),o=!1,Ce(t)}}}function Eo(s,e,n){let o;ee(s,Be,c=>n(2,o=c));let{value:t}=e,r;const l=Qe();function a(c){c.dataset.replicatedValue=t}const u=c=>{n(1,r.dataset.replicatedValue=c.target.value,r),l("input",c.target.value)};function i(c){De[c?"unshift":"push"](()=>{r=c,n(1,r)})}return s.$$set=c=>{"value"in c&&n(0,t=c.value)},[t,r,o,l,a,u,i]}class No extends ae{constructor(e){super();ue(this,e,Eo,Uo,ce,{value:0})}}const Co=s=>({strokesArray:s&1}),$t=s=>({fetchStrokes:s[1],strokesArray:s[0],deleteAllStrokesFromDb:s[2]});function zo(s){let e;const n=s[6].default,o=fe(n,s,s[5],$t);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,[r]){o&&o.p&&(!e||r&33)&&de(o,n,t,t[5],e?me(n,t[5],r,Co):pe(t[5]),$t)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function Fo(s,e,n){let{$$slots:o={},$$scope:t}=e,{dbPath:r}=e,{autoFetchStrokes:l=!1}=e,a;const u=Ye(H(),`${r}/strokes`),i=Ke(u,st("timestamp"));l&&c();async function c(){const p=await rt(i),m=[];for(const g of p.docs)m.push(ye({id:g.id},g.data()));n(0,a=m)}async function f(){return new Promise(async p=>{const m=[];let g=Fe(H()),d=0;for(const $ of a){d>=500&&(m.push(g.commit()),g=Fe(H()),d=0);const b=re(H(),`${r}/strokes/${$.id}`);g.delete(b),d+=1}m.push(g.commit()),await Promise.all(m),n(0,a=[]),p()})}return s.$$set=p=>{"dbPath"in p&&n(3,r=p.dbPath),"autoFetchStrokes"in p&&n(4,l=p.autoFetchStrokes),"$$scope"in p&&n(5,t=p.$$scope)},[a,c,f,r,l,t,o]}class Vo extends ae{constructor(e){super();ue(this,e,Fo,zo,ce,{dbPath:3,autoFetchStrokes:4})}}function Bo(s,e){let n=document.getElementById(e);return n==null||n.appendChild(s),{destroy(){s.remove()}}}function Rt(s,e){let n=new IntersectionObserver(o=>{for(const t of o)if(t.isIntersecting){e(),n.unobserve(s);return}},{root:null,threshold:.2,rootMargin:"0px"});n.observe(s)}const Wo=s=>({strokesArray:s&1}),It=s=>({listenToStrokes:s[1],strokesArray:s[0],handleNewlyDrawnStroke:s[2],deleteAllStrokesFromDb:s[3]});function Mo(s){let e;const n=s[6].default,o=fe(n,s,s[5],It);return{c(){o&&o.c()},l(t){o&&o.l(t)},m(t,r){o&&o.m(t,r),e=!0},p(t,[r]){o&&o.p&&(!e||r&33)&&de(o,n,t,t[5],e?me(n,t[5],r,Wo):pe(t[5]),It)},i(t){e||(T(o,t),e=!0)},o(t){P(o,t),e=!1},d(t){o&&o.d(t)}}}function Tt(s){const e=ye({id:s.id},s.data());return e.startTime=0,e.endTime=0,s.data().isErasing||(e.endTime+=.5),e}function jo(s,e,n){let{$$slots:o={},$$scope:t}=e,{dbPath:r}=e,l,a;const u=Ye(H(),`${r}/strokes`),i=Ke(u,st("timestamp"));Xe(()=>{a&&a()});async function c(){a=Ge(i,async m=>{m.docChanges().filter(d=>d.type==="removed").length>0?(n(0,l=[]),await Qt(),m.docs.length>0&&m.docs.forEach(d=>{l.push(Tt(d))})):(l||n(0,l=[]),m.docs.length===l.length||m.docChanges().filter(d=>d.type==="added").forEach(d=>{n(0,l=[...l,Tt(d.doc)])}))})}function f(m){l.push(m);try{lt(re(H(),`${r}/strokes/${m.id}`),ye({timestamp:Ht()},m))}catch(g){alert(g)}}async function p(){return new Promise(async m=>{const g=[];let d=Fe(H()),$=0;for(const b of l){$>=500&&(g.push(d.commit()),d=Fe(H()),$=0);const w=re(H(),`${r}/strokes/${b.id}`);d.delete(w),$+=1}g.push(d.commit()),await Promise.all(g),n(0,l=[]),m()})}return s.$$set=m=>{"dbPath"in m&&n(4,r=m.dbPath),"$$scope"in m&&n(5,t=m.$$scope)},[l,c,f,p,r,t,o]}class Oo extends ae{constructor(e){super();ue(this,e,jo,Mo,ce,{dbPath:4})}}function At(s,e,n){const o=s.slice();return o[36]=e[n],o}function Pt(s){let e,n,o,t,r,l=[],a=new Map,u,i,c,f,p,m,g;n=new Yt({props:{disabled:_e(s[0].name)&&s[0].askerUID&&s[5].uid!==s[0].askerUID,value:s[0].name,class:"room-title",style:`width: ${s[6]}px;`,$$slots:{helper:[Go]},$$scope:{ctx:s}}}),n.$on("input",s[19]);let d=s[0].blackboards;const $=b=>b[36];for(let b=0;b<d.length;b+=1){let w=At(s,d,b),v=$(w);a.set(v,l[b]=Et(v,w))}return{c(){e=z("div"),X(n.$$.fragment),o=q(),t=z("div"),r=q();for(let b=0;b<l.length;b+=1)l[b].c();u=q(),i=z("div"),c=M("New blackboard"),this.h()},l(b){e=F(b,"DIV",{style:!0});var w=N(e);G(n.$$.fragment,w),o=Q(w),t=F(w,"DIV",{style:!0}),N(t).forEach(h),r=Q(w);for(let L=0;L<l.length;L+=1)l[L].l(w);u=Q(w),i=F(w,"DIV",{style:!0});var v=N(i);c=j(v,"New blackboard"),v.forEach(h),w.forEach(h),this.h()},h(){_(t,"margin-bottom","20px"),_(i,"display","flex"),_(i,"justify-content","center"),_(i,"align-items","center"),_(i,"margin-top","40px"),_(i,"background-color","#2e3131"),_(i,"font-family","Roboto, sans-serif"),_(i,"text-transform","uppercase"),_(i,"height","35px"),_(e,"padding","16px"),Te(e,"question",_e(s[0].name))},m(b,w){R(b,e,w),Y(n,e,null),U(e,o),U(e,t),U(e,r);for(let v=0;v<l.length;v+=1)l[v].m(e,null);U(e,u),U(e,i),U(i,c),p=!0,m||(g=[x(i,"click",s[16]),ze(f=Bo.call(null,e,"main-content"))],m=!0)},p(b,w){const v={};w[0]&33&&(v.disabled=_e(b[0].name)&&b[0].askerUID&&b[5].uid!==b[0].askerUID),w[0]&1&&(v.value=b[0].name),w[0]&64&&(v.style=`width: ${b[6]}px;`),w[0]&31|w[1]&131072&&(v.$$scope={dirty:w,ctx:b}),n.$set(v),w[0]&61409|w[1]&122624&&(d=b[0].blackboards,$e(),l=Xt(l,w,$,1,b,d,a,e,Gt,Et,u,At),Re()),w[0]&1&&Te(e,"question",_e(b[0].name))},i(b){if(!p){T(n.$$.fragment,b);for(let w=0;w<d.length;w+=1)T(l[w]);p=!0}},o(b){P(n.$$.fragment,b);for(let w=0;w<l.length;w+=1)P(l[w]);p=!1},d(b){b&&h(e),K(n);for(let w=0;w<l.length;w+=1)l[w].d();m=!1,Ce(g)}}}function qo(s){let e=s[0].askerName+"",n,o,t=je(s[0].dateAsked)+"",r;return{c(){n=M(e),o=M(" asked on "),r=M(t)},l(l){n=j(l,e),o=j(l," asked on "),r=j(l,t)},m(l,a){R(l,n,a),R(l,o,a),R(l,r,a)},p(l,a){a[0]&1&&e!==(e=l[0].askerName+"")&&ve(n,e),a[0]&1&&t!==(t=je(l[0].dateAsked)+"")&&ve(r,t)},d(l){l&&h(n),l&&h(o),l&&h(r)}}}function Qo(s){let e,n,o;return{c(){e=M("Resolving this question in "),n=M(s[4]),o=M(", cancel by re-adding ?")},l(t){e=j(t,"Resolving this question in "),n=j(t,s[4]),o=j(t,", cancel by re-adding ?")},m(t,r){R(t,e,r),R(t,n,r),R(t,o,r)},p(t,r){r[0]&16&&ve(n,t[4])},d(t){t&&h(e),t&&h(n),t&&h(o)}}}function Ho(s){let e,n,o;return{c(){e=M("Pinging server members in "),n=M(s[2]),o=M(", cancel by backtracking the ?")},l(t){e=j(t,"Pinging server members in "),n=j(t,s[2]),o=j(t,", cancel by backtracking the ?")},m(t,r){R(t,e,r),R(t,n,r),R(t,o,r)},p(t,r){r[0]&4&&ve(n,t[2])},d(t){t&&h(e),t&&h(n),t&&h(o)}}}function St(s){let e,n=je(s[0].dateResolved)+"",o;return{c(){e=M(", resolved "),o=M(n)},l(t){e=j(t,", resolved "),o=j(t,n)},m(t,r){R(t,e,r),R(t,o,r)},p(t,r){r[0]&1&&n!==(n=je(t[0].dateResolved)+"")&&ve(o,n)},d(t){t&&h(e),t&&h(o)}}}function Xo(s){let e,n;function o(a,u){if(a[1])return Ho;if(a[3])return Qo;if(a[0].askerName&&a[0].askerUID&&a[0].date)return qo}let t=o(s),r=t&&t(s),l=s[0].dateResolved&&St(s);return{c(){r&&r.c(),e=q(),l&&l.c(),n=ne()},l(a){r&&r.l(a),e=Q(a),l&&l.l(a),n=ne()},m(a,u){r&&r.m(a,u),R(a,e,u),l&&l.m(a,u),R(a,n,u)},p(a,u){t===(t=o(a))&&r?r.p(a,u):(r&&r.d(1),r=t&&t(a),r&&(r.c(),r.m(e.parentNode,e))),a[0].dateResolved?l?l.p(a,u):(l=St(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(a){r&&r.d(a),a&&h(e),l&&l.d(a),a&&h(n)}}}function Go(s){let e,n;return e=new Kt({props:{slot:"helper",persistent:!0,$$slots:{default:[Xo]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,t){Y(e,o,t),n=!0},p(o,t){const r={};t[0]&31|t[1]&131072&&(r.$$scope={dirty:t,ctx:o}),e.$set(r)},i(o){n||(T(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function Lt(s){let e,n,o,t,r,l;function a(...f){return s[20](s[36],...f)}e=new No({props:{value:s[39].description||""}}),e.$on("input",a);const u=[Ko,Yo],i=[];function c(f,p){return f[39].audioDownloadURL?0:1}return o=c(s),t=i[o]=u[o](s),{c(){X(e.$$.fragment),n=q(),t.c(),r=ne()},l(f){G(e.$$.fragment,f),n=Q(f),t.l(f),r=ne()},m(f,p){Y(e,f,p),R(f,n,p),i[o].m(f,p),R(f,r,p),l=!0},p(f,p){s=f;const m={};p[1]&256&&(m.value=s[39].description||""),e.$set(m);let g=o;o=c(s),o===g?i[o].p(s,p):($e(),P(i[g],1,1,()=>{i[g]=null}),Re(),t=i[o],t?t.p(s,p):(t=i[o]=u[o](s),t.c()),T(t,1),t.m(r.parentNode,r))},i(f){l||(T(e.$$.fragment,f),T(t),l=!0)},o(f){P(e.$$.fragment,f),P(t),l=!1},d(f){K(e,f),f&&h(n),i[o].d(f),f&&h(r)}}}function Yo(s){let e,n;return e=new Oo({props:{dbPath:s[9]+s[36],$$slots:{default:[rn,({listenToStrokes:o,strokesArray:t,handleNewlyDrawnStroke:r,deleteAllStrokesFromDb:l})=>({43:o,41:t,44:r,42:l}),({listenToStrokes:o,strokesArray:t,handleNewlyDrawnStroke:r,deleteAllStrokesFromDb:l})=>[0,(o?4096:0)|(t?1024:0)|(r?8192:0)|(l?2048:0)]]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,t){Y(e,o,t),n=!0},p(o,t){const r={};t[0]&1&&(r.dbPath=o[9]+o[36]),t[0]&449|t[1]&138496&&(r.$$scope={dirty:t,ctx:o}),e.$set(r)},i(o){n||(T(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function Ko(s){let e,n;return e=new Vo({props:{dbPath:s[9]+s[36],$$slots:{default:[un,({fetchStrokes:o,strokesArray:t,deleteAllStrokesFromDb:r})=>({40:o,41:t,42:r}),({fetchStrokes:o,strokesArray:t,deleteAllStrokesFromDb:r})=>[0,(o?512:0)|(t?1024:0)|(r?2048:0)]]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,t){Y(e,o,t),n=!0},p(o,t){const r={};t[0]&1&&(r.dbPath=o[9]+o[36]),t[0]&224|t[1]&132864&&(r.$$scope={dirty:t,ctx:o}),e.$set(r)},i(o){n||(T(e.$$.fragment,o),n=!0)},o(o){P(e.$$.fragment,o),n=!1},d(o){K(e,o)}}}function Jo(s){let e,n,o;return n=new no({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=z("div"),X(n.$$.fragment),this.h()},l(t){e=F(t,"DIV",{style:!0});var r=N(e);G(n.$$.fragment,r),r.forEach(h),this.h()},h(){_(e,"display","flex"),_(e,"justify-content","center"),_(e,"margin-left","20px"),_(e,"margin-right","20px")},m(t,r){R(t,e,r),Y(n,e,null),o=!0},p:be,i(t){o||(T(n.$$.fragment,t),o=!0)},o(t){P(n.$$.fragment,t),o=!1},d(t){t&&h(e),K(n)}}}function Zo(s){let e,n,o,t;return{c(){e=z("span"),n=M("stop_circle"),this.h()},l(r){e=F(r,"SPAN",{class:!0,style:!0});var l=N(e);n=j(l,"stop_circle"),l.forEach(h),this.h()},h(){D(e,"class","material-icons"),_(e,"font-size","2.5rem"),_(e,"color","cyan"),_(e,"margin-left","30px"),_(e,"margin-right","26px")},m(r,l){R(r,e,l),U(e,n),o||(t=x(e,"click",function(){Le(s[46])&&s[46].apply(this,arguments)}),o=!0)},p(r,l){s=r},i:be,o:be,d(r){r&&h(e),o=!1,t()}}}function xo(s){let e,n,o,t;return{c(){e=z("span"),n=M("radio_button_checked"),this.h()},l(r){e=F(r,"SPAN",{class:!0,style:!0});var l=N(e);n=j(l,"radio_button_checked"),l.forEach(h),this.h()},h(){D(e,"class","material-icons"),_(e,"font-size","2.5rem"),_(e,"color","cyan"),_(e,"margin-left","30px"),_(e,"margin-right","26px")},m(r,l){R(r,e,l),U(e,n),o||(t=x(e,"click",function(){Le(s[45])&&s[45].apply(this,arguments)}),o=!0)},p(r,l){s=r},i:be,o:be,d(r){r&&h(e),o=!1,t()}}}function en(s){let e,n,o,t;const r=[xo,Zo,Jo],l=[];function a(u,i){return u[8]==="pre_record"?0:u[8]==="mid_record"?1:2}return e=a(s),n=l[e]=r[e](s),{c(){n.c(),o=ne()},l(u){n.l(u),o=ne()},m(u,i){l[e].m(u,i),R(u,o,i),t=!0},p(u,i){let c=e;e=a(u),e===c?l[e].p(u,i):($e(),P(l[c],1,1,()=>{l[c]=null}),Re(),n=l[e],n?n.p(u,i):(n=l[e]=r[e](u),n.c()),T(n,1),n.m(o.parentNode,o))},i(u){t||(T(n),t=!0)},o(u){P(n),t=!1},d(u){l[e].d(u),u&&h(o)}}}function tn(s){let e;return{c(){e=M("Wipe board")},l(n){e=j(n,"Wipe board")},m(n,o){R(n,e,o)},d(n){n&&h(e)}}}function on(s){let e=(s[39].backgroundImageDownloadURL?"Remove background":"Set background")+"",n,o,t,r,l,a;function u(...i){return s[22](s[39],...i)}return{c(){n=M(e),o=q(),t=z("input"),this.h()},l(i){n=j(i,e),o=Q(i),t=F(i,"INPUT",{id:!0,style:!0,type:!0,accept:!0}),this.h()},h(){D(t,"id",r="input-"+s[39].id),_(t,"display","none"),D(t,"type","file"),D(t,"accept","image/gif, image/jpeg, image/png")},m(i,c){R(i,n,c),R(i,o,c),R(i,t,c),l||(a=x(t,"change",u),l=!0)},p(i,c){s=i,c[1]&256&&e!==(e=(s[39].backgroundImageDownloadURL?"Remove background":"Set background")+"")&&ve(n,e),c[1]&256&&r!==(r="input-"+s[39].id)&&D(t,"id",r)},d(i){i&&h(n),i&&h(o),i&&h(t),l=!1,a()}}}function nn(s){let e,n,o,t,r;return n=new ut({props:{slot:"dropdown-menu",$$slots:{default:[tn]},$$scope:{ctx:s}}}),n.$on("SMUI:action",function(){Le(s[42])&&s[42].apply(this,arguments)}),t=new ut({props:{$$slots:{default:[on]},$$scope:{ctx:s}}}),t.$on("click",function(){Le(s[39].backgroundImageDownloadURL?s[11](s[39].id):Nt(s[39].id))&&(s[39].backgroundImageDownloadURL?s[11](s[39].id):Nt(s[39].id)).apply(this,arguments)}),{c(){e=z("div"),X(n.$$.fragment),o=q(),X(t.$$.fragment),this.h()},l(l){e=F(l,"DIV",{slot:!0});var a=N(e);G(n.$$.fragment,a),o=Q(a),G(t.$$.fragment,a),a.forEach(h),this.h()},h(){D(e,"slot","dropdown-menu")},m(l,a){R(l,e,a),Y(n,e,null),U(e,o),Y(t,e,null),r=!0},p(l,a){s=l;const u={};a[1]&131072&&(u.$$scope={dirty:a,ctx:s}),n.$set(u);const i={};a[1]&131328&&(i.$$scope={dirty:a,ctx:s}),t.$set(i)},i(l){r||(T(n.$$.fragment,l),T(t.$$.fragment,l),r=!0)},o(l){P(n.$$.fragment,l),P(t.$$.fragment,l),r=!1},d(l){l&&h(e),K(n),K(t)}}}function sn(s){let e,n;function o(...t){return s[23](s[44],...t)}return e=new ko({props:{strokesArray:s[41],currentTime:s[47],backgroundImageDownloadURL:s[39].backgroundImageDownloadURL,$$slots:{"dropdown-menu":[nn],default:[en]},$$scope:{ctx:s}}}),e.$on("stroke-drawn",o),{c(){X(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){Y(e,t,r),n=!0},p(t,r){s=t;const l={};r[1]&1024&&(l.strokesArray=s[41]),r[1]&65536&&(l.currentTime=s[47]),r[1]&256&&(l.backgroundImageDownloadURL=s[39].backgroundImageDownloadURL),r[0]&256|r[1]&182528&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function rn(s){let e,n,o,t,r,l,a;function u(...i){return s[24](s[36],...i)}return n=new To({props:{$$slots:{default:[sn,({startRecording:i,stopRecording:c,currentTime:f})=>({45:i,46:c,47:f}),({startRecording:i,stopRecording:c,currentTime:f})=>[0,(i?16384:0)|(c?32768:0)|(f?65536:0)]]},$$scope:{ctx:s}}}),n.$on("record-end",u),{c(){e=z("div"),X(n.$$.fragment),this.h()},l(i){e=F(i,"DIV",{style:!0});var c=N(e);G(n.$$.fragment,c),c.forEach(h),this.h()},h(){D(e,"style",o=`width: ${s[6]}px; height: ${s[7]}px; position: relative`)},m(i,c){R(i,e,c),Y(n,e,null),r=!0,l||(a=ze(t=Rt.call(null,e,s[43])),l=!0)},p(i,c){s=i;const f={};c[0]&256|c[1]&249088&&(f.$$scope={dirty:c,ctx:s}),n.$set(f),(!r||c[0]&192&&o!==(o=`width: ${s[6]}px; height: ${s[7]}px; position: relative`))&&D(e,"style",o),t&&Le(t.update)&&c[1]&4096&&t.update.call(null,s[43])},i(i){r||(T(n.$$.fragment,i),r=!0)},o(i){P(n.$$.fragment,i),r=!1},d(i){i&&h(e),K(n),l=!1,a()}}}function Ut(s){let e,n;function o(){return s[21](s[39],s[42])}return e=new oo({props:{color:"primary",$$slots:{default:[ln]},$$scope:{ctx:s}}}),e.$on("click",o),{c(){X(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,r){Y(e,t,r),n=!0},p(t,r){s=t;const l={};r[1]&131072&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function ln(s){let e;return{c(){e=M("Delete video")},l(n){e=j(n,"Delete video")},m(n,o){R(n,e,o)},d(n){n&&h(e)}}}function an(s){let e,n,o=s[5].uid===s[39].creatorUID&&Ut(s);return{c(){o&&o.c(),e=ne()},l(t){o&&o.l(t),e=ne()},m(t,r){o&&o.m(t,r),R(t,e,r),n=!0},p(t,r){t[5].uid===t[39].creatorUID?o?(o.p(t,r),r[0]&32|r[1]&256&&T(o,1)):(o=Ut(t),o.c(),T(o,1),o.m(e.parentNode,e)):o&&($e(),P(o,1,1,()=>{o=null}),Re())},i(t){n||(T(o),n=!0)},o(t){P(o),n=!1},d(t){o&&o.d(t),t&&h(e)}}}function un(s){let e,n,o,t,r,l,a;return n=new Do({props:{strokesArray:s[41],audioDownloadURL:s[39].audioDownloadURL,backgroundImageDownloadURL:s[39].backgroundImageDownloadURL,$$slots:{default:[an]},$$scope:{ctx:s}}}),{c(){e=z("div"),X(n.$$.fragment),this.h()},l(u){e=F(u,"DIV",{style:!0});var i=N(e);G(n.$$.fragment,i),i.forEach(h),this.h()},h(){D(e,"style",o=`width: ${s[6]}px; height: ${s[7]+40}px; position: relative`)},m(u,i){R(u,e,i),Y(n,e,null),r=!0,l||(a=ze(t=Rt.call(null,e,s[40])),l=!0)},p(u,i){const c={};i[1]&1024&&(c.strokesArray=u[41]),i[1]&256&&(c.audioDownloadURL=u[39].audioDownloadURL),i[1]&256&&(c.backgroundImageDownloadURL=u[39].backgroundImageDownloadURL),i[0]&32|i[1]&131328&&(c.$$scope={dirty:i,ctx:u}),n.$set(c),(!r||i[0]&192&&o!==(o=`width: ${u[6]}px; height: ${u[7]+40}px; position: relative`))&&D(e,"style",o),t&&Le(t.update)&&i[1]&512&&t.update.call(null,u[40])},i(u){r||(T(n.$$.fragment,u),r=!0)},o(u){P(n.$$.fragment,u),r=!1},d(u){u&&h(e),K(n),l=!1,a()}}}function cn(s){let e,n,o=s[39]&&Lt(s);return{c(){o&&o.c(),e=q()},l(t){o&&o.l(t),e=Q(t)},m(t,r){o&&o.m(t,r),R(t,e,r),n=!0},p(t,r){t[39]?o?(o.p(t,r),r[1]&256&&T(o,1)):(o=Lt(t),o.c(),T(o,1),o.m(e.parentNode,e)):o&&($e(),P(o,1,1,()=>{o=null}),Re())},i(t){n||(T(o),n=!0)},o(t){P(o),n=!1},d(t){o&&o.d(t),t&&h(e)}}}function Et(s,e){let n,o,t;return o=new Lo({props:{dbPath:e[9]+e[36],$$slots:{default:[cn,({boardDoc:r})=>({39:r}),({boardDoc:r})=>[0,r?256:0]]},$$scope:{ctx:e}}}),{key:s,first:null,c(){n=ne(),X(o.$$.fragment),this.h()},l(r){n=ne(),G(o.$$.fragment,r),this.h()},h(){this.first=n},m(r,l){R(r,n,l),Y(o,r,l),t=!0},p(r,l){e=r;const a={};l[0]&1&&(a.dbPath=e[9]+e[36]),l[0]&481|l[1]&131328&&(a.$$scope={dirty:l,ctx:e}),o.$set(a)},i(r){t||(T(o.$$.fragment,r),t=!0)},o(r){P(o.$$.fragment,r),t=!1},d(r){r&&h(n),K(o,r)}}}function fn(s){let e,n,o=s[0]&&Pt(s);return{c(){o&&o.c(),e=ne()},l(t){o&&o.l(t),e=ne()},m(t,r){o&&o.m(t,r),R(t,e,r),n=!0},p(t,r){t[0]?o?(o.p(t,r),r[0]&1&&T(o,1)):(o=Pt(t),o.c(),T(o,1),o.m(e.parentNode,e)):o&&($e(),P(o,1,1,()=>{o=null}),Re())},i(t){n||(T(o),n=!0)},o(t){P(o),n=!1},d(t){o&&o.d(t),t&&h(e)}}}async function wn({page:s}){return{props:{classID:s.params.class,roomID:s.params.room}}}function Nt(s){document.getElementById(`input-${s}`).click()}function _e(s){return s.charAt(s.length-1)==="?"}function tt(s){return s.askerName&&s.dateAsked&&s.askerUID}function dn(s,e,n){let o,t,r,l,a;ee(s,ct,I=>n(5,t=I)),ee(s,Be,I=>n(6,r=I)),ee(s,et,I=>n(7,l=I)),ee(s,Me,I=>n(8,a=I));let{classID:u}=e,{roomID:i}=e,c,f;const p=`classes/${u}/blackboards/`,m=`classes/${u}/rooms/`;t.uid||ro("/");async function g(I,C){const se=re(H(),p+C),te=I.target.files[0];if(!!te)if(te.type.split("/")[0]==="image"){const we=Je(),ie=Ze(we,`images/${We()}`);await it(ie,te);const Ne=await at(ie);he(se,{backgroundImageDownloadURL:Ne})}else alert("Error: only images can be used")}function d(I){const C=re(H(),p+I);he(C,{backgroundImageDownloadURL:Se()})}let $="",b=5,w,v=5;async function L({srcElement:I}){const{value:C}=I,se={name:C};!_e(f.name)&&_e(C)&&!tt(f)?k():$&&!_e(C)?J():!_e(C)&&tt(f)?V():w&&_e(C)&&tt(f)&&E(),await he(o,se)}function k(){n(2,b=5),n(1,$=setInterval(()=>{n(2,b-=1),b===0&&(Z(),le(),J())},1e3))}function V(){n(4,v=5),n(3,w=setInterval(()=>{n(4,v-=1),v===0&&S()},1e3))}function S(){he(o,{dateResolved:new Date().toISOString()})}function E(){clearTimeout(w),n(3,w="")}function J(){clearTimeout($),n(1,$="")}function Z(){he(o,{askerName:t.name||"Beaver #999",askerUID:t.uid,dateAsked:new Date().toISOString()})}async function le(){const I=[],C=Jt(),se=Zt(C,"sendTextMessage"),te=Ye(H(),"users"),we=Ke(te,xt("willReceiveText","==",!0)),ie=await rt(we);if(ie.docs)for(const Ne of ie.docs){console.log("phoneNumber =",Ne.data().phoneNumber);try{Ne.id!==t.uid&&I.push(se({content:`${t.name} asked on https://ihtfp.app: "${f.name||"Fake question here"}"`,toWho:Ne.data().phoneNumber}))}catch(Ct){alert(Ct)}}await Promise.all(I),console.log("success, sent all texts.")}async function Ie({detail:I},C){const se=re(H(),p+C);await he(se,{description:I})}async function Ee(){c&&c(),c=Ge(o,I=>{n(0,f=ye({id:I.id},I.data()))})}Xe(()=>{c()});async function ke(I,C){const se=Je(),te=Ze(se,`audio/${We()}`);await it(te,I);const we=await at(te),ie=re(H(),p+C);await he(ie,{creatorUID:t.uid,creatorPhoneNumber:t.phoneNumber,date:new Date().toISOString(),audioDownloadURL:we,audioRefFullPath:te.fullPath}),Me.set("pre_record")}async function A({id:I,audioRefFullPath:C},se){const te=[],we=re(H(),p+I);if(C){const ie=Ze(Je(),C);te.push(eo(ie))}te.push(he(we,{creator:Se(),creatorPhoneNumber:Se(),date:Se(),audioDownloadURL:Se(),audioRefFullPath:Se()})),te.push(se()),await Promise.all(te)}async function B(){const I=We(),C=re(H(),p+I);await Promise.all([lt(C,{}),he(o,{blackboards:to(I)})])}const O=I=>L(I),y=(I,C)=>Ie(C,I),W=(I,C)=>A(I,C),oe=(I,C)=>g(C,I.id),ge=(I,C)=>I(C.detail.newStroke),Oe=(I,C)=>ke(C.detail.audioBlob,I);return s.$$set=I=>{"classID"in I&&n(17,u=I.classID),"roomID"in I&&n(18,i=I.roomID)},s.$$.update=()=>{s.$$.dirty[0]&262144&&(o=re(H(),m+i)),s.$$.dirty[0]&262144&&Ee()},[f,$,b,w,v,t,r,l,a,p,g,d,L,Ie,ke,A,B,u,i,O,y,W,oe,ge,Oe]}class yn extends ae{constructor(e){super();ue(this,e,dn,fn,ce,{classID:17,roomID:18},null,[-1,-1])}}export{yn as default,wn as load};
