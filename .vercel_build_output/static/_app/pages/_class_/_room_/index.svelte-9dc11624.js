var It=Object.defineProperty;var Ge=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var Ye=(r,e,o)=>e in r?It(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,Le=(r,e)=>{for(var o in e||(e={}))Tt.call(e,o)&&Ye(r,o,e[o]);if(Ge)for(var o of Ge(e))At.call(e,o)&&Ye(r,o,e[o]);return r};import{S as de,i as pe,s as me,aw as Lt,k as q,e as C,n as Q,c as z,b as y,L as d,U as Pt,av as he,f as R,Z as K,aA as _e,t as B,a as S,aB as ge,d as p,g as M,M as P,af as Ut,H as be,aa as St,j as V,m as j,o as W,ax as Et,ay as Nt,h as ae,I as ke,J as we,K as $e,x as D,u as T,v as F,$ as Pe,E as X,a2 as Ue,ad as Ct,r as ie,w as ue,aC as Fe,A as Ke,aD as Se,N as ce,a4 as Je,P as Y,a5 as Ze,a6 as zt,W as xe,a3 as et,aE as Bt,R as tt,O as oe,aF as Mt,a8 as ot,at as Vt,au as jt,l as J,aG as Wt,aH as Ft,aI as Oe,aJ as qe,aK as nt,aL as rt,_ as ne,aM as Ot,aN as qt,aO as Qt,a7 as Ht,aP as Xt,ae as Gt,aQ as ve,az as ye,ah as st,X as Yt,aR as Kt}from"../../../chunks/vendor-da8027ad.js";import{R as Jt,a as Zt,D as xt}from"../../../chunks/RenderlessFetchStrokes-a85d8772.js";import{_ as eo}from"../../../chunks/preload-helper-ec9aa979.js";import{o as Qe,u as lt,j as Ee,a as at,c as He,d as Ne,f as to,e as oo,k as Ce,g as no,l as ze}from"../../../chunks/navigation-d0de6f35.js";import{d as Be,r as ro,a as so}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const lo=r=>({}),it=r=>({});function ut(r,e,o){const t=r.slice();return t[11]=e[o],t}function ct(r){let e,o,t,n,s,l=r[2].pencilColors,i=[];for(let u=0;u<l.length;u+=1)i[u]=ft(ut(r,l,u));return{c(){for(let u=0;u<i.length;u+=1)i[u].c();e=q(),o=C("img"),this.h()},l(u){for(let a=0;a<i.length;a+=1)i[a].l(u);e=Q(u),o=z(u,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){y(o,"width","46"),y(o,"height","33"),d(o,"margin-left","8px"),Pt(o.src,t="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||y(o,"src",t),y(o,"alt","eraser"),y(o,"class","svelte-1bgxyxs"),he(o,"eraser-selected",r[3].type==="eraser")},m(u,a){for(let c=0;c<i.length;c+=1)i[c].m(u,a);R(u,e,a),R(u,o,a),n||(s=K(o,"click",r[7]),n=!0)},p(u,a){if(a&12){l=u[2].pencilColors;let c;for(c=0;c<l.length;c+=1){const f=ut(u,l,c);i[c]?i[c].p(f,a):(i[c]=ft(f),i[c].c(),i[c].m(e.parentNode,e))}for(;c<i.length;c+=1)i[c].d(1);i.length=l.length}a&8&&he(o,"eraser-selected",u[3].type==="eraser")},d(u){Ut(i,u),u&&p(e),u&&p(o),n=!1,s()}}}function ft(r){let e,o,t,n,s,l,i,u,a,c,f,k;function b(){return r[6](r[11])}return{c(){e=C("div"),o=_e("svg"),t=_e("g"),n=_e("path"),s=B(`;\r
            `),l=_e("polygon"),u=_e("path"),a=_e("path"),this.h()},l(_){e=z(_,"DIV",{style:!0,class:!0});var m=S(e);o=ge(m,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var I=S(o);t=ge(I,"g",{});var h=S(t);n=ge(h,"path",{d:!0}),S(n).forEach(p),s=M(h,`;\r
            `),l=ge(h,"polygon",{style:!0,points:!0}),S(l).forEach(p),u=ge(h,"path",{style:!0,d:!0}),S(u).forEach(p),a=ge(h,"path",{style:!0,d:!0}),S(a).forEach(p),h.forEach(p),I.forEach(p),m.forEach(p),this.h()},h(){y(n,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),y(l,"style",i=`fill: ${r[11]};`),y(l,"points","50,211.978 38.879,175.24 61.122,175.24"),d(u,"fill","#424242"),y(u,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),y(a,"style",c=`fill: ${r[11]};`),y(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),y(o,"preserveAspectRatio","none"),y(o,"version","1.1"),y(o,"id","Layer_1"),y(o,"xmlns","http://www.w3.org/2000/svg"),y(o,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(o,"x","0px"),y(o,"y","0px"),y(o,"width","16px"),y(o,"height","30px"),y(o,"viewBox","0 0 100 230"),d(o,"enable-background","new 0 0 100 230"),y(o,"xml:space","preserve"),y(o,"class","svelte-1bgxyxs"),d(e,"margin","0 4px"),d(e,"width","30px"),d(e,"height","42px"),d(e,"border-radius","3px"),d(e,"align-items","center"),d(e,"display","flex"),d(e,"justify-content","center"),y(e,"class","svelte-1bgxyxs"),he(e,"pencil-selected",r[3].color===r[11])},m(_,m){R(_,e,m),P(e,o),P(o,t),P(t,n),P(t,s),P(t,l),P(t,u),P(t,a),f||(k=K(e,"click",b),f=!0)},p(_,m){r=_,m&4&&i!==(i=`fill: ${r[11]};`)&&y(l,"style",i),m&4&&c!==(c=`fill: ${r[11]};`)&&y(a,"style",c),m&12&&he(e,"pencil-selected",r[3].color===r[11])},d(_){_&&p(e),f=!1,k()}}}function ao(r){let e;const o=r[5]["dropdown-menu"],t=be(o,r,r[10],it);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&1024)&&ke(t,o,n,n[10],e?$e(o,n[10],s,lo):we(n[10]),it)},i(n){e||(D(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function io(r){let e,o;return e=new Ct({props:{$$slots:{default:[ao]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n&1024&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function uo(r){let e,o,t,n,s,l=(r[1]?"No touch":"Touch draw")+"",i,u,a=Object.keys(r[2]).length>0,c,f,k,b,_,m,I,h,w;t=new Lt({props:{icons:!1,checked:!r[1],style:"margin: 0 !important"}});let $=a&&ct(r);const O=r[5].default,N=be(O,r,r[10],null);let Re={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[io]},$$scope:{ctx:r}};return m=new St({props:Re}),r[9](m),{c(){e=C("div"),o=C("div"),V(t.$$.fragment),n=q(),s=C("div"),i=B(l),u=q(),$&&$.c(),c=q(),N&&N.c(),f=q(),k=C("span"),b=B("more_horiz"),_=q(),V(m.$$.fragment),this.h()},l(L){e=z(L,"DIV",{style:!0});var U=S(e);o=z(U,"DIV",{style:!0});var Z=S(o);j(t.$$.fragment,Z),n=Q(Z),s=z(Z,"DIV",{style:!0});var x=S(s);i=M(x,l),x.forEach(p),Z.forEach(p),u=Q(U),$&&$.l(U),c=Q(U),N&&N.l(U),f=Q(U),k=z(U,"SPAN",{class:!0,style:!0});var fe=S(k);b=M(fe,"more_horiz"),fe.forEach(p),_=Q(U),j(m.$$.fragment,U),U.forEach(p),this.h()},h(){d(s,"margin-top","2px"),d(s,"font-size","0.55rem"),d(s,"font-family","Roboto,sans-serif"),d(s,"color","white"),d(o,"margin-right","10px"),d(o,"text-align","center"),y(k,"class","material-icons"),d(k,"margin-right","10px"),d(k,"color","white"),d(k,"font-size","2rem"),d(e,"position","absolute"),d(e,"display","flex"),d(e,"align-items","center"),d(e,"height","50px"),d(e,"left","0"),d(e,"right","auto"),d(e,"top","0"),d(e,"bottom","auto"),d(e,"z-index","100"),d(e,"background-color","grey"),d(e,"padding-left","10px"),d(e,"border-radius","2px")},m(L,U){R(L,e,U),P(e,o),W(t,o,null),P(o,n),P(o,s),P(s,i),P(e,u),$&&$.m(e,null),P(e,c),N&&N.m(e,null),P(e,f),P(e,k),P(k,b),P(e,_),W(m,e,null),I=!0,h||(w=[K(o,"click",Et(Nt(r[4]))),K(k,"click",r[8])],h=!0)},p(L,[U]){const Z={};U&2&&(Z.checked=!L[1]),t.$set(Z),(!I||U&2)&&l!==(l=(L[1]?"No touch":"Touch draw")+"")&&ae(i,l),U&4&&(a=Object.keys(L[2]).length>0),a?$?$.p(L,U):($=ct(L),$.c(),$.m(e,c)):$&&($.d(1),$=null),N&&N.p&&(!I||U&1024)&&ke(N,O,L,L[10],I?$e(O,L[10],U,null):we(L[10]),null);const x={};U&1024&&(x.$$scope={dirty:U,ctx:L}),m.$set(x)},i(L){I||(D(t.$$.fragment,L),D(N,L),D(m.$$.fragment,L),I=!0)},o(L){T(t.$$.fragment,L),T(N,L),T(m.$$.fragment,L),I=!1},d(L){L&&p(e),F(t),$&&$.d(),N&&N.d(L),r[9](null),F(m),h=!1,Pe(w)}}}function co(r,e,o){let t,n,s;X(r,Qe,_=>o(1,t=_)),X(r,lt,_=>o(2,n=_)),X(r,Ee,_=>o(3,s=_));let{$$slots:l={},$$scope:i}=e,u;function a(){Qe.set(!t)}const c=_=>Ee.set({type:"pencil",color:_,lineWidth:3}),f=()=>Ee.set({type:"eraser",color:"",lineWidth:40}),k=()=>u.setOpen(!0);function b(_){Ue[_?"unshift":"push"](()=>{u=_,o(0,u)})}return r.$$set=_=>{"$$scope"in _&&o(10,i=_.$$scope)},[u,t,n,s,a,l,c,f,k,b,i]}class fo extends de{constructor(e){super();pe(this,e,co,uo,me,{})}}const po=r=>({}),dt=r=>({slot:"dropdown-menu"});function pt(r){let e,o;return e=new fo({props:{$$slots:{"dropdown-menu":[ho],default:[mo]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n&131072&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function mo(r){let e;const o=r[14].default,t=be(o,r,r[17],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&131072)&&ke(t,o,n,n[17],e?$e(o,n[17],s,null):we(n[17]),null)},i(n){e||(D(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function ho(r){let e;const o=r[14]["dropdown-menu"],t=be(o,r,r[17],dt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&131072)&&ke(t,o,n,n[17],e?$e(o,n[17],s,po):we(n[17]),dt)},i(n){e||(D(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function _o(r){let e,o,t,n,s,l,i,u,a,c=r[0]&&pt(r);return{c(){c&&c.c(),e=q(),o=C("canvas"),n=q(),s=C("canvas"),this.h()},l(f){c&&c.l(f),e=Q(f),o=z(f,"CANVAS",{style:!0});var k=S(o);k.forEach(p),n=Q(f),s=z(f,"CANVAS",{style:!0});var b=S(s);b.forEach(p),this.h()},h(){y(o,"style",t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[4]}px; height: ${r[3]}px`),y(s,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[4]}px; height: ${r[3]}px`)},m(f,k){c&&c.m(f,k),R(f,e,k),R(f,o,k),r[15](o),R(f,n,k),R(f,s,k),r[16](s),i=!0,u||(a=[K(o,"touchstart",r[5]),K(o,"touchmove",r[6]),K(o,"touchend",r[7])],u=!0)},p(f,[k]){f[0]?c?(c.p(f,k),k&1&&D(c,1)):(c=pt(f),c.c(),D(c,1),c.m(e.parentNode,e)):c&&(ie(),T(c,1,1,()=>{c=null}),ue()),(!i||k&24&&t!==(t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${f[4]}px; height: ${f[3]}px`))&&y(o,"style",t),(!i||k&24&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${f[4]}px; height: ${f[3]}px`))&&y(s,"style",l)},i(f){i||(D(c),i=!0)},o(f){T(c),i=!1},d(f){c&&c.d(f),f&&p(e),f&&p(o),r[15](null),f&&p(n),f&&p(s),r[16](null),u=!1,Pe(a)}}}function go(r){return(r.endTime-r.startTime)/r.points.length}function bo(r,e,o){let t,n,s,l;X(r,at,g=>o(3,t=g)),X(r,He,g=>o(4,n=g)),X(r,Ee,g=>o(21,s=g)),X(r,Qe,g=>o(22,l=g));let{$$slots:i={},$$scope:u}=e,{strokesArray:a}=e,{currentTime:c=0}=e,{backgroundImageDownloadURL:f=""}=e;const k=Fe();let b,_,m,I,h=[],w=!1,$={x:-1,y:-1},O={points:[]},N;Ke(()=>{o(10,b=m.getContext("2d")),o(11,_=I.getContext("2d"))});function Re(g){if(g.touches.length>1)return;const E=g.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}x(g,{isInitialContact:!0})}function L(g){if(!w)return;if(g.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const E=g.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}x(g,{isInitialContact:!1})}function U(g){if(!w||g.touches.length>0)return;const E=g.changedTouches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}Me(O),w=!1}function Z(g){w=!0,$={x:-1,y:-1},O={strokeNumber:a.length+1,startTime:Number(c.toFixed(1)),color:s.color,lineWidth:s.lineWidth,isErasing:s.type==="eraser",points:[],sessionID:"123"}}function x(g,{isInitialContact:E}){g.preventDefault(),E&&Z();const G=Te(g);fe(g,G)}function fe(g,E){O.points.push({unitX:parseFloat(E.x/m.width).toFixed(4),unitY:parseFloat(E.y/m.height).toFixed(4)}),$.x!==-1&&$.y!==-1&&so([De($),De(E)],1,s.type==="eraser",b,s.color,s.lineWidth,m),$=E}function Me(g){g.endTime=Number(c.toFixed(1)),g.id=Ne(),h.push(g),k("stroke-drawn",{newStroke:g})}function Te(g){const{left:E,top:G}=m.getBoundingClientRect();return{x:g.touches[0].pageX-E-window.scrollX,y:g.touches[0].pageY-G-window.scrollY}}function De({x:g,y:E}){return{unitX:g/m.width,unitY:E/m.height}}function Ae(){b.clearRect(0,0,n,t)}function Ve(g){Ue[g?"unshift":"push"](()=>{m=g,o(1,m),o(10,b),o(4,n),o(3,t),o(0,a)})}function je(g){Ue[g?"unshift":"push"](()=>{I=g,o(2,I),o(10,b),o(4,n),o(3,t),o(0,a),o(1,m)})}return r.$$set=g=>{"strokesArray"in g&&o(0,a=g.strokesArray),"currentTime"in g&&o(8,c=g.currentTime),"backgroundImageDownloadURL"in g&&o(9,f=g.backgroundImageDownloadURL),"$$scope"in g&&o(17,u=g.$$scope)},r.$$.update=()=>{if(r.$$.dirty&1051&&b&&(o(1,m.width=n,m),o(1,m.height=t,m),o(2,I.width=n,I),o(2,I.height=t,I),a))for(const g of a)Be(g,null,b,m);if(r.$$.dirty&2566&&_&&(_.clearRect(0,0,I.scrollWidth,I.scrollHeight),ro(f,m,_)),r.$$.dirty&13315&&b&&a){let g=h.length,E=a.length;if(g!==E)if(g<E)if(g===0){for(const G of a)Be(G,null,b,m);o(12,h=[...a])}else for(let G=g;G<E;G++){const se=a[G];Be(se,se.startTime!==se.endTime?go(se):null,b,m),h.push(se)}else{let G=function(){Ae(),o(12,h=[]),$={x:-1,y:-1};for(const We of a)Be(We,null,b,m)};(function(){console.log("debounced board reset"),N&&clearTimeout(N),o(13,N=setTimeout(G,1e3))})()}}},[a,m,I,t,n,Re,L,U,c,f,b,_,h,N,i,Ve,je,u]}class ko extends de{constructor(e){super();pe(this,e,bo,_o,me,{strokesArray:0,currentTime:8,backgroundImageDownloadURL:9})}}const wo=r=>({currentTime:r&1}),mt=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function $o(r){let e;const o=r[4].default,t=be(o,r,r[3],mt);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,[s]){t&&t.p&&(!e||s&9)&&ke(t,o,n,n[3],e?$e(o,n[3],s,wo):we(n[3]),mt)},i(n){e||(D(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function vo(r,e,o){let t,n;X(r,to,_=>o(8,t=_)),X(r,oo,_=>o(9,n=_));let{$$slots:s={},$$scope:l}=e,i,u=0,a;Ke(async()=>{window&&(i=await eo(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=i.default)});const c=Fe();let f=null;function k(){return new Promise(async(_,m)=>{if(!n.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),m("Cannot start recording because mic stream is muted");return}const I=t.clone();f=new MediaRecorder(I),f.start(),a=setInterval(()=>o(0,u+=.1),100),c("record-start"),Ce.set("mid_record"),_()})}function b(){return new Promise((_,m)=>{clearTimeout(a),Ce.set("post_record"),f.addEventListener("dataavailable",I=>{const h=I.data;c("record-end",{audioBlob:h}),_()}),f.stop();for(const I of f.stream.getTracks())I.stop()})}return r.$$set=_=>{"$$scope"in _&&o(3,l=_.$$scope)},[u,k,b,l,s]}class yo extends de{constructor(e){super();pe(this,e,vo,$o,me,{})}}function Ro(r,e){let o=document.getElementById(e);return o==null||o.appendChild(r),{destroy(){r.remove()}}}function ht(r,e){let o=new IntersectionObserver(t=>{for(const n of t)if(n.isIntersecting){e(),o.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});o.observe(r)}function Do(r){let e,o,t,n;return{c(){e=C("div"),o=C("textarea"),this.h()},l(s){e=z(s,"DIV",{class:!0,style:!0});var l=S(e);o=z(l,"TEXTAREA",{style:!0,class:!0}),S(o).forEach(p),l.forEach(p),this.h()},h(){o.value=r[0],d(o,"box-sizing","border-box"),d(o,"width",r[2]+"px"),d(o,"padding","6px"),d(o,"border-radius","2px"),d(o,"font-family","Roboto, sans-serif"),d(o,"color","rgb(60 55 56 / 87%)"),y(o,"class","svelte-tv3wak"),y(e,"class","grow-wrap svelte-tv3wak"),d(e,"font-family","Roboto, sans-serif"),d(e,"margin","10px 0px")},m(s,l){R(s,e,l),P(e,o),r[6](e),t||(n=[K(o,"input",r[5]),Se(r[4].call(null,e))],t=!0)},p(s,[l]){l&1&&(o.value=s[0]),l&4&&d(o,"width",s[2]+"px")},i:ce,o:ce,d(s){s&&p(e),r[6](null),t=!1,Pe(n)}}}function Io(r,e,o){let t;X(r,He,c=>o(2,t=c));let{value:n}=e,s;const l=Fe();function i(c){c.dataset.replicatedValue=n}const u=c=>{o(1,s.dataset.replicatedValue=c.target.value,s),l("input",c.target.value)};function a(c){Ue[c?"unshift":"push"](()=>{s=c,o(1,s)})}return r.$$set=c=>{"value"in c&&o(0,n=c.value)},[n,s,t,l,i,u,a]}class To extends de{constructor(e){super();pe(this,e,Io,Do,me,{value:0})}}const Ao=r=>({strokesArray:r&1}),_t=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function Lo(r){let e;const o=r[6].default,t=be(o,r,r[5],_t);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,[s]){t&&t.p&&(!e||s&33)&&ke(t,o,n,n[5],e?$e(o,n[5],s,Ao):we(n[5]),_t)},i(n){e||(D(t,n),e=!0)},o(n){T(t,n),e=!1},d(n){t&&t.d(n)}}}function gt(r){const e=Le({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function Po(r,e,o){let{$$slots:t={},$$scope:n}=e,{dbPath:s}=e,l,i;const u=Je(Y(),`${s}/strokes`),a=Ze(u,zt("timestamp"));xe(()=>{i&&i()});async function c(){i=et(a,async b=>{b.docChanges().filter(m=>m.type==="removed").length>0?(o(0,l=[]),await Bt(),b.docs.length>0&&b.docs.forEach(m=>{l.push(gt(m))})):(l||o(0,l=[]),b.docs.length===l.length||b.docChanges().filter(m=>m.type==="added").forEach(m=>{o(0,l=[...l,gt(m.doc)])}))})}function f(b){l.push(b);try{tt(oe(Y(),`${s}/strokes/${b.id}`),Le({timestamp:Mt()},b))}catch(_){alert(_)}}async function k(){return new Promise(async b=>{const _=[];let m=ot(Y()),I=0;for(const h of l){I>=500&&(_.push(m.commit()),m=ot(Y()),I=0);const w=oe(Y(),`${s}/strokes/${h.id}`);m.delete(w),I+=1}_.push(m.commit()),await Promise.all(_),o(0,l=[]),b()})}return r.$$set=b=>{"dbPath"in b&&o(4,s=b.dbPath),"$$scope"in b&&o(5,n=b.$$scope)},[l,c,f,k,s,n,t]}class Uo extends de{constructor(e){super();pe(this,e,Po,Lo,me,{dbPath:4})}}function bt(r,e,o){const t=r.slice();return t[36]=e[o],t}function kt(r){let e,o,t,n,s,l=[],i=new Map,u,a,c,f,k,b,_;o=new Wt({props:{disabled:re(r[0].name)&&r[0].askerUID&&r[6].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[7]}px;`,$$slots:{helper:[zo]},$$scope:{ctx:r}}}),o.$on("input",r[20]);let m=r[0].blackboards;const I=h=>h[36];for(let h=0;h<m.length;h+=1){let w=bt(r,m,h),$=I(w);i.set($,l[h]=yt($,w))}return{c(){e=C("div"),V(o.$$.fragment),t=q(),n=C("div"),s=q();for(let h=0;h<l.length;h+=1)l[h].c();u=q(),a=C("div"),c=B("New blackboard"),this.h()},l(h){e=z(h,"DIV",{style:!0});var w=S(e);j(o.$$.fragment,w),t=Q(w),n=z(w,"DIV",{style:!0}),S(n).forEach(p),s=Q(w);for(let O=0;O<l.length;O+=1)l[O].l(w);u=Q(w),a=z(w,"DIV",{style:!0});var $=S(a);c=M($,"New blackboard"),$.forEach(p),w.forEach(p),this.h()},h(){d(n,"margin-bottom","20px"),d(a,"display","flex"),d(a,"justify-content","center"),d(a,"align-items","center"),d(a,"margin-top","40px"),d(a,"background-color","#2e3131"),d(a,"font-family","Roboto, sans-serif"),d(a,"text-transform","uppercase"),d(a,"color","white"),d(a,"height","35px"),d(a,"width",r[7]+"px"),d(e,"padding","16px"),he(e,"question",re(r[0].name))},m(h,w){R(h,e,w),W(o,e,null),P(e,t),P(e,n),P(e,s);for(let $=0;$<l.length;$+=1)l[$].m(e,null);P(e,u),P(e,a),P(a,c),k=!0,b||(_=[K(a,"click",r[16]),Se(f=Ro.call(null,e,"main-content"))],b=!0)},p(h,w){const $={};w[0]&65&&($.disabled=re(h[0].name)&&h[0].askerUID&&h[6].uid!==h[0].askerUID),w[0]&1&&($.value=h[0].name),w[0]&128&&($.style=`width: ${h[7]}px;`),w[0]&31|w[1]&131072&&($.$$scope={dirty:w,ctx:h}),o.$set($),w[0]&61409|w[1]&122624&&(m=h[0].blackboards,ie(),l=Vt(l,w,I,1,h,m,i,e,jt,yt,u,bt),ue()),(!k||w[0]&128)&&d(a,"width",h[7]+"px"),w[0]&1&&he(e,"question",re(h[0].name))},i(h){if(!k){D(o.$$.fragment,h);for(let w=0;w<m.length;w+=1)D(l[w]);k=!0}},o(h){T(o.$$.fragment,h);for(let w=0;w<l.length;w+=1)T(l[w]);k=!1},d(h){h&&p(e),F(o);for(let w=0;w<l.length;w+=1)l[w].d();b=!1,Pe(_)}}}function So(r){let e=r[0].askerName+"",o,t,n=ze(r[0].dateAsked)+"",s;return{c(){o=B(e),t=B(" asked on "),s=B(n)},l(l){o=M(l,e),t=M(l," asked on "),s=M(l,n)},m(l,i){R(l,o,i),R(l,t,i),R(l,s,i)},p(l,i){i[0]&1&&e!==(e=l[0].askerName+"")&&ae(o,e),i[0]&1&&n!==(n=ze(l[0].dateAsked)+"")&&ae(s,n)},d(l){l&&p(o),l&&p(t),l&&p(s)}}}function Eo(r){let e,o,t;return{c(){e=B("Resolving this question in "),o=B(r[4]),t=B(", cancel by re-adding ?")},l(n){e=M(n,"Resolving this question in "),o=M(n,r[4]),t=M(n,", cancel by re-adding ?")},m(n,s){R(n,e,s),R(n,o,s),R(n,t,s)},p(n,s){s[0]&16&&ae(o,n[4])},d(n){n&&p(e),n&&p(o),n&&p(t)}}}function No(r){let e,o,t;return{c(){e=B("Pinging server members in "),o=B(r[2]),t=B(", cancel by backtracking the ?")},l(n){e=M(n,"Pinging server members in "),o=M(n,r[2]),t=M(n,", cancel by backtracking the ?")},m(n,s){R(n,e,s),R(n,o,s),R(n,t,s)},p(n,s){s[0]&4&&ae(o,n[2])},d(n){n&&p(e),n&&p(o),n&&p(t)}}}function wt(r){let e,o=ze(r[0].dateResolved)+"",t;return{c(){e=B(", resolved "),t=B(o)},l(n){e=M(n,", resolved "),t=M(n,o)},m(n,s){R(n,e,s),R(n,t,s)},p(n,s){s[0]&1&&o!==(o=ze(n[0].dateResolved)+"")&&ae(t,o)},d(n){n&&p(e),n&&p(t)}}}function Co(r){let e,o;function t(i,u){if(i[1])return No;if(i[3])return Eo;if(i[0].askerName&&i[0].askerUID&&i[0].date)return So}let n=t(r),s=n&&n(r),l=r[0].dateResolved&&wt(r);return{c(){s&&s.c(),e=q(),l&&l.c(),o=J()},l(i){s&&s.l(i),e=Q(i),l&&l.l(i),o=J()},m(i,u){s&&s.m(i,u),R(i,e,u),l&&l.m(i,u),R(i,o,u)},p(i,u){n===(n=t(i))&&s?s.p(i,u):(s&&s.d(1),s=n&&n(i),s&&(s.c(),s.m(e.parentNode,e))),i[0].dateResolved?l?l.p(i,u):(l=wt(i),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null)},d(i){s&&s.d(i),i&&p(e),l&&l.d(i),i&&p(o)}}}function zo(r){let e,o;return e=new Ft({props:{slot:"helper",persistent:!0,$$slots:{default:[Co]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&31|n[1]&131072&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function $t(r){let e,o,t,n,s,l;function i(...f){return r[21](r[36],...f)}e=new To({props:{value:r[39].description||""}}),e.$on("input",i);const u=[Mo,Bo],a=[];function c(f,k){return f[39].audioDownloadURL?0:1}return t=c(r),n=a[t]=u[t](r),{c(){V(e.$$.fragment),o=q(),n.c(),s=J()},l(f){j(e.$$.fragment,f),o=Q(f),n.l(f),s=J()},m(f,k){W(e,f,k),R(f,o,k),a[t].m(f,k),R(f,s,k),l=!0},p(f,k){r=f;const b={};k[1]&256&&(b.value=r[39].description||""),e.$set(b);let _=t;t=c(r),t===_?a[t].p(r,k):(ie(),T(a[_],1,1,()=>{a[_]=null}),ue(),n=a[t],n?n.p(r,k):(n=a[t]=u[t](r),n.c()),D(n,1),n.m(s.parentNode,s))},i(f){l||(D(e.$$.fragment,f),D(n),l=!0)},o(f){T(e.$$.fragment,f),T(n),l=!1},d(f){F(e,f),f&&p(o),a[t].d(f),f&&p(s)}}}function Bo(r){let e,o;return e=new Uo({props:{dbPath:r[5]+r[36],$$slots:{default:[Xo,({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>({43:t,41:n,44:s,42:l}),({listenToStrokes:t,strokesArray:n,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>[0,(t?4096:0)|(n?1024:0)|(s?8192:0)|(l?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&33&&(s.dbPath=t[5]+t[36]),n[0]&897|n[1]&138496&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function Mo(r){let e,o;return e=new Zt({props:{dbPath:r[5]+r[36],$$slots:{default:[Ko,({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:s})=>({40:t,41:n,42:s}),({fetchStrokes:t,strokesArray:n,deleteAllStrokesFromDb:s})=>[0,(t?512:0)|(n?1024:0)|(s?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,n){W(e,t,n),o=!0},p(t,n){const s={};n[0]&33&&(s.dbPath=t[5]+t[36]),n[0]&448|n[1]&132864&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){T(e.$$.fragment,t),o=!1},d(t){F(e,t)}}}function Vo(r){let e,o,t;return o=new Kt({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=C("div"),V(o.$$.fragment),this.h()},l(n){e=z(n,"DIV",{style:!0});var s=S(e);j(o.$$.fragment,s),s.forEach(p),this.h()},h(){d(e,"display","flex"),d(e,"justify-content","center"),d(e,"margin-left","20px"),d(e,"margin-right","20px")},m(n,s){R(n,e,s),W(o,e,null),t=!0},p:ce,i(n){t||(D(o.$$.fragment,n),t=!0)},o(n){T(o.$$.fragment,n),t=!1},d(n){n&&p(e),F(o)}}}function jo(r){let e,o,t,n;return{c(){e=C("span"),o=B("stop_circle"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);o=M(l,"stop_circle"),l.forEach(p),this.h()},h(){y(e,"class","material-icons"),d(e,"font-size","2.5rem"),d(e,"color","cyan"),d(e,"margin-left","30px"),d(e,"margin-right","26px")},m(s,l){R(s,e,l),P(e,o),t||(n=K(e,"click",function(){ye(r[46])&&r[46].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&p(e),t=!1,n()}}}function Wo(r){let e,o,t,n;return{c(){e=C("span"),o=B("radio_button_checked"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);o=M(l,"radio_button_checked"),l.forEach(p),this.h()},h(){y(e,"class","material-icons"),d(e,"font-size","2.5rem"),d(e,"color","cyan"),d(e,"margin-left","30px"),d(e,"margin-right","26px")},m(s,l){R(s,e,l),P(e,o),t||(n=K(e,"click",function(){ye(r[45])&&r[45].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&p(e),t=!1,n()}}}function Fo(r){let e,o,t,n;const s=[Wo,jo,Vo],l=[];function i(u,a){return u[9]==="pre_record"?0:u[9]==="mid_record"?1:2}return e=i(r),o=l[e]=s[e](r),{c(){o.c(),t=J()},l(u){o.l(u),t=J()},m(u,a){l[e].m(u,a),R(u,t,a),n=!0},p(u,a){let c=e;e=i(u),e===c?l[e].p(u,a):(ie(),T(l[c],1,1,()=>{l[c]=null}),ue(),o=l[e],o?o.p(u,a):(o=l[e]=s[e](u),o.c()),D(o,1),o.m(t.parentNode,t))},i(u){n||(D(o),n=!0)},o(u){T(o),n=!1},d(u){l[e].d(u),u&&p(t)}}}function Oo(r){let e;return{c(){e=B("Wipe board")},l(o){e=M(o,"Wipe board")},m(o,t){R(o,e,t)},d(o){o&&p(e)}}}function qo(r){let e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"",o,t,n,s,l,i;function u(...a){return r[23](r[39],...a)}return{c(){o=B(e),t=q(),n=C("input"),this.h()},l(a){o=M(a,e),t=Q(a),n=z(a,"INPUT",{id:!0,style:!0,type:!0,accept:!0}),this.h()},h(){y(n,"id",s="input-"+r[39].id),d(n,"display","none"),y(n,"type","file"),y(n,"accept","image/gif, image/jpeg, image/png")},m(a,c){R(a,o,c),R(a,t,c),R(a,n,c),l||(i=K(n,"change",u),l=!0)},p(a,c){r=a,c[1]&256&&e!==(e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"")&&ae(o,e),c[1]&256&&s!==(s="input-"+r[39].id)&&y(n,"id",s)},d(a){a&&p(o),a&&p(t),a&&p(n),l=!1,i()}}}function Qo(r){let e,o,t,n,s;return o=new st({props:{slot:"dropdown-menu",$$slots:{default:[Oo]},$$scope:{ctx:r}}}),o.$on("SMUI:action",function(){ye(r[42])&&r[42].apply(this,arguments)}),n=new st({props:{$$slots:{default:[qo]},$$scope:{ctx:r}}}),n.$on("click",function(){ye(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id))&&(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id)).apply(this,arguments)}),{c(){e=C("div"),V(o.$$.fragment),t=q(),V(n.$$.fragment),this.h()},l(l){e=z(l,"DIV",{slot:!0});var i=S(e);j(o.$$.fragment,i),t=Q(i),j(n.$$.fragment,i),i.forEach(p),this.h()},h(){y(e,"slot","dropdown-menu")},m(l,i){R(l,e,i),W(o,e,null),P(e,t),W(n,e,null),s=!0},p(l,i){r=l;const u={};i[1]&131072&&(u.$$scope={dirty:i,ctx:r}),o.$set(u);const a={};i[1]&131328&&(a.$$scope={dirty:i,ctx:r}),n.$set(a)},i(l){s||(D(o.$$.fragment,l),D(n.$$.fragment,l),s=!0)},o(l){T(o.$$.fragment,l),T(n.$$.fragment,l),s=!1},d(l){l&&p(e),F(o),F(n)}}}function Ho(r){let e,o;function t(...n){return r[24](r[44],...n)}return e=new ko({props:{strokesArray:r[41],currentTime:r[47],backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{"dropdown-menu":[Qo],default:[Fo]},$$scope:{ctx:r}}}),e.$on("stroke-drawn",t),{c(){V(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,s){W(e,n,s),o=!0},p(n,s){r=n;const l={};s[1]&1024&&(l.strokesArray=r[41]),s[1]&65536&&(l.currentTime=r[47]),s[1]&256&&(l.backgroundImageDownloadURL=r[39].backgroundImageDownloadURL),s[0]&512|s[1]&182528&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(n){o||(D(e.$$.fragment,n),o=!0)},o(n){T(e.$$.fragment,n),o=!1},d(n){F(e,n)}}}function Xo(r){let e,o,t,n,s,l,i;function u(...a){return r[25](r[36],...a)}return o=new yo({props:{$$slots:{default:[Ho,({startRecording:a,stopRecording:c,currentTime:f})=>({45:a,46:c,47:f}),({startRecording:a,stopRecording:c,currentTime:f})=>[0,(a?16384:0)|(c?32768:0)|(f?65536:0)]]},$$scope:{ctx:r}}}),o.$on("record-end",u),{c(){e=C("div"),V(o.$$.fragment),this.h()},l(a){e=z(a,"DIV",{style:!0});var c=S(e);j(o.$$.fragment,c),c.forEach(p),this.h()},h(){y(e,"style",t=`width: ${r[7]}px; height: ${r[8]}px; position: relative`)},m(a,c){R(a,e,c),W(o,e,null),s=!0,l||(i=Se(n=ht.call(null,e,r[43])),l=!0)},p(a,c){r=a;const f={};c[0]&512|c[1]&249088&&(f.$$scope={dirty:c,ctx:r}),o.$set(f),(!s||c[0]&384&&t!==(t=`width: ${r[7]}px; height: ${r[8]}px; position: relative`))&&y(e,"style",t),n&&ye(n.update)&&c[1]&4096&&n.update.call(null,r[43])},i(a){s||(D(o.$$.fragment,a),s=!0)},o(a){T(o.$$.fragment,a),s=!1},d(a){a&&p(e),F(o),l=!1,i()}}}function vt(r){let e,o;function t(){return r[22](r[39],r[42])}return e=new Yt({props:{color:"primary",$$slots:{default:[Go]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(n){j(e.$$.fragment,n)},m(n,s){W(e,n,s),o=!0},p(n,s){r=n;const l={};s[1]&131072&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(n){o||(D(e.$$.fragment,n),o=!0)},o(n){T(e.$$.fragment,n),o=!1},d(n){F(e,n)}}}function Go(r){let e;return{c(){e=B("Delete video")},l(o){e=M(o,"Delete video")},m(o,t){R(o,e,t)},d(o){o&&p(e)}}}function Yo(r){let e,o,t=r[6].uid===r[39].creatorUID&&vt(r);return{c(){t&&t.c(),e=J()},l(n){t&&t.l(n),e=J()},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[6].uid===n[39].creatorUID?t?(t.p(n,s),s[0]&64|s[1]&256&&D(t,1)):(t=vt(n),t.c(),D(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(n){o||(D(t),o=!0)},o(n){T(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}function Ko(r){let e,o,t,n,s,l,i;return o=new xt({props:{strokesArray:r[41],audioDownloadURL:r[39].audioDownloadURL,backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{default:[Yo]},$$scope:{ctx:r}}}),{c(){e=C("div"),V(o.$$.fragment),this.h()},l(u){e=z(u,"DIV",{style:!0});var a=S(e);j(o.$$.fragment,a),a.forEach(p),this.h()},h(){y(e,"style",t=`width: ${r[7]}px; height: ${r[8]+40}px; position: relative`)},m(u,a){R(u,e,a),W(o,e,null),s=!0,l||(i=Se(n=ht.call(null,e,r[40])),l=!0)},p(u,a){const c={};a[1]&1024&&(c.strokesArray=u[41]),a[1]&256&&(c.audioDownloadURL=u[39].audioDownloadURL),a[1]&256&&(c.backgroundImageDownloadURL=u[39].backgroundImageDownloadURL),a[0]&64|a[1]&131328&&(c.$$scope={dirty:a,ctx:u}),o.$set(c),(!s||a[0]&384&&t!==(t=`width: ${u[7]}px; height: ${u[8]+40}px; position: relative`))&&y(e,"style",t),n&&ye(n.update)&&a[1]&512&&n.update.call(null,u[40])},i(u){s||(D(o.$$.fragment,u),s=!0)},o(u){T(o.$$.fragment,u),s=!1},d(u){u&&p(e),F(o),l=!1,i()}}}function Jo(r){let e,o,t=r[39]&&$t(r);return{c(){t&&t.c(),e=q()},l(n){t&&t.l(n),e=Q(n)},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[39]?t?(t.p(n,s),s[1]&256&&D(t,1)):(t=$t(n),t.c(),D(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(n){o||(D(t),o=!0)},o(n){T(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}function yt(r,e){let o,t,n;return t=new Jt({props:{dbPath:e[5]+e[36],$$slots:{default:[Jo,({boardDoc:s})=>({39:s}),({boardDoc:s})=>[0,s?256:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){o=J(),V(t.$$.fragment),this.h()},l(s){o=J(),j(t.$$.fragment,s),this.h()},h(){this.first=o},m(s,l){R(s,o,l),W(t,s,l),n=!0},p(s,l){e=s;const i={};l[0]&33&&(i.dbPath=e[5]+e[36]),l[0]&993|l[1]&131328&&(i.$$scope={dirty:l,ctx:e}),t.$set(i)},i(s){n||(D(t.$$.fragment,s),n=!0)},o(s){T(t.$$.fragment,s),n=!1},d(s){s&&p(o),F(t,s)}}}function Zo(r){let e,o,t=r[0]&&kt(r);return{c(){t&&t.c(),e=J()},l(n){t&&t.l(n),e=J()},m(n,s){t&&t.m(n,s),R(n,e,s),o=!0},p(n,s){n[0]?t?(t.p(n,s),s[0]&1&&D(t,1)):(t=kt(n),t.c(),D(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(n){o||(D(t),o=!0)},o(n){T(t),o=!1},d(n){t&&t.d(n),n&&p(e)}}}async function an({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Rt(r){document.getElementById(`input-${r}`).click()}function re(r){return r?r.charAt(r.length-1)==="?":!1}function Xe(r){return r.askerName&&r.dateAsked&&r.askerUID}function xo(r,e,o){let t,n,s,l,i,u,a;X(r,lt,v=>o(6,l=v)),X(r,He,v=>o(7,i=v)),X(r,at,v=>o(8,u=v)),X(r,Ce,v=>o(9,a=v));let{classID:c}=e,{roomID:f}=e,k,b;l.uid||no("/");async function _(){k&&k(),k=et(s,v=>{o(0,b=Le({id:v.id},v.data()))})}xe(()=>{k()});async function m(v,A){const ee=oe(Y(),t+A),H=v.target.files[0];if(!!H)if(H.type.split("/")[0]==="image"){const le=Oe(),te=qe(le,`images/${Ne()}`);await nt(te,H);const Ie=await rt(te);ne(ee,{backgroundImageDownloadURL:Ie})}else alert("Error: only images can be used")}function I(v){const A=oe(Y(),t+v);ne(A,{backgroundImageDownloadURL:ve()})}let h="",w=5,$,O=5;async function N({srcElement:v}){const{value:A}=v,ee={name:A};!re(b.name)&&re(A)&&!Xe(b)?Re():h&&!re(A)?x():!re(A)&&Xe(b)?L():$&&re(A)&&Xe(b)&&Z(),await ne(s,ee)}function Re(){o(2,w=5),o(1,h=setInterval(()=>{o(2,w-=1),w===0&&(fe(),Me(),x())},1e3))}function L(){o(4,O=5),o(3,$=setInterval(()=>{o(4,O-=1),O===0&&U()},1e3))}function U(){ne(s,{dateResolved:new Date().toISOString()})}function Z(){clearTimeout($),o(3,$="")}function x(){clearTimeout(h),o(1,h="")}function fe(){ne(s,{askerName:l.name||"Beaver #999",askerUID:l.uid,dateAsked:new Date().toISOString()})}async function Me(){const v=[],A=Ot(),ee=qt(A,"sendTextMessage"),H=Je(Y(),"users"),le=Ze(H,Qt("willReceiveText","==",!0)),te=await Ht(le);if(te.docs)for(const Ie of te.docs){console.log("phoneNumber =",Ie.data().phoneNumber);try{Ie.id!==l.uid&&v.push(ee({content:`${l.name} asked on https://ihtfp.app: "${b.name||"Fake question here"}"`,toWho:Ie.data().phoneNumber}))}catch(Dt){alert(Dt)}}await Promise.all(v),console.log("success, sent all texts.")}async function Te({detail:v},A){const ee=oe(Y(),t+A);await ne(ee,{description:v})}async function De(v,A){const ee=Oe(),H=qe(ee,`audio/${Ne()}`);await nt(H,v);const le=await rt(H),te=oe(Y(),t+A);await ne(te,{creatorUID:l.uid,creatorPhoneNumber:l.phoneNumber,date:new Date().toISOString(),audioDownloadURL:le,audioRefFullPath:H.fullPath}),Ce.set("pre_record")}async function Ae({id:v,audioRefFullPath:A},ee){const H=[],le=oe(Y(),t+v);if(A){const te=qe(Oe(),A);H.push(Xt(te))}H.push(ne(le,{creator:ve(),creatorPhoneNumber:ve(),date:ve(),audioDownloadURL:ve(),audioRefFullPath:ve()})),H.push(ee()),await Promise.all(H)}async function Ve(){const v=Ne(),A=oe(Y(),t+v);await Promise.all([tt(A,{}),ne(s,{blackboards:Gt(v)})])}const je=v=>N(v),g=(v,A)=>Te(A,v),E=(v,A)=>Ae(v,A),G=(v,A)=>m(A,v.id),se=(v,A)=>v(A.detail.newStroke),We=(v,A)=>De(A.detail.audioBlob,v);return r.$$set=v=>{"classID"in v&&o(17,c=v.classID),"roomID"in v&&o(18,f=v.roomID)},r.$$.update=()=>{r.$$.dirty[0]&131072&&o(5,t=`classes/${c}/blackboards/`),r.$$.dirty[0]&131072&&o(19,n=`classes/${c}/rooms/`),r.$$.dirty[0]&786432&&(s=oe(Y(),n+f)),r.$$.dirty[0]&262144&&_()},[b,h,w,$,O,t,l,i,u,a,m,I,N,Te,De,Ae,Ve,c,f,n,je,g,E,G,se,We]}class un extends de{constructor(e){super();pe(this,e,xo,Zo,me,{classID:17,roomID:18},null,[-1,-1])}}export{un as default,an as load};
