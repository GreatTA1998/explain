var Mt=Object.defineProperty;var rt=Object.getOwnPropertySymbols;var zt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var lt=(n,e,t)=>e in n?Mt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Te=(n,e)=>{for(var t in e||(e={}))zt.call(e,t)&&lt(n,t,e[t]);if(rt)for(var t of rt(e))jt.call(e,t)&&lt(n,t,e[t]);return n};import{S as ae,i as ie,s as ue,ax as Ft,k as M,e as U,n as z,c as E,b as y,M as w,W as Wt,aw as oe,f as v,a1 as X,aB as ce,t as C,a as L,aC as fe,d as h,g as B,N,ag as Ot,I as he,j,m as F,o as W,ay as qt,az as Qt,h as de,J as ge,K as be,L as ke,x as R,u as I,v as O,F as H,r as ne,w as re,a2 as Ke,aD as Je,A as st,ab as Ht,a3 as $e,ae as Xt,ai as Ze,aE as we,aF as Gt,aA as Pe,O as le,a5 as at,Q,a6 as it,a7 as Yt,X as ut,a4 as ct,aG as Kt,T as ft,P as G,aH as Jt,a9 as dt,au as Zt,l as Y,aI as xt,av as eo,aJ as to,_ as K,aK as xe,aL as et,aM as pt,aN as mt,aO as pe,aP as oo,aQ as no,aR as ro,a8 as lo,aS as so,af as ao,Y as io,aT as uo}from"../../../chunks/vendor-c30b751f.js";import{R as co,a as fo,D as po}from"../../../chunks/RenderlessFetchStrokes-5f068974.js";import{_ as mo}from"../../../chunks/preload-helper-ec9aa979.js";import{o as tt,u as _t,j as Se,a as ht,c as ot,d as Ae,f as _o,e as ho,g as go,k as Le,b as bo}from"../../../chunks/navigation-42d1d4ee.js";/* empty css                                                                */import{d as Ne,r as ko,a as $o}from"../../../chunks/canvas-74f91cf9.js";import"../../../chunks/singletons-12a22614.js";const wo=n=>({}),gt=n=>({});function bt(n,e,t){const o=n.slice();return o[9]=e[t],o}function kt(n){let e,t,o,r,l,s=n[1].pencilColors,a=[];for(let i=0;i<s.length;i+=1)a[i]=$t(bt(n,s,i));return{c(){for(let i=0;i<a.length;i+=1)a[i].c();e=M(),t=U("img"),this.h()},l(i){for(let u=0;u<a.length;u+=1)a[u].l(i);e=z(i),t=E(i,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){y(t,"width","46"),y(t,"height","33"),w(t,"margin-left","8px"),Wt(t.src,o="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||y(t,"src",o),y(t,"alt","eraser"),y(t,"class","svelte-1bgxyxs"),oe(t,"eraser-selected",n[2].type==="eraser")},m(i,u){for(let f=0;f<a.length;f+=1)a[f].m(i,u);v(i,e,u),v(i,t,u),r||(l=X(t,"click",n[7]),r=!0)},p(i,u){if(u&6){s=i[1].pencilColors;let f;for(f=0;f<s.length;f+=1){const p=bt(i,s,f);a[f]?a[f].p(p,u):(a[f]=$t(p),a[f].c(),a[f].m(e.parentNode,e))}for(;f<a.length;f+=1)a[f].d(1);a.length=s.length}u&4&&oe(t,"eraser-selected",i[2].type==="eraser")},d(i){Ot(a,i),i&&h(e),i&&h(t),r=!1,l()}}}function $t(n){let e,t,o,r,l,s,a,i,u,f,p,$;function k(){return n[6](n[9])}return{c(){e=U("div"),t=ce("svg"),o=ce("g"),r=ce("path"),l=C(`;\r
            `),s=ce("polygon"),i=ce("path"),u=ce("path"),this.h()},l(m){e=E(m,"DIV",{style:!0,class:!0});var d=L(e);t=fe(d,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var b=L(t);o=fe(b,"g",{});var _=L(o);r=fe(_,"path",{d:!0}),L(r).forEach(h),l=B(_,`;\r
            `),s=fe(_,"polygon",{style:!0,points:!0}),L(s).forEach(h),i=fe(_,"path",{style:!0,d:!0}),L(i).forEach(h),u=fe(_,"path",{style:!0,d:!0}),L(u).forEach(h),_.forEach(h),b.forEach(h),d.forEach(h),this.h()},h(){y(r,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),y(s,"style",a=`fill: ${n[9]};`),y(s,"points","50,211.978 38.879,175.24 61.122,175.24"),w(i,"fill","#424242"),y(i,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),y(u,"style",f=`fill: ${n[9]};`),y(u,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),y(t,"preserveAspectRatio","none"),y(t,"version","1.1"),y(t,"id","Layer_1"),y(t,"xmlns","http://www.w3.org/2000/svg"),y(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(t,"x","0px"),y(t,"y","0px"),y(t,"width","16px"),y(t,"height","30px"),y(t,"viewBox","0 0 100 230"),w(t,"enable-background","new 0 0 100 230"),y(t,"xml:space","preserve"),y(t,"class","svelte-1bgxyxs"),w(e,"margin","0 4px"),w(e,"width","30px"),w(e,"height","42px"),w(e,"border-radius","3px"),w(e,"align-items","center"),w(e,"display","flex"),w(e,"justify-content","center"),y(e,"class","svelte-1bgxyxs"),oe(e,"pencil-selected",n[2].color===n[9])},m(m,d){v(m,e,d),N(e,t),N(t,o),N(o,r),N(o,l),N(o,s),N(o,i),N(o,u),p||($=X(e,"click",k),p=!0)},p(m,d){n=m,d&2&&a!==(a=`fill: ${n[9]};`)&&y(s,"style",a),d&2&&f!==(f=`fill: ${n[9]};`)&&y(u,"style",f),d&6&&oe(e,"pencil-selected",n[2].color===n[9])},d(m){m&&h(e),p=!1,$()}}}function vo(n){let e,t,o,r,l,s=(n[0]?"No touch":"Touch draw")+"",a,i,u=Object.keys(n[1]).length>0,f,p,$,k,m;o=new Ft({props:{icons:!1,checked:!n[0],style:"margin: 0 !important"}});let d=u&&kt(n);const b=n[5].default,_=he(b,n,n[4],null),T=n[5]["dropdown-menu"],S=he(T,n,n[4],gt);return{c(){e=U("div"),t=U("div"),j(o.$$.fragment),r=M(),l=U("div"),a=C(s),i=M(),d&&d.c(),f=M(),_&&_.c(),p=M(),S&&S.c(),this.h()},l(D){e=E(D,"DIV",{style:!0});var P=L(e);t=E(P,"DIV",{style:!0});var q=L(t);F(o.$$.fragment,q),r=z(q),l=E(q,"DIV",{style:!0});var x=L(l);a=B(x,s),x.forEach(h),q.forEach(h),i=z(P),d&&d.l(P),f=z(P),_&&_.l(P),p=z(P),S&&S.l(P),P.forEach(h),this.h()},h(){w(l,"margin-top","2px"),w(l,"font-size","0.55rem"),w(l,"font-family","Roboto,sans-serif"),w(l,"color","white"),w(t,"margin-right","10px"),w(t,"text-align","center"),w(e,"position","absolute"),w(e,"display","flex"),w(e,"align-items","center"),w(e,"height","50px"),w(e,"left","0"),w(e,"right","auto"),w(e,"top","0"),w(e,"bottom","auto"),w(e,"z-index","100"),w(e,"background-color","grey"),w(e,"padding-left","10px"),w(e,"border-radius","2px")},m(D,P){v(D,e,P),N(e,t),W(o,t,null),N(t,r),N(t,l),N(l,a),N(e,i),d&&d.m(e,null),N(e,f),_&&_.m(e,null),N(e,p),S&&S.m(e,null),$=!0,k||(m=X(t,"click",qt(Qt(n[3]))),k=!0)},p(D,[P]){const q={};P&1&&(q.checked=!D[0]),o.$set(q),(!$||P&1)&&s!==(s=(D[0]?"No touch":"Touch draw")+"")&&de(a,s),P&2&&(u=Object.keys(D[1]).length>0),u?d?d.p(D,P):(d=kt(D),d.c(),d.m(e,f)):d&&(d.d(1),d=null),_&&_.p&&(!$||P&16)&&ge(_,b,D,D[4],$?ke(b,D[4],P,null):be(D[4]),null),S&&S.p&&(!$||P&16)&&ge(S,T,D,D[4],$?ke(T,D[4],P,wo):be(D[4]),gt)},i(D){$||(R(o.$$.fragment,D),R(_,D),R(S,D),$=!0)},o(D){I(o.$$.fragment,D),I(_,D),I(S,D),$=!1},d(D){D&&h(e),O(o),d&&d.d(),_&&_.d(D),S&&S.d(D),k=!1,m()}}}function yo(n,e,t){let o,r,l;H(n,tt,p=>t(0,o=p)),H(n,_t,p=>t(1,r=p)),H(n,Se,p=>t(2,l=p));let{$$slots:s={},$$scope:a}=e;function i(){tt.set(!o)}const u=p=>Se.set({type:"pencil",color:p,lineWidth:3}),f=()=>Se.set({type:"eraser",color:"",lineWidth:40});return n.$$set=p=>{"$$scope"in p&&t(4,a=p.$$scope)},[o,r,l,i,a,s,u,f]}class Do extends ae{constructor(e){super();ie(this,e,yo,vo,ue,{})}}function wt(n){let e,t;return e=new Do({props:{$$slots:{"dropdown-menu":[Uo],default:[Ro]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&134217922&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Ro(n){let e;const t=n[20].default,o=he(t,n,n[27],null);return{c(){o&&o.c()},l(r){o&&o.l(r)},m(r,l){o&&o.m(r,l),e=!0},p(r,l){o&&o.p&&(!e||l[0]&134217728)&&ge(o,t,r,r[27],e?ke(t,r[27],l,null):be(r[27]),null)},i(r){e||(R(o,r),e=!0)},o(r){I(o,r),e=!1},d(r){o&&o.d(r)}}}function Io(n){let e,t;return e=new Ze({props:{$$slots:{default:[Po]},$$scope:{ctx:n}}}),e.$on("click",n[11]),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&134217728&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function To(n){let e,t;return e=new Ze({props:{$$slots:{default:[So]},$$scope:{ctx:n}}}),e.$on("click",n[10]),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&134217728&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Po(n){let e;return{c(){e=C("Set background")},l(t){e=B(t,"Set background")},m(t,o){v(t,e,o)},d(t){t&&h(e)}}}function So(n){let e;return{c(){e=C("Remove background")},l(t){e=B(t,"Remove background")},m(t,o){v(t,e,o)},d(t){t&&h(e)}}}function Ao(n){let e;return{c(){e=C("Wipe board")},l(t){e=B(t,"Wipe board")},m(t,o){v(t,e,o)},d(t){t&&h(e)}}}function Lo(n){let e,t,o,r,l;const s=[To,Io],a=[];function i(u,f){return u[1]?0:1}return e=i(n),t=a[e]=s[e](n),r=new Ze({props:{$$slots:{default:[Ao]},$$scope:{ctx:n}}}),r.$on("SMUI:action",n[9]),{c(){t.c(),o=M(),j(r.$$.fragment)},l(u){t.l(u),o=z(u),F(r.$$.fragment,u)},m(u,f){a[e].m(u,f),v(u,o,f),W(r,u,f),l=!0},p(u,f){let p=e;e=i(u),e===p?a[e].p(u,f):(ne(),I(a[p],1,1,()=>{a[p]=null}),re(),t=a[e],t?t.p(u,f):(t=a[e]=s[e](u),t.c()),R(t,1),t.m(o.parentNode,o));const $={};f[0]&134217728&&($.$$scope={dirty:f,ctx:u}),r.$set($)},i(u){l||(R(t),R(r.$$.fragment,u),l=!0)},o(u){I(t),I(r.$$.fragment,u),l=!1},d(u){a[e].d(u),u&&h(o),O(r,u)}}}function No(n){let e,t;return e=new Xt({props:{$$slots:{default:[Lo]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&134217730&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Uo(n){let e,t,o,r,l,s,a,i,u,f,p={style:"width: 300px",$$slots:{default:[No]},$$scope:{ctx:n}};return a=new Ht({props:p}),n[24](a),{c(){e=U("div"),t=U("span"),o=C("more_horiz"),r=M(),l=U("input"),s=M(),j(a.$$.fragment),this.h()},l($){e=E($,"DIV",{slot:!0});var k=L(e);t=E(k,"SPAN",{class:!0,style:!0});var m=L(t);o=B(m,"more_horiz"),m.forEach(h),r=z(k),l=E(k,"INPUT",{style:!0,type:!0,accept:!0}),s=z(k),F(a.$$.fragment,k),k.forEach(h),this.h()},h(){y(t,"class","material-icons"),w(t,"margin-right","10px"),w(t,"color","white"),w(t,"font-size","2rem"),w(l,"display","none"),y(l,"type","file"),y(l,"accept","image/gif, image/jpeg, image/png"),y(e,"slot","dropdown-menu")},m($,k){v($,e,k),N(e,t),N(t,o),N(e,r),N(e,l),n[22](l),N(e,s),W(a,e,null),i=!0,u||(f=[X(t,"click",n[21]),X(l,"change",n[23])],u=!0)},p($,k){const m={};k[0]&134217730&&(m.$$scope={dirty:k,ctx:$}),a.$set(m)},i($){i||(R(a.$$.fragment,$),i=!0)},o($){I(a.$$.fragment,$),i=!1},d($){$&&h(e),n[22](null),n[24](null),O(a),u=!1,Ke(f)}}}function Eo(n){let e,t,o,r,l,s,a,i,u,f=n[0]&&wt(n);return{c(){f&&f.c(),e=M(),t=U("canvas"),r=M(),l=U("canvas"),this.h()},l(p){f&&f.l(p),e=z(p),t=E(p,"CANVAS",{style:!0});var $=L(t);$.forEach(h),r=z(p),l=E(p,"CANVAS",{style:!0});var k=L(l);k.forEach(h),this.h()},h(){y(t,"style",o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${n[5]}px; height: ${n[4]}px`),y(l,"style",s=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${n[5]}px; height: ${n[4]}px`)},m(p,$){f&&f.m(p,$),v(p,e,$),v(p,t,$),n[25](t),v(p,r,$),v(p,l,$),n[26](l),a=!0,i||(u=[X(t,"touchstart",n[12]),X(t,"touchmove",n[13]),X(t,"touchend",n[14])],i=!0)},p(p,$){p[0]?f?(f.p(p,$),$[0]&1&&R(f,1)):(f=wt(p),f.c(),R(f,1),f.m(e.parentNode,e)):f&&(ne(),I(f,1,1,()=>{f=null}),re()),(!a||$[0]&48&&o!==(o=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${p[5]}px; height: ${p[4]}px`))&&y(t,"style",o),(!a||$[0]&48&&s!==(s=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${p[5]}px; height: ${p[4]}px`))&&y(l,"style",s)},i(p){a||(R(f),a=!0)},o(p){I(f),a=!1},d(p){f&&f.d(p),p&&h(e),p&&h(t),n[25](null),p&&h(r),p&&h(l),n[26](null),i=!1,Ke(u)}}}function Co(n){return(n.endTime-n.startTime)/n.points.length}function Bo(n,e,t){let o,r,l,s;H(n,ht,c=>t(4,o=c)),H(n,ot,c=>t(5,r=c)),H(n,Se,c=>t(31,l=c)),H(n,tt,c=>t(32,s=c));let{$$slots:a={},$$scope:i}=e,{strokesArray:u}=e,{currentTime:f=0}=e,{backgroundImageDownloadURL:p=""}=e;const $=Je();let k,m,d,b,_=[],T=!1,S={x:-1,y:-1},D={points:[]},P,q,x;st(()=>{t(16,k=d.getContext("2d")),t(17,m=b.getContext("2d"))});function ve(c){$("background-upload",{imageFile:c.target.files[0]})}function Ue(c){$("board-wipe")}function Ee(){$("background-reset")}function Ce(){x.click()}function ye(c){if(c.touches.length>1)return;const g=c.touches[0].touchType==="stylus";if(s&&!g){console.log("error: cannot use finger during Apple Pencil mode");return}me(c,{isInitialContact:!0})}function Be(c){if(!T)return;if(c.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const g=c.touches[0].touchType==="stylus";if(s&&!g){console.log("error: cannot use finger during Apple Pencil mode");return}me(c,{isInitialContact:!1})}function Ve(c){if(!T||c.touches.length>0)return;const g=c.changedTouches[0].touchType==="stylus";if(s&&!g){console.log("error: cannot use finger during Apple Pencil mode");return}Me(D),T=!1}function De(c){T=!0,S={x:-1,y:-1},D={strokeNumber:u.length+1,startTime:Number(f.toFixed(1)),color:l.color,lineWidth:l.lineWidth,isErasing:l.type==="eraser",points:[],sessionID:"123"}}function me(c,{isInitialContact:g}){c.preventDefault(),g&&De();const A=ze(c);Re(c,A)}function Re(c,g){D.points.push({unitX:parseFloat(g.x/d.width).toFixed(4),unitY:parseFloat(g.y/d.height).toFixed(4)}),S.x!==-1&&S.y!==-1&&$o([Ie(S),Ie(g)],1,l.type==="eraser",k,l.color,l.lineWidth,d),S=g}function Me(c){c.endTime=Number(f.toFixed(1)),c.id=Ae(),_.push(c),$("stroke-drawn",{newStroke:c})}function ze(c){const{left:g,top:A}=d.getBoundingClientRect();return{x:c.touches[0].pageX-g-window.scrollX,y:c.touches[0].pageY-A-window.scrollY}}function Ie({x:c,y:g}){return{unitX:c/d.width,unitY:g/d.height}}function je(){k.clearRect(0,0,r,o)}const Fe=()=>q.setOpen(!0);function We(c){$e[c?"unshift":"push"](()=>{x=c,t(7,x)})}const Oe=c=>ve(c);function qe(c){$e[c?"unshift":"push"](()=>{q=c,t(6,q)})}function Qe(c){$e[c?"unshift":"push"](()=>{d=c,t(2,d),t(16,k),t(5,r),t(4,o),t(0,u)})}function He(c){$e[c?"unshift":"push"](()=>{b=c,t(3,b),t(16,k),t(5,r),t(4,o),t(0,u),t(2,d)})}return n.$$set=c=>{"strokesArray"in c&&t(0,u=c.strokesArray),"currentTime"in c&&t(15,f=c.currentTime),"backgroundImageDownloadURL"in c&&t(1,p=c.backgroundImageDownloadURL),"$$scope"in c&&t(27,i=c.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&65589&&k&&(t(2,d.width=r,d),t(2,d.height=o,d),t(3,b.width=r,b),t(3,b.height=o,b),u))for(const c of u)Ne(c,null,k,d);if(n.$$.dirty[0]&131086&&m&&(m.clearRect(0,0,b.scrollWidth,b.scrollHeight),ko(p,d,m)),n.$$.dirty[0]&851973&&k&&u){let c=_.length,g=u.length;if(c!==g)if(c<g)if(c===0){for(const A of u)Ne(A,null,k,d);t(18,_=[...u])}else for(let A=c;A<g;A++){const V=u[A];Ne(V,V.startTime!==V.endTime?Co(V):null,k,d),_.push(V)}else{let A=function(){je(),t(18,_=[]),S={x:-1,y:-1};for(const J of u)Ne(J,null,k,d)};(function(){console.log("debounced board reset"),P&&clearTimeout(P),t(19,P=setTimeout(A,1e3))})()}}},[u,p,d,b,o,r,q,x,ve,Ue,Ee,Ce,ye,Be,Ve,f,k,m,_,P,a,Fe,We,Oe,qe,Qe,He,i]}class Vo extends ae{constructor(e){super();ie(this,e,Bo,Eo,ue,{strokesArray:0,currentTime:15,backgroundImageDownloadURL:1},null,[-1,-1])}}const Mo=n=>({currentTime:n&1}),vt=n=>({startRecording:n[1],stopRecording:n[2],currentTime:n[0]});function zo(n){let e;const t=n[4].default,o=he(t,n,n[3],vt);return{c(){o&&o.c()},l(r){o&&o.l(r)},m(r,l){o&&o.m(r,l),e=!0},p(r,[l]){o&&o.p&&(!e||l&9)&&ge(o,t,r,r[3],e?ke(t,r[3],l,Mo):be(r[3]),vt)},i(r){e||(R(o,r),e=!0)},o(r){I(o,r),e=!1},d(r){o&&o.d(r)}}}function jo(n,e,t){let o,r;H(n,_o,m=>t(8,o=m)),H(n,ho,m=>t(9,r=m));let{$$slots:l={},$$scope:s}=e,a,i=0,u;st(async()=>{window&&(a=await mo(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=a.default)});const f=Je();let p=null;function $(){return new Promise(async(m,d)=>{if(!r.local.audio){alert('Cannot start recording because your mic is muted - click the switch next to your "beaver #n" to unmute'),d("Cannot start recording because mic stream is muted");return}const b=o.clone();p=new MediaRecorder(b),p.start(),u=setInterval(()=>t(0,i+=.1),100),f("record-start"),m()})}function k(){return new Promise((m,d)=>{clearTimeout(u),p.addEventListener("dataavailable",b=>{const _=b.data;f("record-end",{audioBlob:_}),m()}),p.stop();for(const b of p.stream.getTracks())b.stop()})}return n.$$set=m=>{"$$scope"in m&&t(3,s=m.$$scope)},[i,$,k,s,l]}class Fo extends ae{constructor(e){super();ie(this,e,jo,zo,ue,{})}}function Wo(n,e){let t=document.getElementById(e);return t==null||t.appendChild(n),{destroy(){n.remove()}}}function yt(n,e){let t=new IntersectionObserver(o=>{for(const r of o)if(r.isIntersecting){e(),t.unobserve(n);return}},{root:null,threshold:.2,rootMargin:"0px"});t.observe(n)}function Oo(n){let e,t,o,r,l;return{c(){e=U("div"),t=U("textarea"),this.h()},l(s){e=E(s,"DIV",{class:!0,style:!0});var a=L(e);t=E(a,"TEXTAREA",{rows:!0,style:!0,class:!0}),L(t).forEach(h),a.forEach(h),this.h()},h(){t.value=n[0],y(t,"rows","1"),w(t,"width",n[1]+"px"),y(t,"class","svelte-1xi77cs"),y(e,"class","grow-wrap svelte-1xi77cs"),w(e,"display","grid")},m(s,a){v(s,e,a),N(e,t),n[7](e),r||(l=[X(t,"input",n[6]),we(n[5].call(null,e)),we(o=Gt.call(null,e,n[3]))],r=!0)},p(s,[a]){a&1&&(t.value=s[0]),a&2&&w(t,"width",s[1]+"px"),o&&Pe(o.update)&&a&8&&o.update.call(null,s[3])},i:le,o:le,d(s){s&&h(e),n[7](null),r=!1,Ke(l)}}}function qo(n,e,t){let o,r;H(n,ot,p=>t(1,r=p));let{value:l}=e,s;const a=Je();function i(p){p.dataset.replicatedValue=l}const u=p=>{t(2,s.dataset.replicatedValue=p.target.value,s),a("input",p.target.value)};function f(p){$e[p?"unshift":"push"](()=>{s=p,t(2,s)})}return n.$$set=p=>{"value"in p&&t(0,l=p.value)},n.$$.update=()=>{n.$$.dirty&2&&t(3,o={width:`${r}px`})},[l,r,s,o,a,i,u,f]}class Qo extends ae{constructor(e){super();ie(this,e,qo,Oo,ue,{value:0})}}const Ho=n=>({strokesArray:n&1}),Dt=n=>({listenToStrokes:n[1],strokesArray:n[0],handleNewlyDrawnStroke:n[2],deleteAllStrokesFromDb:n[3]});function Xo(n){let e;const t=n[6].default,o=he(t,n,n[5],Dt);return{c(){o&&o.c()},l(r){o&&o.l(r)},m(r,l){o&&o.m(r,l),e=!0},p(r,[l]){o&&o.p&&(!e||l&33)&&ge(o,t,r,r[5],e?ke(t,r[5],l,Ho):be(r[5]),Dt)},i(r){e||(R(o,r),e=!0)},o(r){I(o,r),e=!1},d(r){o&&o.d(r)}}}function Rt(n){const e=Te({id:n.id},n.data());return e.startTime=0,e.endTime=0,n.data().isErasing||(e.endTime+=.5),e}function Go(n,e,t){let{$$slots:o={},$$scope:r}=e,{dbPath:l}=e,s,a;const i=at(Q(),`${l}/strokes`),u=it(i,Yt("timestamp"));ut(()=>{a&&a()});async function f(){a=ct(u,async k=>{k.docChanges().filter(d=>d.type==="removed").length>0?(t(0,s=[]),await Kt(),k.docs.length>0&&k.docs.forEach(d=>{s.push(Rt(d))})):(s||t(0,s=[]),k.docs.length===s.length||k.docChanges().filter(d=>d.type==="added").forEach(d=>{t(0,s=[...s,Rt(d.doc)])}))})}function p(k){s.push(k);try{ft(G(Q(),`${l}/strokes/${k.id}`),Te({timestamp:Jt()},k))}catch(m){alert(m)}}async function $(){return new Promise(async k=>{const m=[];let d=dt(Q()),b=0;for(const _ of s){b>=500&&(m.push(d.commit()),d=dt(Q()),b=0);const T=G(Q(),`${l}/strokes/${_.id}`);d.delete(T),b+=1}m.push(d.commit()),await Promise.all(m),t(0,s=[]),k()})}return n.$$set=k=>{"dbPath"in k&&t(4,l=k.dbPath),"$$scope"in k&&t(5,r=k.$$scope)},[s,f,p,$,l,r,o]}class Yo extends ae{constructor(e){super();ie(this,e,Go,Xo,ue,{dbPath:4})}}function It(n,e,t){const o=n.slice();return o[41]=e[t],o[43]=t,o}function Tt(n){let e,t,o,r,l,s=[],a=new Map,i,u,f,p;t=new xt({props:{disabled:te(n[0].name)&&n[0].askerUID&&n[6].uid!==n[0].askerUID,value:n[0].name,class:"room-title",style:`width: ${n[8]}px;`,$$slots:{helper:[en]},$$scope:{ctx:n}}}),t.$on("input",n[22]);let $=n[0].blackboards;const k=m=>m[41];for(let m=0;m<$.length;m+=1){let d=It(n,$,m),b=k(d);a.set(b,s[m]=Nt(b,d))}return{c(){e=U("div"),j(t.$$.fragment),o=M(),r=U("div"),l=M();for(let m=0;m<s.length;m+=1)s[m].c();this.h()},l(m){e=E(m,"DIV",{style:!0});var d=L(e);F(t.$$.fragment,d),o=z(d),r=E(d,"DIV",{style:!0}),L(r).forEach(h),l=z(d);for(let b=0;b<s.length;b+=1)s[b].l(d);d.forEach(h),this.h()},h(){w(r,"margin-bottom","20px"),w(e,"padding","16px"),oe(e,"question",te(n[0].name))},m(m,d){v(m,e,d),W(t,e,null),N(e,o),N(e,r),N(e,l);for(let b=0;b<s.length;b+=1)s[b].m(e,null);u=!0,f||(p=we(i=Wo.call(null,e,"main-content")),f=!0)},p(m,d){const b={};d[0]&65&&(b.disabled=te(m[0].name)&&m[0].askerUID&&m[6].uid!==m[0].askerUID),d[0]&1&&(b.value=m[0].name),d[0]&256&&(b.style=`width: ${m[8]}px;`),d[0]&31|d[1]&4194304&&(b.$$scope={dirty:d,ctx:m}),t.$set(b),d[0]&507873|d[1]&2351104&&($=m[0].blackboards,ne(),s=Zt(s,d,k,1,m,$,a,e,eo,Nt,null,It),re()),d[0]&1&&oe(e,"question",te(m[0].name))},i(m){if(!u){R(t.$$.fragment,m);for(let d=0;d<$.length;d+=1)R(s[d]);u=!0}},o(m){I(t.$$.fragment,m);for(let d=0;d<s.length;d+=1)I(s[d]);u=!1},d(m){m&&h(e),O(t);for(let d=0;d<s.length;d+=1)s[d].d();f=!1,p()}}}function Ko(n){let e=n[0].askerName+"",t,o,r=Le(n[0].dateAsked)+"",l;return{c(){t=C(e),o=C(" asked on "),l=C(r)},l(s){t=B(s,e),o=B(s," asked on "),l=B(s,r)},m(s,a){v(s,t,a),v(s,o,a),v(s,l,a)},p(s,a){a[0]&1&&e!==(e=s[0].askerName+"")&&de(t,e),a[0]&1&&r!==(r=Le(s[0].dateAsked)+"")&&de(l,r)},d(s){s&&h(t),s&&h(o),s&&h(l)}}}function Jo(n){let e,t,o;return{c(){e=C("Resolving this question in "),t=C(n[4]),o=C(", cancel by re-adding ?")},l(r){e=B(r,"Resolving this question in "),t=B(r,n[4]),o=B(r,", cancel by re-adding ?")},m(r,l){v(r,e,l),v(r,t,l),v(r,o,l)},p(r,l){l[0]&16&&de(t,r[4])},d(r){r&&h(e),r&&h(t),r&&h(o)}}}function Zo(n){let e,t,o;return{c(){e=C("Pinging server members in "),t=C(n[2]),o=C(", cancel by backtracking the ?")},l(r){e=B(r,"Pinging server members in "),t=B(r,n[2]),o=B(r,", cancel by backtracking the ?")},m(r,l){v(r,e,l),v(r,t,l),v(r,o,l)},p(r,l){l[0]&4&&de(t,r[2])},d(r){r&&h(e),r&&h(t),r&&h(o)}}}function Pt(n){let e,t=Le(n[0].dateResolved)+"",o;return{c(){e=C(", resolved "),o=C(t)},l(r){e=B(r,", resolved "),o=B(r,t)},m(r,l){v(r,e,l),v(r,o,l)},p(r,l){l[0]&1&&t!==(t=Le(r[0].dateResolved)+"")&&de(o,t)},d(r){r&&h(e),r&&h(o)}}}function xo(n){let e,t;function o(a,i){if(a[1])return Zo;if(a[3])return Jo;if(a[0].askerName&&a[0].askerUID&&a[0].date)return Ko}let r=o(n),l=r&&r(n),s=n[0].dateResolved&&Pt(n);return{c(){l&&l.c(),e=M(),s&&s.c(),t=Y()},l(a){l&&l.l(a),e=z(a),s&&s.l(a),t=Y()},m(a,i){l&&l.m(a,i),v(a,e,i),s&&s.m(a,i),v(a,t,i)},p(a,i){r===(r=o(a))&&l?l.p(a,i):(l&&l.d(1),l=r&&r(a),l&&(l.c(),l.m(e.parentNode,e))),a[0].dateResolved?s?s.p(a,i):(s=Pt(a),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},d(a){l&&l.d(a),a&&h(e),s&&s.d(a),a&&h(t)}}}function en(n){let e,t;return e=new to({props:{slot:"helper",persistent:!0,$$slots:{default:[xo]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&31|r[1]&4194304&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function St(n){let e,t,o,r,l,s,a,i,u,f,p;function $(..._){return n[23](n[41],..._)}o=new Qo({props:{value:n[44].description||""}}),o.$on("input",$);const k=[on,tn],m=[];function d(_,T){return _[44].audioDownloadURL?0:1}a=d(n),i=m[a]=k[a](n);let b=n[43]===n[0].blackboards.length-1&&Lt(n);return{c(){e=U("div"),t=M(),j(o.$$.fragment),r=M(),l=U("div"),s=M(),i.c(),u=M(),b&&b.c(),f=Y(),this.h()},l(_){e=E(_,"DIV",{style:!0}),L(e).forEach(h),t=z(_),F(o.$$.fragment,_),r=z(_),l=E(_,"DIV",{style:!0}),L(l).forEach(h),s=z(_),i.l(_),u=z(_),b&&b.l(_),f=Y(),this.h()},h(){w(e,"margin-top","10px"),w(l,"margin-bottom","10px")},m(_,T){v(_,e,T),v(_,t,T),W(o,_,T),v(_,r,T),v(_,l,T),v(_,s,T),m[a].m(_,T),v(_,u,T),b&&b.m(_,T),v(_,f,T),p=!0},p(_,T){n=_;const S={};T[1]&8192&&(S.value=n[44].description||""),o.$set(S);let D=a;a=d(n),a===D?m[a].p(n,T):(ne(),I(m[D],1,1,()=>{m[D]=null}),re(),i=m[a],i?i.p(n,T):(i=m[a]=k[a](n),i.c()),R(i,1),i.m(u.parentNode,u)),n[43]===n[0].blackboards.length-1?b?b.p(n,T):(b=Lt(n),b.c(),b.m(f.parentNode,f)):b&&(b.d(1),b=null)},i(_){p||(R(o.$$.fragment,_),R(i),p=!0)},o(_){I(o.$$.fragment,_),I(i),p=!1},d(_){_&&h(e),_&&h(t),O(o,_),_&&h(r),_&&h(l),_&&h(s),m[a].d(_),_&&h(u),b&&b.d(_),_&&h(f)}}}function tn(n){let e,t;return e=new Yo({props:{dbPath:n[5]+n[41],$$slots:{default:[un,({listenToStrokes:o,strokesArray:r,handleNewlyDrawnStroke:l,deleteAllStrokesFromDb:s})=>({48:o,46:r,49:l,47:s}),({listenToStrokes:o,strokesArray:r,handleNewlyDrawnStroke:l,deleteAllStrokesFromDb:s})=>[0,(o?131072:0)|(r?32768:0)|(l?262144:0)|(s?65536:0)]]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&33&&(l.dbPath=o[5]+o[41]),r[0]&897|r[1]&4431872&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function on(n){let e,t;return e=new fo({props:{dbPath:n[5]+n[41],$$slots:{default:[dn,({fetchStrokes:o,strokesArray:r,deleteAllStrokesFromDb:l})=>({45:o,46:r,47:l}),({fetchStrokes:o,strokesArray:r,deleteAllStrokesFromDb:l})=>[0,(o?16384:0)|(r?32768:0)|(l?65536:0)]]},$$scope:{ctx:n}}}),{c(){j(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,r){W(e,o,r),t=!0},p(o,r){const l={};r[0]&33&&(l.dbPath=o[5]+o[41]),r[0]&832|r[1]&4251648&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){t||(R(e.$$.fragment,o),t=!0)},o(o){I(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function nn(n){let e,t,o;return t=new uo({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=U("div"),j(t.$$.fragment),this.h()},l(r){e=E(r,"DIV",{style:!0});var l=L(e);F(t.$$.fragment,l),l.forEach(h),this.h()},h(){w(e,"display","flex"),w(e,"justify-content","center"),w(e,"margin-left","20px"),w(e,"margin-right","20px")},m(r,l){v(r,e,l),W(t,e,null),o=!0},p:le,i(r){o||(R(t.$$.fragment,r),o=!0)},o(r){I(t.$$.fragment,r),o=!1},d(r){r&&h(e),O(t)}}}function rn(n){let e,t,o,r;function l(){return n[26](n[51],n[41])}return{c(){e=U("span"),t=C("stop_circle"),this.h()},l(s){e=E(s,"SPAN",{class:!0,style:!0});var a=L(e);t=B(a,"stop_circle"),a.forEach(h),this.h()},h(){y(e,"class","material-icons svelte-53fhoc"),w(e,"font-size","2.5rem"),w(e,"color","cyan"),w(e,"margin-left","30px"),w(e,"margin-right","26px"),oe(e,"unclickable",n[7]!==n[44].recorderBrowserTabID)},m(s,a){v(s,e,a),N(e,t),o||(r=X(e,"click",l),o=!0)},p(s,a){n=s,a[0]&128|a[1]&8192&&oe(e,"unclickable",n[7]!==n[44].recorderBrowserTabID)},i:le,o:le,d(s){s&&h(e),o=!1,r()}}}function ln(n){let e,t,o,r;function l(){return n[25](n[50],n[41])}return{c(){e=U("span"),t=C("radio_button_checked"),this.h()},l(s){e=E(s,"SPAN",{class:!0,style:!0});var a=L(e);t=B(a,"radio_button_checked"),a.forEach(h),this.h()},h(){y(e,"class","material-icons"),w(e,"font-size","2.5rem"),w(e,"color","cyan"),w(e,"margin-left","30px"),w(e,"margin-right","26px")},m(s,a){v(s,e,a),N(e,t),o||(r=X(e,"click",l),o=!0)},p(s,a){n=s},i:le,o:le,d(s){s&&h(e),o=!1,r()}}}function sn(n){let e,t,o,r;const l=[ln,rn,nn],s=[];function a(i,u){return!i[44].recordState||i[44].recordState==="pre_record"?0:i[44].recordState==="mid_record"?1:2}return e=a(n),t=s[e]=l[e](n),{c(){t.c(),o=Y()},l(i){t.l(i),o=Y()},m(i,u){s[e].m(i,u),v(i,o,u),r=!0},p(i,u){let f=e;e=a(i),e===f?s[e].p(i,u):(ne(),I(s[f],1,1,()=>{s[f]=null}),re(),t=s[e],t?t.p(i,u):(t=s[e]=l[e](i),t.c()),R(t,1),t.m(o.parentNode,o))},i(i){r||(R(t),r=!0)},o(i){I(t),r=!1},d(i){s[e].d(i),i&&h(o)}}}function an(n){let e,t;function o(...s){return n[27](n[41],...s)}function r(){return n[28](n[41])}function l(...s){return n[29](n[49],...s)}return e=new Vo({props:{strokesArray:n[46],currentTime:n[52],backgroundImageDownloadURL:n[44].backgroundImageDownloadURL,$$slots:{default:[sn]},$$scope:{ctx:n}}}),e.$on("background-upload",o),e.$on("background-reset",r),e.$on("stroke-drawn",l),e.$on("board-wipe",function(){Pe(n[47])&&n[47].apply(this,arguments)}),{c(){j(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,a){W(e,s,a),t=!0},p(s,a){n=s;const i={};a[1]&32768&&(i.strokesArray=n[46]),a[1]&2097152&&(i.currentTime=n[52]),a[1]&8192&&(i.backgroundImageDownloadURL=n[44].backgroundImageDownloadURL),a[0]&129|a[1]&4202496&&(i.$$scope={dirty:a,ctx:n}),e.$set(i)},i(s){t||(R(e.$$.fragment,s),t=!0)},o(s){I(e.$$.fragment,s),t=!1},d(s){O(e,s)}}}function un(n){let e,t,o,r,l,s,a;function i(...u){return n[30](n[46],n[41],...u)}return t=new Fo({props:{$$slots:{default:[an,({startRecording:u,stopRecording:f,currentTime:p})=>({50:u,51:f,52:p}),({startRecording:u,stopRecording:f,currentTime:p})=>[0,(u?524288:0)|(f?1048576:0)|(p?2097152:0)]]},$$scope:{ctx:n}}}),t.$on("record-end",i),{c(){e=U("div"),j(t.$$.fragment),this.h()},l(u){e=E(u,"DIV",{style:!0});var f=L(e);F(t.$$.fragment,f),f.forEach(h),this.h()},h(){y(e,"style",o=`width: ${n[8]}px; height: ${n[9]}px; position: relative`)},m(u,f){v(u,e,f),W(t,e,null),l=!0,s||(a=we(r=yt.call(null,e,n[48])),s=!0)},p(u,f){n=u;const p={};f[0]&129|f[1]&6397952&&(p.$$scope={dirty:f,ctx:n}),t.$set(p),(!l||f[0]&768&&o!==(o=`width: ${n[8]}px; height: ${n[9]}px; position: relative`))&&y(e,"style",o),r&&Pe(r.update)&&f[1]&131072&&r.update.call(null,n[48])},i(u){l||(R(t.$$.fragment,u),l=!0)},o(u){I(t.$$.fragment,u),l=!1},d(u){u&&h(e),O(t),s=!1,a()}}}function At(n){let e,t;function o(){return n[24](n[44],n[47])}return e=new io({props:{color:"primary",$$slots:{default:[cn]},$$scope:{ctx:n}}}),e.$on("click",o),{c(){j(e.$$.fragment)},l(r){F(e.$$.fragment,r)},m(r,l){W(e,r,l),t=!0},p(r,l){n=r;const s={};l[1]&4194304&&(s.$$scope={dirty:l,ctx:n}),e.$set(s)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){O(e,r)}}}function cn(n){let e;return{c(){e=C("Delete video")},l(t){e=B(t,"Delete video")},m(t,o){v(t,e,o)},d(t){t&&h(e)}}}function fn(n){let e,t,o=n[6].uid===n[44].creatorUID&&At(n);return{c(){o&&o.c(),e=Y()},l(r){o&&o.l(r),e=Y()},m(r,l){o&&o.m(r,l),v(r,e,l),t=!0},p(r,l){r[6].uid===r[44].creatorUID?o?(o.p(r,l),l[0]&64|l[1]&8192&&R(o,1)):(o=At(r),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),I(o,1,1,()=>{o=null}),re())},i(r){t||(R(o),t=!0)},o(r){I(o),t=!1},d(r){o&&o.d(r),r&&h(e)}}}function dn(n){let e,t,o,r,l,s,a;return t=new po({props:{strokesArray:n[46],audioDownloadURL:n[44].audioDownloadURL,backgroundImageDownloadURL:n[44].backgroundImageDownloadURL,$$slots:{default:[fn]},$$scope:{ctx:n}}}),{c(){e=U("div"),j(t.$$.fragment),this.h()},l(i){e=E(i,"DIV",{style:!0});var u=L(e);F(t.$$.fragment,u),u.forEach(h),this.h()},h(){y(e,"style",o=`width: ${n[8]}px; height: ${n[9]+40}px; position: relative`)},m(i,u){v(i,e,u),W(t,e,null),l=!0,s||(a=we(r=yt.call(null,e,n[45])),s=!0)},p(i,u){const f={};u[1]&32768&&(f.strokesArray=i[46]),u[1]&8192&&(f.audioDownloadURL=i[44].audioDownloadURL),u[1]&8192&&(f.backgroundImageDownloadURL=i[44].backgroundImageDownloadURL),u[0]&64|u[1]&4202496&&(f.$$scope={dirty:u,ctx:i}),t.$set(f),(!l||u[0]&768&&o!==(o=`width: ${i[8]}px; height: ${i[9]+40}px; position: relative`))&&y(e,"style",o),r&&Pe(r.update)&&u[1]&16384&&r.update.call(null,i[45])},i(i){l||(R(t.$$.fragment,i),l=!0)},o(i){I(t.$$.fragment,i),l=!1},d(i){i&&h(e),O(t),s=!1,a()}}}function Lt(n){let e,t,o,r;return{c(){e=U("div"),t=C("New blackboard"),this.h()},l(l){e=E(l,"DIV",{style:!0});var s=L(e);t=B(s,"New blackboard"),s.forEach(h),this.h()},h(){w(e,"display","flex"),w(e,"justify-content","center"),w(e,"align-items","center"),w(e,"margin-top","40px"),w(e,"background-color","#2e3131"),w(e,"font-family","Roboto, sans-serif"),w(e,"text-transform","uppercase"),w(e,"color","white"),w(e,"height","35px"),w(e,"width",n[8]+"px")},m(l,s){v(l,e,s),N(e,t),o||(r=X(e,"click",n[18]),o=!0)},p(l,s){s[0]&256&&w(e,"width",l[8]+"px")},d(l){l&&h(e),o=!1,r()}}}function pn(n){let e,t,o=n[44]&&St(n);return{c(){o&&o.c(),e=M()},l(r){o&&o.l(r),e=z(r)},m(r,l){o&&o.m(r,l),v(r,e,l),t=!0},p(r,l){r[44]?o?(o.p(r,l),l[1]&8192&&R(o,1)):(o=St(r),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),I(o,1,1,()=>{o=null}),re())},i(r){t||(R(o),t=!0)},o(r){I(o),t=!1},d(r){o&&o.d(r),r&&h(e)}}}function Nt(n,e){let t,o,r;return o=new co({props:{dbPath:e[5]+e[41],$$slots:{default:[pn,({boardDoc:l})=>({44:l}),({boardDoc:l})=>[0,l?8192:0]]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=Y(),j(o.$$.fragment),this.h()},l(l){t=Y(),F(o.$$.fragment,l),this.h()},h(){this.first=t},m(l,s){v(l,t,s),W(o,l,s),r=!0},p(l,s){e=l;const a={};s[0]&33&&(a.dbPath=e[5]+e[41]),s[0]&993|s[1]&4202496&&(a.$$scope={dirty:s,ctx:e}),o.$set(a)},i(l){r||(R(o.$$.fragment,l),r=!0)},o(l){I(o.$$.fragment,l),r=!1},d(l){l&&h(t),O(o,l)}}}function mn(n){let e,t,o=n[0]&&Tt(n);return{c(){o&&o.c(),e=Y()},l(r){o&&o.l(r),e=Y()},m(r,l){o&&o.m(r,l),v(r,e,l),t=!0},p(r,l){r[0]?o?(o.p(r,l),l[0]&1&&R(o,1)):(o=Tt(r),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ne(),I(o,1,1,()=>{o=null}),re())},i(r){t||(R(o),t=!0)},o(r){I(o),t=!1},d(r){o&&o.d(r),r&&h(e)}}}async function Dn({page:n}){return{props:{classID:n.params.class,roomID:n.params.room}}}function Ut(...n){for(const e of n)e()}function te(n){return n?n.charAt(n.length-1)==="?":!1}function nt(n){return n.askerName&&n.dateAsked&&n.askerUID}function _n(n,e,t){let o,r,l,s,a,i,u;H(n,_t,c=>t(6,s=c)),H(n,bo,c=>t(7,a=c)),H(n,ot,c=>t(8,i=c)),H(n,ht,c=>t(9,u=c));let{classID:f}=e,{roomID:p}=e,$,k;s.uid||go("/");async function m(){$&&$(),$=ct(l,c=>{t(0,k=Te({id:c.id},c.data()))})}ut(()=>{$()});function d(c){const g=G(Q(),o+c);K(g,{recorderBrowserTabID:a})}function b(c,g){const A=G(Q(),o+c);K(A,{recordState:g})}async function _(c,g){const A=G(Q(),o+g);if(!!c)if(c.type.split("/")[0]==="image"){const V=xe(),J=et(V,`images/${Ae()}`);await pt(J,c);const ee=await mt(J);K(A,{backgroundImageDownloadURL:ee})}else alert("Error: only images can be used")}function T(c){const g=G(Q(),o+c);K(g,{backgroundImageDownloadURL:pe()})}let S="",D=5,P,q=5;async function x({srcElement:c}){const{value:g}=c,A={name:g};!te(k.name)&&te(g)&&!nt(k)?ve():S&&!te(g)?ye():!te(g)&&nt(k)?Ue():P&&te(g)&&nt(k)&&Ce(),await K(l,A)}function ve(){t(2,D=5),t(1,S=setInterval(()=>{t(2,D-=1),D===0&&(Be(),Ve(),ye())},1e3))}function Ue(){t(4,q=5),t(3,P=setInterval(()=>{t(4,q-=1),q===0&&Ee()},1e3))}function Ee(){K(l,{dateResolved:new Date().toISOString()})}function Ce(){clearTimeout(P),t(3,P="")}function ye(){clearTimeout(S),t(1,S="")}function Be(){K(l,{askerName:s.name||"Beaver #999",askerUID:s.uid,dateAsked:new Date().toISOString()})}async function Ve(){const c=[],g=oo(),A=no(g,"sendTextMessage"),V=at(Q(),"users"),J=it(V,ro("willReceiveText","==",!0)),ee=await lo(J);if(ee.docs)for(const _e of ee.docs){console.log("phoneNumber =",_e.data().phoneNumber);try{_e.id!==s.uid&&c.push(A({content:`${s.name} asked on https://ihtfp.app: "${k.name||"Fake question here"}"`,toWho:_e.data().phoneNumber}))}catch(Xe){alert(Xe)}}await Promise.all(c),console.log("success, sent all texts.")}async function De({detail:c},g){const A=G(Q(),o+g);await K(A,{description:c})}async function me(c,g,A){function V(Z){return Z.startTime!==0&&Z.endTime!==J}const J=.5,ee=[],_e=g.length;for(let Z=0;Z<_e;Z++){if(!V(g[Z])){let se=Z-1;for(;se>=0;){if(V(g[se])){g[Z].startTime=g[se].endTime,g[Z].endTime=g[Z].startTime+J,ee.push(Z);break}se-=1}}for(let se of ee){const Ye=g[se],Bt=o+A,Vt=G(Q(),`${Bt}/strokes/${Ye.id}`);K(Vt,{startTime:Ye.startTime,endTime:Ye.endTime})}}const Xe=xe(),Ge=et(Xe,`audio/${Ae()}`);await pt(Ge,c);const Et=await mt(Ge),Ct=G(Q(),o+A);await K(Ct,{creatorUID:s.uid,creatorPhoneNumber:s.phoneNumber,date:new Date().toISOString(),audioDownloadURL:Et,audioRefFullPath:Ge.fullPath}),b(A,"pre_record")}async function Re({id:c,audioRefFullPath:g},A){const V=[],J=G(Q(),o+c);if(g){const ee=et(xe(),g);V.push(so(ee))}V.push(K(J,{creator:pe(),creatorPhoneNumber:pe(),date:pe(),audioDownloadURL:pe(),audioRefFullPath:pe()})),V.push(A()),await Promise.all(V)}async function Me(){const c=Ae(),g=G(Q(),o+c);await Promise.all([ft(g,{}),K(l,{blackboards:ao(c)})])}const ze=c=>x(c),Ie=(c,g)=>De(g,c),je=(c,g)=>Re(c,g),Fe=(c,g)=>Ut(c,()=>b(g,"mid_record"),()=>d(g)),We=(c,g)=>Ut(c,()=>b(g,"post_record")),Oe=(c,g)=>_(g.detail.imageFile,c),qe=c=>T(c),Qe=(c,g)=>c(g.detail.newStroke),He=(c,g,A)=>me(A.detail.audioBlob,c,g);return n.$$set=c=>{"classID"in c&&t(19,f=c.classID),"roomID"in c&&t(20,p=c.roomID)},n.$$.update=()=>{n.$$.dirty[0]&524288&&t(5,o=`classes/${f}/blackboards/`),n.$$.dirty[0]&524288&&t(21,r=`classes/${f}/rooms/`),n.$$.dirty[0]&3145728&&(l=G(Q(),r+p)),n.$$.dirty[0]&1048576&&m()},[k,S,D,P,q,o,s,a,i,u,d,b,_,T,x,De,me,Re,Me,f,p,r,ze,Ie,je,Fe,We,Oe,qe,Qe,He]}class Rn extends ae{constructor(e){super();ie(this,e,_n,mn,ue,{classID:19,roomID:20},null,[-1,-1])}}export{Rn as default,Dn as load};
