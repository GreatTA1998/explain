var Tt=Object.defineProperty;var Ge=Object.getOwnPropertySymbols;var At=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable;var Ye=(r,e,n)=>e in r?Tt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,Le=(r,e)=>{for(var n in e||(e={}))At.call(e,n)&&Ye(r,n,e[n]);if(Ge)for(var n of Ge(e))Lt.call(e,n)&&Ye(r,n,e[n]);return r};import{S as de,i as pe,s as me,ay as Pt,k as O,e as C,n as q,c as z,b as y,L as m,U as Ut,au as he,f as D,a3 as J,az as _e,t as B,a as S,aA as ge,d as p,g as M,M as P,af as St,H as be,ad as Et,j as V,m as j,o as W,av as Nt,aw as Ct,h as ae,I as ke,J as we,K as $e,x as R,u as T,v as F,a4 as Pe,E as G,Z as Ue,ae as zt,r as ie,w as ue,aB as Fe,A as Ke,aC as Se,N as ce,a8 as Je,P as Y,a9 as Ze,aa as Bt,a6 as xe,a7 as et,aD as Mt,R as tt,O as oe,aE as Vt,ac as ot,as as jt,at as Wt,l as Z,Y as Ft,a5 as Ot,aF as Oe,aG as qe,aH as nt,aI as rt,_ as ne,aJ as qt,aK as Qt,aL as Ht,ab as Xt,aM as Gt,aN as Yt,aO as ve,ax as ye,ag as st,a0 as Kt,aP as Jt}from"../../../chunks/vendor-c3eb7dcc.js";import{R as Zt,a as xt,D as eo}from"../../../chunks/RenderlessFetchStrokes-5a7b6be2.js";import{_ as to}from"../../../chunks/preload-helper-ec9aa979.js";import{o as Qe,u as lt,f as Ee,a as at,c as He,g as Ne,e as it,j as Ce,k as ze}from"../../../chunks/store-60662746.js";import{d as Be,r as oo,a as no,g as ro}from"../../../chunks/canvas-0a4edf37.js";import"../../../chunks/singletons-12a22614.js";const so=r=>({}),ut=r=>({});function ct(r,e,n){const t=r.slice();return t[11]=e[n],t}function ft(r){let e,n,t,o,s,l=r[2].pencilColors,c=[];for(let i=0;i<l.length;i+=1)c[i]=dt(ct(r,l,i));return{c(){for(let i=0;i<c.length;i+=1)c[i].c();e=O(),n=C("img"),this.h()},l(i){for(let a=0;a<c.length;a+=1)c[a].l(i);e=q(i),n=z(i,"IMG",{width:!0,height:!0,style:!0,src:!0,alt:!0,class:!0}),this.h()},h(){y(n,"width","46"),y(n,"height","33"),m(n,"margin-left","8px"),Ut(n.src,t="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR30G9gEErDXNf8qxm0-vvSLs2zaE8V6v-pDqxNg-CUaoeORwmoosKPF-DC2SUG772Tm3A&usqp=CAU")||y(n,"src",t),y(n,"alt","eraser"),y(n,"class","svelte-1bgxyxs"),he(n,"eraser-selected",r[3].type==="eraser")},m(i,a){for(let u=0;u<c.length;u+=1)c[u].m(i,a);D(i,e,a),D(i,n,a),o||(s=J(n,"click",r[7]),o=!0)},p(i,a){if(a&12){l=i[2].pencilColors;let u;for(u=0;u<l.length;u+=1){const f=ct(i,l,u);c[u]?c[u].p(f,a):(c[u]=dt(f),c[u].c(),c[u].m(e.parentNode,e))}for(;u<c.length;u+=1)c[u].d(1);c.length=l.length}a&8&&he(n,"eraser-selected",i[3].type==="eraser")},d(i){St(c,i),i&&p(e),i&&p(n),o=!1,s()}}}function dt(r){let e,n,t,o,s,l,c,i,a,u,f,_;function g(){return r[6](r[11])}return{c(){e=C("div"),n=_e("svg"),t=_e("g"),o=_e("path"),s=B(`;\r
            `),l=_e("polygon"),i=_e("path"),a=_e("path"),this.h()},l(w){e=z(w,"DIV",{style:!0,class:!0});var d=S(e);n=ge(d,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,viewBox:!0,style:!0,"xml:space":!0,class:!0});var I=S(n);t=ge(I,"g",{});var b=S(t);o=ge(b,"path",{d:!0}),S(o).forEach(p),s=M(b,`;\r
            `),l=ge(b,"polygon",{style:!0,points:!0}),S(l).forEach(p),i=ge(b,"path",{style:!0,d:!0}),S(i).forEach(p),a=ge(b,"path",{style:!0,d:!0}),S(a).forEach(p),b.forEach(p),I.forEach(p),d.forEach(p),this.h()},h(){y(o,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
              L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),y(l,"style",c=`fill: ${r[11]};`),y(l,"points","50,211.978 38.879,175.24 61.122,175.24"),m(i,"fill","#424242"),y(i,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
                l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),y(a,"style",u=`fill: ${r[11]};`),y(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
                c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
                c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),y(n,"preserveAspectRatio","none"),y(n,"version","1.1"),y(n,"id","Layer_1"),y(n,"xmlns","http://www.w3.org/2000/svg"),y(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(n,"x","0px"),y(n,"y","0px"),y(n,"width","16px"),y(n,"height","30px"),y(n,"viewBox","0 0 100 230"),m(n,"enable-background","new 0 0 100 230"),y(n,"xml:space","preserve"),y(n,"class","svelte-1bgxyxs"),m(e,"margin","0 4px"),m(e,"width","30px"),m(e,"height","42px"),m(e,"border-radius","3px"),m(e,"align-items","center"),m(e,"display","flex"),m(e,"justify-content","center"),y(e,"class","svelte-1bgxyxs"),he(e,"pencil-selected",r[3].color===r[11])},m(w,d){D(w,e,d),P(e,n),P(n,t),P(t,o),P(t,s),P(t,l),P(t,i),P(t,a),f||(_=J(e,"click",g),f=!0)},p(w,d){r=w,d&4&&c!==(c=`fill: ${r[11]};`)&&y(l,"style",c),d&4&&u!==(u=`fill: ${r[11]};`)&&y(a,"style",u),d&12&&he(e,"pencil-selected",r[3].color===r[11])},d(w){w&&p(e),f=!1,_()}}}function lo(r){let e;const n=r[5]["dropdown-menu"],t=be(n,r,r[10],ut);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&1024)&&ke(t,n,o,o[10],e?$e(n,o[10],s,so):we(o[10]),ut)},i(o){e||(R(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function ao(r){let e,n;return e=new zt({props:{$$slots:{default:[lo]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o&1024&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function io(r){let e,n,t,o,s,l=(r[1]?"No touch":"Touch draw")+"",c,i,a=Object.keys(r[2]).length>0,u,f,_,g,w,d,I,b,k;t=new Pt({props:{icons:!1,checked:!r[1],style:"margin: 0 !important"}});let v=a&&ft(r);const Q=r[5].default,N=be(Q,r,r[10],null);let De={style:"left: 100px; top: 50px; width: 300px",$$slots:{default:[ao]},$$scope:{ctx:r}};return d=new Et({props:De}),r[9](d),{c(){e=C("div"),n=C("div"),V(t.$$.fragment),o=O(),s=C("div"),c=B(l),i=O(),v&&v.c(),u=O(),N&&N.c(),f=O(),_=C("span"),g=B("more_horiz"),w=O(),V(d.$$.fragment),this.h()},l(L){e=z(L,"DIV",{style:!0});var U=S(e);n=z(U,"DIV",{style:!0});var K=S(n);j(t.$$.fragment,K),o=q(K),s=z(K,"DIV",{style:!0});var ee=S(s);c=M(ee,l),ee.forEach(p),K.forEach(p),i=q(U),v&&v.l(U),u=q(U),N&&N.l(U),f=q(U),_=z(U,"SPAN",{class:!0,style:!0});var fe=S(_);g=M(fe,"more_horiz"),fe.forEach(p),w=q(U),j(d.$$.fragment,U),U.forEach(p),this.h()},h(){m(s,"margin-top","2px"),m(s,"font-size","0.55rem"),m(s,"font-family","Roboto,sans-serif"),m(s,"color","white"),m(n,"margin-right","10px"),m(n,"text-align","center"),y(_,"class","material-icons"),m(_,"margin-right","10px"),m(_,"color","white"),m(_,"font-size","2rem"),m(e,"position","absolute"),m(e,"display","flex"),m(e,"align-items","center"),m(e,"height","50px"),m(e,"left","0"),m(e,"right","auto"),m(e,"top","0"),m(e,"bottom","auto"),m(e,"z-index","100"),m(e,"background-color","grey"),m(e,"padding-left","10px"),m(e,"border-radius","2px")},m(L,U){D(L,e,U),P(e,n),W(t,n,null),P(n,o),P(n,s),P(s,c),P(e,i),v&&v.m(e,null),P(e,u),N&&N.m(e,null),P(e,f),P(e,_),P(_,g),P(e,w),W(d,e,null),I=!0,b||(k=[J(n,"click",Nt(Ct(r[4]))),J(_,"click",r[8])],b=!0)},p(L,[U]){const K={};U&2&&(K.checked=!L[1]),t.$set(K),(!I||U&2)&&l!==(l=(L[1]?"No touch":"Touch draw")+"")&&ae(c,l),U&4&&(a=Object.keys(L[2]).length>0),a?v?v.p(L,U):(v=ft(L),v.c(),v.m(e,u)):v&&(v.d(1),v=null),N&&N.p&&(!I||U&1024)&&ke(N,Q,L,L[10],I?$e(Q,L[10],U,null):we(L[10]),null);const ee={};U&1024&&(ee.$$scope={dirty:U,ctx:L}),d.$set(ee)},i(L){I||(R(t.$$.fragment,L),R(N,L),R(d.$$.fragment,L),I=!0)},o(L){T(t.$$.fragment,L),T(N,L),T(d.$$.fragment,L),I=!1},d(L){L&&p(e),F(t),v&&v.d(),N&&N.d(L),r[9](null),F(d),b=!1,Pe(k)}}}function uo(r,e,n){let t,o,s;G(r,Qe,w=>n(1,t=w)),G(r,lt,w=>n(2,o=w)),G(r,Ee,w=>n(3,s=w));let{$$slots:l={},$$scope:c}=e,i;function a(){Qe.set(!t)}const u=w=>Ee.set({type:"pencil",color:w,lineWidth:3}),f=()=>Ee.set({type:"eraser",color:"",lineWidth:40}),_=()=>i.setOpen(!0);function g(w){Ue[w?"unshift":"push"](()=>{i=w,n(0,i)})}return r.$$set=w=>{"$$scope"in w&&n(10,c=w.$$scope)},[i,t,o,s,a,l,u,f,_,g,c]}class co extends de{constructor(e){super();pe(this,e,uo,io,me,{})}}const fo=r=>({}),pt=r=>({slot:"dropdown-menu"});function mt(r){let e,n;return e=new co({props:{$$slots:{"dropdown-menu":[mo],default:[po]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o&131072&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function po(r){let e;const n=r[14].default,t=be(n,r,r[17],null);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&131072)&&ke(t,n,o,o[17],e?$e(n,o[17],s,null):we(o[17]),null)},i(o){e||(R(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function mo(r){let e;const n=r[14]["dropdown-menu"],t=be(n,r,r[17],pt);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,s){t&&t.p&&(!e||s&131072)&&ke(t,n,o,o[17],e?$e(n,o[17],s,fo):we(o[17]),pt)},i(o){e||(R(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function ho(r){let e,n,t,o,s,l,c,i,a,u=r[0]&&mt(r);return{c(){u&&u.c(),e=O(),n=C("canvas"),o=O(),s=C("canvas"),this.h()},l(f){u&&u.l(f),e=q(f),n=z(f,"CANVAS",{style:!0});var _=S(n);_.forEach(p),o=q(f),s=z(f,"CANVAS",{style:!0});var g=S(s);g.forEach(p),this.h()},h(){y(n,"style",t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${r[4]}px; height: ${r[3]}px`),y(s,"style",l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${r[4]}px; height: ${r[3]}px`)},m(f,_){u&&u.m(f,_),D(f,e,_),D(f,n,_),r[15](n),D(f,o,_),D(f,s,_),r[16](s),c=!0,i||(a=[J(n,"touchstart",r[5]),J(n,"touchmove",r[6]),J(n,"touchend",r[7])],i=!0)},p(f,[_]){f[0]?u?(u.p(f,_),_&1&&R(u,1)):(u=mt(f),u.c(),R(u,1),u.m(e.parentNode,e)):u&&(ie(),T(u,1,1,()=>{u=null}),ue()),(!c||_&24&&t!==(t=`position: absolute; z-index: 1; margin-top: 0; margin-left: 0; width: ${f[4]}px; height: ${f[3]}px`))&&y(n,"style",t),(!c||_&24&&l!==(l=`position: absolute;
  top: 0;
  left: 0;
  z-index: 0;
  display: block;
  background-color: rgb(46, 49, 49); width: ${f[4]}px; height: ${f[3]}px`))&&y(s,"style",l)},i(f){c||(R(u),c=!0)},o(f){T(u),c=!1},d(f){u&&u.d(f),f&&p(e),f&&p(n),r[15](null),f&&p(o),f&&p(s),r[16](null),i=!1,Pe(a)}}}function _o(r){return(r.endTime-r.startTime)/r.points.length}function go(r,e,n){let t,o,s,l;G(r,at,h=>n(3,t=h)),G(r,He,h=>n(4,o=h)),G(r,Ee,h=>n(21,s=h)),G(r,Qe,h=>n(22,l=h));let{$$slots:c={},$$scope:i}=e,{strokesArray:a}=e,{currentTime:u=0}=e,{backgroundImageDownloadURL:f=""}=e;const _=Fe();let g,w,d,I,b=[],k=!1,v={x:-1,y:-1},Q={points:[]},N;Ke(()=>{n(10,g=d.getContext("2d")),n(11,w=I.getContext("2d"))});function De(h){if(h.touches.length>1)return;const E=h.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ee(h,{isInitialContact:!0})}function L(h){if(!k)return;if(h.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}const E=h.touches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}ee(h,{isInitialContact:!1})}function U(h){if(!k||h.touches.length>0)return;const E=h.changedTouches[0].touchType==="stylus";if(l&&!E){console.log("error: cannot use finger during Apple Pencil mode");return}Te(Q),k=!1}function K(h){k=!0,v={x:-1,y:-1},Q={strokeNumber:a.length+1,startTime:Number(u.toFixed(1)),color:s.color,lineWidth:s.lineWidth,isErasing:s.type==="eraser",points:[],sessionID:"123"}}function ee(h,{isInitialContact:E}){h.preventDefault(),E&&K();const X=Me(h);fe(h,X)}function fe(h,E){Q.points.push({unitX:parseFloat(E.x/d.width).toFixed(4),unitY:parseFloat(E.y/d.height).toFixed(4)}),v.x!==-1&&v.y!==-1&&no([Re(v),Re(E)],1,s.type==="eraser",g,s.color,s.lineWidth,d),v=E}function Te(h){h.endTime=Number(u.toFixed(1)),h.id=Ne(),b.push(h),_("stroke-drawn",{newStroke:h})}function Me(h){const{left:E,top:X}=d.getBoundingClientRect();return{x:h.touches[0].pageX-E-window.scrollX,y:h.touches[0].pageY-X-window.scrollY}}function Re({x:h,y:E}){return{unitX:h/d.width,unitY:E/d.height}}function Ae(){g.clearRect(0,0,o,t)}function Ve(h){Ue[h?"unshift":"push"](()=>{d=h,n(1,d),n(10,g),n(4,o),n(3,t),n(0,a)})}function je(h){Ue[h?"unshift":"push"](()=>{I=h,n(2,I),n(10,g),n(4,o),n(3,t),n(0,a),n(1,d)})}return r.$$set=h=>{"strokesArray"in h&&n(0,a=h.strokesArray),"currentTime"in h&&n(8,u=h.currentTime),"backgroundImageDownloadURL"in h&&n(9,f=h.backgroundImageDownloadURL),"$$scope"in h&&n(17,i=h.$$scope)},r.$$.update=()=>{if(r.$$.dirty&1051&&g&&(n(1,d.width=o,d),n(1,d.height=t,d),n(2,I.width=o,I),n(2,I.height=t,I),a))for(const h of a)Be(h,null,g,d);if(r.$$.dirty&2566&&w&&(w.clearRect(0,0,I.scrollWidth,I.scrollHeight),oo(f,d,w)),r.$$.dirty&13315&&g&&a){let h=b.length,E=a.length;if(h!==E)if(h<E)if(h===0){for(const X of a)Be(X,null,g,d);n(12,b=[...a])}else for(let X=h;X<E;X++){const se=a[X];Be(se,se.startTime!==se.endTime?_o(se):null,g,d),b.push(se)}else{let X=function(){Ae(),n(12,b=[]),v={x:-1,y:-1};for(const We of a)Be(We,null,g,d)};(function(){console.log("debounced board reset"),N&&clearTimeout(N),n(13,N=setTimeout(X,1e3))})()}}},[a,d,I,t,o,De,L,U,u,f,g,w,b,N,c,Ve,je,i]}class bo extends de{constructor(e){super();pe(this,e,go,ho,me,{strokesArray:0,currentTime:8,backgroundImageDownloadURL:9})}}const ko=r=>({currentTime:r&1}),ht=r=>({startRecording:r[1],stopRecording:r[2],currentTime:r[0]});function wo(r){let e;const n=r[4].default,t=be(n,r,r[3],ht);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,[s]){t&&t.p&&(!e||s&9)&&ke(t,n,o,o[3],e?$e(n,o[3],s,ko):we(o[3]),ht)},i(o){e||(R(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function $o(r,e,n){let t;G(r,it,g=>n(8,t=g));let{$$slots:o={},$$scope:s}=e,l,c=0,i;Ke(async()=>{window&&(l=await to(()=>import("../../../chunks/index-f195c495.js"),[]),window.MediaRecorder=l.default)});const a=Fe();let u=null;function f(){return new Promise(async g=>{if(!t){const d=await navigator.mediaDevices.getUserMedia({audio:!0});it.set(d)}const w=t.clone();u=new MediaRecorder(w),u.start(),i=setInterval(()=>n(0,c+=.1),100),a("record-start"),Ce.set("mid_record"),g()})}function _(){return new Promise((g,w)=>{clearTimeout(i),Ce.set("post_record"),u.addEventListener("dataavailable",d=>{const I=d.data;a("record-end",{audioBlob:I}),g()}),u.stop();for(const d of u.stream.getTracks())d.stop()})}return r.$$set=g=>{"$$scope"in g&&n(3,s=g.$$scope)},[c,f,_,s,o]}class vo extends de{constructor(e){super();pe(this,e,$o,wo,me,{})}}function yo(r,e){let n=document.getElementById(e);return n==null||n.appendChild(r),{destroy(){r.remove()}}}function _t(r,e){let n=new IntersectionObserver(t=>{for(const o of t)if(o.isIntersecting){e(),n.unobserve(r);return}},{root:null,threshold:.2,rootMargin:"0px"});n.observe(r)}function Do(r){let e,n,t,o;return{c(){e=C("div"),n=C("textarea"),this.h()},l(s){e=z(s,"DIV",{class:!0,style:!0});var l=S(e);n=z(l,"TEXTAREA",{style:!0,class:!0}),S(n).forEach(p),l.forEach(p),this.h()},h(){n.value=r[0],m(n,"box-sizing","border-box"),m(n,"width",r[2]+"px"),m(n,"padding","6px"),m(n,"border-radius","2px"),m(n,"font-family","Roboto, sans-serif"),m(n,"color","rgb(60 55 56 / 87%)"),y(n,"class","svelte-tv3wak"),y(e,"class","grow-wrap svelte-tv3wak"),m(e,"font-family","Roboto, sans-serif"),m(e,"margin","10px 0px")},m(s,l){D(s,e,l),P(e,n),r[6](e),t||(o=[J(n,"input",r[5]),Se(r[4].call(null,e))],t=!0)},p(s,[l]){l&1&&(n.value=s[0]),l&4&&m(n,"width",s[2]+"px")},i:ce,o:ce,d(s){s&&p(e),r[6](null),t=!1,Pe(o)}}}function Ro(r,e,n){let t;G(r,He,u=>n(2,t=u));let{value:o}=e,s;const l=Fe();function c(u){u.dataset.replicatedValue=o}const i=u=>{n(1,s.dataset.replicatedValue=u.target.value,s),l("input",u.target.value)};function a(u){Ue[u?"unshift":"push"](()=>{s=u,n(1,s)})}return r.$$set=u=>{"value"in u&&n(0,o=u.value)},[o,s,t,l,c,i,a]}class Io extends de{constructor(e){super();pe(this,e,Ro,Do,me,{value:0})}}const To=r=>({strokesArray:r&1}),gt=r=>({listenToStrokes:r[1],strokesArray:r[0],handleNewlyDrawnStroke:r[2],deleteAllStrokesFromDb:r[3]});function Ao(r){let e;const n=r[6].default,t=be(n,r,r[5],gt);return{c(){t&&t.c()},l(o){t&&t.l(o)},m(o,s){t&&t.m(o,s),e=!0},p(o,[s]){t&&t.p&&(!e||s&33)&&ke(t,n,o,o[5],e?$e(n,o[5],s,To):we(o[5]),gt)},i(o){e||(R(t,o),e=!0)},o(o){T(t,o),e=!1},d(o){t&&t.d(o)}}}function bt(r){const e=Le({id:r.id},r.data());return e.startTime=0,e.endTime=0,r.data().isErasing||(e.endTime+=.5),e}function Lo(r,e,n){let{$$slots:t={},$$scope:o}=e,{dbPath:s}=e,l,c;const i=Je(Y(),`${s}/strokes`),a=Ze(i,Bt("timestamp"));xe(()=>{c&&c()});async function u(){c=et(a,async g=>{g.docChanges().filter(d=>d.type==="removed").length>0?(n(0,l=[]),await Mt(),g.docs.length>0&&g.docs.forEach(d=>{l.push(bt(d))})):(l||n(0,l=[]),g.docs.length===l.length||g.docChanges().filter(d=>d.type==="added").forEach(d=>{n(0,l=[...l,bt(d.doc)])}))})}function f(g){l.push(g);try{tt(oe(Y(),`${s}/strokes/${g.id}`),Le({timestamp:Vt()},g))}catch(w){alert(w)}}async function _(){return new Promise(async g=>{const w=[];let d=ot(Y()),I=0;for(const b of l){I>=500&&(w.push(d.commit()),d=ot(Y()),I=0);const k=oe(Y(),`${s}/strokes/${b.id}`);d.delete(k),I+=1}w.push(d.commit()),await Promise.all(w),n(0,l=[]),g()})}return r.$$set=g=>{"dbPath"in g&&n(4,s=g.dbPath),"$$scope"in g&&n(5,o=g.$$scope)},[l,u,f,_,s,o,t]}class Po extends de{constructor(e){super();pe(this,e,Lo,Ao,me,{dbPath:4})}}function kt(r,e,n){const t=r.slice();return t[36]=e[n],t}function wt(r){let e,n,t,o,s,l=[],c=new Map,i,a,u,f,_,g,w;n=new Ft({props:{disabled:re(r[0].name)&&r[0].askerUID&&r[5].uid!==r[0].askerUID,value:r[0].name,class:"room-title",style:`width: ${r[6]}px;`,$$slots:{helper:[Co]},$$scope:{ctx:r}}}),n.$on("input",r[19]);let d=r[0].blackboards;const I=b=>b[36];for(let b=0;b<d.length;b+=1){let k=kt(r,d,b),v=I(k);c.set(v,l[b]=Dt(v,k))}return{c(){e=C("div"),V(n.$$.fragment),t=O(),o=C("div"),s=O();for(let b=0;b<l.length;b+=1)l[b].c();i=O(),a=C("div"),u=B("New blackboard"),this.h()},l(b){e=z(b,"DIV",{style:!0});var k=S(e);j(n.$$.fragment,k),t=q(k),o=z(k,"DIV",{style:!0}),S(o).forEach(p),s=q(k);for(let Q=0;Q<l.length;Q+=1)l[Q].l(k);i=q(k),a=z(k,"DIV",{style:!0});var v=S(a);u=M(v,"New blackboard"),v.forEach(p),k.forEach(p),this.h()},h(){m(o,"margin-bottom","20px"),m(a,"display","flex"),m(a,"justify-content","center"),m(a,"align-items","center"),m(a,"margin-top","40px"),m(a,"background-color","#2e3131"),m(a,"font-family","Roboto, sans-serif"),m(a,"text-transform","uppercase"),m(a,"height","35px"),m(e,"padding","16px"),he(e,"question",re(r[0].name))},m(b,k){D(b,e,k),W(n,e,null),P(e,t),P(e,o),P(e,s);for(let v=0;v<l.length;v+=1)l[v].m(e,null);P(e,i),P(e,a),P(a,u),_=!0,g||(w=[J(a,"click",r[16]),Se(f=yo.call(null,e,"main-content"))],g=!0)},p(b,k){const v={};k[0]&33&&(v.disabled=re(b[0].name)&&b[0].askerUID&&b[5].uid!==b[0].askerUID),k[0]&1&&(v.value=b[0].name),k[0]&64&&(v.style=`width: ${b[6]}px;`),k[0]&31|k[1]&131072&&(v.$$scope={dirty:k,ctx:b}),n.$set(v),k[0]&61409|k[1]&122624&&(d=b[0].blackboards,ie(),l=jt(l,k,I,1,b,d,c,e,Wt,Dt,i,kt),ue()),k[0]&1&&he(e,"question",re(b[0].name))},i(b){if(!_){R(n.$$.fragment,b);for(let k=0;k<d.length;k+=1)R(l[k]);_=!0}},o(b){T(n.$$.fragment,b);for(let k=0;k<l.length;k+=1)T(l[k]);_=!1},d(b){b&&p(e),F(n);for(let k=0;k<l.length;k+=1)l[k].d();g=!1,Pe(w)}}}function Uo(r){let e=r[0].askerName+"",n,t,o=ze(r[0].dateAsked)+"",s;return{c(){n=B(e),t=B(" asked on "),s=B(o)},l(l){n=M(l,e),t=M(l," asked on "),s=M(l,o)},m(l,c){D(l,n,c),D(l,t,c),D(l,s,c)},p(l,c){c[0]&1&&e!==(e=l[0].askerName+"")&&ae(n,e),c[0]&1&&o!==(o=ze(l[0].dateAsked)+"")&&ae(s,o)},d(l){l&&p(n),l&&p(t),l&&p(s)}}}function So(r){let e,n,t;return{c(){e=B("Resolving this question in "),n=B(r[4]),t=B(", cancel by re-adding ?")},l(o){e=M(o,"Resolving this question in "),n=M(o,r[4]),t=M(o,", cancel by re-adding ?")},m(o,s){D(o,e,s),D(o,n,s),D(o,t,s)},p(o,s){s[0]&16&&ae(n,o[4])},d(o){o&&p(e),o&&p(n),o&&p(t)}}}function Eo(r){let e,n,t;return{c(){e=B("Pinging server members in "),n=B(r[2]),t=B(", cancel by backtracking the ?")},l(o){e=M(o,"Pinging server members in "),n=M(o,r[2]),t=M(o,", cancel by backtracking the ?")},m(o,s){D(o,e,s),D(o,n,s),D(o,t,s)},p(o,s){s[0]&4&&ae(n,o[2])},d(o){o&&p(e),o&&p(n),o&&p(t)}}}function $t(r){let e,n=ze(r[0].dateResolved)+"",t;return{c(){e=B(", resolved "),t=B(n)},l(o){e=M(o,", resolved "),t=M(o,n)},m(o,s){D(o,e,s),D(o,t,s)},p(o,s){s[0]&1&&n!==(n=ze(o[0].dateResolved)+"")&&ae(t,n)},d(o){o&&p(e),o&&p(t)}}}function No(r){let e,n;function t(c,i){if(c[1])return Eo;if(c[3])return So;if(c[0].askerName&&c[0].askerUID&&c[0].date)return Uo}let o=t(r),s=o&&o(r),l=r[0].dateResolved&&$t(r);return{c(){s&&s.c(),e=O(),l&&l.c(),n=Z()},l(c){s&&s.l(c),e=q(c),l&&l.l(c),n=Z()},m(c,i){s&&s.m(c,i),D(c,e,i),l&&l.m(c,i),D(c,n,i)},p(c,i){o===(o=t(c))&&s?s.p(c,i):(s&&s.d(1),s=o&&o(c),s&&(s.c(),s.m(e.parentNode,e))),c[0].dateResolved?l?l.p(c,i):(l=$t(c),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(c){s&&s.d(c),c&&p(e),l&&l.d(c),c&&p(n)}}}function Co(r){let e,n;return e=new Ot({props:{slot:"helper",persistent:!0,$$slots:{default:[No]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&31|o[1]&131072&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function vt(r){let e,n,t,o,s,l;function c(...f){return r[20](r[36],...f)}e=new Io({props:{value:r[39].description||""}}),e.$on("input",c);const i=[Bo,zo],a=[];function u(f,_){return f[39].audioDownloadURL?0:1}return t=u(r),o=a[t]=i[t](r),{c(){V(e.$$.fragment),n=O(),o.c(),s=Z()},l(f){j(e.$$.fragment,f),n=q(f),o.l(f),s=Z()},m(f,_){W(e,f,_),D(f,n,_),a[t].m(f,_),D(f,s,_),l=!0},p(f,_){r=f;const g={};_[1]&256&&(g.value=r[39].description||""),e.$set(g);let w=t;t=u(r),t===w?a[t].p(r,_):(ie(),T(a[w],1,1,()=>{a[w]=null}),ue(),o=a[t],o?o.p(r,_):(o=a[t]=i[t](r),o.c()),R(o,1),o.m(s.parentNode,s))},i(f){l||(R(e.$$.fragment,f),R(o),l=!0)},o(f){T(e.$$.fragment,f),T(o),l=!1},d(f){F(e,f),f&&p(n),a[t].d(f),f&&p(s)}}}function zo(r){let e,n;return e=new Po({props:{dbPath:r[9]+r[36],$$slots:{default:[Ho,({listenToStrokes:t,strokesArray:o,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>({43:t,41:o,44:s,42:l}),({listenToStrokes:t,strokesArray:o,handleNewlyDrawnStroke:s,deleteAllStrokesFromDb:l})=>[0,(t?4096:0)|(o?1024:0)|(s?8192:0)|(l?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&1&&(s.dbPath=t[9]+t[36]),o[0]&449|o[1]&138496&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Bo(r){let e,n;return e=new xt({props:{dbPath:r[9]+r[36],$$slots:{default:[Yo,({fetchStrokes:t,strokesArray:o,deleteAllStrokesFromDb:s})=>({40:t,41:o,42:s}),({fetchStrokes:t,strokesArray:o,deleteAllStrokesFromDb:s})=>[0,(t?512:0)|(o?1024:0)|(s?2048:0)]]},$$scope:{ctx:r}}}),{c(){V(e.$$.fragment)},l(t){j(e.$$.fragment,t)},m(t,o){W(e,t,o),n=!0},p(t,o){const s={};o[0]&1&&(s.dbPath=t[9]+t[36]),o[0]&224|o[1]&132864&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(R(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Mo(r){let e,n,t;return n=new Jt({props:{class:"my-four-colors",style:"height: 32px; width: 32px;",indeterminate:!0,fourColor:!0}}),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(o){e=z(o,"DIV",{style:!0});var s=S(e);j(n.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"display","flex"),m(e,"justify-content","center"),m(e,"margin-left","20px"),m(e,"margin-right","20px")},m(o,s){D(o,e,s),W(n,e,null),t=!0},p:ce,i(o){t||(R(n.$$.fragment,o),t=!0)},o(o){T(n.$$.fragment,o),t=!1},d(o){o&&p(e),F(n)}}}function Vo(r){let e,n,t,o;return{c(){e=C("span"),n=B("stop_circle"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);n=M(l,"stop_circle"),l.forEach(p),this.h()},h(){y(e,"class","material-icons"),m(e,"font-size","2.5rem"),m(e,"color","cyan"),m(e,"margin-left","30px"),m(e,"margin-right","26px")},m(s,l){D(s,e,l),P(e,n),t||(o=J(e,"click",function(){ye(r[46])&&r[46].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&p(e),t=!1,o()}}}function jo(r){let e,n,t,o;return{c(){e=C("span"),n=B("radio_button_checked"),this.h()},l(s){e=z(s,"SPAN",{class:!0,style:!0});var l=S(e);n=M(l,"radio_button_checked"),l.forEach(p),this.h()},h(){y(e,"class","material-icons"),m(e,"font-size","2.5rem"),m(e,"color","cyan"),m(e,"margin-left","30px"),m(e,"margin-right","26px")},m(s,l){D(s,e,l),P(e,n),t||(o=J(e,"click",function(){ye(r[45])&&r[45].apply(this,arguments)}),t=!0)},p(s,l){r=s},i:ce,o:ce,d(s){s&&p(e),t=!1,o()}}}function Wo(r){let e,n,t,o;const s=[jo,Vo,Mo],l=[];function c(i,a){return i[8]==="pre_record"?0:i[8]==="mid_record"?1:2}return e=c(r),n=l[e]=s[e](r),{c(){n.c(),t=Z()},l(i){n.l(i),t=Z()},m(i,a){l[e].m(i,a),D(i,t,a),o=!0},p(i,a){let u=e;e=c(i),e===u?l[e].p(i,a):(ie(),T(l[u],1,1,()=>{l[u]=null}),ue(),n=l[e],n?n.p(i,a):(n=l[e]=s[e](i),n.c()),R(n,1),n.m(t.parentNode,t))},i(i){o||(R(n),o=!0)},o(i){T(n),o=!1},d(i){l[e].d(i),i&&p(t)}}}function Fo(r){let e;return{c(){e=B("Wipe board")},l(n){e=M(n,"Wipe board")},m(n,t){D(n,e,t)},d(n){n&&p(e)}}}function Oo(r){let e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"",n,t,o,s,l,c;function i(...a){return r[22](r[39],...a)}return{c(){n=B(e),t=O(),o=C("input"),this.h()},l(a){n=M(a,e),t=q(a),o=z(a,"INPUT",{id:!0,style:!0,type:!0,accept:!0}),this.h()},h(){y(o,"id",s="input-"+r[39].id),m(o,"display","none"),y(o,"type","file"),y(o,"accept","image/gif, image/jpeg, image/png")},m(a,u){D(a,n,u),D(a,t,u),D(a,o,u),l||(c=J(o,"change",i),l=!0)},p(a,u){r=a,u[1]&256&&e!==(e=(r[39].backgroundImageDownloadURL?"Remove background":"Set background")+"")&&ae(n,e),u[1]&256&&s!==(s="input-"+r[39].id)&&y(o,"id",s)},d(a){a&&p(n),a&&p(t),a&&p(o),l=!1,c()}}}function qo(r){let e,n,t,o,s;return n=new st({props:{slot:"dropdown-menu",$$slots:{default:[Fo]},$$scope:{ctx:r}}}),n.$on("SMUI:action",function(){ye(r[42])&&r[42].apply(this,arguments)}),o=new st({props:{$$slots:{default:[Oo]},$$scope:{ctx:r}}}),o.$on("click",function(){ye(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id))&&(r[39].backgroundImageDownloadURL?r[11](r[39].id):Rt(r[39].id)).apply(this,arguments)}),{c(){e=C("div"),V(n.$$.fragment),t=O(),V(o.$$.fragment),this.h()},l(l){e=z(l,"DIV",{slot:!0});var c=S(e);j(n.$$.fragment,c),t=q(c),j(o.$$.fragment,c),c.forEach(p),this.h()},h(){y(e,"slot","dropdown-menu")},m(l,c){D(l,e,c),W(n,e,null),P(e,t),W(o,e,null),s=!0},p(l,c){r=l;const i={};c[1]&131072&&(i.$$scope={dirty:c,ctx:r}),n.$set(i);const a={};c[1]&131328&&(a.$$scope={dirty:c,ctx:r}),o.$set(a)},i(l){s||(R(n.$$.fragment,l),R(o.$$.fragment,l),s=!0)},o(l){T(n.$$.fragment,l),T(o.$$.fragment,l),s=!1},d(l){l&&p(e),F(n),F(o)}}}function Qo(r){let e,n;function t(...o){return r[23](r[44],...o)}return e=new bo({props:{strokesArray:r[41],currentTime:r[47],backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{"dropdown-menu":[qo],default:[Wo]},$$scope:{ctx:r}}}),e.$on("stroke-drawn",t),{c(){V(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,s){W(e,o,s),n=!0},p(o,s){r=o;const l={};s[1]&1024&&(l.strokesArray=r[41]),s[1]&65536&&(l.currentTime=r[47]),s[1]&256&&(l.backgroundImageDownloadURL=r[39].backgroundImageDownloadURL),s[0]&256|s[1]&182528&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(o){n||(R(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){F(e,o)}}}function Ho(r){let e,n,t,o,s,l,c;function i(...a){return r[24](r[36],...a)}return n=new vo({props:{$$slots:{default:[Qo,({startRecording:a,stopRecording:u,currentTime:f})=>({45:a,46:u,47:f}),({startRecording:a,stopRecording:u,currentTime:f})=>[0,(a?16384:0)|(u?32768:0)|(f?65536:0)]]},$$scope:{ctx:r}}}),n.$on("record-end",i),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(a){e=z(a,"DIV",{style:!0});var u=S(e);j(n.$$.fragment,u),u.forEach(p),this.h()},h(){y(e,"style",t=`width: ${r[6]}px; height: ${r[7]}px; position: relative`)},m(a,u){D(a,e,u),W(n,e,null),s=!0,l||(c=Se(o=_t.call(null,e,r[43])),l=!0)},p(a,u){r=a;const f={};u[0]&256|u[1]&249088&&(f.$$scope={dirty:u,ctx:r}),n.$set(f),(!s||u[0]&192&&t!==(t=`width: ${r[6]}px; height: ${r[7]}px; position: relative`))&&y(e,"style",t),o&&ye(o.update)&&u[1]&4096&&o.update.call(null,r[43])},i(a){s||(R(n.$$.fragment,a),s=!0)},o(a){T(n.$$.fragment,a),s=!1},d(a){a&&p(e),F(n),l=!1,c()}}}function yt(r){let e,n;function t(){return r[21](r[39],r[42])}return e=new Kt({props:{color:"primary",$$slots:{default:[Xo]},$$scope:{ctx:r}}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(o){j(e.$$.fragment,o)},m(o,s){W(e,o,s),n=!0},p(o,s){r=o;const l={};s[1]&131072&&(l.$$scope={dirty:s,ctx:r}),e.$set(l)},i(o){n||(R(e.$$.fragment,o),n=!0)},o(o){T(e.$$.fragment,o),n=!1},d(o){F(e,o)}}}function Xo(r){let e;return{c(){e=B("Delete video")},l(n){e=M(n,"Delete video")},m(n,t){D(n,e,t)},d(n){n&&p(e)}}}function Go(r){let e,n,t=r[5].uid===r[39].creatorUID&&yt(r);return{c(){t&&t.c(),e=Z()},l(o){t&&t.l(o),e=Z()},m(o,s){t&&t.m(o,s),D(o,e,s),n=!0},p(o,s){o[5].uid===o[39].creatorUID?t?(t.p(o,s),s[0]&32|s[1]&256&&R(t,1)):(t=yt(o),t.c(),R(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(R(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&p(e)}}}function Yo(r){let e,n,t,o,s,l,c;return n=new eo({props:{strokesArray:r[41],audioDownloadURL:r[39].audioDownloadURL,backgroundImageDownloadURL:r[39].backgroundImageDownloadURL,$$slots:{default:[Go]},$$scope:{ctx:r}}}),{c(){e=C("div"),V(n.$$.fragment),this.h()},l(i){e=z(i,"DIV",{style:!0});var a=S(e);j(n.$$.fragment,a),a.forEach(p),this.h()},h(){y(e,"style",t=`width: ${r[6]}px; height: ${r[7]+40}px; position: relative`)},m(i,a){D(i,e,a),W(n,e,null),s=!0,l||(c=Se(o=_t.call(null,e,r[40])),l=!0)},p(i,a){const u={};a[1]&1024&&(u.strokesArray=i[41]),a[1]&256&&(u.audioDownloadURL=i[39].audioDownloadURL),a[1]&256&&(u.backgroundImageDownloadURL=i[39].backgroundImageDownloadURL),a[0]&32|a[1]&131328&&(u.$$scope={dirty:a,ctx:i}),n.$set(u),(!s||a[0]&192&&t!==(t=`width: ${i[6]}px; height: ${i[7]+40}px; position: relative`))&&y(e,"style",t),o&&ye(o.update)&&a[1]&512&&o.update.call(null,i[40])},i(i){s||(R(n.$$.fragment,i),s=!0)},o(i){T(n.$$.fragment,i),s=!1},d(i){i&&p(e),F(n),l=!1,c()}}}function Ko(r){let e,n,t=r[39]&&vt(r);return{c(){t&&t.c(),e=O()},l(o){t&&t.l(o),e=q(o)},m(o,s){t&&t.m(o,s),D(o,e,s),n=!0},p(o,s){o[39]?t?(t.p(o,s),s[1]&256&&R(t,1)):(t=vt(o),t.c(),R(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(R(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&p(e)}}}function Dt(r,e){let n,t,o;return t=new Zt({props:{dbPath:e[9]+e[36],$$slots:{default:[Ko,({boardDoc:s})=>({39:s}),({boardDoc:s})=>[0,s?256:0]]},$$scope:{ctx:e}}}),{key:r,first:null,c(){n=Z(),V(t.$$.fragment),this.h()},l(s){n=Z(),j(t.$$.fragment,s),this.h()},h(){this.first=n},m(s,l){D(s,n,l),W(t,s,l),o=!0},p(s,l){e=s;const c={};l[0]&1&&(c.dbPath=e[9]+e[36]),l[0]&481|l[1]&131328&&(c.$$scope={dirty:l,ctx:e}),t.$set(c)},i(s){o||(R(t.$$.fragment,s),o=!0)},o(s){T(t.$$.fragment,s),o=!1},d(s){s&&p(n),F(t,s)}}}function Jo(r){let e,n,t=r[0]&&wt(r);return{c(){t&&t.c(),e=Z()},l(o){t&&t.l(o),e=Z()},m(o,s){t&&t.m(o,s),D(o,e,s),n=!0},p(o,s){o[0]?t?(t.p(o,s),s[0]&1&&R(t,1)):(t=wt(o),t.c(),R(t,1),t.m(e.parentNode,e)):t&&(ie(),T(t,1,1,()=>{t=null}),ue())},i(o){n||(R(t),n=!0)},o(o){T(t),n=!1},d(o){t&&t.d(o),o&&p(e)}}}async function ln({page:r}){return{props:{classID:r.params.class,roomID:r.params.room}}}function Rt(r){document.getElementById(`input-${r}`).click()}function re(r){return r.charAt(r.length-1)==="?"}function Xe(r){return r.askerName&&r.dateAsked&&r.askerUID}function Zo(r,e,n){let t,o,s,l,c;G(r,lt,$=>n(5,o=$)),G(r,He,$=>n(6,s=$)),G(r,at,$=>n(7,l=$)),G(r,Ce,$=>n(8,c=$));let{classID:i}=e,{roomID:a}=e,u,f;const _=`classes/${i}/blackboards/`,g=`classes/${i}/rooms/`;o.uid||ro("/");async function w($,A){const x=oe(Y(),_+A),H=$.target.files[0];if(!!H)if(H.type.split("/")[0]==="image"){const le=Oe(),te=qe(le,`images/${Ne()}`);await nt(te,H);const Ie=await rt(te);ne(x,{backgroundImageDownloadURL:Ie})}else alert("Error: only images can be used")}function d($){const A=oe(Y(),_+$);ne(A,{backgroundImageDownloadURL:ve()})}let I="",b=5,k,v=5;async function Q({srcElement:$}){const{value:A}=$,x={name:A};!re(f.name)&&re(A)&&!Xe(f)?N():I&&!re(A)?K():!re(A)&&Xe(f)?De():k&&re(A)&&Xe(f)&&U(),await ne(t,x)}function N(){n(2,b=5),n(1,I=setInterval(()=>{n(2,b-=1),b===0&&(ee(),fe(),K())},1e3))}function De(){n(4,v=5),n(3,k=setInterval(()=>{n(4,v-=1),v===0&&L()},1e3))}function L(){ne(t,{dateResolved:new Date().toISOString()})}function U(){clearTimeout(k),n(3,k="")}function K(){clearTimeout(I),n(1,I="")}function ee(){ne(t,{askerName:o.name||"Beaver #999",askerUID:o.uid,dateAsked:new Date().toISOString()})}async function fe(){const $=[],A=qt(),x=Qt(A,"sendTextMessage"),H=Je(Y(),"users"),le=Ze(H,Ht("willReceiveText","==",!0)),te=await Xt(le);if(te.docs)for(const Ie of te.docs){console.log("phoneNumber =",Ie.data().phoneNumber);try{Ie.id!==o.uid&&$.push(x({content:`${o.name} asked on https://ihtfp.app: "${f.name||"Fake question here"}"`,toWho:Ie.data().phoneNumber}))}catch(It){alert(It)}}await Promise.all($),console.log("success, sent all texts.")}async function Te({detail:$},A){const x=oe(Y(),_+A);await ne(x,{description:$})}async function Me(){u&&u(),u=et(t,$=>{n(0,f=Le({id:$.id},$.data()))})}xe(()=>{u()});async function Re($,A){const x=Oe(),H=qe(x,`audio/${Ne()}`);await nt(H,$);const le=await rt(H),te=oe(Y(),_+A);await ne(te,{creatorUID:o.uid,creatorPhoneNumber:o.phoneNumber,date:new Date().toISOString(),audioDownloadURL:le,audioRefFullPath:H.fullPath}),Ce.set("pre_record")}async function Ae({id:$,audioRefFullPath:A},x){const H=[],le=oe(Y(),_+$);if(A){const te=qe(Oe(),A);H.push(Gt(te))}H.push(ne(le,{creator:ve(),creatorPhoneNumber:ve(),date:ve(),audioDownloadURL:ve(),audioRefFullPath:ve()})),H.push(x()),await Promise.all(H)}async function Ve(){const $=Ne(),A=oe(Y(),_+$);await Promise.all([tt(A,{}),ne(t,{blackboards:Yt($)})])}const je=$=>Q($),h=($,A)=>Te(A,$),E=($,A)=>Ae($,A),X=($,A)=>w(A,$.id),se=($,A)=>$(A.detail.newStroke),We=($,A)=>Re(A.detail.audioBlob,$);return r.$$set=$=>{"classID"in $&&n(17,i=$.classID),"roomID"in $&&n(18,a=$.roomID)},r.$$.update=()=>{r.$$.dirty[0]&262144&&(t=oe(Y(),g+a)),r.$$.dirty[0]&262144&&Me()},[f,I,b,k,v,o,s,l,c,_,w,d,Q,Te,Re,Ae,Ve,i,a,je,h,E,X,se,We]}class an extends de{constructor(e){super();pe(this,e,Zo,Jo,me,{classID:17,roomID:18},null,[-1,-1])}}export{an as default,ln as load};
