var et=Object.defineProperty;var Ce=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var Ee=(o,e,s)=>e in o?et(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,fe=(o,e)=>{for(var s in e||(e={}))tt.call(e,s)&&Ee(o,s,e[s]);if(Ce)for(var s of Ce(e))st.call(e,s)&&Ee(o,s,e[s]);return o};import{S as re,i as ae,s as se,aa as nt,ab as ot,a3 as ue,ac as Oe,e as y,t as F,k as A,j as z,c as C,a as O,g as B,d as g,n as N,m as L,M as p,f as k,N as w,o as U,a1 as me,h as le,ad as Te,x as v,u as I,v as q,F as K,A as de,a5 as _e,Q as J,a8 as Re,P as Z,_ as ne,ae as Se,r as Y,w as G,af as rt,V as at,l as W,ag as lt,ah as it,ai as ct,aj as ft,ak as ut,b as V,al as mt,W as dt,I as he,J as ge,K as be,L as ve,X as $e,am as _t,an as je,ao as Ve,ap as pt,aq as ht,T as De,ar as gt,as as te,O as ie,R as bt,a4 as Me,a6 as vt,a7 as $t,at as Ae,au as Ne,av as Pe,aw as pe,ax as Dt,ay as It,az as wt,aA as kt}from"../../chunks/vendor-577628cf.js";import{u as Ie,g as we,b as ke,i as ye,r as x,d as ze,e as ce,f as Le,a as yt,c as Ct}from"../../chunks/navigation-a5eee486.js";import{b as Et}from"../../chunks/canvas-74f91cf9.js";import"../../chunks/singletons-12a22614.js";function Ue(o,e,s){const t=o.slice();return t[17]=e[s],t}function Ot(o){let e;return{c(){e=F("arrow_drop_down")},l(s){e=B(s,"arrow_drop_down")},m(s,t){k(s,e,t)},d(s){s&&g(e)}}}function qe(o){let e,s,t=o[7].enrolledClasses,n=[];for(let a=0;a<t.length;a+=1)n[a]=Be(Ue(o,t,a));const r=a=>I(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=W()},l(a){for(let l=0;l<n.length;l+=1)n[l].l(a);e=W()},m(a,l){for(let i=0;i<n.length;i+=1)n[i].m(a,l);k(a,e,l),s=!0},p(a,l){if(l&385){t=a[7].enrolledClasses;let i;for(i=0;i<t.length;i+=1){const m=Ue(a,t,i);n[i]?(n[i].p(m,l),v(n[i],1)):(n[i]=Be(m),n[i].c(),v(n[i],1),n[i].m(e.parentNode,e))}for(Y(),i=t.length;i<n.length;i+=1)r(i);G()}},i(a){if(!s){for(let l=0;l<t.length;l+=1)v(n[l]);s=!0}},o(a){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)I(n[l]);s=!1},d(a){lt(n,a),a&&g(e)}}}function Fe(o){let e,s;function t(){return o[10](o[17])}return e=new ct({props:{$$slots:{default:[Tt]},$$scope:{ctx:o}}}),e.$on("SMUI:action",t),{c(){z(e.$$.fragment)},l(n){L(e.$$.fragment,n)},m(n,r){U(e,n,r),s=!0},p(n,r){o=n;const a={};r&1048704&&(a.$$scope={dirty:r,ctx:o}),e.$set(a)},i(n){s||(v(e.$$.fragment,n),s=!0)},o(n){I(e.$$.fragment,n),s=!1},d(n){q(e,n)}}}function Tt(o){let e=o[17].name+"",s,t;return{c(){s=F(e),t=A()},l(n){s=B(n,e),t=N(n)},m(n,r){k(n,s,r),k(n,t,r)},p(n,r){r&128&&e!==(e=n[17].name+"")&&le(s,e)},d(n){n&&g(s),n&&g(t)}}}function Be(o){let e,s,t=o[17].name!==o[0]&&Fe(o);return{c(){t&&t.c(),e=W()},l(n){t&&t.l(n),e=W()},m(n,r){t&&t.m(n,r),k(n,e,r),s=!0},p(n,r){n[17].name!==n[0]?t?(t.p(n,r),r&129&&v(t,1)):(t=Fe(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(Y(),I(t,1,1,()=>{t=null}),G())},i(n){s||(v(t),s=!0)},o(n){I(t),s=!1},d(n){t&&t.d(n),n&&g(e)}}}function Rt(o){let e,s,t=o[7].enrolledClasses&&qe(o);return{c(){t&&t.c(),e=W()},l(n){t&&t.l(n),e=W()},m(n,r){t&&t.m(n,r),k(n,e,r),s=!0},p(n,r){n[7].enrolledClasses?t?(t.p(n,r),r&128&&v(t,1)):(t=qe(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(Y(),I(t,1,1,()=>{t=null}),G())},i(n){s||(v(t),s=!0)},o(n){I(t),s=!1},d(n){t&&t.d(n),n&&g(e)}}}function He(o){let e,s,t;function n(a){o[11](a)}let r={options:o[6],getOptionLabel:Vt,textfield$variant:"outlined",label:"Search class"};return o[3]!==void 0&&(r.value=o[3]),e=new it({props:r}),ue.push(()=>Oe(e,"value",n)),{c(){z(e.$$.fragment)},l(a){L(e.$$.fragment,a)},m(a,l){U(e,a,l),t=!0},p(a,l){const i={};l&64&&(i.options=a[6]),!s&&l&8&&(s=!0,i.value=a[3],Te(()=>s=!1)),e.$set(i)},i(a){t||(v(e.$$.fragment,a),t=!0)},o(a){I(e.$$.fragment,a),t=!1},d(a){q(e,a)}}}function St(o){let e,s,t,n;e=new Se({props:{$$slots:{default:[Rt]},$$scope:{ctx:o}}});let r=o[2].length>0&&He(o);return{c(){z(e.$$.fragment),s=A(),t=y("div"),r&&r.c(),this.h()},l(a){L(e.$$.fragment,a),s=N(a),t=C(a,"DIV",{style:!0});var l=O(t);r&&r.l(l),l.forEach(g),this.h()},h(){p(t,"margin","4px")},m(a,l){U(e,a,l),k(a,s,l),k(a,t,l),r&&r.m(t,null),n=!0},p(a,l){const i={};l&1048705&&(i.$$scope={dirty:l,ctx:a}),e.$set(i),a[2].length>0?r?(r.p(a,l),l&4&&v(r,1)):(r=He(a),r.c(),v(r,1),r.m(t,null)):r&&(Y(),I(r,1,1,()=>{r=null}),G())},i(a){n||(v(e.$$.fragment,a),v(r),n=!0)},o(a){I(e.$$.fragment,a),I(r),n=!1},d(a){q(e,a),a&&g(s),a&&g(t),r&&r.d()}}}function jt(o){let e,s,t,n,r,a,l,i,m,d,c,f,u,_,$,T;d=new nt({props:{class:"material-icons",$$slots:{default:[Ot]},$$scope:{ctx:o}}});function H(h){o[13](h)}let ee={anchor:!1,anchorCorner:"BOTTOM_LEFT",style:"left: 70px; top: 65px; width: 220px; overflow: visible;",$$slots:{default:[St]},$$scope:{ctx:o}};return o[4]!==void 0&&(ee.anchorElement=o[4]),f=new ot({props:ee}),o[12](f),ue.push(()=>Oe(f,"anchorElement",H)),{c(){e=y("div"),s=y("div"),t=y("div"),n=y("h1"),r=F(o[0]),a=A(),l=y("div"),i=F(o[1]),m=A(),z(d.$$.fragment),c=A(),z(f.$$.fragment),this.h()},l(h){e=C(h,"DIV",{});var E=O(e);s=C(E,"DIV",{style:!0});var M=O(s);t=C(M,"DIV",{});var D=O(t);n=C(D,"H1",{style:!0});var b=O(n);r=B(b,o[0]),b.forEach(g),a=N(D),l=C(D,"DIV",{style:!0});var j=O(l);i=B(j,o[1]),j.forEach(g),D.forEach(g),m=N(M),L(d.$$.fragment,M),M.forEach(g),c=N(E),L(f.$$.fragment,E),E.forEach(g),this.h()},h(){p(n,"font-family","Roboto, sans-serif"),p(n,"font-weight","400"),p(n,"margin-left","6px"),p(n,"margin-top","5px"),p(n,"margin-bottom","0px"),p(n,"font-size","2.0rem"),p(l,"font-family","Roboto,sans-serif"),p(l,"font-size","0.875rem"),p(l,"color","rgba(0,0,0,.6)"),p(l,"margin-left","8px"),p(l,"margin-bottom","12px"),p(s,"display","flex"),p(s,"align-items","center")},m(h,E){k(h,e,E),w(e,s),w(s,t),w(t,n),w(n,r),w(t,a),w(t,l),w(l,i),w(s,m),U(d,s,null),w(e,c),U(f,e,null),o[14](e),_=!0,$||(T=me(s,"click",o[9]),$=!0)},p(h,[E]){(!_||E&1)&&le(r,h[0]),(!_||E&2)&&le(i,h[1]);const M={};E&1048576&&(M.$$scope={dirty:E,ctx:h}),d.$set(M);const D={};E&1048781&&(D.$$scope={dirty:E,ctx:h}),!u&&E&16&&(u=!0,D.anchorElement=h[4],Te(()=>u=!1)),f.$set(D)},i(h){_||(v(d.$$.fragment,h),v(f.$$.fragment,h),_=!0)},o(h){I(d.$$.fragment,h),I(f.$$.fragment,h),_=!1},d(h){h&&g(e),q(d),o[12](null),q(f),o[14](null),$=!1,T()}}}const Vt=o=>o?`${o.name} (${o.description})`:"";function Mt(o,e,s){let t,n;K(o,Ie,h=>s(7,n=h));let{nameOfClass:r}=e,{descriptionOfClass:a}=e,l,i=[],m="",d;de(async()=>{const h=_e(J(),"/classes"),E=await Re(h),M=[];E.forEach(D=>{M.push(fe({id:D.id},D.data()))}),s(2,i=[...M])});async function c({mitClass:h}){console.log("join mitClass =",h);for(const M of n.enrolledClasses)if(M.id===h.id){alert(`You are already in ${h.name}`);return}const E=J();ne(Z(E,`users/${n.uid}`),{enrolledClasses:rt(h),mostRecentClassID:h.id}),ne(Z(E,`classes/${h.id}`),{numOfMembers:at(1)}),we(`/${h.id}/${h.id}`)}async function f(h){const E=J(),M=Z(E,`users/${n.uid}`);ne(M,{mostRecentClassID:h.id}),we(`/${h.id}/${h.id}`)}const u=()=>d.setOpen(!0),_=h=>f(h);function $(h){m=h,s(3,m)}function T(h){ue[h?"unshift":"push"](()=>{d=h,s(5,d)})}function H(h){l=h,s(4,l)}function ee(h){ue[h?"unshift":"push"](()=>{l=h,s(4,l)})}return o.$$set=h=>{"nameOfClass"in h&&s(0,r=h.nameOfClass),"descriptionOfClass"in h&&s(1,a=h.descriptionOfClass)},o.$$.update=()=>{o.$$.dirty&8&&m&&(console.log("selected option =",m),c({mitClass:m})),o.$$.dirty&4&&s(6,t=i)},[r,a,i,m,l,d,t,n,f,u,_,$,T,H,ee]}class At extends re{constructor(e){super();ae(this,e,Mt,jt,se,{nameOfClass:0,descriptionOfClass:1})}}function Nt(o){let e;const s=o[2].default,t=he(s,o,o[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,r){t&&t.p&&(!e||r&8)&&ge(t,s,n,n[3],e?ve(s,n[3],r,null):be(n[3]),null)},i(n){e||(v(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function Pt(o){let e,s,t,n,r,a,l,i,m,d;return l=new At({props:{nameOfClass:o[0],descriptionOfClass:o[1]}}),m=new Se({props:{$$slots:{default:[Nt]},$$scope:{ctx:o}}}),{c(){e=y("div"),s=y("div"),t=y("img"),r=A(),a=y("div"),z(l.$$.fragment),i=A(),z(m.$$.fragment),this.h()},l(c){e=C(c,"DIV",{style:!0,class:!0});var f=O(e);s=C(f,"DIV",{style:!0,class:!0});var u=O(s);t=C(u,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),r=N(u),a=C(u,"DIV",{class:!0});var _=O(a);L(l.$$.fragment,_),_.forEach(g),u.forEach(g),f.forEach(g),i=N(c),L(m.$$.fragment,c),this.h()},h(){dt(t.src,n="/logo.png")||V(t,"src",n),V(t,"width","60"),V(t,"height","54"),V(t,"alt","web-logo"),V(t,"class","svelte-f4hgt4"),V(a,"class","svelte-f4hgt4"),p(s,"display","flex"),p(s,"align-items","center"),V(s,"class","svelte-f4hgt4"),p(e,"margin-bottom","12px"),p(e,"padding-top","2px"),p(e,"padding-bottom","0"),p(e,"padding-left","8px"),V(e,"class","mdc-elevation--z"+4+" svelte-f4hgt4")},m(c,f){k(c,e,f),w(e,s),w(s,t),w(s,r),w(s,a),U(l,a,null),k(c,i,f),U(m,c,f),d=!0},p(c,f){const u={};f&1&&(u.nameOfClass=c[0]),f&2&&(u.descriptionOfClass=c[1]),l.$set(u);const _={};f&8&&(_.$$scope={dirty:f,ctx:c}),m.$set(_)},i(c){d||(v(l.$$.fragment,c),v(m.$$.fragment,c),d=!0)},o(c){I(l.$$.fragment,c),I(m.$$.fragment,c),d=!1},d(c){c&&g(e),q(l),c&&g(i),q(m,c)}}}function zt(o){let e,s;return e=new mt({props:{$$slots:{default:[Pt]},$$scope:{ctx:o}}}),{c(){z(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){U(e,t,n),s=!0},p(t,n){const r={};n&11&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){I(e.$$.fragment,t),s=!1},d(t){q(e,t)}}}function Lt(o){let e;return{c(){e=y("main"),this.h()},l(s){e=C(s,"MAIN",{class:!0,id:!0,style:!0});var t=O(e);t.forEach(g),this.h()},h(){V(e,"class","main-content svelte-f4hgt4"),V(e,"id","main-content"),p(e,"padding","0")},m(s,t){k(s,e,t)},d(s){s&&g(e)}}}function Ut(o){let e,s,t,n,r;return s=new ft({props:{style:"overflow-y: scroll; height: 100%;",class:"mdc-elevation--z"+5,$$slots:{default:[zt]},$$scope:{ctx:o}}}),n=new ut({props:{class:"app-content",$$slots:{default:[Lt]},$$scope:{ctx:o}}}),{c(){e=y("div"),z(s.$$.fragment),t=A(),z(n.$$.fragment),this.h()},l(a){e=C(a,"DIV",{class:!0});var l=O(e);L(s.$$.fragment,l),t=N(l),L(n.$$.fragment,l),l.forEach(g),this.h()},h(){V(e,"class","drawer-container svelte-f4hgt4")},m(a,l){k(a,e,l),U(s,e,null),w(e,t),U(n,e,null),r=!0},p(a,[l]){const i={};l&11&&(i.$$scope={dirty:l,ctx:a}),s.$set(i);const m={};l&8&&(m.$$scope={dirty:l,ctx:a}),n.$set(m)},i(a){r||(v(s.$$.fragment,a),v(n.$$.fragment,a),r=!0)},o(a){I(s.$$.fragment,a),I(n.$$.fragment,a),r=!1},d(a){a&&g(e),q(s),q(n)}}}function qt(o,e,s){let{$$slots:t={},$$scope:n}=e,{nameOfClass:r}=e,{descriptionOfClass:a}=e;return o.$$set=l=>{"nameOfClass"in l&&s(0,r=l.nameOfClass),"descriptionOfClass"in l&&s(1,a=l.descriptionOfClass),"$$scope"in l&&s(3,n=l.$$scope)},[r,a,t,n]}class Ft extends re{constructor(e){super();ae(this,e,qt,Ut,se,{nameOfClass:0,descriptionOfClass:1})}}function Bt(o,e,s){let t,n,r,a;K(o,ke,_=>s(10,n=_)),K(o,Ie,_=>s(3,r=_)),K(o,ye,_=>s(4,a=_));let{classID:l}=e,{roomID:i}=e,m,d,c,f,u;return $e(()=>{u&&u(),a&&(_t(d),ye.set(!1)),f&&f.cancel()}),de(()=>{x.set({}),c=je(Ve(),".info/connected"),u=pt(c,async _=>{if(_.val()===!0){const $=ze();m=je(Ve(),`/class/${l}/room/${i}/participants/${$}`),f=ht(m),f.set({hasDisconnected:!0,userUID:r.uid}),s(2,d=Z(J(),`classes/${l}/participants/${$}`)),De(d,{uid:r.uid,browserTabID:n,currentRoomID:i,name:t}),ye.set(!0)}})}),o.$$set=_=>{"classID"in _&&s(0,l=_.classID),"roomID"in _&&s(1,i=_.roomID)},o.$$.update=()=>{o.$$.dirty&8&&(t=r.name?r.name:"Beaver #"),o.$$.dirty&30&&a&&r.name&&ne(d,{currentRoomID:i,name:r.name})},[l,i,d,r,a]}class Ht extends re{constructor(e){super();ae(this,e,Bt,null,se,{classID:0,roomID:1})}}const Jt="0ac8a98cf9bef2827f5beef5cd36c4f42a442863ce904a2469de12caa9097fa1",Wt=o=>({activeSpeakerID:o&2,firestoreIDToDailyID:o&1}),Je=o=>({toggleMic:o[2],activeSpeakerID:o[1],firestoreIDToDailyID:o[0]});function Kt(o){let e;const s=o[8].default,t=he(s,o,o[7],Je);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,r){t&&t.m(n,r),e=!0},p(n,[r]){t&&t.p&&(!e||r&131)&&ge(t,s,n,n[7],e?ve(s,n[7],r,Wt):be(n[7]),Je)},i(n){e||(v(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}async function Qt({track:o,participant:e}){switch(o.kind){case"audio":if(e.local)return;{const s=document.createElement("audio");s.srcObject=new MediaStream([o]),s.setAttribute("id","audio"+e.user_id),s.setAttribute("playsinline",!0),s.setAttribute("autoplay",!0),document.getElementById("container-for-audio-elements").appendChild(s)}break}}async function Yt({track:o,participant:e}){const s=document.getElementById(o.id);s&&(s.srcObject=null,s.remove())}function Gt(o,e,s){let t,n,r;K(o,ce,D=>s(10,t=D)),K(o,ke,D=>s(11,n=D)),K(o,Le,D=>s(12,r=D));let{$$slots:a={},$$scope:l}=e,{roomID:i}=e,m,d,c,f,u,_="";$e(()=>{f==="connected"&&E()}),de(async()=>{await $(),T()});async function $(){return new Promise(async(D,b)=>{if(!r)try{const S=await navigator.mediaDevices.getUserMedia({audio:!0});Le.set(S)}catch{return alert(`Don't forget to enable your your mic! Click the "aA" / "i" button beside the URL bar "https://explain.mit.edu", then click "website settings" / "microphone"`),b("Can't access mic stream")}const[j]=r.getAudioTracks();m=gt.createCallObject({audioSource:j,videoSource:!1});const P=["participant-joined","participant-updated","participant-left"];for(const S of P)m.on(S,()=>{ce.set(m.participants());const R={};for(const Q of Object.keys(t)){const oe=t[Q],X=oe.user_name;X&&(R[X]=oe.user_id)}s(0,d=R)});m.on("track-started",Qt),m.on("track-stopped",Yt),m.on("active-speaker-change",({activeSpeaker:S})=>{s(1,_=S.peerId)}),m.on("load-attempt-failed",({action:S,errorMsg:R})=>{alert(S+": "+R)}),m.on("error",({action:S,errorMsg:R})=>{alert(S+": "+R)}),D()})}async function T(){s(4,c="not_connected"),s(5,f="connecting"),s(6,u=i);const{url:D}=await H();D&&(await ee(D),s(4,c="connecting"),s(5,f="connected"))}function H(){return new Promise(async D=>{try{const b=2*60*60,P=await(await fetch("https://api.daily.co/v1/rooms",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+Jt},body:JSON.stringify({name:i,properties:{exp:Math.round(Date.now()/1e3)+b,eject_at_room_exp:!0,start_video_off:!0}})})).json();P.error==="invalid-request-error"&&P.info===`a room named ${i} already exists`?D({url:`https://feynman.daily.co/${i}`}):D(P)}catch(b){console.error(b),alert(b),reject({url:""})}})}function ee(D){return new Promise(async(b,j)=>{try{await m.join({url:D,userName:n}),b()}catch(P){console.log("error)"),alert(P),j()}})}function h(){m.setLocalAudio(!t.local.audio),ce.set(m.participants())}function E(){const D=document.querySelectorAll("audio");for(const b of D)b.remove();M(),s(4,c="connected"),s(5,f="not_connected")}function M(){m.leave(),ce.set({}),s(1,_="")}return o.$$set=D=>{"roomID"in D&&s(3,i=D.roomID),"$$scope"in D&&s(7,l=D.$$scope)},o.$$.update=()=>{o.$$.dirty&120&&u!==i&&f==="connected"&&c==="connecting"&&E(),o.$$.dirty&120&&u!==i&&f==="not_connected"&&c==="connected"&&T()},[d,_,h,i,c,f,u,l,a]}class Xt extends re{constructor(e){super();ae(this,e,Gt,Kt,se,{roomID:3})}}function We(o,e,s){const t=o.slice();return t[23]=e[s],t}function Ke(o,e,s){const t=o.slice();return t[26]=e[s],t}function Qe(o){let e,s;return e=new Ht({props:{classID:o[0],roomID:o[1]}}),{c(){z(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){U(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.classID=t[0]),n&2&&(r.roomID=t[1]),e.$set(r)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){I(e.$$.fragment,t),s=!1},d(t){q(e,t)}}}function Zt(o){let e,s;return{c(){e=y("div"),s=F("(empty room)"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=B(n,"(empty room)"),n.forEach(g),this.h()},h(){p(e,"margin-bottom","2px")},m(t,n){k(t,e,n),w(e,s)},p:ie,d(t){t&&g(e)}}}function xt(o){let e,s=o[23].name+"",t;return{c(){e=y("div"),t=F(s),this.h()},l(n){e=C(n,"DIV",{style:!0,class:!0});var r=O(e);t=B(r,s),r.forEach(g),this.h()},h(){p(e,"white-space","nowrap"),p(e,"overflow","hidden"),p(e,"text-overflow","ellipsis margin-bottom: 2px"),V(e,"class","svelte-d2j7h9"),pe(e,"question-item",o[23].name.charAt(o[23].name.length-1)==="?"&&o[23].id!==o[1])},m(n,r){k(n,e,r),w(e,t)},p(n,r){r&16&&s!==(s=n[23].name+"")&&le(t,s),r&18&&pe(e,"question-item",n[23].name.charAt(n[23].name.length-1)==="?"&&n[23].id!==n[1])},d(n){n&&g(e)}}}function Ye(o){let e=[],s=new Map,t,n,r=o[5][o[23].id];const a=l=>l[26].browserTabID;for(let l=0;l<r.length;l+=1){let i=Ke(o,r,l),m=a(i);s.set(m,e[l]=Xe(m,i))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();t=W()},l(l){for(let i=0;i<e.length;i+=1)e[i].l(l);t=W()},m(l,i){for(let m=0;m<e.length;m+=1)e[m].m(l,i);k(l,t,i),n=!0},p(l,i){i&7340272&&(r=l[5][l[23].id],Y(),e=Ne(e,i,a,1,l,r,s,t.parentNode,Pe,Xe,t,Ke),G())},i(l){if(!n){for(let i=0;i<r.length;i+=1)v(e[i]);n=!0}},o(l){for(let i=0;i<e.length;i+=1)I(e[i]);n=!1},d(l){for(let i=0;i<e.length;i+=1)e[i].d(l);l&&g(t)}}}function Ge(o){let e,s,t,n;const r=[ts,es],a=[];function l(i,m){return i[26].browserTabID===i[7]?0:i[6][i[22][i[26].browserTabID]]?1:-1}return~(e=l(o))&&(s=a[e]=r[e](o)),{c(){s&&s.c(),t=W()},l(i){s&&s.l(i),t=W()},m(i,m){~e&&a[e].m(i,m),k(i,t,m),n=!0},p(i,m){let d=e;e=l(i),e===d?~e&&a[e].p(i,m):(s&&(Y(),I(a[d],1,1,()=>{a[d]=null}),G()),~e?(s=a[e],s?s.p(i,m):(s=a[e]=r[e](i),s.c()),v(s,1),s.m(t.parentNode,t)):s=null)},i(i){n||(v(s),n=!0)},o(i){I(s),n=!1},d(i){~e&&a[e].d(i),i&&g(t)}}}function es(o){let e;function s(r,a){return r[6][r[22][r[26].browserTabID]].audio?ns:ss}let t=s(o),n=t(o);return{c(){n.c(),e=W()},l(r){n.l(r),e=W()},m(r,a){n.m(r,a),k(r,e,a)},p(r,a){t===(t=s(r))&&n?n.p(r,a):(n.d(1),n=t(r),n&&(n.c(),n.m(e.parentNode,e)))},i:ie,o:ie,d(r){n.d(r),r&&g(e)}}}function ts(o){let e,s,t,n,r,a,l;t=new Dt({props:{checked:o[6].local.audio,style:"margin: 0 !important"}});function i(c,f){return c[6].local.audio?rs:os}let m=i(o),d=m(o);return{c(){e=y("div"),s=y("div"),z(t.$$.fragment),n=A(),d.c(),this.h()},l(c){e=C(c,"DIV",{style:!0});var f=O(e);s=C(f,"DIV",{style:!0});var u=O(s);L(t.$$.fragment,u),u.forEach(g),n=N(f),d.l(f),f.forEach(g),this.h()},h(){p(s,"margin-right","0"),p(s,"margin-left","auto"),p(s,"padding-top","5px"),p(e,"display","flex"),p(e,"align-items","center"),p(e,"margin-right","0"),p(e,"margin-left","auto")},m(c,f){k(c,e,f),w(e,s),U(t,s,null),w(e,n),d.m(e,null),r=!0,a||(l=me(s,"click",It(wt(function(){kt(o[21])&&o[21].apply(this,arguments)}))),a=!0)},p(c,f){o=c;const u={};f&64&&(u.checked=o[6].local.audio),t.$set(u),m!==(m=i(o))&&(d.d(1),d=m(o),d&&(d.c(),d.m(e,null)))},i(c){r||(v(t.$$.fragment,c),r=!0)},o(c){I(t.$$.fragment,c),r=!1},d(c){c&&g(e),q(t),d.d(),a=!1,l()}}}function ss(o){let e,s;return{c(){e=y("span"),s=F("mic_off"),this.h()},l(t){e=C(t,"SPAN",{class:!0,style:!0});var n=O(e);s=B(n,"mic_off"),n.forEach(g),this.h()},h(){V(e,"class","material-icons"),p(e,"margin-right","0"),p(e,"margin-left","auto"),p(e,"font-size","1.1rem"),p(e,"color","red")},m(t,n){k(t,e,n),w(e,s)},p:ie,d(t){t&&g(e)}}}function ns(o){let e,s;return{c(){e=y("span"),s=F("mic"),this.h()},l(t){e=C(t,"SPAN",{class:!0,style:!0});var n=O(e);s=B(n,"mic"),n.forEach(g),this.h()},h(){V(e,"class","material-icons"),p(e,"margin-right","0"),p(e,"margin-left","auto"),p(e,"font-size","1.1rem"),p(e,"color",o[22]&&o[22][o[26].browserTabID]&&o[22][o[26].browserTabID]===o[20]?"white":"")},m(t,n){k(t,e,n),w(e,s)},p(t,n){n&5242928&&p(e,"color",t[22]&&t[22][t[26].browserTabID]&&t[22][t[26].browserTabID]===t[20]?"white":"")},d(t){t&&g(e)}}}function os(o){let e,s;return{c(){e=y("div"),s=F("muted"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=B(n,"muted"),n.forEach(g),this.h()},h(){p(e,"font-size","0.7rem"),p(e,"margin-left","6px"),p(e,"color","red")},m(t,n){k(t,e,n),w(e,s)},d(t){t&&g(e)}}}function rs(o){let e,s;return{c(){e=y("div"),s=F("voice on"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=B(n,"voice on"),n.forEach(g),this.h()},h(){p(e,"font-size","0.7rem"),p(e,"margin-left","6px"),p(e,"color","#33ff33")},m(t,n){k(t,e,n),w(e,s)},d(t){t&&g(e)}}}function Xe(o,e){let s,t,n=e[26].name+"",r,a,l=Object.keys(e[6]).length>0,i,m,d=l&&Ge(e);return{key:o,first:null,c(){s=y("div"),t=y("div"),r=F(n),a=A(),d&&d.c(),i=A(),this.h()},l(c){s=C(c,"DIV",{style:!0});var f=O(s);t=C(f,"DIV",{style:!0,class:!0});var u=O(t);r=B(u,n),u.forEach(g),a=N(f),d&&d.l(f),i=N(f),f.forEach(g),this.h()},h(){p(t,"font-size","0.7rem"),p(t,"margin-left","6px"),V(t,"class","svelte-d2j7h9"),pe(t,"speaking",e[22]&&e[22][e[26].browserTabID]&&e[22][e[26].browserTabID]===e[20]),p(s,"display","flex"),p(s,"align-items","center"),this.first=s},m(c,f){k(c,s,f),w(s,t),w(t,r),w(s,a),d&&d.m(s,null),w(s,i),m=!0},p(c,f){e=c,(!m||f&48)&&n!==(n=e[26].name+"")&&le(r,n),f&5242928&&pe(t,"speaking",e[22]&&e[22][e[26].browserTabID]&&e[22][e[26].browserTabID]===e[20]),f&64&&(l=Object.keys(e[6]).length>0),l?d?(d.p(e,f),f&64&&v(d,1)):(d=Ge(e),d.c(),v(d,1),d.m(s,i)):d&&(Y(),I(d,1,1,()=>{d=null}),G())},i(c){m||(v(d),m=!0)},o(c){I(d),m=!1},d(c){c&&g(s),d&&d.d()}}}function Ze(o,e){let s,t,n,r,a,l,i,m;function d($,T){if($[23].name)return xt;if($[23].name==="")return Zt}let c=d(e),f=c&&c(e),u=e[5][e[23].id]&&Ye(e);function _(){return e[11](e[23])}return{key:o,first:null,c(){s=y("div"),t=y("div"),f&&f.c(),n=A(),u&&u.c(),a=A(),this.h()},l($){s=C($,"DIV",{style:!0});var T=O(s);t=C(T,"DIV",{class:!0,style:!0});var H=O(t);f&&f.l(H),n=N(H),u&&u.l(H),H.forEach(g),a=N(T),T.forEach(g),this.h()},h(){V(t,"class",r=""+(Ae(e[23].id===e[1]?"selected":"")+" svelte-d2j7h9")),p(t,"padding","6px 10px 6px 8px"),p(t,"opacity","90%"),p(t,"border-radius","5px"),p(s,"padding","6px"),this.first=s},m($,T){k($,s,T),w(s,t),f&&f.m(t,null),w(t,n),u&&u.m(t,null),w(s,a),l=!0,i||(m=me(s,"click",_),i=!0)},p($,T){e=$,c===(c=d(e))&&f?f.p(e,T):(f&&f.d(1),f=c&&c(e),f&&(f.c(),f.m(t,n))),e[5][e[23].id]?u?(u.p(e,T),T&48&&v(u,1)):(u=Ye(e),u.c(),v(u,1),u.m(t,null)):u&&(Y(),I(u,1,1,()=>{u=null}),G()),(!l||T&18&&r!==(r=""+(Ae(e[23].id===e[1]?"selected":"")+" svelte-d2j7h9")))&&V(t,"class",r)},i($){l||(v(u),l=!0)},o($){I(u),l=!1},d($){$&&g(s),f&&f.d(),u&&u.d(),i=!1,m()}}}function as(o){let e=[],s=new Map,t,n,r,a,l,i,m,d,c=o[4];const f=u=>u[23].id+u[1];for(let u=0;u<c.length;u+=1){let _=We(o,c,u),$=f(_);s.set($,e[u]=Ze($,_))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();t=A(),n=y("div"),r=y("span"),a=F("add"),l=F(`\r
      new room`),this.h()},l(u){for(let T=0;T<e.length;T+=1)e[T].l(u);t=N(u),n=C(u,"DIV",{style:!0});var _=O(n);r=C(_,"SPAN",{class:!0,style:!0});var $=O(r);a=B($,"add"),$.forEach(g),l=B(_,`\r
      new room`),_.forEach(g),this.h()},h(){V(r,"class","material-icons"),p(r,"margin-left","6px"),p(r,"margin-right","5px"),p(r,"margin-top","2.5px"),p(r,"font-size","1.2rem"),p(n,"padding","6px"),p(n,"display","flex"),p(n,"align-items","center")},m(u,_){for(let $=0;$<e.length;$+=1)e[$].m(u,_);k(u,t,_),k(u,n,_),w(n,r),w(r,a),w(n,l),i=!0,m||(d=me(n,"click",o[8]),m=!0)},p(u,_){_&7340275&&(c=u[4],Y(),e=Ne(e,_,f,1,u,c,s,t.parentNode,Pe,Ze,t,We),G())},i(u){if(!i){for(let _=0;_<c.length;_+=1)v(e[_]);i=!0}},o(u){for(let _=0;_<e.length;_+=1)I(e[_]);i=!1},d(u){for(let _=0;_<e.length;_+=1)e[_].d(u);u&&g(t),u&&g(n),m=!1,d()}}}function ls(o){let e,s;return e=new Ft({props:{nameOfClass:o[2],descriptionOfClass:o[3],$$slots:{default:[as]},$$scope:{ctx:o}}}),{c(){z(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,n){U(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.nameOfClass=t[2]),n&8&&(r.descriptionOfClass=t[3]),n&7344371&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){I(e.$$.fragment,t),s=!1},d(t){q(e,t)}}}function is(o){let e=o[0],s,t,n,r,a,l,i=Qe(o);r=new Xt({props:{roomID:o[1],$$slots:{default:[ls,({activeSpeakerID:c,toggleMic:f,firestoreIDToDailyID:u})=>({20:c,21:f,22:u}),({activeSpeakerID:c,toggleMic:f,firestoreIDToDailyID:u})=>(c?1048576:0)|(f?2097152:0)|(u?4194304:0)]},$$scope:{ctx:o}}});const m=o[10].default,d=he(m,o,o[12],null);return{c(){i.c(),s=A(),t=y("div"),n=A(),z(r.$$.fragment),a=A(),d&&d.c(),this.h()},l(c){i.l(c),s=N(c),t=C(c,"DIV",{id:!0});var f=O(t);f.forEach(g),n=N(c),L(r.$$.fragment,c),a=N(c),d&&d.l(c),this.h()},h(){V(t,"id","container-for-audio-elements")},m(c,f){i.m(c,f),k(c,s,f),k(c,t,f),k(c,n,f),U(r,c,f),k(c,a,f),d&&d.m(c,f),l=!0},p(c,[f]){f&1&&se(e,e=c[0])?(Y(),I(i,1,1,ie),G(),i=Qe(c),i.c(),v(i),i.m(s.parentNode,s)):i.p(c,f);const u={};f&2&&(u.roomID=c[1]),f&7344383&&(u.$$scope={dirty:f,ctx:c}),r.$set(u),d&&d.p&&(!l||f&4096)&&ge(d,m,c,c[12],l?ve(m,c[12],f,null):be(c[12]),null)},i(c){l||(v(i),v(r.$$.fragment,c),v(d,c),l=!0)},o(c){I(i),I(r.$$.fragment,c),I(d,c),l=!1},d(c){i.d(c),c&&g(s),c&&g(t),c&&g(n),q(r,c),c&&g(a),d&&d.d(c)}}}function ps({page:o}){return{props:{classID:o.params.class,roomID:o.params.room}}}function cs(o,e,s){let t,n,r,a;K(o,x,b=>s(5,t=b)),K(o,Ie,b=>s(9,n=b)),K(o,ce,b=>s(6,r=b)),K(o,ke,b=>s(7,a=b));let{$$slots:l={},$$scope:i}=e,{classID:m}=e,{roomID:d}=e,c=[],f="",u="",_=[];function $(){for(const b of c)b();c=[]}async function T(){const b=Z(J(),`classes/${m}`),j=await bt(b);s(2,f=j.data().name),s(3,u=j.data().description)}de(async()=>{window.addEventListener("resize",h),h()}),$e(()=>{$(),window.removeEventListener("resize",h)});async function H(){for(const R of _)if(R.name===""){alert("There is still an empty room available");return}const b=ze(),j=`classes/${m}/`,P=Z(J(),j+`rooms/${b}`),S=Z(J(),j+`blackboards/${b}`);await Promise.all([De(P,{name:"",blackboards:[b],date:new Date().toISOString()}),De(S,{})])}function ee(){const{height:b,width:j}=Et();yt.set(b),Ct.set(j)}function h(){setTimeout(ee,100)}function E(){const b=_e(J(),`classes/${m}/participants`);c.push(Me(b,j=>{j.docChanges().forEach(P=>{const S=P.doc.data(),R=S.currentRoomID;switch(P.type){case"added":t[R]||te(x,t[R]=[],t),te(x,t[R]=[...t[R],S],t);break;case"modified":for(const Q of Object.keys(t))for(const oe of t[Q])oe.browserTabID===S.browserTabID&&te(x,t[Q]=t[Q].filter(X=>X.browserTabID!==S.browserTabID),t);t[R]||te(x,t[R]=[],t),te(x,t[R]=[...t[R],S],t);break;case"removed":te(x,t[R]=t[R].filter(Q=>Q.browserTabID!==S.browserTabID),t);break}})}))}function M(){const b=_e(J(),`classes/${m}/rooms`),j=vt(b,$t("date","asc"));c.push(Me(j,async P=>{const S=[];if(P.forEach(R=>{S.push(fe({id:R.id,ref:R.ref.path},R.data()))}),s(4,_=S),_.length===0){const R=_e(J(),`classes/${m}/rooms`),Q=[];(await Re(R)).docs.forEach(X=>{Q.push(fe({id:X.id},X.data()))});for(const X of Q){const xe=Z(J(),`classes/${m}/rooms/${X.id}`);ne(xe,{date:Date.now()})}}}))}const D=b=>we(`/${m}/${b.id}`);return o.$$set=b=>{"classID"in b&&s(0,m=b.classID),"roomID"in b&&s(1,d=b.roomID),"$$scope"in b&&s(12,i=b.$$scope)},o.$$.update=()=>{if(o.$$.dirty&515&&m){$(),te(x,t=[],t),T(),E(),M();const b=Z(J(),`users/${n.uid}`);ne(b,{mostRecentClassAndRoomID:`/${m}/${d}`})}},[m,d,f,u,_,t,r,a,H,n,l,D,i]}class hs extends re{constructor(e){super();ae(this,e,cs,is,se,{classID:0,roomID:1})}}export{hs as default,ps as load};
