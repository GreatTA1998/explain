var xe=Object.defineProperty;var Ie=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var ye=(o,e,n)=>e in o?xe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,fe=(o,e)=>{for(var n in e||(e={}))et.call(e,n)&&ye(o,n,e[n]);if(Ie)for(var n of Ie(e))tt.call(e,n)&&ye(o,n,e[n]);return o};import{S as x,i as ee,s as te,a9 as st,aa as nt,a2 as oe,ab as ke,e as E,t as q,k as M,j as A,c as O,a as T,g as B,d as p,n as V,m as z,L as h,f as w,M as I,o as P,a0 as ce,h as se,ac as Ce,x as $,u as D,v as L,E as J,A as le,a4 as ue,P as W,a7 as ot,O as Z,_ as ae,ad as Ee,r as K,w as Q,ae as lt,V as at,l as H,af as rt,ag as it,ah as ft,ai as ct,aj as ut,b as S,ak as mt,U as dt,H as me,I as de,J as _e,K as pe,W as he,al as _t,am as Oe,an as Te,ao as pt,ap as ht,R as ge,aq as gt,a5 as bt,a6 as $t,a3 as Re,Q as vt,ar as re,as as Se,at as je,au as Me,Z as Dt,av as ie,aw as wt,ax as It,ay as yt,az as kt,N as Ve}from"../../chunks/vendor-dda63b98.js";import{u as Ne,g as be,b as $e,i as ve,r as X,d as Ae,e as ne,f as ze,c as Ct,a as Et}from"../../chunks/navigation-85f32556.js";import{b as Ot}from"../../chunks/canvas-74f91cf9.js";import"../../chunks/singletons-12a22614.js";function Pe(o,e,n){const t=o.slice();return t[18]=e[n],t}function Tt(o){let e;return{c(){e=q("arrow_drop_down")},l(n){e=B(n,"arrow_drop_down")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function Le(o){let e,n,t=o[7].enrolledClasses,s=[];for(let a=0;a<t.length;a+=1)s[a]=qe(Pe(o,t,a));const l=a=>D(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=H()},l(a){for(let r=0;r<s.length;r+=1)s[r].l(a);e=H()},m(a,r){for(let i=0;i<s.length;i+=1)s[i].m(a,r);w(a,e,r),n=!0},p(a,r){if(r&385){t=a[7].enrolledClasses;let i;for(i=0;i<t.length;i+=1){const c=Pe(a,t,i);s[i]?(s[i].p(c,r),$(s[i],1)):(s[i]=qe(c),s[i].c(),$(s[i],1),s[i].m(e.parentNode,e))}for(K(),i=t.length;i<s.length;i+=1)l(i);Q()}},i(a){if(!n){for(let r=0;r<t.length;r+=1)$(s[r]);n=!0}},o(a){s=s.filter(Boolean);for(let r=0;r<s.length;r+=1)D(s[r]);n=!1},d(a){rt(s,a),a&&p(e)}}}function Ue(o){let e,n;function t(){return o[10](o[18])}return e=new ft({props:{$$slots:{default:[Rt]},$$scope:{ctx:o}}}),e.$on("SMUI:action",t),{c(){A(e.$$.fragment)},l(s){z(e.$$.fragment,s)},m(s,l){P(e,s,l),n=!0},p(s,l){o=s;const a={};l&2097280&&(a.$$scope={dirty:l,ctx:o}),e.$set(a)},i(s){n||($(e.$$.fragment,s),n=!0)},o(s){D(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function Rt(o){let e=o[18].name+"",n,t;return{c(){n=q(e),t=M()},l(s){n=B(s,e),t=V(s)},m(s,l){w(s,n,l),w(s,t,l)},p(s,l){l&128&&e!==(e=s[18].name+"")&&se(n,e)},d(s){s&&p(n),s&&p(t)}}}function qe(o){let e,n,t=o[18].name!==o[0]&&Ue(o);return{c(){t&&t.c(),e=H()},l(s){t&&t.l(s),e=H()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[18].name!==s[0]?t?(t.p(s,l),l&129&&$(t,1)):(t=Ue(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),D(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){D(t),n=!1},d(s){t&&t.d(s),s&&p(e)}}}function St(o){let e,n,t=o[7].enrolledClasses&&Le(o);return{c(){t&&t.c(),e=H()},l(s){t&&t.l(s),e=H()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[7].enrolledClasses?t?(t.p(s,l),l&128&&$(t,1)):(t=Le(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),D(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){D(t),n=!1},d(s){t&&t.d(s),s&&p(e)}}}function Be(o){let e,n,t;function s(a){o[11](a)}let l={options:o[6],getOptionLabel:Vt,textfield$variant:"outlined",label:"Search class"};return o[3]!==void 0&&(l.value=o[3]),e=new it({props:l}),oe.push(()=>ke(e,"value",s)),{c(){A(e.$$.fragment)},l(a){z(e.$$.fragment,a)},m(a,r){P(e,a,r),t=!0},p(a,r){const i={};r&64&&(i.options=a[6]),!n&&r&8&&(n=!0,i.value=a[3],Ce(()=>n=!1)),e.$set(i)},i(a){t||($(e.$$.fragment,a),t=!0)},o(a){D(e.$$.fragment,a),t=!1},d(a){L(e,a)}}}function jt(o){let e,n,t,s;e=new Ee({props:{$$slots:{default:[St]},$$scope:{ctx:o}}});let l=o[2].length>0&&Be(o);return{c(){A(e.$$.fragment),n=M(),t=E("div"),l&&l.c(),this.h()},l(a){z(e.$$.fragment,a),n=V(a),t=O(a,"DIV",{style:!0});var r=T(t);l&&l.l(r),r.forEach(p),this.h()},h(){h(t,"margin","4px")},m(a,r){P(e,a,r),w(a,n,r),w(a,t,r),l&&l.m(t,null),s=!0},p(a,r){const i={};r&2097281&&(i.$$scope={dirty:r,ctx:a}),e.$set(i),a[2].length>0?l?(l.p(a,r),r&4&&$(l,1)):(l=Be(a),l.c(),$(l,1),l.m(t,null)):l&&(K(),D(l,1,1,()=>{l=null}),Q())},i(a){s||($(e.$$.fragment,a),$(l),s=!0)},o(a){D(e.$$.fragment,a),D(l),s=!1},d(a){L(e,a),a&&p(n),a&&p(t),l&&l.d()}}}function Mt(o){let e,n,t,s,l,a,r,i,c,f,u,m,d,v,y,R;f=new st({props:{class:"material-icons",on:!0,$$slots:{default:[Tt]},$$scope:{ctx:o}}});function F(_){o[13](_)}let Y={anchor:!1,anchorCorner:"BOTTOM_LEFT",style:"left: 70px; top: 65px; width: 220px; overflow: visible;",$$slots:{default:[jt]},$$scope:{ctx:o}};return o[4]!==void 0&&(Y.anchorElement=o[4]),m=new nt({props:Y}),o[12](m),oe.push(()=>ke(m,"anchorElement",F)),{c(){e=E("div"),n=E("div"),t=E("div"),s=E("h1"),l=q(o[0]),a=M(),r=E("div"),i=q(o[1]),c=M(),A(f.$$.fragment),u=M(),A(m.$$.fragment),this.h()},l(_){e=O(_,"DIV",{});var k=T(e);n=O(k,"DIV",{style:!0});var b=T(n);t=O(b,"DIV",{});var g=T(t);s=O(g,"H1",{style:!0});var C=T(s);l=B(C,o[0]),C.forEach(p),a=V(g),r=O(g,"DIV",{style:!0});var j=T(r);i=B(j,o[1]),j.forEach(p),g.forEach(p),c=V(b),z(f.$$.fragment,b),b.forEach(p),u=V(k),z(m.$$.fragment,k),k.forEach(p),this.h()},h(){h(s,"font-family","Roboto, sans-serif"),h(s,"font-weight","400"),h(s,"margin-left","6px"),h(s,"margin-top","5px"),h(s,"margin-bottom","0px"),h(s,"font-size","2.0rem"),h(r,"font-family","Roboto,sans-serif"),h(r,"font-size","0.875rem"),h(r,"color","rgba(0,0,0,.6)"),h(r,"margin-left","8px"),h(r,"margin-bottom","12px"),h(n,"display","flex"),h(n,"align-items","center")},m(_,k){w(_,e,k),I(e,n),I(n,t),I(t,s),I(s,l),I(t,a),I(t,r),I(r,i),I(n,c),P(f,n,null),I(e,u),P(m,e,null),o[14](e),v=!0,y||(R=ce(n,"click",o[9]),y=!0)},p(_,[k]){(!v||k&1)&&se(l,_[0]),(!v||k&2)&&se(i,_[1]);const b={};k&2097152&&(b.$$scope={dirty:k,ctx:_}),f.$set(b);const g={};k&2097357&&(g.$$scope={dirty:k,ctx:_}),!d&&k&16&&(d=!0,g.anchorElement=_[4],Ce(()=>d=!1)),m.$set(g)},i(_){v||($(f.$$.fragment,_),$(m.$$.fragment,_),v=!0)},o(_){D(f.$$.fragment,_),D(m.$$.fragment,_),v=!1},d(_){_&&p(e),L(f),o[12](null),L(m),o[14](null),y=!1,R()}}}const Vt=o=>o?`${o.name} (${o.description})`:"";function Nt(o,e,n){let t,s;J(o,Ne,_=>n(7,s=_));let{nameOfClass:l}=e,{descriptionOfClass:a}=e,r,i=[],c="";console.log("$user =",s);let f;le(async()=>{console.log("$user.enrolledClasses =",s.enrolledClasses);const _=ue(W(),"/classes"),k=await ot(_),b=[];k.forEach(g=>{b.push(fe({id:g.id},g.data()))}),n(2,i=[...b])});async function u({mitClass:_}){console.log("join mitClass =",_);for(const b of s.enrolledClasses)if(b.id===_.id){alert(`You are already in ${_.name}`);return}const k=W();ae(Z(k,`users/${s.uid}`),{enrolledClasses:lt(_),mostRecentClassID:_.id}),ae(Z(k,`classes/${_.id}`),{numOfMembers:at(1)}),be(`/${_.id}/${_.id}`)}async function m(_){const k=W(),b=Z(k,`users/${s.uid}`);ae(b,{mostRecentClassID:_.id}),be(`/${_.id}/${_.id}`)}const d=()=>f.setOpen(!0),v=_=>m(_);function y(_){c=_,n(3,c)}function R(_){oe[_?"unshift":"push"](()=>{f=_,n(5,f)})}function F(_){r=_,n(4,r)}function Y(_){oe[_?"unshift":"push"](()=>{r=_,n(4,r)})}return o.$$set=_=>{"nameOfClass"in _&&n(0,l=_.nameOfClass),"descriptionOfClass"in _&&n(1,a=_.descriptionOfClass)},o.$$.update=()=>{o.$$.dirty&8&&c&&(console.log("selected option =",c),u({mitClass:c})),o.$$.dirty&4&&n(6,t=i.filter(_=>["8.01"].includes(_.name)))},[l,a,i,c,r,f,t,s,m,d,v,y,R,F,Y]}class At extends x{constructor(e){super();ee(this,e,Nt,Mt,te,{nameOfClass:0,descriptionOfClass:1})}}function zt(o){let e;const n=o[2].default,t=me(n,o,o[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,l){t&&t.p&&(!e||l&8)&&de(t,n,s,s[3],e?pe(n,s[3],l,null):_e(s[3]),null)},i(s){e||($(t,s),e=!0)},o(s){D(t,s),e=!1},d(s){t&&t.d(s)}}}function Pt(o){let e,n,t,s,l,a,r,i,c,f;return r=new At({props:{nameOfClass:o[0],descriptionOfClass:o[1]}}),c=new Ee({props:{$$slots:{default:[zt]},$$scope:{ctx:o}}}),{c(){e=E("div"),n=E("div"),t=E("img"),l=M(),a=E("div"),A(r.$$.fragment),i=M(),A(c.$$.fragment),this.h()},l(u){e=O(u,"DIV",{style:!0,class:!0});var m=T(e);n=O(m,"DIV",{style:!0,class:!0});var d=T(n);t=O(d,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),l=V(d),a=O(d,"DIV",{class:!0});var v=T(a);z(r.$$.fragment,v),v.forEach(p),d.forEach(p),m.forEach(p),i=V(u),z(c.$$.fragment,u),this.h()},h(){dt(t.src,s="/logo.png")||S(t,"src",s),S(t,"width","60"),S(t,"height","54"),S(t,"alt","web-logo"),S(t,"class","svelte-f4hgt4"),S(a,"class","svelte-f4hgt4"),h(n,"display","flex"),h(n,"align-items","center"),S(n,"class","svelte-f4hgt4"),h(e,"margin-bottom","12px"),h(e,"padding-top","2px"),h(e,"padding-bottom","0"),h(e,"padding-left","8px"),S(e,"class","mdc-elevation--z"+4+" svelte-f4hgt4")},m(u,m){w(u,e,m),I(e,n),I(n,t),I(n,l),I(n,a),P(r,a,null),w(u,i,m),P(c,u,m),f=!0},p(u,m){const d={};m&1&&(d.nameOfClass=u[0]),m&2&&(d.descriptionOfClass=u[1]),r.$set(d);const v={};m&8&&(v.$$scope={dirty:m,ctx:u}),c.$set(v)},i(u){f||($(r.$$.fragment,u),$(c.$$.fragment,u),f=!0)},o(u){D(r.$$.fragment,u),D(c.$$.fragment,u),f=!1},d(u){u&&p(e),L(r),u&&p(i),L(c,u)}}}function Lt(o){let e,n;return e=new mt({props:{$$slots:{default:[Pt]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,s){P(e,t,s),n=!0},p(t,s){const l={};s&11&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ut(o){let e;return{c(){e=E("main"),this.h()},l(n){e=O(n,"MAIN",{class:!0,id:!0,style:!0});var t=T(e);t.forEach(p),this.h()},h(){S(e,"class","main-content svelte-f4hgt4"),S(e,"id","main-content"),h(e,"padding","0")},m(n,t){w(n,e,t)},d(n){n&&p(e)}}}function qt(o){let e,n,t,s,l;return n=new ct({props:{style:"overflow-y: scroll; height: 100%;",class:"mdc-elevation--z"+5,$$slots:{default:[Lt]},$$scope:{ctx:o}}}),s=new ut({props:{class:"app-content",$$slots:{default:[Ut]},$$scope:{ctx:o}}}),{c(){e=E("div"),A(n.$$.fragment),t=M(),A(s.$$.fragment),this.h()},l(a){e=O(a,"DIV",{class:!0});var r=T(e);z(n.$$.fragment,r),t=V(r),z(s.$$.fragment,r),r.forEach(p),this.h()},h(){S(e,"class","drawer-container svelte-f4hgt4")},m(a,r){w(a,e,r),P(n,e,null),I(e,t),P(s,e,null),l=!0},p(a,[r]){const i={};r&11&&(i.$$scope={dirty:r,ctx:a}),n.$set(i);const c={};r&8&&(c.$$scope={dirty:r,ctx:a}),s.$set(c)},i(a){l||($(n.$$.fragment,a),$(s.$$.fragment,a),l=!0)},o(a){D(n.$$.fragment,a),D(s.$$.fragment,a),l=!1},d(a){a&&p(e),L(n),L(s)}}}function Bt(o,e,n){let{$$slots:t={},$$scope:s}=e,{nameOfClass:l}=e,{descriptionOfClass:a}=e;return o.$$set=r=>{"nameOfClass"in r&&n(0,l=r.nameOfClass),"descriptionOfClass"in r&&n(1,a=r.descriptionOfClass),"$$scope"in r&&n(3,s=r.$$scope)},[l,a,t,s]}class Ft extends x{constructor(e){super();ee(this,e,Bt,qt,te,{nameOfClass:0,descriptionOfClass:1})}}function Ht(o,e,n){let t,s,l,a;J(o,$e,v=>n(10,s=v)),J(o,Ne,v=>n(3,l=v)),J(o,ve,v=>n(4,a=v));let{classID:r}=e,{roomID:i}=e,c,f,u,m,d;return he(()=>{d&&d(),a&&(_t(f),ve.set(!1)),m&&m.cancel()}),le(()=>{X.set({}),u=Oe(Te(),".info/connected"),d=pt(u,async v=>{if(v.val()===!0){const y=Ae();c=Oe(Te(),`/class/${r}/room/${i}/participants/${y}`),m=ht(c),m.set({hasDisconnected:!0,userUID:l.uid}),n(2,f=Z(W(),`classes/${r}/participants/${y}`)),ge(f,{uid:l.uid,browserTabID:s,currentRoomID:i,name:t}),ve.set(!0)}})}),o.$$set=v=>{"classID"in v&&n(0,r=v.classID),"roomID"in v&&n(1,i=v.roomID)},o.$$.update=()=>{o.$$.dirty&8&&(t=l.name?l.name:"Beaver #"),o.$$.dirty&30&&a&&l.name&&ae(f,{currentRoomID:i,name:l.name})},[r,i,f,l,a]}class Jt extends x{constructor(e){super();ee(this,e,Ht,null,te,{classID:0,roomID:1})}}const Wt="0ac8a98cf9bef2827f5beef5cd36c4f42a442863ce904a2469de12caa9097fa1",Kt=o=>({activeSpeakerID:o&2,firestoreIDToDailyID:o&1}),Fe=o=>({toggleMic:o[2],activeSpeakerID:o[1],firestoreIDToDailyID:o[0]});function Qt(o){let e;const n=o[8].default,t=me(n,o,o[7],Fe);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,[l]){t&&t.p&&(!e||l&131)&&de(t,n,s,s[7],e?pe(n,s[7],l,Kt):_e(s[7]),Fe)},i(s){e||($(t,s),e=!0)},o(s){D(t,s),e=!1},d(s){t&&t.d(s)}}}async function Yt({track:o,participant:e}){switch(o.kind){case"audio":if(e.local)return;{const n=document.createElement("audio");n.srcObject=new MediaStream([o]),n.setAttribute("id","audio"+e.user_id),n.setAttribute("playsinline",!0),n.setAttribute("autoplay",!0),document.getElementById("container-for-audio-elements").appendChild(n)}break}}async function Gt({track:o,participant:e}){const n=document.getElementById(o.id);n&&(n.srcObject=null,n.remove())}function Zt(o,e,n){let t,s,l;J(o,ne,g=>n(10,t=g)),J(o,$e,g=>n(11,s=g)),J(o,ze,g=>n(12,l=g));let{$$slots:a={},$$scope:r}=e,{roomID:i}=e,c,f,u,m,d,v="";he(()=>{m==="connected"&&k()}),le(async()=>{await y(),R()});async function y(){return new Promise(async(g,C)=>{if(!l)try{const U=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("micStream =",U),ze.set(U),console.log("dailyMicStream =",l)}catch{alert("Mic. permission was denied by your browser - it's needed for voice chat and for recording voiced explanations. Reset your mic. settings, which is usually an icon button close to the website URL bar e.g. the left side of 'https://ihtfp.app'"),C()}const[j]=l.getAudioTracks();c=gt.createCallObject({audioSource:j,videoSource:!1});const N=["participant-joined","participant-updated","participant-left"];for(const U of N)c.on(U,()=>{ne.set(c.participants());const G={};for(const Xe of Object.keys(t)){const De=t[Xe],we=De.user_name;we&&(G[we]=De.user_id)}n(0,f=G)});c.on("track-started",Yt),c.on("track-stopped",Gt),c.on("active-speaker-change",({activeSpeaker:U})=>{n(1,v=U.peerId)}),c.on("load-attempt-failed",({action:U,errorMsg:G})=>{alert(U+": "+G)}),c.on("error",({action:U,errorMsg:G})=>{alert(U+": "+G)}),g()})}async function R(){n(4,u="not_connected"),n(5,m="connecting"),n(6,d=i);const{url:g}=await F();g&&(await Y(g),n(4,u="connecting"),n(5,m="connected"))}function F(){return new Promise(async g=>{try{const C=2*60*60,N=await(await fetch("https://api.daily.co/v1/rooms",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+Wt},body:JSON.stringify({name:i,properties:{exp:Math.round(Date.now()/1e3)+C,eject_at_room_exp:!0,start_video_off:!0}})})).json();N.error==="invalid-request-error"&&N.info===`a room named ${i} already exists`?g({url:`https://feynman.daily.co/${i}`}):g(N)}catch(C){console.error(C),alert(C),reject({url:""})}})}function Y(g){return new Promise(async(C,j)=>{try{await c.join({url:g,userName:s}),C()}catch(N){console.log("error)"),alert(N),j()}})}function _(){console.log("toggling mic"),c.setLocalAudio(!t.local.audio),ne.set(c.participants())}function k(){const g=document.querySelectorAll("audio");for(const C of g)C.remove();b(),n(4,u="connected"),n(5,m="not_connected")}function b(){c.leave(),ne.set({}),n(1,v="")}return o.$$set=g=>{"roomID"in g&&n(3,i=g.roomID),"$$scope"in g&&n(7,r=g.$$scope)},o.$$.update=()=>{o.$$.dirty&120&&u==="connecting"&&m==="connected"&&d!==i&&(console.log("part 1: user moved to a different room before voice chat connected"),k()),o.$$.dirty&120&&u==="connected"&&m==="not_connected"&&d!==i&&(console.log("part 2: ready to join the new room"),R())},[f,v,_,i,u,m,d,r,a]}class Xt extends x{constructor(e){super();ee(this,e,Zt,Qt,te,{roomID:3})}}function He(o,e,n){const t=o.slice();return t[21]=e[n],t}function Je(o,e,n){const t=o.slice();return t[24]=e[n],t}function xt(o){let e,n;return{c(){e=E("div"),n=q("(no title)"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=B(s,"(no title)"),s.forEach(p),this.h()},h(){h(e,"margin-bottom","2px")},m(t,s){w(t,e,s),I(e,n)},p:Ve,d(t){t&&p(e)}}}function es(o){let e,n=o[21].name+"",t;return{c(){e=E("div"),t=q(n),this.h()},l(s){e=O(s,"DIV",{style:!0,class:!0});var l=T(e);t=B(l,n),l.forEach(p),this.h()},h(){h(e,"white-space","nowrap"),h(e,"overflow","hidden"),h(e,"text-overflow","ellipsis margin-bottom: 2px"),S(e,"class","svelte-twz7iw"),ie(e,"question-item",o[21].name.charAt(o[21].name.length-1)==="?")},m(s,l){w(s,e,l),I(e,t)},p(s,l){l&16&&n!==(n=s[21].name+"")&&se(t,n),l&16&&ie(e,"question-item",s[21].name.charAt(s[21].name.length-1)==="?")},d(s){s&&p(e)}}}function We(o){let e=[],n=new Map,t,s,l=o[5][o[21].id];const a=r=>r[24].browserTabID;for(let r=0;r<l.length;r+=1){let i=Je(o,l,r),c=a(i);n.set(c,e[r]=Ge(c,i))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=H()},l(r){for(let i=0;i<e.length;i+=1)e[i].l(r);t=H()},m(r,i){for(let c=0;c<e.length;c+=1)e[c].m(r,i);w(r,t,i),s=!0},p(r,i){i&1835248&&(l=r[5][r[21].id],K(),e=je(e,i,a,1,r,l,n,t.parentNode,Me,Ge,t,Je),Q())},i(r){if(!s){for(let i=0;i<l.length;i+=1)$(e[i]);s=!0}},o(r){for(let i=0;i<e.length;i+=1)D(e[i]);s=!1},d(r){for(let i=0;i<e.length;i+=1)e[i].d(r);r&&p(t)}}}function Ke(o){let e,n,t,s=o[24].browserTabID===o[7]&&Qe(o),l=o[6][o[20][o[24].browserTabID]]&&Ye(o);return{c(){s&&s.c(),e=M(),l&&l.c(),n=H()},l(a){s&&s.l(a),e=V(a),l&&l.l(a),n=H()},m(a,r){s&&s.m(a,r),w(a,e,r),l&&l.m(a,r),w(a,n,r),t=!0},p(a,r){a[24].browserTabID===a[7]?s?(s.p(a,r),r&176&&$(s,1)):(s=Qe(a),s.c(),$(s,1),s.m(e.parentNode,e)):s&&(K(),D(s,1,1,()=>{s=null}),Q()),a[6][a[20][a[24].browserTabID]]?l?l.p(a,r):(l=Ye(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i(a){t||($(s),t=!0)},o(a){D(s),t=!1},d(a){s&&s.d(a),a&&p(e),l&&l.d(a),a&&p(n)}}}function Qe(o){let e,n,t,s,l,a,r;t=new kt({props:{checked:o[6].local.audio,style:"margin: 0 !important"}});function i(u,m){return u[6].local.audio?ss:ts}let c=i(o),f=c(o);return{c(){e=E("div"),n=E("div"),A(t.$$.fragment),s=M(),f.c(),this.h()},l(u){e=O(u,"DIV",{style:!0});var m=T(e);n=O(m,"DIV",{style:!0});var d=T(n);z(t.$$.fragment,d),d.forEach(p),s=V(m),f.l(m),m.forEach(p),this.h()},h(){h(n,"margin-right","0"),h(n,"margin-left","auto"),h(n,"padding-top","5px"),h(e,"display","flex"),h(e,"align-items","center"),h(e,"margin-right","0"),h(e,"margin-left","auto")},m(u,m){w(u,e,m),I(e,n),P(t,n,null),I(e,s),f.m(e,null),l=!0,a||(r=ce(n,"click",wt(It(function(){yt(o[19])&&o[19].apply(this,arguments)}))),a=!0)},p(u,m){o=u;const d={};m&64&&(d.checked=o[6].local.audio),t.$set(d),c!==(c=i(o))&&(f.d(1),f=c(o),f&&(f.c(),f.m(e,null)))},i(u){l||($(t.$$.fragment,u),l=!0)},o(u){D(t.$$.fragment,u),l=!1},d(u){u&&p(e),L(t),f.d(),a=!1,r()}}}function ts(o){let e,n;return{c(){e=E("div"),n=q("muted"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=B(s,"muted"),s.forEach(p),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","red")},m(t,s){w(t,e,s),I(e,n)},d(t){t&&p(e)}}}function ss(o){let e,n;return{c(){e=E("div"),n=q("voice on"),this.h()},l(t){e=O(t,"DIV",{style:!0});var s=T(e);n=B(s,"voice on"),s.forEach(p),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","green")},m(t,s){w(t,e,s),I(e,n)},d(t){t&&p(e)}}}function Ye(o){let e;function n(l,a){return l[6][l[20][l[24].browserTabID]].audio?os:ns}let t=n(o),s=t(o);return{c(){s.c(),e=H()},l(l){s.l(l),e=H()},m(l,a){s.m(l,a),w(l,e,a)},p(l,a){t===(t=n(l))&&s?s.p(l,a):(s.d(1),s=t(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){s.d(l),l&&p(e)}}}function ns(o){let e,n;return{c(){e=E("span"),n=q("mic_off"),this.h()},l(t){e=O(t,"SPAN",{class:!0,style:!0});var s=T(e);n=B(s,"mic_off"),s.forEach(p),this.h()},h(){S(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.2rem"),h(e,"color","red")},m(t,s){w(t,e,s),I(e,n)},p:Ve,d(t){t&&p(e)}}}function os(o){let e,n;return{c(){e=E("span"),n=q("mic"),this.h()},l(t){e=O(t,"SPAN",{class:!0,style:!0});var s=T(e);n=B(s,"mic"),s.forEach(p),this.h()},h(){S(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.2rem"),h(e,"color",o[20]&&o[20][o[24].browserTabID]&&o[20][o[24].browserTabID]===o[18]?"white":"")},m(t,s){w(t,e,s),I(e,n)},p(t,s){s&1310768&&h(e,"color",t[20]&&t[20][t[24].browserTabID]&&t[20][t[24].browserTabID]===t[18]?"white":"")},d(t){t&&p(e)}}}function Ge(o,e){let n,t,s=e[24].name+"",l,a,r=Object.keys(e[6]).length>0,i,c,f=r&&Ke(e);return{key:o,first:null,c(){n=E("div"),t=E("div"),l=q(s),a=M(),f&&f.c(),i=M(),this.h()},l(u){n=O(u,"DIV",{style:!0});var m=T(n);t=O(m,"DIV",{style:!0,class:!0});var d=T(t);l=B(d,s),d.forEach(p),a=V(m),f&&f.l(m),i=V(m),m.forEach(p),this.h()},h(){h(t,"font-size","0.7rem"),h(t,"margin-left","6px"),S(t,"class","svelte-twz7iw"),ie(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),h(n,"display","flex"),h(n,"align-items","center"),this.first=n},m(u,m){w(u,n,m),I(n,t),I(t,l),I(n,a),f&&f.m(n,null),I(n,i),c=!0},p(u,m){e=u,(!c||m&48)&&s!==(s=e[24].name+"")&&se(l,s),m&1310768&&ie(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),m&64&&(r=Object.keys(e[6]).length>0),r?f?(f.p(e,m),m&64&&$(f,1)):(f=Ke(e),f.c(),$(f,1),f.m(n,i)):f&&(K(),D(f,1,1,()=>{f=null}),Q())},i(u){c||($(f),c=!0)},o(u){D(f),c=!1},d(u){u&&p(n),f&&f.d()}}}function Ze(o,e){let n,t,s,l,a,r,i,c;function f(y,R){if(y[21].name)return es;if(y[21].name==="")return xt}let u=f(e),m=u&&u(e),d=e[5][e[21].id]&&We(e);function v(){return e[10](e[21])}return{key:o,first:null,c(){n=E("div"),t=E("div"),m&&m.c(),s=M(),d&&d.c(),a=M(),this.h()},l(y){n=O(y,"DIV",{style:!0});var R=T(n);t=O(R,"DIV",{class:!0,style:!0});var F=T(t);m&&m.l(F),s=V(F),d&&d.l(F),F.forEach(p),a=V(R),R.forEach(p),this.h()},h(){S(t,"class",l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-twz7iw")),h(t,"padding","6px 10px 6px 8px"),h(t,"opacity","90%"),h(t,"border-radius","5px"),h(n,"padding","6px"),this.first=n},m(y,R){w(y,n,R),I(n,t),m&&m.m(t,null),I(t,s),d&&d.m(t,null),I(n,a),r=!0,i||(c=ce(n,"click",v),i=!0)},p(y,R){e=y,u===(u=f(e))&&m?m.p(e,R):(m&&m.d(1),m=u&&u(e),m&&(m.c(),m.m(t,s))),e[5][e[21].id]?d?(d.p(e,R),R&48&&$(d,1)):(d=We(e),d.c(),$(d,1),d.m(t,null)):d&&(K(),D(d,1,1,()=>{d=null}),Q()),(!r||R&18&&l!==(l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-twz7iw")))&&S(t,"class",l)},i(y){r||($(d),r=!0)},o(y){D(d),r=!1},d(y){y&&p(n),m&&m.d(),d&&d.d(),i=!1,c()}}}function ls(o){let e,n,t;return{c(){e=E("span"),n=q("add"),t=q(`\r
      New room`),this.h()},l(s){e=O(s,"SPAN",{class:!0,style:!0});var l=T(e);n=B(l,"add"),l.forEach(p),t=B(s,`\r
      New room`),this.h()},h(){S(e,"class","material-icons"),h(e,"margin-right","4px")},m(s,l){w(s,e,l),I(e,n),w(s,t,l)},d(s){s&&p(e),s&&p(t)}}}function as(o){let e=[],n=new Map,t,s,l,a=o[4];const r=i=>i[21].id+i[1];for(let i=0;i<a.length;i+=1){let c=He(o,a,i),f=r(c);n.set(f,e[i]=Ze(f,c))}return s=new Dt({props:{style:"width: 100%; margin: auto;",$$slots:{default:[ls]},$$scope:{ctx:o}}}),s.$on("click",o[8]),{c(){for(let i=0;i<e.length;i+=1)e[i].c();t=M(),A(s.$$.fragment)},l(i){for(let c=0;c<e.length;c+=1)e[c].l(i);t=V(i),z(s.$$.fragment,i)},m(i,c){for(let f=0;f<e.length;f+=1)e[f].m(i,c);w(i,t,c),P(s,i,c),l=!0},p(i,c){c&1835251&&(a=i[4],K(),e=je(e,c,r,1,i,a,n,t.parentNode,Me,Ze,t,He),Q());const f={};c&2048&&(f.$$scope={dirty:c,ctx:i}),s.$set(f)},i(i){if(!l){for(let c=0;c<a.length;c+=1)$(e[c]);$(s.$$.fragment,i),l=!0}},o(i){for(let c=0;c<e.length;c+=1)D(e[c]);D(s.$$.fragment,i),l=!1},d(i){for(let c=0;c<e.length;c+=1)e[c].d(i);i&&p(t),L(s,i)}}}function rs(o){let e,n;return e=new Ft({props:{nameOfClass:o[2],descriptionOfClass:o[3],$$slots:{default:[as]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,s){P(e,t,s),n=!0},p(t,s){const l={};s&4&&(l.nameOfClass=t[2]),s&8&&(l.descriptionOfClass=t[3]),s&1837299&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function is(o){let e,n,t,s,l,a,r;e=new Jt({props:{classID:o[0],roomID:o[1]}}),l=new Xt({props:{roomID:o[1],$$slots:{default:[rs,({activeSpeakerID:f,toggleMic:u,firestoreIDToDailyID:m})=>({18:f,19:u,20:m}),({activeSpeakerID:f,toggleMic:u,firestoreIDToDailyID:m})=>(f?262144:0)|(u?524288:0)|(m?1048576:0)]},$$scope:{ctx:o}}});const i=o[9].default,c=me(i,o,o[11],null);return{c(){A(e.$$.fragment),n=M(),t=E("div"),s=M(),A(l.$$.fragment),a=M(),c&&c.c(),this.h()},l(f){z(e.$$.fragment,f),n=V(f),t=O(f,"DIV",{id:!0});var u=T(t);u.forEach(p),s=V(f),z(l.$$.fragment,f),a=V(f),c&&c.l(f),this.h()},h(){S(t,"id","container-for-audio-elements")},m(f,u){P(e,f,u),w(f,n,u),w(f,t,u),w(f,s,u),P(l,f,u),w(f,a,u),c&&c.m(f,u),r=!0},p(f,[u]){const m={};u&1&&(m.classID=f[0]),u&2&&(m.roomID=f[1]),e.$set(m);const d={};u&2&&(d.roomID=f[1]),u&1837311&&(d.$$scope={dirty:u,ctx:f}),l.$set(d),c&&c.p&&(!r||u&2048)&&de(c,i,f,f[11],r?pe(i,f[11],u,null):_e(f[11]),null)},i(f){r||($(e.$$.fragment,f),$(l.$$.fragment,f),$(c,f),r=!0)},o(f){D(e.$$.fragment,f),D(l.$$.fragment,f),D(c,f),r=!1},d(f){L(e,f),f&&p(n),f&&p(t),f&&p(s),L(l,f),f&&p(a),c&&c.d(f)}}}function ps({page:o}){return{props:{classID:o.params.class,roomID:o.params.room}}}function fs(o,e,n){let t,s,l;J(o,X,b=>n(5,t=b)),J(o,ne,b=>n(6,s=b)),J(o,$e,b=>n(7,l=b));let{$$slots:a={},$$scope:r}=e,{classID:i}=e,{roomID:c}=e,f="",u="",m=[];he(()=>{for(const b of R)b();window.removeEventListener("resize",y)}),le(async()=>{console.log("__layout mounted, but should only be done once"),window.addEventListener("resize",y),y();const b=Z(W(),`classes/${i}`),g=await vt(b);n(2,f=g.data().name),n(3,u=g.data().description)});async function d(){for(const N of m)if(N.name===""){alert("A room is still untitled - use it before creating a new one");return}const b=Ae(),g=`classes/${i}/`,C=Z(W(),g+`rooms/${b}`),j=Z(W(),g+`blackboards/${b}`);await Promise.all([ge(C,{name:"",blackboards:[b],date:new Date().toISOString()}),ge(j,{})])}function v(){const{height:b,width:g}=Ot();Ct.set(b),Et.set(g)}function y(){setTimeout(v,100)}let R=[];const F=ue(W(),`classes/${i}/participants`),Y=ue(W(),`classes/${i}/rooms`),_=bt(Y,$t("date","asc"));R.push(Re(_,b=>{const g=[];b.forEach(C=>{g.push(fe({id:C.id,ref:C.ref.path},C.data()))}),n(4,m=g)})),R.push(Re(F,b=>{b.docChanges().forEach(g=>{const C=g.doc.data(),j=C.currentRoomID;switch(g.type){case"added":t[j]||re(X,t[j]=[],t),t[j].push(C);break;case"modified":for(const N of Object.keys(t))for(const U of t[N])U.browserTabID===C.browserTabID&&re(X,t[N]=t[N].filter(G=>G.browserTabID!==C.browserTabID),t);t[j]||re(X,t[j]=[],t),t[j].push(C);break;case"removed":re(X,t[j]=t[j].filter(N=>N.browserTabID!==C.browserTabID),t);break}})}));const k=b=>be(`/${i}/${b.id}`);return o.$$set=b=>{"classID"in b&&n(0,i=b.classID),"roomID"in b&&n(1,c=b.roomID),"$$scope"in b&&n(11,r=b.$$scope)},[i,c,f,u,m,t,s,l,d,a,k,r]}class hs extends x{constructor(e){super();ee(this,e,fs,is,te,{classID:0,roomID:1})}}export{hs as default,ps as load};
