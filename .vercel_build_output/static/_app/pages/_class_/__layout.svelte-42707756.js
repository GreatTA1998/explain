var xe=Object.defineProperty;var we=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var ye=(o,e,n)=>e in o?xe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,ce=(o,e)=>{for(var n in e||(e={}))et.call(e,n)&&ye(o,n,e[n]);if(we)for(var n of we(e))tt.call(e,n)&&ye(o,n,e[n]);return o};import{S as ee,i as te,s as se,a9 as st,aa as nt,a2 as le,ab as ke,e as C,t as q,k as M,j as A,c as E,a as R,g as F,d as g,n as V,m as P,L as _,f as w,M as y,o as z,Z as ae,h as ne,ac as Ce,x as $,u as I,v as L,E as J,A as re,a4 as ue,P as W,a7 as ot,O as X,_ as ie,ad as Ee,r as K,w as Q,ae as lt,V as at,l as H,af as rt,ag as it,ah as ft,ai as ct,aj as ut,b as j,ak as dt,U as mt,H as de,I as me,J as _e,K as pe,W as he,al as _t,am as Oe,an as Te,ao as pt,ap as ht,R as ge,aq as gt,a5 as bt,a6 as vt,a3 as Re,Q as $t,ar as x,as as Se,at as je,au as Me,av as fe,aw as Dt,ax as It,ay as wt,az as yt,N as Ve}from"../../chunks/vendor-bc7dd356.js";import{u as Ne,g as be,b as ve,i as $e,r as Z,d as Ae,e as oe,f as Pe,a as kt,c as Ct}from"../../chunks/navigation-3ddb30f2.js";import{b as Et}from"../../chunks/canvas-74f91cf9.js";import"../../chunks/singletons-12a22614.js";function ze(o,e,n){const t=o.slice();return t[18]=e[n],t}function Ot(o){let e;return{c(){e=q("arrow_drop_down")},l(n){e=F(n,"arrow_drop_down")},m(n,t){w(n,e,t)},d(n){n&&g(e)}}}function Le(o){let e,n,t=o[7].enrolledClasses,s=[];for(let a=0;a<t.length;a+=1)s[a]=qe(ze(o,t,a));const l=a=>I(s[a],1,1,()=>{s[a]=null});return{c(){for(let a=0;a<s.length;a+=1)s[a].c();e=H()},l(a){for(let r=0;r<s.length;r+=1)s[r].l(a);e=H()},m(a,r){for(let i=0;i<s.length;i+=1)s[i].m(a,r);w(a,e,r),n=!0},p(a,r){if(r&385){t=a[7].enrolledClasses;let i;for(i=0;i<t.length;i+=1){const m=ze(a,t,i);s[i]?(s[i].p(m,r),$(s[i],1)):(s[i]=qe(m),s[i].c(),$(s[i],1),s[i].m(e.parentNode,e))}for(K(),i=t.length;i<s.length;i+=1)l(i);Q()}},i(a){if(!n){for(let r=0;r<t.length;r+=1)$(s[r]);n=!0}},o(a){s=s.filter(Boolean);for(let r=0;r<s.length;r+=1)I(s[r]);n=!1},d(a){rt(s,a),a&&g(e)}}}function Ue(o){let e,n;function t(){return o[10](o[18])}return e=new ft({props:{$$slots:{default:[Tt]},$$scope:{ctx:o}}}),e.$on("SMUI:action",t),{c(){A(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,l){z(e,s,l),n=!0},p(s,l){o=s;const a={};l&2097280&&(a.$$scope={dirty:l,ctx:o}),e.$set(a)},i(s){n||($(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function Tt(o){let e=o[18].name+"",n,t;return{c(){n=q(e),t=M()},l(s){n=F(s,e),t=V(s)},m(s,l){w(s,n,l),w(s,t,l)},p(s,l){l&128&&e!==(e=s[18].name+"")&&ne(n,e)},d(s){s&&g(n),s&&g(t)}}}function qe(o){let e,n,t=o[18].name!==o[0]&&Ue(o);return{c(){t&&t.c(),e=H()},l(s){t&&t.l(s),e=H()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[18].name!==s[0]?t?(t.p(s,l),l&129&&$(t,1)):(t=Ue(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),I(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){I(t),n=!1},d(s){t&&t.d(s),s&&g(e)}}}function Rt(o){let e,n,t=o[7].enrolledClasses&&Le(o);return{c(){t&&t.c(),e=H()},l(s){t&&t.l(s),e=H()},m(s,l){t&&t.m(s,l),w(s,e,l),n=!0},p(s,l){s[7].enrolledClasses?t?(t.p(s,l),l&128&&$(t,1)):(t=Le(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(K(),I(t,1,1,()=>{t=null}),Q())},i(s){n||($(t),n=!0)},o(s){I(t),n=!1},d(s){t&&t.d(s),s&&g(e)}}}function Fe(o){let e,n,t;function s(a){o[11](a)}let l={options:o[6],getOptionLabel:Mt,textfield$variant:"outlined",label:"Search class"};return o[3]!==void 0&&(l.value=o[3]),e=new it({props:l}),le.push(()=>ke(e,"value",s)),{c(){A(e.$$.fragment)},l(a){P(e.$$.fragment,a)},m(a,r){z(e,a,r),t=!0},p(a,r){const i={};r&64&&(i.options=a[6]),!n&&r&8&&(n=!0,i.value=a[3],Ce(()=>n=!1)),e.$set(i)},i(a){t||($(e.$$.fragment,a),t=!0)},o(a){I(e.$$.fragment,a),t=!1},d(a){L(e,a)}}}function St(o){let e,n,t,s;e=new Ee({props:{$$slots:{default:[Rt]},$$scope:{ctx:o}}});let l=o[2].length>0&&Fe(o);return{c(){A(e.$$.fragment),n=M(),t=C("div"),l&&l.c(),this.h()},l(a){P(e.$$.fragment,a),n=V(a),t=E(a,"DIV",{style:!0});var r=R(t);l&&l.l(r),r.forEach(g),this.h()},h(){_(t,"margin","4px")},m(a,r){z(e,a,r),w(a,n,r),w(a,t,r),l&&l.m(t,null),s=!0},p(a,r){const i={};r&2097281&&(i.$$scope={dirty:r,ctx:a}),e.$set(i),a[2].length>0?l?(l.p(a,r),r&4&&$(l,1)):(l=Fe(a),l.c(),$(l,1),l.m(t,null)):l&&(K(),I(l,1,1,()=>{l=null}),Q())},i(a){s||($(e.$$.fragment,a),$(l),s=!0)},o(a){I(e.$$.fragment,a),I(l),s=!1},d(a){L(e,a),a&&g(n),a&&g(t),l&&l.d()}}}function jt(o){let e,n,t,s,l,a,r,i,m,f,c,u,d,p,D,k;f=new st({props:{class:"material-icons",$$slots:{default:[Ot]},$$scope:{ctx:o}}});function B(h){o[13](h)}let Y={anchor:!1,anchorCorner:"BOTTOM_LEFT",style:"left: 70px; top: 65px; width: 220px; overflow: visible;",$$slots:{default:[St]},$$scope:{ctx:o}};return o[4]!==void 0&&(Y.anchorElement=o[4]),u=new nt({props:Y}),o[12](u),le.push(()=>ke(u,"anchorElement",B)),{c(){e=C("div"),n=C("div"),t=C("div"),s=C("h1"),l=q(o[0]),a=M(),r=C("div"),i=q(o[1]),m=M(),A(f.$$.fragment),c=M(),A(u.$$.fragment),this.h()},l(h){e=E(h,"DIV",{});var O=R(e);n=E(O,"DIV",{style:!0});var v=R(n);t=E(v,"DIV",{});var b=R(t);s=E(b,"H1",{style:!0});var T=R(s);l=F(T,o[0]),T.forEach(g),a=V(b),r=E(b,"DIV",{style:!0});var S=R(r);i=F(S,o[1]),S.forEach(g),b.forEach(g),m=V(v),P(f.$$.fragment,v),v.forEach(g),c=V(O),P(u.$$.fragment,O),O.forEach(g),this.h()},h(){_(s,"font-family","Roboto, sans-serif"),_(s,"font-weight","400"),_(s,"margin-left","6px"),_(s,"margin-top","5px"),_(s,"margin-bottom","0px"),_(s,"font-size","2.0rem"),_(r,"font-family","Roboto,sans-serif"),_(r,"font-size","0.875rem"),_(r,"color","rgba(0,0,0,.6)"),_(r,"margin-left","8px"),_(r,"margin-bottom","12px"),_(n,"display","flex"),_(n,"align-items","center")},m(h,O){w(h,e,O),y(e,n),y(n,t),y(t,s),y(s,l),y(t,a),y(t,r),y(r,i),y(n,m),z(f,n,null),y(e,c),z(u,e,null),o[14](e),p=!0,D||(k=ae(n,"click",o[9]),D=!0)},p(h,[O]){(!p||O&1)&&ne(l,h[0]),(!p||O&2)&&ne(i,h[1]);const v={};O&2097152&&(v.$$scope={dirty:O,ctx:h}),f.$set(v);const b={};O&2097357&&(b.$$scope={dirty:O,ctx:h}),!d&&O&16&&(d=!0,b.anchorElement=h[4],Ce(()=>d=!1)),u.$set(b)},i(h){p||($(f.$$.fragment,h),$(u.$$.fragment,h),p=!0)},o(h){I(f.$$.fragment,h),I(u.$$.fragment,h),p=!1},d(h){h&&g(e),L(f),o[12](null),L(u),o[14](null),D=!1,k()}}}const Mt=o=>o?`${o.name} (${o.description})`:"";function Vt(o,e,n){let t,s;J(o,Ne,h=>n(7,s=h));let{nameOfClass:l}=e,{descriptionOfClass:a}=e,r,i=[],m="";console.log("$user =",s);let f;re(async()=>{console.log("$user.enrolledClasses =",s.enrolledClasses);const h=ue(W(),"/classes"),O=await ot(h),v=[];O.forEach(b=>{v.push(ce({id:b.id},b.data()))}),n(2,i=[...v])});async function c({mitClass:h}){console.log("join mitClass =",h);for(const v of s.enrolledClasses)if(v.id===h.id){alert(`You are already in ${h.name}`);return}const O=W();ie(X(O,`users/${s.uid}`),{enrolledClasses:lt(h),mostRecentClassID:h.id}),ie(X(O,`classes/${h.id}`),{numOfMembers:at(1)}),be(`/${h.id}/${h.id}`)}async function u(h){const O=W(),v=X(O,`users/${s.uid}`);ie(v,{mostRecentClassID:h.id}),be(`/${h.id}/${h.id}`)}const d=()=>f.setOpen(!0),p=h=>u(h);function D(h){m=h,n(3,m)}function k(h){le[h?"unshift":"push"](()=>{f=h,n(5,f)})}function B(h){r=h,n(4,r)}function Y(h){le[h?"unshift":"push"](()=>{r=h,n(4,r)})}return o.$$set=h=>{"nameOfClass"in h&&n(0,l=h.nameOfClass),"descriptionOfClass"in h&&n(1,a=h.descriptionOfClass)},o.$$.update=()=>{o.$$.dirty&8&&m&&(console.log("selected option =",m),c({mitClass:m})),o.$$.dirty&4&&n(6,t=i.filter(h=>["8.01"].includes(h.name)))},[l,a,i,m,r,f,t,s,u,d,p,D,k,B,Y]}class Nt extends ee{constructor(e){super();te(this,e,Vt,jt,se,{nameOfClass:0,descriptionOfClass:1})}}function At(o){let e;const n=o[2].default,t=de(n,o,o[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,l){t&&t.p&&(!e||l&8)&&me(t,n,s,s[3],e?pe(n,s[3],l,null):_e(s[3]),null)},i(s){e||($(t,s),e=!0)},o(s){I(t,s),e=!1},d(s){t&&t.d(s)}}}function Pt(o){let e,n,t,s,l,a,r,i,m,f;return r=new Nt({props:{nameOfClass:o[0],descriptionOfClass:o[1]}}),m=new Ee({props:{$$slots:{default:[At]},$$scope:{ctx:o}}}),{c(){e=C("div"),n=C("div"),t=C("img"),l=M(),a=C("div"),A(r.$$.fragment),i=M(),A(m.$$.fragment),this.h()},l(c){e=E(c,"DIV",{style:!0,class:!0});var u=R(e);n=E(u,"DIV",{style:!0,class:!0});var d=R(n);t=E(d,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),l=V(d),a=E(d,"DIV",{class:!0});var p=R(a);P(r.$$.fragment,p),p.forEach(g),d.forEach(g),u.forEach(g),i=V(c),P(m.$$.fragment,c),this.h()},h(){mt(t.src,s="/logo.png")||j(t,"src",s),j(t,"width","60"),j(t,"height","54"),j(t,"alt","web-logo"),j(t,"class","svelte-f4hgt4"),j(a,"class","svelte-f4hgt4"),_(n,"display","flex"),_(n,"align-items","center"),j(n,"class","svelte-f4hgt4"),_(e,"margin-bottom","12px"),_(e,"padding-top","2px"),_(e,"padding-bottom","0"),_(e,"padding-left","8px"),j(e,"class","mdc-elevation--z"+4+" svelte-f4hgt4")},m(c,u){w(c,e,u),y(e,n),y(n,t),y(n,l),y(n,a),z(r,a,null),w(c,i,u),z(m,c,u),f=!0},p(c,u){const d={};u&1&&(d.nameOfClass=c[0]),u&2&&(d.descriptionOfClass=c[1]),r.$set(d);const p={};u&8&&(p.$$scope={dirty:u,ctx:c}),m.$set(p)},i(c){f||($(r.$$.fragment,c),$(m.$$.fragment,c),f=!0)},o(c){I(r.$$.fragment,c),I(m.$$.fragment,c),f=!1},d(c){c&&g(e),L(r),c&&g(i),L(m,c)}}}function zt(o){let e,n;return e=new dt({props:{$$slots:{default:[Pt]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,s){z(e,t,s),n=!0},p(t,s){const l={};s&11&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Lt(o){let e;return{c(){e=C("main"),this.h()},l(n){e=E(n,"MAIN",{class:!0,id:!0,style:!0});var t=R(e);t.forEach(g),this.h()},h(){j(e,"class","main-content svelte-f4hgt4"),j(e,"id","main-content"),_(e,"padding","0")},m(n,t){w(n,e,t)},d(n){n&&g(e)}}}function Ut(o){let e,n,t,s,l;return n=new ct({props:{style:"overflow-y: scroll; height: 100%;",class:"mdc-elevation--z"+5,$$slots:{default:[zt]},$$scope:{ctx:o}}}),s=new ut({props:{class:"app-content",$$slots:{default:[Lt]},$$scope:{ctx:o}}}),{c(){e=C("div"),A(n.$$.fragment),t=M(),A(s.$$.fragment),this.h()},l(a){e=E(a,"DIV",{class:!0});var r=R(e);P(n.$$.fragment,r),t=V(r),P(s.$$.fragment,r),r.forEach(g),this.h()},h(){j(e,"class","drawer-container svelte-f4hgt4")},m(a,r){w(a,e,r),z(n,e,null),y(e,t),z(s,e,null),l=!0},p(a,[r]){const i={};r&11&&(i.$$scope={dirty:r,ctx:a}),n.$set(i);const m={};r&8&&(m.$$scope={dirty:r,ctx:a}),s.$set(m)},i(a){l||($(n.$$.fragment,a),$(s.$$.fragment,a),l=!0)},o(a){I(n.$$.fragment,a),I(s.$$.fragment,a),l=!1},d(a){a&&g(e),L(n),L(s)}}}function qt(o,e,n){let{$$slots:t={},$$scope:s}=e,{nameOfClass:l}=e,{descriptionOfClass:a}=e;return o.$$set=r=>{"nameOfClass"in r&&n(0,l=r.nameOfClass),"descriptionOfClass"in r&&n(1,a=r.descriptionOfClass),"$$scope"in r&&n(3,s=r.$$scope)},[l,a,t,s]}class Ft extends ee{constructor(e){super();te(this,e,qt,Ut,se,{nameOfClass:0,descriptionOfClass:1})}}function Bt(o,e,n){let t,s,l,a;J(o,ve,p=>n(10,s=p)),J(o,Ne,p=>n(3,l=p)),J(o,$e,p=>n(4,a=p));let{classID:r}=e,{roomID:i}=e,m,f,c,u,d;return he(()=>{d&&d(),a&&(_t(f),$e.set(!1)),u&&u.cancel()}),re(()=>{Z.set({}),c=Oe(Te(),".info/connected"),d=pt(c,async p=>{if(p.val()===!0){const D=Ae();m=Oe(Te(),`/class/${r}/room/${i}/participants/${D}`),u=ht(m),u.set({hasDisconnected:!0,userUID:l.uid}),n(2,f=X(W(),`classes/${r}/participants/${D}`)),ge(f,{uid:l.uid,browserTabID:s,currentRoomID:i,name:t}),$e.set(!0)}})}),o.$$set=p=>{"classID"in p&&n(0,r=p.classID),"roomID"in p&&n(1,i=p.roomID)},o.$$.update=()=>{o.$$.dirty&8&&(t=l.name?l.name:"Beaver #"),o.$$.dirty&30&&a&&l.name&&ie(f,{currentRoomID:i,name:l.name})},[r,i,f,l,a]}class Ht extends ee{constructor(e){super();te(this,e,Bt,null,se,{classID:0,roomID:1})}}const Jt="0ac8a98cf9bef2827f5beef5cd36c4f42a442863ce904a2469de12caa9097fa1",Wt=o=>({activeSpeakerID:o&2,firestoreIDToDailyID:o&1}),Be=o=>({toggleMic:o[2],activeSpeakerID:o[1],firestoreIDToDailyID:o[0]});function Kt(o){let e;const n=o[8].default,t=de(n,o,o[7],Be);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,l){t&&t.m(s,l),e=!0},p(s,[l]){t&&t.p&&(!e||l&131)&&me(t,n,s,s[7],e?pe(n,s[7],l,Wt):_e(s[7]),Be)},i(s){e||($(t,s),e=!0)},o(s){I(t,s),e=!1},d(s){t&&t.d(s)}}}async function Qt({track:o,participant:e}){switch(o.kind){case"audio":if(e.local)return;{const n=document.createElement("audio");n.srcObject=new MediaStream([o]),n.setAttribute("id","audio"+e.user_id),n.setAttribute("playsinline",!0),n.setAttribute("autoplay",!0),document.getElementById("container-for-audio-elements").appendChild(n)}break}}async function Yt({track:o,participant:e}){const n=document.getElementById(o.id);n&&(n.srcObject=null,n.remove())}function Gt(o,e,n){let t,s,l;J(o,oe,b=>n(10,t=b)),J(o,ve,b=>n(11,s=b)),J(o,Pe,b=>n(12,l=b));let{$$slots:a={},$$scope:r}=e,{roomID:i}=e,m,f,c,u,d,p="";he(()=>{u==="connected"&&O()}),re(async()=>{await D(),k()});async function D(){return new Promise(async(b,T)=>{if(!l)try{const U=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("micStream =",U),Pe.set(U),console.log("dailyMicStream =",l)}catch{alert("Mic. permission was denied by your browser - it's needed for voice chat and for recording voiced explanations. Reset your mic. settings, which is usually an icon button close to the website URL bar e.g. the left side of 'https://ihtfp.app'"),T()}const[S]=l.getAudioTracks();m=gt.createCallObject({audioSource:S,videoSource:!1});const N=["participant-joined","participant-updated","participant-left"];for(const U of N)m.on(U,()=>{oe.set(m.participants());const G={};for(const Xe of Object.keys(t)){const De=t[Xe],Ie=De.user_name;Ie&&(G[Ie]=De.user_id)}n(0,f=G)});m.on("track-started",Qt),m.on("track-stopped",Yt),m.on("active-speaker-change",({activeSpeaker:U})=>{n(1,p=U.peerId)}),m.on("load-attempt-failed",({action:U,errorMsg:G})=>{alert(U+": "+G)}),m.on("error",({action:U,errorMsg:G})=>{alert(U+": "+G)}),b()})}async function k(){n(4,c="not_connected"),n(5,u="connecting"),n(6,d=i);const{url:b}=await B();b&&(await Y(b),n(4,c="connecting"),n(5,u="connected"))}function B(){return new Promise(async b=>{try{const T=2*60*60,N=await(await fetch("https://api.daily.co/v1/rooms",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+Jt},body:JSON.stringify({name:i,properties:{exp:Math.round(Date.now()/1e3)+T,eject_at_room_exp:!0,start_video_off:!0}})})).json();N.error==="invalid-request-error"&&N.info===`a room named ${i} already exists`?b({url:`https://feynman.daily.co/${i}`}):b(N)}catch(T){console.error(T),alert(T),reject({url:""})}})}function Y(b){return new Promise(async(T,S)=>{try{await m.join({url:b,userName:s}),T()}catch(N){console.log("error)"),alert(N),S()}})}function h(){m.setLocalAudio(!t.local.audio),oe.set(m.participants())}function O(){const b=document.querySelectorAll("audio");for(const T of b)T.remove();v(),n(4,c="connected"),n(5,u="not_connected")}function v(){m.leave(),oe.set({}),n(1,p="")}return o.$$set=b=>{"roomID"in b&&n(3,i=b.roomID),"$$scope"in b&&n(7,r=b.$$scope)},o.$$.update=()=>{o.$$.dirty&120&&c==="connecting"&&u==="connected"&&d!==i&&(console.log("part 1: user moved to a different room before voice chat connected"),O()),o.$$.dirty&120&&c==="connected"&&u==="not_connected"&&d!==i&&(console.log("part 2: ready to join the new room"),k())},[f,p,h,i,c,u,d,r,a]}class Zt extends ee{constructor(e){super();te(this,e,Gt,Kt,se,{roomID:3})}}function He(o,e,n){const t=o.slice();return t[21]=e[n],t}function Je(o,e,n){const t=o.slice();return t[24]=e[n],t}function Xt(o){let e,n;return{c(){e=C("div"),n=q("(empty room)"),this.h()},l(t){e=E(t,"DIV",{style:!0});var s=R(e);n=F(s,"(empty room)"),s.forEach(g),this.h()},h(){_(e,"margin-bottom","2px")},m(t,s){w(t,e,s),y(e,n)},p:Ve,d(t){t&&g(e)}}}function xt(o){let e,n=o[21].name+"",t;return{c(){e=C("div"),t=q(n),this.h()},l(s){e=E(s,"DIV",{style:!0,class:!0});var l=R(e);t=F(l,n),l.forEach(g),this.h()},h(){_(e,"white-space","nowrap"),_(e,"overflow","hidden"),_(e,"text-overflow","ellipsis margin-bottom: 2px"),j(e,"class","svelte-d2j7h9"),fe(e,"question-item",o[21].name.charAt(o[21].name.length-1)==="?"&&o[21].id!==o[1])},m(s,l){w(s,e,l),y(e,t)},p(s,l){l&16&&n!==(n=s[21].name+"")&&ne(t,n),l&18&&fe(e,"question-item",s[21].name.charAt(s[21].name.length-1)==="?"&&s[21].id!==s[1])},d(s){s&&g(e)}}}function We(o){let e=[],n=new Map,t,s,l=o[5][o[21].id];const a=r=>r[24].browserTabID;for(let r=0;r<l.length;r+=1){let i=Je(o,l,r),m=a(i);n.set(m,e[r]=Ge(m,i))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=H()},l(r){for(let i=0;i<e.length;i+=1)e[i].l(r);t=H()},m(r,i){for(let m=0;m<e.length;m+=1)e[m].m(r,i);w(r,t,i),s=!0},p(r,i){i&1835248&&(l=r[5][r[21].id],K(),e=je(e,i,a,1,r,l,n,t.parentNode,Me,Ge,t,Je),Q())},i(r){if(!s){for(let i=0;i<l.length;i+=1)$(e[i]);s=!0}},o(r){for(let i=0;i<e.length;i+=1)I(e[i]);s=!1},d(r){for(let i=0;i<e.length;i+=1)e[i].d(r);r&&g(t)}}}function Ke(o){let e,n,t,s=o[24].browserTabID===o[7]&&Qe(o),l=o[6][o[20][o[24].browserTabID]]&&Ye(o);return{c(){s&&s.c(),e=M(),l&&l.c(),n=H()},l(a){s&&s.l(a),e=V(a),l&&l.l(a),n=H()},m(a,r){s&&s.m(a,r),w(a,e,r),l&&l.m(a,r),w(a,n,r),t=!0},p(a,r){a[24].browserTabID===a[7]?s?(s.p(a,r),r&176&&$(s,1)):(s=Qe(a),s.c(),$(s,1),s.m(e.parentNode,e)):s&&(K(),I(s,1,1,()=>{s=null}),Q()),a[6][a[20][a[24].browserTabID]]?l?l.p(a,r):(l=Ye(a),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i(a){t||($(s),t=!0)},o(a){I(s),t=!1},d(a){s&&s.d(a),a&&g(e),l&&l.d(a),a&&g(n)}}}function Qe(o){let e,n,t,s,l,a,r;t=new yt({props:{checked:o[6].local.audio,style:"margin: 0 !important"}});function i(c,u){return c[6].local.audio?ts:es}let m=i(o),f=m(o);return{c(){e=C("div"),n=C("div"),A(t.$$.fragment),s=M(),f.c(),this.h()},l(c){e=E(c,"DIV",{style:!0});var u=R(e);n=E(u,"DIV",{style:!0});var d=R(n);P(t.$$.fragment,d),d.forEach(g),s=V(u),f.l(u),u.forEach(g),this.h()},h(){_(n,"margin-right","0"),_(n,"margin-left","auto"),_(n,"padding-top","5px"),_(e,"display","flex"),_(e,"align-items","center"),_(e,"margin-right","0"),_(e,"margin-left","auto")},m(c,u){w(c,e,u),y(e,n),z(t,n,null),y(e,s),f.m(e,null),l=!0,a||(r=ae(n,"click",Dt(It(function(){wt(o[19])&&o[19].apply(this,arguments)}))),a=!0)},p(c,u){o=c;const d={};u&64&&(d.checked=o[6].local.audio),t.$set(d),m!==(m=i(o))&&(f.d(1),f=m(o),f&&(f.c(),f.m(e,null)))},i(c){l||($(t.$$.fragment,c),l=!0)},o(c){I(t.$$.fragment,c),l=!1},d(c){c&&g(e),L(t),f.d(),a=!1,r()}}}function es(o){let e,n;return{c(){e=C("div"),n=q("muted"),this.h()},l(t){e=E(t,"DIV",{style:!0});var s=R(e);n=F(s,"muted"),s.forEach(g),this.h()},h(){_(e,"font-size","0.7rem"),_(e,"margin-left","6px"),_(e,"color","red")},m(t,s){w(t,e,s),y(e,n)},d(t){t&&g(e)}}}function ts(o){let e,n;return{c(){e=C("div"),n=q("voice on"),this.h()},l(t){e=E(t,"DIV",{style:!0});var s=R(e);n=F(s,"voice on"),s.forEach(g),this.h()},h(){_(e,"font-size","0.7rem"),_(e,"margin-left","6px"),_(e,"color","#33ff33")},m(t,s){w(t,e,s),y(e,n)},d(t){t&&g(e)}}}function Ye(o){let e;function n(l,a){return l[6][l[20][l[24].browserTabID]].audio?ns:ss}let t=n(o),s=t(o);return{c(){s.c(),e=H()},l(l){s.l(l),e=H()},m(l,a){s.m(l,a),w(l,e,a)},p(l,a){t===(t=n(l))&&s?s.p(l,a):(s.d(1),s=t(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){s.d(l),l&&g(e)}}}function ss(o){let e,n;return{c(){e=C("span"),n=q("mic_off"),this.h()},l(t){e=E(t,"SPAN",{class:!0,style:!0});var s=R(e);n=F(s,"mic_off"),s.forEach(g),this.h()},h(){j(e,"class","material-icons"),_(e,"margin-right","0"),_(e,"margin-left","auto"),_(e,"font-size","1.1rem"),_(e,"color","red")},m(t,s){w(t,e,s),y(e,n)},p:Ve,d(t){t&&g(e)}}}function ns(o){let e,n;return{c(){e=C("span"),n=q("mic"),this.h()},l(t){e=E(t,"SPAN",{class:!0,style:!0});var s=R(e);n=F(s,"mic"),s.forEach(g),this.h()},h(){j(e,"class","material-icons"),_(e,"margin-right","0"),_(e,"margin-left","auto"),_(e,"font-size","1.1rem"),_(e,"color",o[20]&&o[20][o[24].browserTabID]&&o[20][o[24].browserTabID]===o[18]?"white":"")},m(t,s){w(t,e,s),y(e,n)},p(t,s){s&1310768&&_(e,"color",t[20]&&t[20][t[24].browserTabID]&&t[20][t[24].browserTabID]===t[18]?"white":"")},d(t){t&&g(e)}}}function Ge(o,e){let n,t,s=e[24].name+"",l,a,r=Object.keys(e[6]).length>0,i,m,f=r&&Ke(e);return{key:o,first:null,c(){n=C("div"),t=C("div"),l=q(s),a=M(),f&&f.c(),i=M(),this.h()},l(c){n=E(c,"DIV",{style:!0});var u=R(n);t=E(u,"DIV",{style:!0,class:!0});var d=R(t);l=F(d,s),d.forEach(g),a=V(u),f&&f.l(u),i=V(u),u.forEach(g),this.h()},h(){_(t,"font-size","0.7rem"),_(t,"margin-left","6px"),j(t,"class","svelte-d2j7h9"),fe(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),_(n,"display","flex"),_(n,"align-items","center"),this.first=n},m(c,u){w(c,n,u),y(n,t),y(t,l),y(n,a),f&&f.m(n,null),y(n,i),m=!0},p(c,u){e=c,(!m||u&48)&&s!==(s=e[24].name+"")&&ne(l,s),u&1310768&&fe(t,"speaking",e[20]&&e[20][e[24].browserTabID]&&e[20][e[24].browserTabID]===e[18]),u&64&&(r=Object.keys(e[6]).length>0),r?f?(f.p(e,u),u&64&&$(f,1)):(f=Ke(e),f.c(),$(f,1),f.m(n,i)):f&&(K(),I(f,1,1,()=>{f=null}),Q())},i(c){m||($(f),m=!0)},o(c){I(f),m=!1},d(c){c&&g(n),f&&f.d()}}}function Ze(o,e){let n,t,s,l,a,r,i,m;function f(D,k){if(D[21].name)return xt;if(D[21].name==="")return Xt}let c=f(e),u=c&&c(e),d=e[5][e[21].id]&&We(e);function p(){return e[10](e[21])}return{key:o,first:null,c(){n=C("div"),t=C("div"),u&&u.c(),s=M(),d&&d.c(),a=M(),this.h()},l(D){n=E(D,"DIV",{style:!0});var k=R(n);t=E(k,"DIV",{class:!0,style:!0});var B=R(t);u&&u.l(B),s=V(B),d&&d.l(B),B.forEach(g),a=V(k),k.forEach(g),this.h()},h(){j(t,"class",l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-d2j7h9")),_(t,"padding","6px 10px 6px 8px"),_(t,"opacity","90%"),_(t,"border-radius","5px"),_(n,"padding","6px"),this.first=n},m(D,k){w(D,n,k),y(n,t),u&&u.m(t,null),y(t,s),d&&d.m(t,null),y(n,a),r=!0,i||(m=ae(n,"click",p),i=!0)},p(D,k){e=D,c===(c=f(e))&&u?u.p(e,k):(u&&u.d(1),u=c&&c(e),u&&(u.c(),u.m(t,s))),e[5][e[21].id]?d?(d.p(e,k),k&48&&$(d,1)):(d=We(e),d.c(),$(d,1),d.m(t,null)):d&&(K(),I(d,1,1,()=>{d=null}),Q()),(!r||k&18&&l!==(l=""+(Se(e[21].id===e[1]?"selected":"")+" svelte-d2j7h9")))&&j(t,"class",l)},i(D){r||($(d),r=!0)},o(D){I(d),r=!1},d(D){D&&g(n),u&&u.d(),d&&d.d(),i=!1,m()}}}function os(o){let e=[],n=new Map,t,s,l,a,r,i,m,f,c=o[4];const u=d=>d[21].id+d[1];for(let d=0;d<c.length;d+=1){let p=He(o,c,d),D=u(p);n.set(D,e[d]=Ze(D,p))}return{c(){for(let d=0;d<e.length;d+=1)e[d].c();t=M(),s=C("div"),l=C("span"),a=q("add"),r=q(`\r
      new room`),this.h()},l(d){for(let k=0;k<e.length;k+=1)e[k].l(d);t=V(d),s=E(d,"DIV",{style:!0});var p=R(s);l=E(p,"SPAN",{class:!0,style:!0});var D=R(l);a=F(D,"add"),D.forEach(g),r=F(p,`\r
      new room`),p.forEach(g),this.h()},h(){j(l,"class","material-icons"),_(l,"margin-left","6px"),_(l,"margin-right","5px"),_(l,"margin-top","2.5px"),_(l,"font-size","1.2rem"),_(s,"padding","6px"),_(s,"display","flex"),_(s,"align-items","center")},m(d,p){for(let D=0;D<e.length;D+=1)e[D].m(d,p);w(d,t,p),w(d,s,p),y(s,l),y(l,a),y(s,r),i=!0,m||(f=ae(s,"click",o[8]),m=!0)},p(d,p){p&1835251&&(c=d[4],K(),e=je(e,p,u,1,d,c,n,t.parentNode,Me,Ze,t,He),Q())},i(d){if(!i){for(let p=0;p<c.length;p+=1)$(e[p]);i=!0}},o(d){for(let p=0;p<e.length;p+=1)I(e[p]);i=!1},d(d){for(let p=0;p<e.length;p+=1)e[p].d(d);d&&g(t),d&&g(s),m=!1,f()}}}function ls(o){let e,n;return e=new Ft({props:{nameOfClass:o[2],descriptionOfClass:o[3],$$slots:{default:[os]},$$scope:{ctx:o}}}),{c(){A(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,s){z(e,t,s),n=!0},p(t,s){const l={};s&4&&(l.nameOfClass=t[2]),s&8&&(l.descriptionOfClass=t[3]),s&1837299&&(l.$$scope={dirty:s,ctx:t}),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){I(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function as(o){let e,n,t,s,l,a,r;e=new Ht({props:{classID:o[0],roomID:o[1]}}),l=new Zt({props:{roomID:o[1],$$slots:{default:[ls,({activeSpeakerID:f,toggleMic:c,firestoreIDToDailyID:u})=>({18:f,19:c,20:u}),({activeSpeakerID:f,toggleMic:c,firestoreIDToDailyID:u})=>(f?262144:0)|(c?524288:0)|(u?1048576:0)]},$$scope:{ctx:o}}});const i=o[9].default,m=de(i,o,o[11],null);return{c(){A(e.$$.fragment),n=M(),t=C("div"),s=M(),A(l.$$.fragment),a=M(),m&&m.c(),this.h()},l(f){P(e.$$.fragment,f),n=V(f),t=E(f,"DIV",{id:!0});var c=R(t);c.forEach(g),s=V(f),P(l.$$.fragment,f),a=V(f),m&&m.l(f),this.h()},h(){j(t,"id","container-for-audio-elements")},m(f,c){z(e,f,c),w(f,n,c),w(f,t,c),w(f,s,c),z(l,f,c),w(f,a,c),m&&m.m(f,c),r=!0},p(f,[c]){const u={};c&1&&(u.classID=f[0]),c&2&&(u.roomID=f[1]),e.$set(u);const d={};c&2&&(d.roomID=f[1]),c&1837311&&(d.$$scope={dirty:c,ctx:f}),l.$set(d),m&&m.p&&(!r||c&2048)&&me(m,i,f,f[11],r?pe(i,f[11],c,null):_e(f[11]),null)},i(f){r||($(e.$$.fragment,f),$(l.$$.fragment,f),$(m,f),r=!0)},o(f){I(e.$$.fragment,f),I(l.$$.fragment,f),I(m,f),r=!1},d(f){L(e,f),f&&g(n),f&&g(t),f&&g(s),L(l,f),f&&g(a),m&&m.d(f)}}}function ms({page:o}){return{props:{classID:o.params.class,roomID:o.params.room}}}function rs(o,e,n){let t,s,l;J(o,Z,v=>n(5,t=v)),J(o,oe,v=>n(6,s=v)),J(o,ve,v=>n(7,l=v));let{$$slots:a={},$$scope:r}=e,{classID:i}=e,{roomID:m}=e,f="",c="",u=[];he(()=>{for(const v of k)v();window.removeEventListener("resize",D)}),re(async()=>{console.log("__layout mounted, but should only be done once"),window.addEventListener("resize",D),D();const v=X(W(),`classes/${i}`),b=await $t(v);n(2,f=b.data().name),n(3,c=b.data().description)});async function d(){for(const N of u)if(N.name===""){alert("There is still an empty room available");return}const v=Ae(),b=`classes/${i}/`,T=X(W(),b+`rooms/${v}`),S=X(W(),b+`blackboards/${v}`);await Promise.all([ge(T,{name:"",blackboards:[v],date:new Date().toISOString()}),ge(S,{})])}function p(){const{height:v,width:b}=Et();kt.set(v),Ct.set(b)}function D(){setTimeout(p,100)}let k=[];const B=ue(W(),`classes/${i}/participants`),Y=ue(W(),`classes/${i}/rooms`),h=bt(Y,vt("date","asc"));k.push(Re(h,v=>{const b=[];v.forEach(T=>{b.push(ce({id:T.id,ref:T.ref.path},T.data()))}),n(4,u=b)})),k.push(Re(B,v=>{v.docChanges().forEach(b=>{const T=b.doc.data(),S=T.currentRoomID;switch(b.type){case"added":t[S]||x(Z,t[S]=[],t),x(Z,t[S]=[...t[S],T],t);break;case"modified":for(const N of Object.keys(t))for(const U of t[N])U.browserTabID===T.browserTabID&&x(Z,t[N]=t[N].filter(G=>G.browserTabID!==T.browserTabID),t);t[S]||x(Z,t[S]=[],t),x(Z,t[S]=[...t[S],T],t);break;case"removed":x(Z,t[S]=t[S].filter(N=>N.browserTabID!==T.browserTabID),t);break}})}));const O=v=>be(`/${i}/${v.id}`);return o.$$set=v=>{"classID"in v&&n(0,i=v.classID),"roomID"in v&&n(1,m=v.roomID),"$$scope"in v&&n(11,r=v.$$scope)},[i,m,f,c,u,t,s,l,d,a,O,r]}class _s extends ee{constructor(e){super();te(this,e,rs,as,se,{classID:0,roomID:1})}}export{_s as default,ms as load};
