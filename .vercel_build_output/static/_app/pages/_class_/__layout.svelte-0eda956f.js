var Xe=Object.defineProperty;var ye=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var Ce=(o,e,s)=>e in o?Xe(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,de=(o,e)=>{for(var s in e||(e={}))xe.call(e,s)&&Ce(o,s,e[s]);if(ye)for(var s of ye(e))et.call(e,s)&&Ce(o,s,e[s]);return o};import{S as te,i as se,s as ee,a9 as tt,aa as st,a2 as ae,ab as Ee,e as y,t as q,k as M,j as P,c as C,a as O,g as F,d as b,n as A,m as z,L as h,f as w,M as I,o as L,Z as ie,h as ne,ac as Oe,x as v,u as $,v as U,E as K,A as ce,a4 as _e,P as G,a7 as nt,O as X,_ as fe,ad as Te,r as Q,w as Y,ae as ot,V as lt,l as J,af as rt,ag as at,ah as it,ai as ct,aj as ft,b as j,ak as ut,U as mt,H as pe,I as he,J as ge,K as be,W as ve,al as dt,am as Re,an as Se,ao as _t,ap as pt,R as De,aq as ht,ar as x,N as oe,Q as gt,a3 as je,a5 as bt,a6 as vt,as as Ve,at as Me,au as Ae,av as ue,aw as Dt,ax as $t,ay as It,az as wt}from"../../chunks/vendor-da8027ad.js";import{u as Ne,g as $e,b as Ie,i as we,r as Z,d as Pe,e as le,f as ze,a as kt,c as yt}from"../../chunks/navigation-d0de6f35.js";import{b as Ct}from"../../chunks/canvas-74f91cf9.js";import"../../chunks/singletons-12a22614.js";function Le(o,e,s){const t=o.slice();return t[18]=e[s],t}function Et(o){let e;return{c(){e=q("arrow_drop_down")},l(s){e=F(s,"arrow_drop_down")},m(s,t){w(s,e,t)},d(s){s&&b(e)}}}function Ue(o){let e,s,t=o[7].enrolledClasses,n=[];for(let r=0;r<t.length;r+=1)n[r]=Fe(Le(o,t,r));const l=r=>$(n[r],1,1,()=>{n[r]=null});return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=J()},l(r){for(let i=0;i<n.length;i+=1)n[i].l(r);e=J()},m(r,i){for(let a=0;a<n.length;a+=1)n[a].m(r,i);w(r,e,i),s=!0},p(r,i){if(i&385){t=r[7].enrolledClasses;let a;for(a=0;a<t.length;a+=1){const d=Le(r,t,a);n[a]?(n[a].p(d,i),v(n[a],1)):(n[a]=Fe(d),n[a].c(),v(n[a],1),n[a].m(e.parentNode,e))}for(Q(),a=t.length;a<n.length;a+=1)l(a);Y()}},i(r){if(!s){for(let i=0;i<t.length;i+=1)v(n[i]);s=!0}},o(r){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)$(n[i]);s=!1},d(r){rt(n,r),r&&b(e)}}}function qe(o){let e,s;function t(){return o[10](o[18])}return e=new it({props:{$$slots:{default:[Ot]},$$scope:{ctx:o}}}),e.$on("SMUI:action",t),{c(){P(e.$$.fragment)},l(n){z(e.$$.fragment,n)},m(n,l){L(e,n,l),s=!0},p(n,l){o=n;const r={};l&2097280&&(r.$$scope={dirty:l,ctx:o}),e.$set(r)},i(n){s||(v(e.$$.fragment,n),s=!0)},o(n){$(e.$$.fragment,n),s=!1},d(n){U(e,n)}}}function Ot(o){let e=o[18].name+"",s,t;return{c(){s=q(e),t=M()},l(n){s=F(n,e),t=A(n)},m(n,l){w(n,s,l),w(n,t,l)},p(n,l){l&128&&e!==(e=n[18].name+"")&&ne(s,e)},d(n){n&&b(s),n&&b(t)}}}function Fe(o){let e,s,t=o[18].name!==o[0]&&qe(o);return{c(){t&&t.c(),e=J()},l(n){t&&t.l(n),e=J()},m(n,l){t&&t.m(n,l),w(n,e,l),s=!0},p(n,l){n[18].name!==n[0]?t?(t.p(n,l),l&129&&v(t,1)):(t=qe(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(Q(),$(t,1,1,()=>{t=null}),Y())},i(n){s||(v(t),s=!0)},o(n){$(t),s=!1},d(n){t&&t.d(n),n&&b(e)}}}function Tt(o){let e,s,t=o[7].enrolledClasses&&Ue(o);return{c(){t&&t.c(),e=J()},l(n){t&&t.l(n),e=J()},m(n,l){t&&t.m(n,l),w(n,e,l),s=!0},p(n,l){n[7].enrolledClasses?t?(t.p(n,l),l&128&&v(t,1)):(t=Ue(n),t.c(),v(t,1),t.m(e.parentNode,e)):t&&(Q(),$(t,1,1,()=>{t=null}),Y())},i(n){s||(v(t),s=!0)},o(n){$(t),s=!1},d(n){t&&t.d(n),n&&b(e)}}}function Be(o){let e,s,t;function n(r){o[11](r)}let l={options:o[6],getOptionLabel:jt,textfield$variant:"outlined",label:"Search class"};return o[3]!==void 0&&(l.value=o[3]),e=new at({props:l}),ae.push(()=>Ee(e,"value",n)),{c(){P(e.$$.fragment)},l(r){z(e.$$.fragment,r)},m(r,i){L(e,r,i),t=!0},p(r,i){const a={};i&64&&(a.options=r[6]),!s&&i&8&&(s=!0,a.value=r[3],Oe(()=>s=!1)),e.$set(a)},i(r){t||(v(e.$$.fragment,r),t=!0)},o(r){$(e.$$.fragment,r),t=!1},d(r){U(e,r)}}}function Rt(o){let e,s,t,n;e=new Te({props:{$$slots:{default:[Tt]},$$scope:{ctx:o}}});let l=o[2].length>0&&Be(o);return{c(){P(e.$$.fragment),s=M(),t=y("div"),l&&l.c(),this.h()},l(r){z(e.$$.fragment,r),s=A(r),t=C(r,"DIV",{style:!0});var i=O(t);l&&l.l(i),i.forEach(b),this.h()},h(){h(t,"margin","4px")},m(r,i){L(e,r,i),w(r,s,i),w(r,t,i),l&&l.m(t,null),n=!0},p(r,i){const a={};i&2097281&&(a.$$scope={dirty:i,ctx:r}),e.$set(a),r[2].length>0?l?(l.p(r,i),i&4&&v(l,1)):(l=Be(r),l.c(),v(l,1),l.m(t,null)):l&&(Q(),$(l,1,1,()=>{l=null}),Y())},i(r){n||(v(e.$$.fragment,r),v(l),n=!0)},o(r){$(e.$$.fragment,r),$(l),n=!1},d(r){U(e,r),r&&b(s),r&&b(t),l&&l.d()}}}function St(o){let e,s,t,n,l,r,i,a,d,m,c,f,u,p,D,T;m=new tt({props:{class:"material-icons",$$slots:{default:[Et]},$$scope:{ctx:o}}});function B(g){o[13](g)}let W={anchor:!1,anchorCorner:"BOTTOM_LEFT",style:"left: 70px; top: 65px; width: 220px; overflow: visible;",$$slots:{default:[Rt]},$$scope:{ctx:o}};return o[4]!==void 0&&(W.anchorElement=o[4]),f=new st({props:W}),o[12](f),ae.push(()=>Ee(f,"anchorElement",B)),{c(){e=y("div"),s=y("div"),t=y("div"),n=y("h1"),l=q(o[0]),r=M(),i=y("div"),a=q(o[1]),d=M(),P(m.$$.fragment),c=M(),P(f.$$.fragment),this.h()},l(g){e=C(g,"DIV",{});var E=O(e);s=C(E,"DIV",{style:!0});var V=O(s);t=C(V,"DIV",{});var _=O(t);n=C(_,"H1",{style:!0});var R=O(n);l=F(R,o[0]),R.forEach(b),r=A(_),i=C(_,"DIV",{style:!0});var N=O(i);a=F(N,o[1]),N.forEach(b),_.forEach(b),d=A(V),z(m.$$.fragment,V),V.forEach(b),c=A(E),z(f.$$.fragment,E),E.forEach(b),this.h()},h(){h(n,"font-family","Roboto, sans-serif"),h(n,"font-weight","400"),h(n,"margin-left","6px"),h(n,"margin-top","5px"),h(n,"margin-bottom","0px"),h(n,"font-size","2.0rem"),h(i,"font-family","Roboto,sans-serif"),h(i,"font-size","0.875rem"),h(i,"color","rgba(0,0,0,.6)"),h(i,"margin-left","8px"),h(i,"margin-bottom","12px"),h(s,"display","flex"),h(s,"align-items","center")},m(g,E){w(g,e,E),I(e,s),I(s,t),I(t,n),I(n,l),I(t,r),I(t,i),I(i,a),I(s,d),L(m,s,null),I(e,c),L(f,e,null),o[14](e),p=!0,D||(T=ie(s,"click",o[9]),D=!0)},p(g,[E]){(!p||E&1)&&ne(l,g[0]),(!p||E&2)&&ne(a,g[1]);const V={};E&2097152&&(V.$$scope={dirty:E,ctx:g}),m.$set(V);const _={};E&2097357&&(_.$$scope={dirty:E,ctx:g}),!u&&E&16&&(u=!0,_.anchorElement=g[4],Oe(()=>u=!1)),f.$set(_)},i(g){p||(v(m.$$.fragment,g),v(f.$$.fragment,g),p=!0)},o(g){$(m.$$.fragment,g),$(f.$$.fragment,g),p=!1},d(g){g&&b(e),U(m),o[12](null),U(f),o[14](null),D=!1,T()}}}const jt=o=>o?`${o.name} (${o.description})`:"";function Vt(o,e,s){let t,n;K(o,Ne,g=>s(7,n=g));let{nameOfClass:l}=e,{descriptionOfClass:r}=e,i,a=[],d="",m;ce(async()=>{const g=_e(G(),"/classes"),E=await nt(g),V=[];E.forEach(_=>{V.push(de({id:_.id},_.data()))}),s(2,a=[...V])});async function c({mitClass:g}){console.log("join mitClass =",g);for(const V of n.enrolledClasses)if(V.id===g.id){alert(`You are already in ${g.name}`);return}const E=G();fe(X(E,`users/${n.uid}`),{enrolledClasses:ot(g),mostRecentClassID:g.id}),fe(X(E,`classes/${g.id}`),{numOfMembers:lt(1)}),$e(`/${g.id}/${g.id}`)}async function f(g){const E=G(),V=X(E,`users/${n.uid}`);fe(V,{mostRecentClassID:g.id}),$e(`/${g.id}/${g.id}`)}const u=()=>m.setOpen(!0),p=g=>f(g);function D(g){d=g,s(3,d)}function T(g){ae[g?"unshift":"push"](()=>{m=g,s(5,m)})}function B(g){i=g,s(4,i)}function W(g){ae[g?"unshift":"push"](()=>{i=g,s(4,i)})}return o.$$set=g=>{"nameOfClass"in g&&s(0,l=g.nameOfClass),"descriptionOfClass"in g&&s(1,r=g.descriptionOfClass)},o.$$.update=()=>{o.$$.dirty&8&&d&&(console.log("selected option =",d),c({mitClass:d})),o.$$.dirty&4&&s(6,t=a.filter(g=>["8.01","6.036"].includes(g.name)))},[l,r,a,d,i,m,t,n,f,u,p,D,T,B,W]}class Mt extends te{constructor(e){super();se(this,e,Vt,St,ee,{nameOfClass:0,descriptionOfClass:1})}}function At(o){let e;const s=o[2].default,t=pe(s,o,o[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,l){t&&t.m(n,l),e=!0},p(n,l){t&&t.p&&(!e||l&8)&&he(t,s,n,n[3],e?be(s,n[3],l,null):ge(n[3]),null)},i(n){e||(v(t,n),e=!0)},o(n){$(t,n),e=!1},d(n){t&&t.d(n)}}}function Nt(o){let e,s,t,n,l,r,i,a,d,m;return i=new Mt({props:{nameOfClass:o[0],descriptionOfClass:o[1]}}),d=new Te({props:{$$slots:{default:[At]},$$scope:{ctx:o}}}),{c(){e=y("div"),s=y("div"),t=y("img"),l=M(),r=y("div"),P(i.$$.fragment),a=M(),P(d.$$.fragment),this.h()},l(c){e=C(c,"DIV",{style:!0,class:!0});var f=O(e);s=C(f,"DIV",{style:!0,class:!0});var u=O(s);t=C(u,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),l=A(u),r=C(u,"DIV",{class:!0});var p=O(r);z(i.$$.fragment,p),p.forEach(b),u.forEach(b),f.forEach(b),a=A(c),z(d.$$.fragment,c),this.h()},h(){mt(t.src,n="/logo.png")||j(t,"src",n),j(t,"width","60"),j(t,"height","54"),j(t,"alt","web-logo"),j(t,"class","svelte-f4hgt4"),j(r,"class","svelte-f4hgt4"),h(s,"display","flex"),h(s,"align-items","center"),j(s,"class","svelte-f4hgt4"),h(e,"margin-bottom","12px"),h(e,"padding-top","2px"),h(e,"padding-bottom","0"),h(e,"padding-left","8px"),j(e,"class","mdc-elevation--z"+4+" svelte-f4hgt4")},m(c,f){w(c,e,f),I(e,s),I(s,t),I(s,l),I(s,r),L(i,r,null),w(c,a,f),L(d,c,f),m=!0},p(c,f){const u={};f&1&&(u.nameOfClass=c[0]),f&2&&(u.descriptionOfClass=c[1]),i.$set(u);const p={};f&8&&(p.$$scope={dirty:f,ctx:c}),d.$set(p)},i(c){m||(v(i.$$.fragment,c),v(d.$$.fragment,c),m=!0)},o(c){$(i.$$.fragment,c),$(d.$$.fragment,c),m=!1},d(c){c&&b(e),U(i),c&&b(a),U(d,c)}}}function Pt(o){let e,s;return e=new ut({props:{$$slots:{default:[Nt]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const l={};n&11&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function zt(o){let e;return{c(){e=y("main"),this.h()},l(s){e=C(s,"MAIN",{class:!0,id:!0,style:!0});var t=O(e);t.forEach(b),this.h()},h(){j(e,"class","main-content svelte-f4hgt4"),j(e,"id","main-content"),h(e,"padding","0")},m(s,t){w(s,e,t)},d(s){s&&b(e)}}}function Lt(o){let e,s,t,n,l;return s=new ct({props:{style:"overflow-y: scroll; height: 100%;",class:"mdc-elevation--z"+5,$$slots:{default:[Pt]},$$scope:{ctx:o}}}),n=new ft({props:{class:"app-content",$$slots:{default:[zt]},$$scope:{ctx:o}}}),{c(){e=y("div"),P(s.$$.fragment),t=M(),P(n.$$.fragment),this.h()},l(r){e=C(r,"DIV",{class:!0});var i=O(e);z(s.$$.fragment,i),t=A(i),z(n.$$.fragment,i),i.forEach(b),this.h()},h(){j(e,"class","drawer-container svelte-f4hgt4")},m(r,i){w(r,e,i),L(s,e,null),I(e,t),L(n,e,null),l=!0},p(r,[i]){const a={};i&11&&(a.$$scope={dirty:i,ctx:r}),s.$set(a);const d={};i&8&&(d.$$scope={dirty:i,ctx:r}),n.$set(d)},i(r){l||(v(s.$$.fragment,r),v(n.$$.fragment,r),l=!0)},o(r){$(s.$$.fragment,r),$(n.$$.fragment,r),l=!1},d(r){r&&b(e),U(s),U(n)}}}function Ut(o,e,s){let{$$slots:t={},$$scope:n}=e,{nameOfClass:l}=e,{descriptionOfClass:r}=e;return o.$$set=i=>{"nameOfClass"in i&&s(0,l=i.nameOfClass),"descriptionOfClass"in i&&s(1,r=i.descriptionOfClass),"$$scope"in i&&s(3,n=i.$$scope)},[l,r,t,n]}class qt extends te{constructor(e){super();se(this,e,Ut,Lt,ee,{nameOfClass:0,descriptionOfClass:1})}}function Ft(o,e,s){let t,n,l,r;K(o,Ie,p=>s(10,n=p)),K(o,Ne,p=>s(3,l=p)),K(o,we,p=>s(4,r=p));let{classID:i}=e,{roomID:a}=e,d,m,c,f,u;return ve(()=>{u&&u(),r&&(dt(m),we.set(!1)),f&&f.cancel()}),ce(()=>{Z.set({}),c=Re(Se(),".info/connected"),u=_t(c,async p=>{if(p.val()===!0){const D=Pe();d=Re(Se(),`/class/${i}/room/${a}/participants/${D}`),f=pt(d),f.set({hasDisconnected:!0,userUID:l.uid}),s(2,m=X(G(),`classes/${i}/participants/${D}`)),De(m,{uid:l.uid,browserTabID:n,currentRoomID:a,name:t}),we.set(!0)}})}),o.$$set=p=>{"classID"in p&&s(0,i=p.classID),"roomID"in p&&s(1,a=p.roomID)},o.$$.update=()=>{o.$$.dirty&8&&(t=l.name?l.name:"Beaver #"),o.$$.dirty&30&&r&&l.name&&fe(m,{currentRoomID:a,name:l.name})},[i,a,m,l,r]}class Bt extends te{constructor(e){super();se(this,e,Ft,null,ee,{classID:0,roomID:1})}}const Ht="0ac8a98cf9bef2827f5beef5cd36c4f42a442863ce904a2469de12caa9097fa1",Jt=o=>({activeSpeakerID:o&2,firestoreIDToDailyID:o&1}),He=o=>({toggleMic:o[2],activeSpeakerID:o[1],firestoreIDToDailyID:o[0]});function Wt(o){let e;const s=o[8].default,t=pe(s,o,o[7],He);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,l){t&&t.m(n,l),e=!0},p(n,[l]){t&&t.p&&(!e||l&131)&&he(t,s,n,n[7],e?be(s,n[7],l,Jt):ge(n[7]),He)},i(n){e||(v(t,n),e=!0)},o(n){$(t,n),e=!1},d(n){t&&t.d(n)}}}async function Kt({track:o,participant:e}){switch(o.kind){case"audio":if(e.local)return;{const s=document.createElement("audio");s.srcObject=new MediaStream([o]),s.setAttribute("id","audio"+e.user_id),s.setAttribute("playsinline",!0),s.setAttribute("autoplay",!0),document.getElementById("container-for-audio-elements").appendChild(s)}break}}async function Qt({track:o,participant:e}){const s=document.getElementById(o.id);s&&(s.srcObject=null,s.remove())}function Yt(o,e,s){let t,n,l;K(o,le,_=>s(10,t=_)),K(o,Ie,_=>s(11,n=_)),K(o,ze,_=>s(12,l=_));let{$$slots:r={},$$scope:i}=e,{roomID:a}=e,d,m,c,f,u,p="";ve(()=>{f==="connected"&&E()}),ce(async()=>{await D(),T()});async function D(){return new Promise(async(_,R)=>{if(!l)try{const k=await navigator.mediaDevices.getUserMedia({audio:!0});ze.set(k)}catch{return alert(`Don't forget to enable your your mic! Click the "aA" / "i" button beside the URL bar "https://explain.mit.edu", then click "website settings" / "microphone"`),R("Can't access mic stream")}const[N]=l.getAudioTracks();d=ht.createCallObject({audioSource:N,videoSource:!1});const S=["participant-joined","participant-updated","participant-left"];for(const k of S)d.on(k,()=>{le.set(d.participants());const H={};for(const me of Object.keys(t)){const re=t[me],ke=re.user_name;ke&&(H[ke]=re.user_id)}s(0,m=H)});d.on("track-started",Kt),d.on("track-stopped",Qt),d.on("active-speaker-change",({activeSpeaker:k})=>{s(1,p=k.peerId)}),d.on("load-attempt-failed",({action:k,errorMsg:H})=>{alert(k+": "+H)}),d.on("error",({action:k,errorMsg:H})=>{alert(k+": "+H)}),_()})}async function T(){s(4,c="not_connected"),s(5,f="connecting"),s(6,u=a);const{url:_}=await B();_&&(await W(_),s(4,c="connecting"),s(5,f="connected"))}function B(){return new Promise(async _=>{try{const R=2*60*60,S=await(await fetch("https://api.daily.co/v1/rooms",{method:"POST",headers:{"content-type":"application/json",Authorization:"Bearer "+Ht},body:JSON.stringify({name:a,properties:{exp:Math.round(Date.now()/1e3)+R,eject_at_room_exp:!0,start_video_off:!0}})})).json();S.error==="invalid-request-error"&&S.info===`a room named ${a} already exists`?_({url:`https://feynman.daily.co/${a}`}):_(S)}catch(R){console.error(R),alert(R),reject({url:""})}})}function W(_){return new Promise(async(R,N)=>{try{await d.join({url:_,userName:n}),R()}catch(S){console.log("error)"),alert(S),N()}})}function g(){d.setLocalAudio(!t.local.audio),le.set(d.participants())}function E(){const _=document.querySelectorAll("audio");for(const R of _)R.remove();V(),s(4,c="connected"),s(5,f="not_connected")}function V(){d.leave(),le.set({}),s(1,p="")}return o.$$set=_=>{"roomID"in _&&s(3,a=_.roomID),"$$scope"in _&&s(7,i=_.$$scope)},o.$$.update=()=>{o.$$.dirty&120&&u!==a&&f==="connected"&&c==="connecting"&&E(),o.$$.dirty&120&&u!==a&&f==="not_connected"&&c==="connected"&&T()},[m,p,g,a,c,f,u,i,r]}class Gt extends te{constructor(e){super();se(this,e,Yt,Wt,ee,{roomID:3})}}function Je(o,e,s){const t=o.slice();return t[22]=e[s],t}function We(o,e,s){const t=o.slice();return t[25]=e[s],t}function Ke(o){let e,s;return e=new Bt({props:{classID:o[0],roomID:o[1]}}),{c(){P(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const l={};n&1&&(l.classID=t[0]),n&2&&(l.roomID=t[1]),e.$set(l)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Zt(o){let e,s;return{c(){e=y("div"),s=q("(empty room)"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=F(n,"(empty room)"),n.forEach(b),this.h()},h(){h(e,"margin-bottom","2px")},m(t,n){w(t,e,n),I(e,s)},p:oe,d(t){t&&b(e)}}}function Xt(o){let e,s=o[22].name+"",t;return{c(){e=y("div"),t=q(s),this.h()},l(n){e=C(n,"DIV",{style:!0,class:!0});var l=O(e);t=F(l,s),l.forEach(b),this.h()},h(){h(e,"white-space","nowrap"),h(e,"overflow","hidden"),h(e,"text-overflow","ellipsis margin-bottom: 2px"),j(e,"class","svelte-d2j7h9"),ue(e,"question-item",o[22].name.charAt(o[22].name.length-1)==="?"&&o[22].id!==o[1])},m(n,l){w(n,e,l),I(e,t)},p(n,l){l&16&&s!==(s=n[22].name+"")&&ne(t,s),l&18&&ue(e,"question-item",n[22].name.charAt(n[22].name.length-1)==="?"&&n[22].id!==n[1])},d(n){n&&b(e)}}}function Qe(o){let e=[],s=new Map,t,n,l=o[5][o[22].id];const r=i=>i[25].browserTabID;for(let i=0;i<l.length;i+=1){let a=We(o,l,i),d=r(a);s.set(d,e[i]=Ge(d,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();t=J()},l(i){for(let a=0;a<e.length;a+=1)e[a].l(i);t=J()},m(i,a){for(let d=0;d<e.length;d+=1)e[d].m(i,a);w(i,t,a),n=!0},p(i,a){a&3670256&&(l=i[5][i[22].id],Q(),e=Me(e,a,r,1,i,l,s,t.parentNode,Ae,Ge,t,We),Y())},i(i){if(!n){for(let a=0;a<l.length;a+=1)v(e[a]);n=!0}},o(i){for(let a=0;a<e.length;a+=1)$(e[a]);n=!1},d(i){for(let a=0;a<e.length;a+=1)e[a].d(i);i&&b(t)}}}function Ye(o){let e,s,t,n;const l=[es,xt],r=[];function i(a,d){return a[25].browserTabID===a[7]?0:a[6][a[21][a[25].browserTabID]]?1:-1}return~(e=i(o))&&(s=r[e]=l[e](o)),{c(){s&&s.c(),t=J()},l(a){s&&s.l(a),t=J()},m(a,d){~e&&r[e].m(a,d),w(a,t,d),n=!0},p(a,d){let m=e;e=i(a),e===m?~e&&r[e].p(a,d):(s&&(Q(),$(r[m],1,1,()=>{r[m]=null}),Y()),~e?(s=r[e],s?s.p(a,d):(s=r[e]=l[e](a),s.c()),v(s,1),s.m(t.parentNode,t)):s=null)},i(a){n||(v(s),n=!0)},o(a){$(s),n=!1},d(a){~e&&r[e].d(a),a&&b(t)}}}function xt(o){let e;function s(l,r){return l[6][l[21][l[25].browserTabID]].audio?ss:ts}let t=s(o),n=t(o);return{c(){n.c(),e=J()},l(l){n.l(l),e=J()},m(l,r){n.m(l,r),w(l,e,r)},p(l,r){t===(t=s(l))&&n?n.p(l,r):(n.d(1),n=t(l),n&&(n.c(),n.m(e.parentNode,e)))},i:oe,o:oe,d(l){n.d(l),l&&b(e)}}}function es(o){let e,s,t,n,l,r,i;t=new Dt({props:{checked:o[6].local.audio,style:"margin: 0 !important"}});function a(c,f){return c[6].local.audio?os:ns}let d=a(o),m=d(o);return{c(){e=y("div"),s=y("div"),P(t.$$.fragment),n=M(),m.c(),this.h()},l(c){e=C(c,"DIV",{style:!0});var f=O(e);s=C(f,"DIV",{style:!0});var u=O(s);z(t.$$.fragment,u),u.forEach(b),n=A(f),m.l(f),f.forEach(b),this.h()},h(){h(s,"margin-right","0"),h(s,"margin-left","auto"),h(s,"padding-top","5px"),h(e,"display","flex"),h(e,"align-items","center"),h(e,"margin-right","0"),h(e,"margin-left","auto")},m(c,f){w(c,e,f),I(e,s),L(t,s,null),I(e,n),m.m(e,null),l=!0,r||(i=ie(s,"click",$t(It(function(){wt(o[20])&&o[20].apply(this,arguments)}))),r=!0)},p(c,f){o=c;const u={};f&64&&(u.checked=o[6].local.audio),t.$set(u),d!==(d=a(o))&&(m.d(1),m=d(o),m&&(m.c(),m.m(e,null)))},i(c){l||(v(t.$$.fragment,c),l=!0)},o(c){$(t.$$.fragment,c),l=!1},d(c){c&&b(e),U(t),m.d(),r=!1,i()}}}function ts(o){let e,s;return{c(){e=y("span"),s=q("mic_off"),this.h()},l(t){e=C(t,"SPAN",{class:!0,style:!0});var n=O(e);s=F(n,"mic_off"),n.forEach(b),this.h()},h(){j(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.1rem"),h(e,"color","red")},m(t,n){w(t,e,n),I(e,s)},p:oe,d(t){t&&b(e)}}}function ss(o){let e,s;return{c(){e=y("span"),s=q("mic"),this.h()},l(t){e=C(t,"SPAN",{class:!0,style:!0});var n=O(e);s=F(n,"mic"),n.forEach(b),this.h()},h(){j(e,"class","material-icons"),h(e,"margin-right","0"),h(e,"margin-left","auto"),h(e,"font-size","1.1rem"),h(e,"color",o[21]&&o[21][o[25].browserTabID]&&o[21][o[25].browserTabID]===o[19]?"white":"")},m(t,n){w(t,e,n),I(e,s)},p(t,n){n&2621488&&h(e,"color",t[21]&&t[21][t[25].browserTabID]&&t[21][t[25].browserTabID]===t[19]?"white":"")},d(t){t&&b(e)}}}function ns(o){let e,s;return{c(){e=y("div"),s=q("muted"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=F(n,"muted"),n.forEach(b),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","red")},m(t,n){w(t,e,n),I(e,s)},d(t){t&&b(e)}}}function os(o){let e,s;return{c(){e=y("div"),s=q("voice on"),this.h()},l(t){e=C(t,"DIV",{style:!0});var n=O(e);s=F(n,"voice on"),n.forEach(b),this.h()},h(){h(e,"font-size","0.7rem"),h(e,"margin-left","6px"),h(e,"color","#33ff33")},m(t,n){w(t,e,n),I(e,s)},d(t){t&&b(e)}}}function Ge(o,e){let s,t,n=e[25].name+"",l,r,i=Object.keys(e[6]).length>0,a,d,m=i&&Ye(e);return{key:o,first:null,c(){s=y("div"),t=y("div"),l=q(n),r=M(),m&&m.c(),a=M(),this.h()},l(c){s=C(c,"DIV",{style:!0});var f=O(s);t=C(f,"DIV",{style:!0,class:!0});var u=O(t);l=F(u,n),u.forEach(b),r=A(f),m&&m.l(f),a=A(f),f.forEach(b),this.h()},h(){h(t,"font-size","0.7rem"),h(t,"margin-left","6px"),j(t,"class","svelte-d2j7h9"),ue(t,"speaking",e[21]&&e[21][e[25].browserTabID]&&e[21][e[25].browserTabID]===e[19]),h(s,"display","flex"),h(s,"align-items","center"),this.first=s},m(c,f){w(c,s,f),I(s,t),I(t,l),I(s,r),m&&m.m(s,null),I(s,a),d=!0},p(c,f){e=c,(!d||f&48)&&n!==(n=e[25].name+"")&&ne(l,n),f&2621488&&ue(t,"speaking",e[21]&&e[21][e[25].browserTabID]&&e[21][e[25].browserTabID]===e[19]),f&64&&(i=Object.keys(e[6]).length>0),i?m?(m.p(e,f),f&64&&v(m,1)):(m=Ye(e),m.c(),v(m,1),m.m(s,a)):m&&(Q(),$(m,1,1,()=>{m=null}),Y())},i(c){d||(v(m),d=!0)},o(c){$(m),d=!1},d(c){c&&b(s),m&&m.d()}}}function Ze(o,e){let s,t,n,l,r,i,a,d;function m(D,T){if(D[22].name)return Xt;if(D[22].name==="")return Zt}let c=m(e),f=c&&c(e),u=e[5][e[22].id]&&Qe(e);function p(){return e[10](e[22])}return{key:o,first:null,c(){s=y("div"),t=y("div"),f&&f.c(),n=M(),u&&u.c(),r=M(),this.h()},l(D){s=C(D,"DIV",{style:!0});var T=O(s);t=C(T,"DIV",{class:!0,style:!0});var B=O(t);f&&f.l(B),n=A(B),u&&u.l(B),B.forEach(b),r=A(T),T.forEach(b),this.h()},h(){j(t,"class",l=""+(Ve(e[22].id===e[1]?"selected":"")+" svelte-d2j7h9")),h(t,"padding","6px 10px 6px 8px"),h(t,"opacity","90%"),h(t,"border-radius","5px"),h(s,"padding","6px"),this.first=s},m(D,T){w(D,s,T),I(s,t),f&&f.m(t,null),I(t,n),u&&u.m(t,null),I(s,r),i=!0,a||(d=ie(s,"click",p),a=!0)},p(D,T){e=D,c===(c=m(e))&&f?f.p(e,T):(f&&f.d(1),f=c&&c(e),f&&(f.c(),f.m(t,n))),e[5][e[22].id]?u?(u.p(e,T),T&48&&v(u,1)):(u=Qe(e),u.c(),v(u,1),u.m(t,null)):u&&(Q(),$(u,1,1,()=>{u=null}),Y()),(!i||T&18&&l!==(l=""+(Ve(e[22].id===e[1]?"selected":"")+" svelte-d2j7h9")))&&j(t,"class",l)},i(D){i||(v(u),i=!0)},o(D){$(u),i=!1},d(D){D&&b(s),f&&f.d(),u&&u.d(),a=!1,d()}}}function ls(o){let e=[],s=new Map,t,n,l,r,i,a,d,m,c=o[4];const f=u=>u[22].id+u[1];for(let u=0;u<c.length;u+=1){let p=Je(o,c,u),D=f(p);s.set(D,e[u]=Ze(D,p))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();t=M(),n=y("div"),l=y("span"),r=q("add"),i=q(`\r
      new room`),this.h()},l(u){for(let T=0;T<e.length;T+=1)e[T].l(u);t=A(u),n=C(u,"DIV",{style:!0});var p=O(n);l=C(p,"SPAN",{class:!0,style:!0});var D=O(l);r=F(D,"add"),D.forEach(b),i=F(p,`\r
      new room`),p.forEach(b),this.h()},h(){j(l,"class","material-icons"),h(l,"margin-left","6px"),h(l,"margin-right","5px"),h(l,"margin-top","2.5px"),h(l,"font-size","1.2rem"),h(n,"padding","6px"),h(n,"display","flex"),h(n,"align-items","center")},m(u,p){for(let D=0;D<e.length;D+=1)e[D].m(u,p);w(u,t,p),w(u,n,p),I(n,l),I(l,r),I(n,i),a=!0,d||(m=ie(n,"click",o[8]),d=!0)},p(u,p){p&3670259&&(c=u[4],Q(),e=Me(e,p,f,1,u,c,s,t.parentNode,Ae,Ze,t,Je),Y())},i(u){if(!a){for(let p=0;p<c.length;p+=1)v(e[p]);a=!0}},o(u){for(let p=0;p<e.length;p+=1)$(e[p]);a=!1},d(u){for(let p=0;p<e.length;p+=1)e[p].d(u);u&&b(t),u&&b(n),d=!1,m()}}}function rs(o){let e,s;return e=new qt({props:{nameOfClass:o[2],descriptionOfClass:o[3],$$slots:{default:[ls]},$$scope:{ctx:o}}}),{c(){P(e.$$.fragment)},l(t){z(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const l={};n&4&&(l.nameOfClass=t[2]),n&8&&(l.descriptionOfClass=t[3]),n&3672307&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){s||(v(e.$$.fragment,t),s=!0)},o(t){$(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function as(o){let e=o[0],s,t,n,l,r,i,a=Ke(o);l=new Gt({props:{roomID:o[1],$$slots:{default:[rs,({activeSpeakerID:c,toggleMic:f,firestoreIDToDailyID:u})=>({19:c,20:f,21:u}),({activeSpeakerID:c,toggleMic:f,firestoreIDToDailyID:u})=>(c?524288:0)|(f?1048576:0)|(u?2097152:0)]},$$scope:{ctx:o}}});const d=o[9].default,m=pe(d,o,o[11],null);return{c(){a.c(),s=M(),t=y("div"),n=M(),P(l.$$.fragment),r=M(),m&&m.c(),this.h()},l(c){a.l(c),s=A(c),t=C(c,"DIV",{id:!0});var f=O(t);f.forEach(b),n=A(c),z(l.$$.fragment,c),r=A(c),m&&m.l(c),this.h()},h(){j(t,"id","container-for-audio-elements")},m(c,f){a.m(c,f),w(c,s,f),w(c,t,f),w(c,n,f),L(l,c,f),w(c,r,f),m&&m.m(c,f),i=!0},p(c,[f]){f&1&&ee(e,e=c[0])?(Q(),$(a,1,1,oe),Y(),a=Ke(c),a.c(),v(a),a.m(s.parentNode,s)):a.p(c,f);const u={};f&2&&(u.roomID=c[1]),f&3672319&&(u.$$scope={dirty:f,ctx:c}),l.$set(u),m&&m.p&&(!i||f&2048)&&he(m,d,c,c[11],i?be(d,c[11],f,null):ge(c[11]),null)},i(c){i||(v(a),v(l.$$.fragment,c),v(m,c),i=!0)},o(c){$(a),$(l.$$.fragment,c),$(m,c),i=!1},d(c){a.d(c),c&&b(s),c&&b(t),c&&b(n),U(l,c),c&&b(r),m&&m.d(c)}}}function _s({page:o}){return{props:{classID:o.params.class,roomID:o.params.room}}}function is(o,e,s){let t,n,l;K(o,Z,_=>s(5,t=_)),K(o,le,_=>s(6,n=_)),K(o,Ie,_=>s(7,l=_));let{$$slots:r={},$$scope:i}=e,{classID:a}=e,{roomID:d}=e,m=[],c="",f="",u=[];function p(){for(const _ of m)_();m=[]}async function D(){const _=X(G(),`classes/${a}`),R=await gt(_);s(2,c=R.data().name),s(3,f=R.data().description)}ce(async()=>{window.addEventListener("resize",W),W()}),ve(()=>{p(),window.removeEventListener("resize",W)});async function T(){for(const k of u)if(k.name===""){alert("There is still an empty room available");return}const _=Pe(),R=`classes/${a}/`,N=X(G(),R+`rooms/${_}`),S=X(G(),R+`blackboards/${_}`);await Promise.all([De(N,{name:"",blackboards:[_],date:new Date().toISOString()}),De(S,{})])}function B(){const{height:_,width:R}=Ct();kt.set(_),yt.set(R)}function W(){setTimeout(B,100)}function g(){const _=_e(G(),`classes/${a}/participants`);m.push(je(_,R=>{R.docChanges().forEach(N=>{const S=N.doc.data(),k=S.currentRoomID;switch(N.type){case"added":t[k]||x(Z,t[k]=[],t),x(Z,t[k]=[...t[k],S],t);break;case"modified":for(const H of Object.keys(t))for(const me of t[H])me.browserTabID===S.browserTabID&&x(Z,t[H]=t[H].filter(re=>re.browserTabID!==S.browserTabID),t);t[k]||x(Z,t[k]=[],t),x(Z,t[k]=[...t[k],S],t);break;case"removed":x(Z,t[k]=t[k].filter(H=>H.browserTabID!==S.browserTabID),t);break}})}))}function E(){const _=_e(G(),`classes/${a}/rooms`),R=bt(_,vt("date","asc"));m.push(je(R,N=>{const S=[];N.forEach(k=>{S.push(de({id:k.id,ref:k.ref.path},k.data()))}),s(4,u=S)}))}const V=_=>$e(`/${a}/${_.id}`);return o.$$set=_=>{"classID"in _&&s(0,a=_.classID),"roomID"in _&&s(1,d=_.roomID),"$$scope"in _&&s(11,i=_.$$scope)},o.$$.update=()=>{o.$$.dirty&1&&a&&(p(),x(Z,t=[],t),D(),g(),E())},[a,d,c,f,u,t,n,l,T,r,V,i]}class ps extends te{constructor(e){super();se(this,e,is,as,ee,{classID:0,roomID:1})}}export{ps as default,_s as load};
