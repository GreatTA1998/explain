import{S as E,i as N,s as F,e as I,c as M,a as W,d as m,f as X,E as Y,a7 as f,ae as z,a0 as y,a8 as B,A as D,a2 as P}from"../../chunks/vendor-0c80fc2b.js";import{r as j,c as O}from"../../chunks/canvasHelpers-a780b7c6.js";const R=function(){const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let s=0;s<20;s++)e+=o.charAt(Math.floor(Math.random()*o.length));return e};function q(o){let e,s,l,n;return{c(){e=I("canvas")},l(r){e=M(r,"CANVAS",{});var a=W(e);a.forEach(m)},m(r,a){X(r,e,a),o[5](e),l||(n=[Y(s=j.call(null,e,{strokesArray:o[0]})),f(e,"touchstart",o[2]),f(e,"touchmove",o[3]),f(e,"touchend",o[4])],l=!0)},p(r,[a]){s&&z(s.update)&&a&1&&s.update.call(null,{strokesArray:r[0]})},i:y,o:y,d(r){r&&m(e),o[5](null),l=!1,B(n)}}}let k=0,_=!1;function H(o,e,s){let{strokesArray:l}=e,n,r,a=!1,c={x:-1,y:-1},h={points:[]},u={type:"PEN",color:"white",lineWidth:2};D(()=>{r=n.getContext("2d")});function b(t){t.touches.length>1||(t.touches[0].touchType,p(t,{isInitialContact:!0}))}function v(t){if(!!a){if(t.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}t.touches[0].touchType,p(t,{isInitialContact:!1})}}function A(t){!a||t.touches.length>0||(t.changedTouches[0].touchType,C(h),a=!1)}function T(t){a=!0,c={x:-1,y:-1},h={strokeNumber:l.length+1,startTime:Number(k.toFixed(1)),color:u.color,lineWidth:u.lineWidth,isErasing:_,points:[],sessionID:"123"}}function p(t,{isInitialContact:i}){t.preventDefault(),i&&T();const d=x(t);w(t,d)}function w(t,i){h.points.push({unitX:parseFloat(i.x/n.width).toFixed(4),unitY:parseFloat(i.y/n.height).toFixed(4)}),c.x!==-1&&c.y!==-1&&O([g(c),g(i)],1,_,r,u.color,u.lineWidth,n),c=i}function C(t){t.endTime=Number(k.toFixed(1)),t.id=R()}function x(t){const{left:i,top:d}=n.getBoundingClientRect();return{x:t.touches[0].pageX-i-window.scrollX,y:t.touches[0].pageY-d-window.scrollY}}function g({x:t,y:i}){return{unitX:t/n.width,unitY:i/n.height}}function S(t){P[t?"unshift":"push"](()=>{n=t,s(1,n)})}return o.$$set=t=>{"strokesArray"in t&&s(0,l=t.strokesArray)},[l,n,b,v,A,S]}class J extends E{constructor(e){super();N(this,e,H,q,F,{strokesArray:0})}}export{J as default};
