var Le=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ce=(o,t,e)=>t in o?Le(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,fe=(o,t)=>{for(var e in t||(t={}))Ee.call(t,e)&&ce(o,e,t[e]);if(ae)for(var e of ae(t))Se.call(t,e)&&ce(o,e,t[e]);return o};import{S as G,i as J,s as K,l as he,f as w,x as T,j as Q,m as Z,o as x,u as D,v as $,r as me,w as de,a5 as We,d as g,a1 as pe,G as ee,k as C,n as R,H as te,I as ne,J as oe,D as F,t as Ce,g as Re,a6 as I,a7 as P,a as L,b as _,K as se,L as U,e as re,c as le,a8 as M,a9 as _e,aa as Fe,A as ge,$ as ie,ab as ye,ac as Ie}from"./vendor-e4153bd8.js";import{u as Pe,b as ue,c as be,a as ke,g as Ne}from"./store-acbdb0b4.js";import{d as O,c as we}from"./canvas-257efe3e.js";function Te(o,t,e){const r=o.slice();return r[5]=t[e],r}function ve(o){let t,e,r=o[0].pencilColors,n=[];for(let l=0;l<r.length;l+=1)n[l]=Ae(Te(o,r,l));const u=l=>D(n[l],1,1,()=>{n[l]=null});return{c(){for(let l=0;l<n.length;l+=1)n[l].c();t=he()},l(l){for(let a=0;a<n.length;a+=1)n[a].l(l);t=he()},m(l,a){for(let s=0;s<n.length;s+=1)n[s].m(l,a);w(l,t,a),e=!0},p(l,a){if(a&1){r=l[0].pencilColors;let s;for(s=0;s<r.length;s+=1){const i=Te(l,r,s);n[s]?(n[s].p(i,a),T(n[s],1)):(n[s]=Ae(i),n[s].c(),T(n[s],1),n[s].m(t.parentNode,t))}for(me(),s=r.length;s<n.length;s+=1)u(s);de()}},i(l){if(!e){for(let a=0;a<r.length;a+=1)T(n[a]);e=!0}},o(l){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)D(n[a]);e=!1},d(l){We(n,l),l&&g(t)}}}function je(o){let t,e,r,n,u,l,a,s,i;return{c(){t=I("svg"),e=I("g"),r=I("path"),n=I("polygon"),l=I("path"),a=I("path"),i=C(),this.h()},l(m){t=P(m,"svg",{preserveAspectRatio:!0,version:!0,id:!0,xmlns:!0,"xmlns:xlink":!0,x:!0,y:!0,width:!0,height:!0,":viewbox":!0,style:!0,"xml:space":!0});var c=L(t);e=P(c,"g",{});var f=L(e);r=P(f,"path",{d:!0}),L(r).forEach(g),n=P(f,"polygon",{style:!0,points:!0}),L(n).forEach(g),l=P(f,"path",{style:!0,d:!0}),L(l).forEach(g),a=P(f,"path",{style:!0,d:!0}),L(a).forEach(g),f.forEach(g),c.forEach(g),i=R(m),this.h()},h(){_(r,"d",`M0,0v72.377c0,1.588,0.234,3.169,0.698,4.706l45.416,150.032C46.633,228.828,48.212,230,50,230s3.367-1.172,3.886-2.883\r
            L99.31,77.079c0.457-1.525,0.69-3.108,0.69-4.702V0.002`),_(n,"style",u=`fill: ${o[5]};`),_(n,"points","50,211.978 38.879,175.24 61.122,175.24"),se(l,"fill","#424242"),_(l,"d",`M63.581,167.118H36.42L8.765,75.761l10.924-9.63l12.5,11.015c1.54,1.353,3.835,1.35,5.375-0.002\r
              l12.468-11.007l12.464,11.005c1.54,1.357,3.839,1.357,5.377,0l12.465-11.005l10.9,9.623L63.581,167.118z`),_(a,"style",s=`fill: ${o[5]};`),_(a,"d",`M91.878,0v65.486l-8.852-7.813c-1.539-1.353-3.838-1.354-5.377,0.002L65.185,68.679L52.72,57.674\r
              c-1.539-1.356-3.838-1.354-5.377-0.002L34.871,68.683L22.375,57.67c-0.769-0.676-1.725-1.013-2.685-1.013\r
              c-0.959,0-1.919,0.339-2.685,1.013L8.121,65.5L8.098,0.024L91.878,0z`),_(t,"preserveAspectRatio","none"),_(t,"version","1.1"),_(t,"id","Layer_1"),_(t,"xmlns","http://www.w3.org/2000/svg"),_(t,"xmlns:xlink","http://www.w3.org/1999/xlink"),_(t,"x","0px"),_(t,"y","0px"),_(t,"width","16px"),_(t,"height","35px"),_(t,":viewbox","`0 0 100 230`"),se(t,"enable-background","new 0 0 100 230"),_(t,"xml:space","preserve")},m(m,c){w(m,t,c),U(t,e),U(e,r),U(e,n),U(e,l),U(e,a),w(m,i,c)},p(m,c){c&1&&u!==(u=`fill: ${m[5]};`)&&_(n,"style",u),c&1&&s!==(s=`fill: ${m[5]};`)&&_(a,"style",s)},d(m){m&&g(t),m&&g(i)}}}function Ae(o){let t,e;function r(){return o[2](o[5])}return t=new pe({props:{$$slots:{default:[je]},$$scope:{ctx:o}}}),t.$on("click",r),{c(){Q(t.$$.fragment)},l(n){Z(t.$$.fragment,n)},m(n,u){x(t,n,u),e=!0},p(n,u){o=n;const l={};u&17&&(l.$$scope={dirty:u,ctx:o}),t.$set(l)},i(n){e||(T(t.$$.fragment,n),e=!0)},o(n){D(t.$$.fragment,n),e=!1},d(n){$(t,n)}}}function Be(o){let t;return{c(){t=Ce("Eraser")},l(e){t=Re(e,"Eraser")},m(e,r){w(e,t,r)},d(e){e&&g(t)}}}function Ue(o){let t=Object.keys(o[0]).length>0,e,r,n,u,l=t&&ve(o);r=new pe({props:{$$slots:{default:[Be]},$$scope:{ctx:o}}}),r.$on("click",o[3]);const a=o[1].default,s=ee(a,o,o[4],null);return{c(){l&&l.c(),e=C(),Q(r.$$.fragment),n=C(),s&&s.c()},l(i){l&&l.l(i),e=R(i),Z(r.$$.fragment,i),n=R(i),s&&s.l(i)},m(i,m){l&&l.m(i,m),w(i,e,m),x(r,i,m),w(i,n,m),s&&s.m(i,m),u=!0},p(i,[m]){m&1&&(t=Object.keys(i[0]).length>0),t?l?(l.p(i,m),m&1&&T(l,1)):(l=ve(i),l.c(),T(l,1),l.m(e.parentNode,e)):l&&(me(),D(l,1,1,()=>{l=null}),de());const c={};m&16&&(c.$$scope={dirty:m,ctx:i}),r.$set(c),s&&s.p&&(!u||m&16)&&te(s,a,i,i[4],u?oe(a,i[4],m,null):ne(i[4]),null)},i(i){u||(T(l),T(r.$$.fragment,i),T(s,i),u=!0)},o(i){D(l),D(r.$$.fragment,i),D(s,i),u=!1},d(i){l&&l.d(i),i&&g(e),$(r,i),i&&g(n),s&&s.d(i)}}}function Me(o,t,e){let r;F(o,Pe,s=>e(0,r=s));let{$$slots:n={},$$scope:u}=t;const l=s=>ue.set({type:"pencil",color:s,lineWidth:3}),a=()=>ue.set({type:"eraser",color:"",lineWidth:40});return o.$$set=s=>{"$$scope"in s&&e(4,u=s.$$scope)},[r,n,l,a,u]}class ze extends G{constructor(t){super();J(this,t,Me,Ue,K,{})}}function He(o){let t;const e=o[11].default,r=ee(e,o,o[13],null);return{c(){r&&r.c()},l(n){r&&r.l(n)},m(n,u){r&&r.m(n,u),t=!0},p(n,u){r&&r.p&&(!t||u&8192)&&te(r,e,n,n[13],t?oe(e,n[13],u,null):ne(n[13]),null)},i(n){t||(T(r,n),t=!0)},o(n){D(r,n),t=!1},d(n){r&&r.d(n)}}}function Oe(o){let t,e,r,n,u,l,a;return t=new ze({props:{$$slots:{default:[He]},$$scope:{ctx:o}}}),{c(){Q(t.$$.fragment),e=C(),r=re("canvas"),this.h()},l(s){Z(t.$$.fragment,s),e=R(s),r=le(s,"CANVAS",{style:!0});var i=L(r);i.forEach(g),this.h()},h(){_(r,"style",n=`background-color: #2e3131; width: ${o[2]}; height: ${o[1]}`)},m(s,i){x(t,s,i),w(s,e,i),w(s,r,i),o[12](r),u=!0,l||(a=[M(r,"touchstart",o[3]),M(r,"touchmove",o[4]),M(r,"touchend",o[5])],l=!0)},p(s,[i]){const m={};i&8192&&(m.$$scope={dirty:i,ctx:s}),t.$set(m),(!u||i&6&&n!==(n=`background-color: #2e3131; width: ${s[2]}; height: ${s[1]}`))&&_(r,"style",n)},i(s){u||(T(t.$$.fragment,s),u=!0)},o(s){D(t.$$.fragment,s),u=!1},d(s){$(t,s),s&&g(e),s&&g(r),o[12](null),l=!1,_e(a)}}}function Ve(o){return(o.endTime-o.startTime)/o.points.length}function Xe(o,t,e){let r,n,u;F(o,be,h=>e(1,r=h)),F(o,ke,h=>e(2,n=h)),F(o,ue,h=>e(17,u=h));let{$$slots:l={},$$scope:a}=t,{strokesArray:s}=t,{currentTime:i=0}=t;const m=Fe();let c,f=[],d,v=!1,E={x:-1,y:-1},N={points:[]},S;ge(()=>{e(8,c=d.getContext("2d"))});function j(h){h.touches.length>1||(h.touches[0].touchType,H(h,{isInitialContact:!0}))}function z(h){if(!!v){if(h.touches.length>1){console.log("touchmove ignored: only 1 finger allowed");return}h.touches[0].touchType,H(h,{isInitialContact:!1})}}function V(h){!v||h.touches.length>0||(h.changedTouches[0].touchType,p(N),v=!1)}function X(h){v=!0,E={x:-1,y:-1},N={strokeNumber:s.length+1,startTime:Number(i.toFixed(1)),color:u.color,lineWidth:u.lineWidth,isErasing:u.type==="eraser",points:[],sessionID:"123"}}function H(h,{isInitialContact:k}){h.preventDefault(),k&&X();const A=b(h);Y(h,A)}function Y(h,k){N.points.push({unitX:parseFloat(k.x/d.width).toFixed(4),unitY:parseFloat(k.y/d.height).toFixed(4)}),E.x!==-1&&E.y!==-1&&we([y(E),y(k)],1,u.type==="eraser",c,u.color,u.lineWidth,d),E=k}function p(h){h.endTime=Number(i.toFixed(1)),h.id=Ne(),f.push(h),m("stroke-drawn",{newStroke:h})}function b(h){const{left:k,top:A}=d.getBoundingClientRect();return{x:h.touches[0].pageX-k-window.scrollX,y:h.touches[0].pageY-A-window.scrollY}}function y({x:h,y:k}){return{unitX:h/d.width,unitY:k/d.height}}function B(){c.clearRect(0,0,n,r)}function q(h){ie[h?"unshift":"push"](()=>{d=h,e(0,d),e(8,c),e(2,n),e(1,r),e(6,s)})}return o.$$set=h=>{"strokesArray"in h&&e(6,s=h.strokesArray),"currentTime"in h&&e(7,i=h.currentTime),"$$scope"in h&&e(13,a=h.$$scope)},o.$$.update=()=>{if(o.$$.dirty&327&&c){e(0,d.width=n,d),e(0,d.height=r,d);for(const h of s)O(h,null,c,d)}if(o.$$.dirty&1857&&c){let h=f.length,k=s.length;if(h!==k)if(h<k)if(h===0){for(const A of s)O(A,null,c,d);e(9,f=[...s])}else for(let A=h;A<k;A++){const W=s[A];O(W,W.startTime!==W.endTime?Ve(W):null,c,d),f.push(W)}else{let A=function(){B(),e(9,f=[]),E={x:-1,y:-1};for(const De of s)O(De,null,c,d)};(function(){console.log("debounced board reset"),S&&clearTimeout(S),e(10,S=setTimeout(A,1e3))})()}}},[d,r,n,j,z,V,s,i,c,f,S,l,q,a]}class $e extends G{constructor(t){super();J(this,t,Xe,Oe,K,{strokesArray:6,currentTime:7})}}function Ye(o){let t,e,r,n,u,l,a,s,i;const m=o[10].default,c=ee(m,o,o[9],null);return{c(){c&&c.c(),t=C(),e=re("canvas"),n=C(),u=re("audio"),this.h()},l(f){c&&c.l(f),t=R(f),e=le(f,"CANVAS",{style:!0});var d=L(e);d.forEach(g),n=R(f),u=le(f,"AUDIO",{src:!0,style:!0});var v=L(u);v.forEach(g),this.h()},h(){_(e,"style",r=`background-color: #2e3131; width: ${o[3]}; height: ${o[2]}`),ye(u.src,l=o[0])||_(u,"src",l),u.controls=!0,se(u,"width","100%")},m(f,d){c&&c.m(f,d),w(f,t,d),w(f,e,d),o[11](e),w(f,n,d),w(f,u,d),o[12](u),a=!0,s||(i=[M(u,"play",o[5]),M(u,"seeking",o[6])],s=!0)},p(f,[d]){c&&c.p&&(!a||d&512)&&te(c,m,f,f[9],a?oe(m,f[9],d,null):ne(f[9]),null),(!a||d&12&&r!==(r=`background-color: #2e3131; width: ${f[3]}; height: ${f[2]}`))&&_(e,"style",r),(!a||d&1&&!ye(u.src,l=f[0]))&&_(u,"src",l)},i(f){a||(T(c,f),a=!0)},o(f){D(c,f),a=!1},d(f){c&&c.d(f),f&&g(t),f&&g(e),o[11](null),f&&g(n),f&&g(u),o[12](null),s=!1,_e(i)}}}let qe=1;function Ge(o){return(o.endTime-o.startTime)/o.points.length}function Je(o,t,e){let r,n;F(o,be,p=>e(2,r=p)),F(o,ke,p=>e(3,n=p));let{$$slots:u={},$$scope:l}=t,{strokesArray:a}=t,{audioDownloadURL:s}=t,i,m=0,c,f,d,v;Ie(()=>{v&&clearTimeout(v)}),ge(()=>{e(8,f=c.getContext("2d"));const p=[];for(let b=0;b<a.length;b++)for(let y=1;y<a[b].points.length;y++){const B={strokeIndex:b,pointIndex:y};p.push(fe({startTime:E(B)},B))}i=p.sort((b,y)=>b.startTime-y.startTime)});function E({strokeIndex:p,pointIndex:b}){const y=a[p];return y.startTime+(b-1)*Ge(y)}function N(){m=0,f.clearRect(0,0,n,r),S()}function S(){if(!!d&&(j(),m<i.length)){const p=i[m],b=1e3*(p.startTime-d.currentTime);v=setTimeout(S,b/qe)}}function j(){if(!d)return;const p=i[m];(!p||p.startTime>d.currentTime)&&(f.clearRect(0,0,c.width,c.height),m=0),z()}function z(){const{currentTime:p}=d;for(let b=m;b<i.length;b++){const y=i[b];if(y.startTime>p)break;V(y),m+=1}}function V({strokeIndex:p,pointIndex:b}){const y=a[p],q=y.lineWidth*(c.scrollWidth/1e3);we(y.points,b,y.isErasing,f,y.color,q,c)}function X(){return new Promise(async p=>{v?(m=0,j()):z(),p()})}function H(p){ie[p?"unshift":"push"](()=>{c=p,e(4,c),e(8,f),e(1,d),e(3,n),e(2,r)})}function Y(p){ie[p?"unshift":"push"](()=>{d=p,e(1,d)})}return o.$$set=p=>{"strokesArray"in p&&e(7,a=p.strokesArray),"audioDownloadURL"in p&&e(0,s=p.audioDownloadURL),"$$scope"in p&&e(9,l=p.$$scope)},o.$$.update=()=>{o.$$.dirty&270&&f&&d&&(e(4,c.width=n,c),e(4,c.height=r,c),X())},[s,d,r,n,c,N,j,a,f,l,u,H,Y]}class et extends G{constructor(t){super();J(this,t,Je,Ye,K,{strokesArray:7,audioDownloadURL:0})}}export{$e as B,et as D};
